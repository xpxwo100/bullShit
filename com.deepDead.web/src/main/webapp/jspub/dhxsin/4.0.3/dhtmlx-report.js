/*
Product Name: dhtmlxSuite 
Version: 4.0.3 
Edition: Professional 
License: content of this file is covered by DHTMLX Commercial or Enterprise license. Usage without proper license is prohibited. To obtain it contact sales@dhtmlx.com
Copyright UAB Dinamenta http://www.dhtmlx.com
*/

if(typeof(window.dhx4)=="undefined"){window.dhx4={version:"4.0.3",skin:null,skinDetect:function(c){var d=document.createElement("DIV");d.className=c+"_skin_detect";if(document.body.firstChild){document.body.insertBefore(d,document.body.firstChild)}else{document.body.appendChild(d)}var a=d.offsetWidth;d.parentNode.removeChild(d);d=null;return{10:"dhx_skyblue",20:"dhx_web",30:"dhx_terrace"}[a]||null},lastId:1,newId:function(){return this.lastId++},zim:{data:{},step:5,first:function(){return 100},last:function(){var d=this.first();for(var c in this.data){d=Math.max(d,this.data[c])}return d},reserve:function(a){this.data[a]=this.last()+this.step;return this.data[a]},clear:function(a){if(this.data[a]!=null){this.data[a]=null;delete this.data[a]}}},s2b:function(a){return(a==true||a==1||a=="true"||a=="1"||a=="yes"||a=="y")},trim:function(a){return String(a).replace(/^\s{1,}/,"").replace(/\s{1,}$/,"")},template:function(c,d,a){return c.replace(/#([a-zA-Z0-9_-]{1,})#/g,function(f,e){if(e.length>0&&typeof(d[e])!="undefined"){if(a==true){return window.dhx4.trim(d[e])}return String(d[e])}return""})},absLeft:function(a){if(typeof(a)=="string"){a=document.getElementById(a)}return this._aOfs(a).left},absTop:function(a){if(typeof(a)=="string"){a=document.getElementById(a)}return this._aOfs(a).top},_aOfsSum:function(a){var d=0,c=0;while(a){d=d+parseInt(a.offsetTop);c=c+parseInt(a.offsetLeft);a=a.offsetParent}return{top:d,left:c}},_aOfsRect:function(e){var h=e.getBoundingClientRect();var k=document.body;var c=document.documentElement;var a=window.pageYOffset||c.scrollTop||k.scrollTop;var f=window.pageXOffset||c.scrollLeft||k.scrollLeft;var g=c.clientTop||k.clientTop||0;var l=c.clientLeft||k.clientLeft||0;var m=h.top+a-g;var d=h.left+f-l;return{top:Math.round(m),left:Math.round(d)}},_aOfs:function(a){if(a.getBoundingClientRect){return this._aOfsRect(a)}else{return this._aOfsSum(a)}},_isObj:function(a){return(a!=null&&typeof(a)=="object"&&typeof(a.length)=="undefined")},_copyObj:function(e){if(this._isObj(e)){var d={};for(var c in e){if(typeof(e[c])=="object"&&e[c]!=null){d[c]=this._copyObj(e[c])}else{d[c]=e[c]}}}else{var d=[];for(var c=0;c<e.length;c++){if(typeof(e[c])=="object"&&e[c]!=null){d[c]=this._copyObj(e[c])}else{d[c]=e[c]}}}return d},screenDim:function(){var a=(navigator.userAgent.indexOf("MSIE")>=0);var c={};c.left=document.body.scrollLeft;c.right=c.left+(window.innerWidth||document.body.clientWidth);c.top=Math.max((a?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop);c.bottom=c.top+(a?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0):window.innerHeight);return c},selectTextRange:function(f,h,c){f=(typeof(f)=="string"?document.getElementById(f):f);var a=f.value.length;h=Math.max(Math.min(h,a),0);c=Math.min(c,a);if(f.setSelectionRange){try{f.setSelectionRange(h,c)}catch(g){}}else{if(f.createTextRange){var d=f.createTextRange();d.moveStart("character",h);d.moveEnd("character",c-a);try{d.select()}catch(g){}}}},transData:null,transDetect:function(){if(this.transData==null){this.transData={transProp:false,transEv:null};var d={MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"transitionend",transition:"transitionend"};for(var c in d){if(this.transData.transProp==false&&document.documentElement.style[c]!=null){this.transData.transProp=c;this.transData.transEv=d[c]}}d=null}return this.transData}};window.dhx4.isIE=(navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0);window.dhx4.isIE6=(window.XMLHttpRequest==null&&navigator.userAgent.indexOf("MSIE")>=0);window.dhx4.isIE7=(navigator.userAgent.indexOf("MSIE 7.0")>=0&&navigator.userAgent.indexOf("Trident")<0);window.dhx4.isOpera=(navigator.userAgent.indexOf("Opera")>=0);window.dhx4.isChrome=(navigator.userAgent.indexOf("Chrome")>=0);window.dhx4.isKHTML=(navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0);window.dhx4.isFF=(navigator.userAgent.indexOf("Firefox")>=0);window.dhx4.isIPad=(navigator.userAgent.search(/iPad/gi)>=0)}if(typeof(window.dhx4.ajax)=="undefined"){window.dhx4.ajax={cache:false,method:"post",get:function(a,c){this._call("GET",a,null,true,c)},getSync:function(a){return this._call("GET",a,null,false)},post:function(c,a,d){if(arguments.length==1){a=""}else{if(arguments.length==2&&(typeof(a)=="function"||typeof(window[a])=="function")){d=a;a=""}else{a=String(a)}}this._call("POST",c,a,true,d)},postSync:function(c,a){a=(a==null?"":String(a));return this._call("POST",c,a,false)},getLong:function(a,c){this._call("GET",a,null,true,c,{url:a})},postLong:function(c,a,d){if(arguments.length==2&&(typeof(a)=="function"||typeof(window[a]))){d=a;a=""}this._call("POST",c,a,true,d,{url:c,postData:a})},_call:function(k,c,a,g,f,e){var d=(window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"));var h=(navigator.userAgent.match(/AppleWebKit/)!=null&&navigator.userAgent.match(/Qt/)!=null&&navigator.userAgent.match(/Safari/)!=null);if(g==true){d.onreadystatechange=function(){if((d.readyState==4&&d.status==200)||(h==true&&d.readyState==3)){window.setTimeout(function(){if(typeof(f)=="function"){f.apply(window,[{xmlDoc:d}])}if(e!=null){if(typeof(e.postData)!="undefined"){dhx4.ajax.postLong(e.url,e.postData,f)}else{dhx4.ajax.getLong(e.url,f)}}f=null;d=null},1)}}}if(k=="GET"&&this.cache!=true){c+=(c.indexOf("?")>=0?"&":"?")+"dhxr"+new Date().getTime()}d.open(k,c,g);if(k=="POST"){d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");if(this.cache!=true){a+=(a.length>0?"&":"")+"dhxr"+new Date().getTime()}}else{a=null}d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.send(a);if(!g){return{xmlDoc:d}}}}}if(typeof(window.dhx4._enableDataLoading)=="undefined"){window.dhx4._enableDataLoading=function(obj,initObj,xmlToJson,xmlRootTag,mode){if(mode=="clear"){for(var a in obj._dhxdataload){obj._dhxdataload[a]=null;delete obj._dhxdataload[a]}obj._loadData=null;obj._dhxdataload=null;obj.load=null;obj.loadStruct=null;obj=null;return}obj._dhxdataload={initObj:initObj,xmlToJson:xmlToJson,xmlRootTag:xmlRootTag,onBeforeXLS:null};obj._loadData=function(data,loadParams,onLoad){if(arguments.length==2){onLoad=loadParams;loadParams=null}var obj=null;if(arguments.length==3){onLoad=arguments[2]}if(typeof(data)=="string"){var k=data.replace(/^\s{1,}/,"").replace(/\s{1,}$/,"");var tag=new RegExp("^<"+this._dhxdataload.xmlRootTag);if(tag.test(k.replace(/^<\?xml[^\?]*\?>\s*/,""))){if(window.DOMParser){obj=(new window.DOMParser()).parseFromString(data,"text/xml")}else{if(typeof(window.ActiveXObject)!="undefined"){obj=new window.ActiveXObject("Microsoft.XMLDOM");obj.async="false";obj.loadXML(data)}}if(obj!=null){obj=this[this._dhxdataload.xmlToJson].apply(this,[obj])}}if(obj==null&&(k.match(/^\{.*\}$/)!=null||k.match(/^\[.*\]$/)!=null)){try{eval("dhx4.temp="+k)}catch(e){dhx4.temp=null}obj=dhx4.temp;dhx4.temp=null}if(obj==null){this.callEvent("onXLS",[]);var params=[];if(typeof(this._dhxdataload.onBeforeXLS)=="function"){var k=this._dhxdataload.onBeforeXLS.apply(this,[data]);if(k!=null&&typeof(k)=="object"){if(k.url!=null){data=k.url}if(k.params!=null){for(var a in k.params){params.push(a+"="+encodeURIComponent(k.params[a]))}}}}var t=this;var callBack=function(r){var obj=null;if((r.xmlDoc.getResponseHeader("Content-Type")||"").search(/xml/gi)>=0||(r.xmlDoc.responseText.replace(/^\s{1,}/,"")).match(/^</)!=null){obj=t[t._dhxdataload.xmlToJson].apply(t,[r.xmlDoc.responseXML])}else{try{eval("dhx4.temp="+r.xmlDoc.responseText)}catch(e){dhx4.temp=null}obj=dhx4.temp;dhx4.temp=null}if(obj!=null){t[t._dhxdataload.initObj].apply(t,[obj,data])}t.callEvent("onXLE",[]);if(onLoad!=null){if(typeof(onLoad)=="function"){onLoad.apply(t,[])}else{if(typeof(window[onLoad])=="function"){window[onLoad].apply(t,[])}}}callBack=onLoad=null;obj=r=t=null};params=params.join("&")+(typeof(loadParams)=="string"?"&"+loadParams:"");if(dhx4.ajax.method=="post"){dhx4.ajax.post(data,params,callBack)}else{if(dhx4.ajax.method=="get"){dhx4.ajax.get(data+(data.indexOf("?")>0?"":"")+params,callBack)}}return}}else{if(typeof(data.documentElement)=="object"||(typeof(data.tagName)!="undefined"&&typeof(data.getElementsByTagName)!="undefined"&&data.getElementsByTagName(this._dhxdataload.xmlRootTag).length>0)){obj=this[this._dhxdataload.xmlToJson].apply(this,[data])}else{obj=window.dhx4._copyObj(data)}}if(obj!=null){this[this._dhxdataload.initObj].apply(this,[obj])}if(onLoad!=null){if(typeof(onLoad)=="function"){onLoad.apply(this,[])}else{if(typeof(window[onLoad])=="function"){window[onLoad].apply(this,[])}}onLoad=null}};if(mode!=null){var k={struct:"loadStruct",data:"load"};for(var a in mode){if(mode[a]==true){obj[k[a]]=function(){return this._loadData.apply(this,arguments)}}}}obj=null}}if(typeof(window.dhx4._eventable)=="undefined"){window.dhx4._eventable=function(a,c){if(c=="clear"){a.detachAllEvents();a.dhxevs=null;a.attachEvent=null;a.detachEvent=null;a.checkEvent=null;a.callEvent=null;a.detachAllEvents=null;a=null;return}a.dhxevs={data:{}};a.attachEvent=function(d,f){d=String(d).toLowerCase();if(!this.dhxevs.data[d]){this.dhxevs.data[d]={}}var e=window.dhx4.newId();this.dhxevs.data[d][e]=f;return e};a.detachEvent=function(g){for(var e in this.dhxevs.data){var f=0;for(var d in this.dhxevs.data[e]){if(d==g){this.dhxevs.data[e][d]=null;delete this.dhxevs.data[e][d]}else{f++}}if(f==0){this.dhxevs.data[e]=null;delete this.dhxevs.data[e]}}};a.checkEvent=function(d){d=String(d).toLowerCase();return(this.dhxevs.data[d]!=null)};a.callEvent=function(e,g){e=String(e).toLowerCase();if(this.dhxevs.data[e]==null){return true}var f=true;for(var d in this.dhxevs.data[e]){f=this.dhxevs.data[e][d].apply(this,g)&&f}return f};a.detachAllEvents=function(){for(var e in this.dhxevs.data){for(var d in this.dhxevs.data[e]){this.dhxevs.data[e][d]=null;delete this.dhxevs.data[e][d]}this.dhxevs.data[e]=null;delete this.dhxevs.data[e]}};a=null}}dhtmlx=function(d){for(var c in d){dhtmlx[c]=d[c]}return dhtmlx};dhtmlx.extend_api=function(a,e,d){var c=window[a];if(!c){return}window[a]=function(h){if(h&&typeof h=="object"&&!h.tagName){var g=c.apply(this,(e._init?e._init(h):arguments));for(var f in dhtmlx){if(e[f]){this[e[f]](dhtmlx[f])}}for(var f in h){if(e[f]){this[e[f]](h[f])}else{if(f.indexOf("on")==0){this.attachEvent(f,h[f])}}}}else{var g=c.apply(this,arguments)}if(e._patch){e._patch(this)}return g||this};window[a].prototype=c.prototype;if(d){dhtmlXHeir(window[a].prototype,d)}};dhtmlxAjax={get:function(a,d){var c=new dtmlXMLLoaderObject(true);c.async=(arguments.length<3);c.waitCall=d;c.loadXML(a);return c},post:function(a,d,e){var c=new dtmlXMLLoaderObject(true);c.async=(arguments.length<4);c.waitCall=e;c.loadXML(a,true,d);return c},getSync:function(a){return this.get(a,null,true)},postSync:function(a,c){return this.post(a,c,null,true)}};function dtmlXMLLoaderObject(c,e,d,a){this.xmlDoc="";if(typeof(d)!="undefined"){this.async=d}else{this.async=true}this.onloadAction=c||null;this.mainObject=e||null;this.waitCall=null;this.rSeed=a||false;return this}dtmlXMLLoaderObject.count=0;dtmlXMLLoaderObject.prototype.waitLoadFunction=function(c){var a=true;this.check=function(){if((c)&&(c.onloadAction!=null)){if((!c.xmlDoc.readyState)||(c.xmlDoc.readyState==4)){if(!a){return}a=false;dtmlXMLLoaderObject.count++;if(typeof c.onloadAction=="function"){c.onloadAction(c.mainObject,null,null,null,c)}if(c.waitCall){c.waitCall.call(this,c);c.waitCall=null}}}};return this.check};dtmlXMLLoaderObject.prototype.getXMLTopNode=function(d,a){if(typeof this.xmlDoc.status=="undefined"||this.xmlDoc.status<400){if(this.xmlDoc.responseXML){var c=this.xmlDoc.responseXML.getElementsByTagName(d);if(c.length==0&&d.indexOf(":")!=-1){var c=this.xmlDoc.responseXML.getElementsByTagName((d.split(":"))[1])}var e=c[0]}else{var e=this.xmlDoc.documentElement}if(e){this._retry=false;return e}if(!this._retry&&_isIE){this._retry=true;var a=this.xmlDoc;this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),true);return this.getXMLTopNode(d,a)}}dhtmlxError.throwError("LoadXML","Incorrect XML",[(a||this.xmlDoc),this.mainObject]);return document.createElement("DIV")};dtmlXMLLoaderObject.prototype.loadXMLString=function(c,a){if(!_isIE){var d=new DOMParser();this.xmlDoc=d.parseFromString(c,"text/xml")}else{this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM");this.xmlDoc.async=this.async;this.xmlDoc.onreadystatechange=function(){};this.xmlDoc.loadXML(c)}if(a){return}if(this.onloadAction){this.onloadAction(this.mainObject,null,null,null,this)}if(this.waitCall){this.waitCall();this.waitCall=null}};dtmlXMLLoaderObject.prototype.loadXML=function(d,c,a,e){if(this.rSeed){d+=((d.indexOf("?")!=-1)?"&":"?")+"a_dhx_rSeed="+(new Date()).valueOf()}this.filePath=d;if((!_isIE)&&(window.XMLHttpRequest)){this.xmlDoc=new XMLHttpRequest()}else{this.xmlDoc=new ActiveXObject("Microsoft.XMLHTTP")}if(this.async){this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this)}this.xmlDoc.open(c?"POST":"GET",d,this.async);if(e){this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")");this.xmlDoc.setRequestHeader("Content-type","text/xml")}else{if(c){this.xmlDoc.setRequestHeader("Content-type",(this.contenttype||"application/x-www-form-urlencoded"))}}this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest");this.xmlDoc.send(null||a);if(!this.async){(new this.waitLoadFunction(this))()}};dtmlXMLLoaderObject.prototype.destructor=function(){this._filterXPath=null;this._getAllNamedChilds=null;this._retry=null;this.async=null;this.rSeed=null;this.filePath=null;this.onloadAction=null;this.mainObject=null;this.xmlDoc=null;this.doXPath=null;this.doXPathOpera=null;this.doXSLTransToObject=null;this.doXSLTransToString=null;this.loadXML=null;this.loadXMLString=null;this.doSerialization=null;this.xmlNodeToJSON=null;this.getXMLTopNode=null;this.setXSLParamValue=null;return null};dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(e){var d={};for(var c=0;c<e.attributes.length;c++){d[e.attributes[c].name]=e.attributes[c].value}d._tagvalue=e.firstChild?e.firstChild.nodeValue:"";for(var c=0;c<e.childNodes.length;c++){var a=e.childNodes[c].tagName;if(a){if(!d[a]){d[a]=[]}d[a].push(this.xmlNodeToJSON(e.childNodes[c]))}}return d};function callerFunction(a,c){this.handler=function(d){if(!d){d=window.event}a(d,c);return true};return this.handler}function getAbsoluteLeft(a){return getOffset(a).left}function getAbsoluteTop(a){return getOffset(a).top}function getOffsetSum(a){var d=0,c=0;while(a){d=d+parseInt(a.offsetTop);c=c+parseInt(a.offsetLeft);a=a.offsetParent}return{top:d,left:c}}function getOffsetRect(e){var h=e.getBoundingClientRect();var k=document.body;var c=document.documentElement;var a=window.pageYOffset||c.scrollTop||k.scrollTop;var f=window.pageXOffset||c.scrollLeft||k.scrollLeft;var g=c.clientTop||k.clientTop||0;var l=c.clientLeft||k.clientLeft||0;var m=h.top+a-g;var d=h.left+f-l;return{top:Math.round(m),left:Math.round(d)}}function getOffset(a){if(a.getBoundingClientRect){return getOffsetRect(a)}else{return getOffsetSum(a)}}function convertStringToBoolean(a){if(typeof(a)=="string"){a=a.toLowerCase()}switch(a){case"1":case"true":case"yes":case"y":case 1:case true:return true;break;default:return false}}function getUrlSymbol(a){if(a.indexOf("?")!=-1){return"&"}else{return"?"}}function dhtmlDragAndDropObject(){if(window.dhtmlDragAndDrop){return window.dhtmlDragAndDrop}this.lastLanding=0;this.dragNode=0;this.dragStartNode=0;this.dragStartObject=0;this.tempDOMU=null;this.tempDOMM=null;this.waitDrag=0;window.dhtmlDragAndDrop=this;return this}dhtmlDragAndDropObject.prototype.removeDraggableItem=function(a){a.onmousedown=null;a.dragStarter=null;a.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(a,c){a.onmousedown=this.preCreateDragCopy;a.dragStarter=c;this.addDragLanding(a,c)};dhtmlDragAndDropObject.prototype.addDragLanding=function(a,c){a.dragLanding=c};dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(a){if((a||window.event)&&(a||event).button==2){return}if(window.dhtmlDragAndDrop.waitDrag){window.dhtmlDragAndDrop.waitDrag=0;document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU;document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM;return false}if(window.dhtmlDragAndDrop.dragNode){window.dhtmlDragAndDrop.stopDrag(a)}window.dhtmlDragAndDrop.waitDrag=1;window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup;window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove;window.dhtmlDragAndDrop.dragStartNode=this;window.dhtmlDragAndDrop.dragStartObject=this.dragStarter;document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy;document.body.onmousemove=window.dhtmlDragAndDrop.callDrag;window.dhtmlDragAndDrop.downtime=new Date().valueOf();if((a)&&(a.preventDefault)){a.preventDefault();return false}return false};dhtmlDragAndDropObject.prototype.callDrag=function(d){if(!d){d=window.event}dragger=window.dhtmlDragAndDrop;if((new Date()).valueOf()-dragger.downtime<100){return}if(!dragger.dragNode){if(dragger.waitDrag){dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,d);if(!dragger.dragNode){return dragger.stopDrag()}dragger.dragNode.onselectstart=function(){return false};dragger.gldragNode=dragger.dragNode;document.body.appendChild(dragger.dragNode);document.body.onmouseup=dragger.stopDrag;dragger.waitDrag=0;dragger.dragNode.pWindow=window;dragger.initFrameRoute()}else{return dragger.stopDrag(d,true)}}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var a=dragger.gldragNode;if(dragger.gldragNode.old){a=dragger.gldragNode.old}a.parentNode.removeChild(a);var c=dragger.dragNode.pWindow;if(a.pWindow&&a.pWindow.dhtmlDragAndDrop.lastLanding){a.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(a.pWindow.dhtmlDragAndDrop.lastLanding)}if(_isIE){var g=document.createElement("Div");g.innerHTML=dragger.dragNode.outerHTML;dragger.dragNode=g.childNodes[0]}else{dragger.dragNode=dragger.dragNode.cloneNode(true)}dragger.dragNode.pWindow=window;dragger.gldragNode.old=dragger.dragNode;document.body.appendChild(dragger.dragNode);c.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=d.clientX+15+(dragger.fx?dragger.fx*(-1):0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";dragger.dragNode.style.top=d.clientY+3+(dragger.fy?dragger.fy*(-1):0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";if(!d.srcElement){var f=d.target}else{f=d.srcElement}dragger.checkLanding(f,d)};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(f){if(window.name){var d=parent.frames[window.name].frameElement.offsetParent;var e=0;var c=0;while(d){e+=d.offsetLeft;c+=d.offsetTop;d=d.offsetParent}if((parent.dhtmlDragAndDrop)){var a=parent.dhtmlDragAndDrop.calculateFramePosition(1);e+=a.split("_")[0]*1;c+=a.split("_")[1]*1}if(f){return e+"_"+c}else{this.fx=e}this.fy=c}return"0_0"};dhtmlDragAndDropObject.prototype.checkLanding=function(c,a){if((c)&&(c.dragLanding)){if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding)}this.lastLanding=c;this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,a.clientX,a.clientY,a);this.lastLanding_scr=(_isIE?a.srcElement:a.target)}else{if((c)&&(c.tagName!="BODY")){this.checkLanding(c.parentNode,a)}else{if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding,a.clientX,a.clientY,a)}this.lastLanding=0;if(this._onNotFound){this._onNotFound()}}}};dhtmlDragAndDropObject.prototype.stopDrag=function(c,d){dragger=window.dhtmlDragAndDrop;if(!d){dragger.stopFrameRoute();var a=dragger.lastLanding;dragger.lastLanding=null;if(a){a.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,a,(_isIE?event.srcElement:c.target))}}dragger.lastLanding=null;if((dragger.dragNode)&&(dragger.dragNode.parentNode==document.body)){dragger.dragNode.parentNode.removeChild(dragger.dragNode)}dragger.dragNode=0;dragger.gldragNode=0;dragger.fx=0;dragger.fy=0;dragger.dragStartNode=0;dragger.dragStartObject=0;document.body.onmouseup=dragger.tempDOMU;document.body.onmousemove=dragger.tempDOMM;dragger.tempDOMU=null;dragger.tempDOMM=null;dragger.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(d){if(d){window.dhtmlDragAndDrop.stopDrag(1,1)}for(var a=0;a<window.frames.length;a++){try{if((window.frames[a]!=d)&&(window.frames[a].dhtmlDragAndDrop)){window.frames[a].dhtmlDragAndDrop.stopFrameRoute(window)}}catch(c){}}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=d)){parent.dhtmlDragAndDrop.stopFrameRoute(window)}}catch(c){}};dhtmlDragAndDropObject.prototype.initFrameRoute=function(d,f){if(d){window.dhtmlDragAndDrop.preCreateDragCopy();window.dhtmlDragAndDrop.dragStartNode=d.dhtmlDragAndDrop.dragStartNode;window.dhtmlDragAndDrop.dragStartObject=d.dhtmlDragAndDrop.dragStartObject;window.dhtmlDragAndDrop.dragNode=d.dhtmlDragAndDrop.dragNode;window.dhtmlDragAndDrop.gldragNode=d.dhtmlDragAndDrop.dragNode;window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag;window.waitDrag=0;if(((!_isIE)&&(f))&&((!_isFF)||(_FFrv<1.8))){window.dhtmlDragAndDrop.calculateFramePosition()}}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=d)){parent.dhtmlDragAndDrop.initFrameRoute(window)}}catch(c){}for(var a=0;a<window.frames.length;a++){try{if((window.frames[a]!=d)&&(window.frames[a].dhtmlDragAndDrop)){window.frames[a].dhtmlDragAndDrop.initFrameRoute(window,((!d||f)?1:0))}}catch(c){}}};_isFF=false;_isIE=false;_isOpera=false;_isKHTML=false;_isMacOS=false;_isChrome=false;_FFrv=false;_KHTMLrv=false;_OperaRv=false;if(navigator.userAgent.indexOf("Macintosh")!=-1){_isMacOS=true}if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){_isChrome=true}if((navigator.userAgent.indexOf("Safari")!=-1)||(navigator.userAgent.indexOf("Konqueror")!=-1)){_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5));if(_KHTMLrv>525){_isFF=true;_FFrv=1.9}else{_isKHTML=true}}else{if(navigator.userAgent.indexOf("Opera")!=-1){_isOpera=true;_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))}else{if(navigator.appName.indexOf("Microsoft")!=-1){_isIE=true;if((navigator.appVersion.indexOf("MSIE 8.0")!=-1||navigator.appVersion.indexOf("MSIE 9.0")!=-1||navigator.appVersion.indexOf("MSIE 10.0")!=-1||document.documentMode>7)&&document.compatMode!="BackCompat"){_isIE=8}}else{if(navigator.appName=="Netscape"&&navigator.userAgent.indexOf("Trident")!=-1){_isIE=8}else{_isFF=true;_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])}}}}dtmlXMLLoaderObject.prototype.doXPath=function(d,f,e,l){if(_isKHTML||(!_isIE&&!window.XPathResult)){return this.doXPathOpera(d,f)}if(_isIE){if(!f){if(!this.xmlDoc.nodeName){f=this.xmlDoc.responseXML}else{f=this.xmlDoc}}if(!f){dhtmlxError.throwError("LoadXML","Incorrect XML",[(f||this.xmlDoc),this.mainObject])}if(e!=null){f.setProperty("SelectionNamespaces","xmlns:xsl='"+e+"'")}if(l=="single"){return f.selectSingleNode(d)}else{return f.selectNodes(d)||new Array(0)}}else{var a=f;if(!f){if(!this.xmlDoc.nodeName){f=this.xmlDoc.responseXML}else{f=this.xmlDoc}}if(!f){dhtmlxError.throwError("LoadXML","Incorrect XML",[(f||this.xmlDoc),this.mainObject])}if(f.nodeName.indexOf("document")!=-1){a=f}else{a=f;f=f.ownerDocument}var h=XPathResult.ANY_TYPE;if(l=="single"){h=XPathResult.FIRST_ORDERED_NODE_TYPE}var g=new Array();var c=f.evaluate(d,a,function(m){return e},h,null);if(h==XPathResult.FIRST_ORDERED_NODE_TYPE){return c.singleNodeValue}var k=c.iterateNext();while(k){g[g.length]=k;k=c.iterateNext()}return g}};function _dhtmlxError(c,a,d){if(!this.catches){this.catches=new Array()}return this}_dhtmlxError.prototype.catchError=function(c,a){this.catches[c]=a};_dhtmlxError.prototype.throwError=function(c,a,d){if(this.catches[c]){return this.catches[c](c,a,d)}if(this.catches.ALL){return this.catches.ALL(c,a,d)}alert("Error type: "+arguments[0]+"\nDescription: "+arguments[1]);return null};window.dhtmlxError=new _dhtmlxError();dtmlXMLLoaderObject.prototype.doXPathOpera=function(d,a){var f=d.replace(/[\/]+/gi,"/").split("/");var e=null;var c=1;if(!f.length){return[]}if(f[0]=="."){e=[a]}else{if(f[0]==""){e=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(f[c].replace(/\[[^\]]*\]/g,""));c++}else{return[]}}for(c;c<f.length;c++){e=this._getAllNamedChilds(e,f[c])}if(f[c-1].indexOf("[")!=-1){e=this._filterXPath(e,f[c-1])}return e};dtmlXMLLoaderObject.prototype._filterXPath=function(e,d){var g=new Array();var d=d.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,"");for(var f=0;f<e.length;f++){if(e[f].getAttribute(d)){g[g.length]=e[f]}}return g};dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(e,d){var h=new Array();if(_isKHTML){d=d.toUpperCase()}for(var g=0;g<e.length;g++){for(var f=0;f<e[g].childNodes.length;f++){if(_isKHTML){if(e[g].childNodes[f].tagName&&e[g].childNodes[f].tagName.toUpperCase()==d){h[h.length]=e[g].childNodes[f]}}else{if(e[g].childNodes[f].tagName==d){h[h.length]=e[g].childNodes[f]}}}}return h};function dhtmlXHeir(e,d){for(var f in d){if(typeof(d[f])=="function"){e[f]=d[f]}}return e}function dhtmlxEvent(c,d,a){if(c.addEventListener){c.addEventListener(d,a,false)}else{if(c.attachEvent){c.attachEvent("on"+d,a)}}}dtmlXMLLoaderObject.prototype.xslDoc=null;dtmlXMLLoaderObject.prototype.setXSLParamValue=function(c,d,e){if(!e){e=this.xslDoc}if(e.responseXML){e=e.responseXML}var a=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+c+"']",e,"http://www.w3.org/1999/XSL/Transform","single");if(a!=null){a.firstChild.nodeValue=d}};dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(f,c){if(!f){f=this.xslDoc}if(f.responseXML){f=f.responseXML}if(!c){c=this.xmlDoc}if(c.responseXML){c=c.responseXML}if(!_isIE){if(!this.XSLProcessor){this.XSLProcessor=new XSLTProcessor();this.XSLProcessor.importStylesheet(f)}var a=this.XSLProcessor.transformToDocument(c)}else{var a=new ActiveXObject("Msxml2.DOMDocument.3.0");try{c.transformNodeToObject(f,a)}catch(d){a=c.transformNode(f)}}return a};dtmlXMLLoaderObject.prototype.doXSLTransToString=function(d,c){var a=this.doXSLTransToObject(d,c);if(typeof(a)=="string"){return a}return this.doSerialization(a)};dtmlXMLLoaderObject.prototype.doSerialization=function(c){if(!c){c=this.xmlDoc}if(c.responseXML){c=c.responseXML}if(!_isIE){var a=new XMLSerializer();return a.serializeToString(c)}else{return c.xml}};dhtmlxEventable=function(obj){obj.attachEvent=function(name,catcher,callObj){name="ev_"+name.toLowerCase();if(!this[name]){this[name]=new this.eventCatcher(callObj||this)}return(name+":"+this[name].addEvent(catcher))};obj.callEvent=function(name,arg0){name="ev_"+name.toLowerCase();if(this[name]){return this[name].apply(this,arg0)}return true};obj.checkEvent=function(name){return(!!this["ev_"+name.toLowerCase()])};obj.eventCatcher=function(obj){var dhx_catch=[];var z=function(){var res=true;for(var i=0;i<dhx_catch.length;i++){if(dhx_catch[i]!=null){var zr=dhx_catch[i].apply(obj,arguments);res=res&&zr}}return res};z.addEvent=function(ev){if(typeof(ev)!="function"){ev=eval(ev)}if(ev){return dhx_catch.push(ev)-1}return false};z.removeEvent=function(id){dhx_catch[id]=null};return z};obj.detachEvent=function(id){if(id!=false){var list=id.split(":");this[list[0]].removeEvent(list[1])}};obj.detachAllEvents=function(){for(var name in this){if(name.indexOf("ev_")==0){this.detachEvent(name);this[name]=null}}};obj=null};if(!window.dhtmlx){dhtmlx={}}dhtmlx.assert=function(c,a){if(!c){dhtmlx.error(a)}};dhtmlx.assert_enabled=function(){return false};dhtmlx.assert_event=function(g,d){if(!g._event_check){g._event_check={};g._event_check_size={}}for(var c in d){g._event_check[c.toLowerCase()]=d[c];var f=-1;for(var e in d[c]){f++}g._event_check_size[c.toLowerCase()]=f}};dhtmlx.assert_method_info=function(f,c,e,g){var a=[];for(var d=0;d<g.length;d++){a.push(g[d][0]+" : "+g[d][1]+"\n   "+g[d][2].describe()+(g[d][3]?"; optional":""))}return f.name+"."+c+"\n"+e+"\n Arguments:\n - "+a.join("\n - ")};dhtmlx.assert_method=function(d,a){for(var c in a){dhtmlx.assert_method_process(d,c,a[c].descr,a[c].args,(a[c].min||99),a[c].skip)}};dhtmlx.assert_method_process=function(g,c,f,h,d,e){var a=g[c];if(!e){g[c]=function(){if(arguments.length!=h.length&&arguments.length<d){dhtmlx.log("warn","Incorrect count of parameters\n"+g[c].describe()+"\n\nExpecting "+h.length+" but have only "+arguments.length)}else{for(var k=0;k<h.length;k++){if(!h[k][3]&&!h[k][2](arguments[k])){dhtmlx.log("warn","Incorrect method call\n"+g[c].describe()+"\n\nActual value of "+(k+1)+" parameter: {"+(typeof arguments[k])+"} "+arguments[k])}}}return a.apply(this,arguments)}}g[c].describe=function(){return dhtmlx.assert_method_info(g,c,f,h)}};dhtmlx.assert_event_call=function(d,c,a){if(d._event_check){if(!d._event_check[c]){dhtmlx.log("warn","Not expected event call :"+c)}else{if(dhtmlx.isNotDefined(a)){dhtmlx.log("warn","Event without parameters :"+c)}else{if(d._event_check_size[c]!=a.length){dhtmlx.log("warn","Incorrect event call, expected "+d._event_check_size[c]+" parameter(s), but have "+a.length+" parameter(s), for "+c+" event")}}}}};dhtmlx.assert_event_attach=function(c,a){if(c._event_check&&!c._event_check[a]){dhtmlx.log("warn","Unknown event name: "+a)}};dhtmlx.assert_property=function(c,a){if(!c._settings_check){c._settings_check={}}dhtmlx.extend(c._settings_check,a)};dhtmlx.assert_check=function(d,c){if(typeof d=="object"){for(var a in d){dhtmlx.assert_settings(a,d[a],c)}}};dhtmlx.assert_settings=function(k,f,e){e=e||this._settings_check;if(e){if(!e[k]){return dhtmlx.log("warn","Unknown propery: "+k)}var h="";var c="";var a=false;for(var d=0;d<e[k].length;d++){var g=e[k][d];if(typeof g=="string"){continue}if(typeof g=="function"){a=a||g(f)}else{if(typeof g=="object"&&typeof g[1]=="function"){a=a||g[1](f);if(a&&g[2]){dhtmlx.assert_check(f,g[2])}}}if(a){break}}if(!a){dhtmlx.log("warn","Invalid configuration\n"+dhtmlx.assert_info(k,e)+"\nActual value: {"+(typeof f)+"} "+f)}}};dhtmlx.assert_info=function(c,g){var a=g[c];var f="";var e=[];for(var d=0;d<a.length;d++){if(typeof rule=="string"){f=a[d]}else{if(a[d].describe){e.push(a[d].describe())}else{if(a[d][1]&&a[d][1].describe){e.push(a[d][1].describe())}}}}return"Property: "+c+", "+f+" \nExpected value: \n - "+e.join("\n - ")};if(dhtmlx.assert_enabled()){dhtmlx.assert_rule_color=function(a){if(typeof a!="string"){return false}if(a.indexOf("#")!==0){return false}if(a.substr(1).replace(/[0-9A-F]/gi,"")!==""){return false}return true};dhtmlx.assert_rule_color.describe=function(){return"{String} Value must start from # and contain hexadecimal code of color"};dhtmlx.assert_rule_template=function(a){if(typeof a=="function"){return true}if(typeof a=="string"){return true}return false};dhtmlx.assert_rule_template.describe=function(){return"{Function},{String} Value must be a function which accepts data object and return text string, or a sting with optional template markers"};dhtmlx.assert_rule_boolean=function(a){if(typeof a=="boolean"){return true}return false};dhtmlx.assert_rule_boolean.describe=function(){return"{Boolean} true or false"};dhtmlx.assert_rule_object=function(a,c){if(typeof a=="object"){return true}return false};dhtmlx.assert_rule_object.describe=function(){return"{Object} Configuration object"};dhtmlx.assert_rule_string=function(a){if(typeof a=="string"){return true}return false};dhtmlx.assert_rule_string.describe=function(){return"{String} Plain string"};dhtmlx.assert_rule_htmlpt=function(a){return !!dhtmlx.toNode(a)};dhtmlx.assert_rule_htmlpt.describe=function(){return"{Object},{String} HTML node or ID of HTML Node"};dhtmlx.assert_rule_notdocumented=function(a){return false};dhtmlx.assert_rule_notdocumented.describe=function(){return"This options wasn't documented"};dhtmlx.assert_rule_key=function(c){var a=function(d){return c[d]};a.describe=function(){var e=[];for(var d in c){e.push(d)}return"{String} can take one of next values: "+e.join(", ")};return a};dhtmlx.assert_rule_dimension=function(a){if(a*1==a&&!isNaN(a)&&a>=0){return true}return false};dhtmlx.assert_rule_dimension.describe=function(){return"{Integer} value must be a positive number"};dhtmlx.assert_rule_number=function(a){if(typeof a=="number"){return true}return false};dhtmlx.assert_rule_number.describe=function(){return"{Integer} value must be a number"};dhtmlx.assert_rule_function=function(a){if(typeof a=="function"){return true}return false};dhtmlx.assert_rule_function.describe=function(){return"{Function} value must be a custom function"};dhtmlx.assert_rule_any=function(a){return true};dhtmlx.assert_rule_any.describe=function(){return"Any value"};dhtmlx.assert_rule_mix=function(d,c){var e=function(a){if(d(a)||c(a)){return true}return false};e.describe=function(){return d.describe()};return e}}dhtmlx.version="3.0";dhtmlx.codebase="./";dhtmlx.copy=function(c){var a=dhtmlx.copy._function;a.prototype=c;return new a()};dhtmlx.copy._function=function(){};dhtmlx.extend=function(c,a){for(var d in a){c[d]=a[d]}if(dhtmlx.assert_enabled()&&a._assert){c._assert();c._assert=null}dhtmlx.assert(c,"Invalid nesting target");dhtmlx.assert(a,"Invalid nesting source");if(a._init){c._init()}return c};dhtmlx.proto_extend=function(){var g=arguments;var d=g[0];var c=[];for(var f=g.length-1;f>0;f--){if(typeof g[f]=="function"){g[f]=g[f].prototype}for(var e in g[f]){if(e=="_init"){c.push(g[f][e])}else{if(!d[e]){d[e]=g[f][e]}}}}if(g[0]._init){c.push(g[0]._init)}d._init=function(){for(var h=0;h<c.length;h++){c[h].apply(this,arguments)}};d.base=g[1];var a=function(h){this._init(h);if(this._parseSettings){this._parseSettings(h,this.defaults)}};a.prototype=d;d=g=null;return a};dhtmlx.bind=function(c,a){return function(){return c.apply(a,arguments)}};dhtmlx.require=function(a){if(!dhtmlx._modules[a]){dhtmlx.assert(dhtmlx.ajax,"load module is required");dhtmlx.exec(dhtmlx.ajax().sync().get(dhtmlx.codebase+a).responseText);dhtmlx._modules[a]=true}};dhtmlx._modules={};dhtmlx.exec=function(code){if(window.execScript){window.execScript(code)}else{window.eval(code)}};dhtmlx.methodPush=function(a,d,c){return function(){var e=false;e=a[d].apply(a,arguments);return e}};dhtmlx.isNotDefined=function(c){return typeof c=="undefined"};dhtmlx.delay=function(e,c,d,a){setTimeout(function(){var f=e.apply(c,d);e=c=d=null;return f},a||1)};dhtmlx.uid=function(){if(!this._seed){this._seed=(new Date).valueOf()}this._seed++;return this._seed};dhtmlx.toNode=function(a){if(typeof a=="string"){return document.getElementById(a)}return a};dhtmlx.toArray=function(a){return dhtmlx.extend((a||[]),dhtmlx.PowerArray)};dhtmlx.toFunctor=function(str){return(typeof(str)=="string")?eval(str):str};dhtmlx._events={};dhtmlx.event=function(e,d,a,c){e=dhtmlx.toNode(e);var f=dhtmlx.uid();dhtmlx._events[f]=[e,d,a];if(c){a=dhtmlx.bind(a,c)}if(e.addEventListener){e.addEventListener(d,a,false)}else{if(e.attachEvent){e.attachEvent("on"+d,a)}}return f};dhtmlx.eventRemove=function(c){if(!c){return}dhtmlx.assert(this._events[c],"Removing non-existing event");var a=dhtmlx._events[c];if(a[0].removeEventListener){a[0].removeEventListener(a[1],a[2],false)}else{if(a[0].detachEvent){a[0].detachEvent("on"+a[1],a[2])}}delete this._events[c]};dhtmlx.log=function(c,d,a){if(window.console&&console.log){c=c.toLowerCase();if(window.console[c]){window.console[c](d||"unknown error")}else{window.console.log(c+": "+d)}if(a){window.console.log(a)}}};dhtmlx.log_full_time=function(a){dhtmlx._start_time_log=new Date();dhtmlx.log("Info","Timing start ["+a+"]");window.setTimeout(function(){var c=new Date();dhtmlx.log("Info","Timing end ["+a+"]:"+(c.valueOf()-dhtmlx._start_time_log.valueOf())/1000+"s")},1)};dhtmlx.log_time=function(a){var d="_start_time_log"+a;if(!dhtmlx[d]){dhtmlx[d]=new Date();dhtmlx.log("Info","Timing start ["+a+"]")}else{var c=new Date();dhtmlx.log("Info","Timing end ["+a+"]:"+(c.valueOf()-dhtmlx[d].valueOf())/1000+"s");dhtmlx[d]=null}};dhtmlx.error=function(c,a){dhtmlx.log("error",c,a)};dhtmlx.EventSystem={_init:function(){this._events={};this._handlers={};this._map={}},block:function(){this._events._block=true},unblock:function(){this._events._block=false},mapEvent:function(a){dhtmlx.extend(this._map,a)},callEvent:function(d,f){if(this._events._block){return true}d=d.toLowerCase();dhtmlx.assert_event_call(this,d,f);var e=this._events[d.toLowerCase()];var a=true;if(dhtmlx.debug){dhtmlx.log("info","["+this.name+"] event:"+d,f)}if(e){for(var c=0;c<e.length;c++){if(e[c].apply(this,(f||[]))===false){a=false}}}if(this._map[d]&&!this._map[d].callEvent(d,f)){a=false}return a},attachEvent:function(c,a,e){c=c.toLowerCase();dhtmlx.assert_event_attach(this,c);e=e||dhtmlx.uid();a=dhtmlx.toFunctor(a);var d=this._events[c]||dhtmlx.toArray();d.push(a);this._events[c]=d;this._handlers[e]={f:a,t:c};return e},detachEvent:function(e){if(this._handlers[e]){var c=this._handlers[e].t;var a=this._handlers[e].f;var d=this._events[c];d.remove(a);delete this._handlers[e]}}};dhtmlx.PowerArray={removeAt:function(c,a){if(c>=0){this.splice(c,(a||1))}},remove:function(a){this.removeAt(this.find(a))},insertAt:function(c,d){if(!d&&d!==0){this.push(c)}else{var a=this.splice(d,(this.length-d));this[d]=c;this.push.apply(this,a)}},find:function(a){for(i=0;i<this.length;i++){if(a==this[i]){return i}}return -1},each:function(a,d){for(var c=0;c<this.length;c++){a.call((d||this),this[c])}},map:function(a,d){for(var c=0;c<this.length;c++){this[c]=a.call((d||this),this[c])}return this}};dhtmlx.env={};if(navigator.userAgent.indexOf("Opera")!=-1){dhtmlx._isOpera=true}else{dhtmlx._isIE=!!document.all;dhtmlx._isFF=!document.all;dhtmlx._isWebKit=(navigator.userAgent.indexOf("KHTML")!=-1);if(navigator.appVersion.indexOf("MSIE 8.0")!=-1&&document.compatMode!="BackCompat"){dhtmlx._isIE=8}if(navigator.appVersion.indexOf("MSIE 9.0")!=-1&&document.compatMode!="BackCompat"){dhtmlx._isIE=9}}dhtmlx.env={};(function(){dhtmlx.env.transform=false;dhtmlx.env.transition=false;var a={};a.names=["transform","transition"];a.transform=["transform","WebkitTransform","MozTransform","oTransform","msTransform"];a.transition=["transition","WebkitTransition","MozTransition","oTransition"];var f=document.createElement("DIV");var e;for(var c=0;c<a.names.length;c++){while(p=a[a.names[c]].pop()){if(typeof f.style[p]!="undefined"){dhtmlx.env[a.names[c]]=true}}}})();dhtmlx.env.transform_prefix=(function(){var a;if(dhtmlx._isOpera){a="-o-"}else{a="";if(dhtmlx._isFF){a="-moz-"}if(dhtmlx._isWebKit){a="-webkit-"}}return a})();dhtmlx.env.svg=(function(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")})();dhtmlx.zIndex={drag:10000};dhtmlx.html={create:function(c,a,d){a=a||{};var e=document.createElement(c);for(var f in a){e.setAttribute(f,a[f])}if(a.style){e.style.cssText=a.style}if(a["class"]){e.className=a["class"]}if(d){e.innerHTML=d}return e},getValue:function(a){a=dhtmlx.toNode(a);if(!a){return""}return dhtmlx.isNotDefined(a.value)?a.innerHTML:a.value},remove:function(c){if(c instanceof Array){for(var a=0;a<c.length;a++){this.remove(c[a])}}else{if(c&&c.parentNode){c.parentNode.removeChild(c)}}},insertBefore:function(c,d,a){if(!c){return}if(d){d.parentNode.insertBefore(c,d)}else{a.appendChild(c)}},locate:function(c,f){c=c||event;var a=c.target||c.srcElement;while(a){if(a.getAttribute){var d=a.getAttribute(f);if(d){return d}}a=a.parentNode}return null},offset:function(e){if(e.getBoundingClientRect){var h=e.getBoundingClientRect();var k=document.body;var c=document.documentElement;var a=window.pageYOffset||c.scrollTop||k.scrollTop;var f=window.pageXOffset||c.scrollLeft||k.scrollLeft;var g=c.clientTop||k.clientTop||0;var l=c.clientLeft||k.clientLeft||0;var m=h.top+a-g;var d=h.left+f-l;return{y:Math.round(m),x:Math.round(d)}}else{var m=0,d=0;while(e){m=m+parseInt(e.offsetTop,10);d=d+parseInt(e.offsetLeft,10);e=e.offsetParent}return{y:m,x:d}}},pos:function(a){a=a||event;if(a.pageX||a.pageY){return{x:a.pageX,y:a.pageY}}var c=((dhtmlx._isIE)&&(document.compatMode!="BackCompat"))?document.documentElement:document.body;return{x:a.clientX+c.scrollLeft-c.clientLeft,y:a.clientY+c.scrollTop-c.clientTop}},preventEvent:function(a){if(a&&a.preventDefault){a.preventDefault()}dhtmlx.html.stopEvent(a)},stopEvent:function(a){(a||event).cancelBubble=true;return false},addCss:function(c,a){c.className+=" "+a},removeCss:function(c,a){c.className=c.className.replace(RegExp(a,"g"),"")}};(function(){var a=document.getElementsByTagName("SCRIPT");dhtmlx.assert(a.length,"Can't locate codebase");if(a.length){a=(a[a.length-1].getAttribute("src")||"").split("/");a.splice(a.length-1,1);dhtmlx.codebase=a.slice(0,a.length).join("/")+"/"}})();if(!dhtmlx.ui){dhtmlx.ui={}}dhtmlx.Destruction={_init:function(){dhtmlx.destructors.push(this)},destructor:function(){this.destructor=function(){};this._htmlmap=null;this._htmlrows=null;if(this._html){document.body.appendChild(this._html)}this._html=null;if(this._obj){this._obj.innerHTML="";this._obj._htmlmap=null}this._obj=this._dataobj=null;this.data=null;this._events=this._handlers={};if(this.render){this.render=function(){}}}};dhtmlx.destructors=[];dhtmlx.event(window,"unload",function(){if(dhtmlx.destructors){for(var d=0;d<dhtmlx.destructors.length;d++){dhtmlx.destructors[d].destructor()}dhtmlx.destructors=[]}for(var c in dhtmlx._events){var e=dhtmlx._events[c];if(e[0].removeEventListener){e[0].removeEventListener(e[1],e[2],false)}else{if(e[0].detachEvent){e[0].detachEvent("on"+e[1],e[2])}}delete dhtmlx._events[c]}});dhtmlx.ajax=function(a,c,d){if(arguments.length!==0){var e=new dhtmlx.ajax();if(d){e.master=d}e.get(a,null,c)}if(!this.getXHR){return new dhtmlx.ajax()}return this};dhtmlx.ajax.prototype={getXHR:function(){if(dhtmlx._isIE){return new ActiveXObject("Microsoft.xmlHTTP")}else{return new XMLHttpRequest()}},send:function(f,l,h){var c=this.getXHR();if(typeof h=="function"){h=[h]}if(typeof l=="object"){var g=[];for(var d in l){var k=l[d];if(k===null||k===dhtmlx.undefined){k=""}g.push(d+"="+encodeURIComponent(k))}l=g.join("&")}if(l&&!this.post){f=f+(f.indexOf("?")!=-1?"&":"?")+l;l=null}c.open(this.post?"POST":"GET",f,!this._sync);if(this.post){c.setRequestHeader("Content-type","application/x-www-form-urlencoded")}var e=this;c.onreadystatechange=function(){if(!c.readyState||c.readyState==4){if(h&&e){for(var a=0;a<h.length;a++){if(h[a]){h[a].call((e.master||e),c.responseText,c.responseXML,c)}}}e.master=null;h=e=null}};c.send(l||null);return c},get:function(a,d,c){this.post=false;return this.send(a,d,c)},post:function(a,d,c){this.post=true;return this.send(a,d,c)},sync:function(){this._sync=true;return this}};dhtmlx.AtomDataLoader={_init:function(a){this.data={};if(a){this._settings.datatype=a.datatype||"json";this._after_init.push(this._load_when_ready)}},_load_when_ready:function(){this._ready_for_data=true;if(this._settings.url){this.url_setter(this._settings.url)}if(this._settings.data){this.data_setter(this._settings.data)}},url_setter:function(a){if(!this._ready_for_data){return a}this.load(a,this._settings.datatype);return a},data_setter:function(a){if(!this._ready_for_data){return a}this.parse(a,this._settings.datatype);return true},load:function(a,c){this.callEvent("onXLS",[]);if(typeof c=="string"){this.data.driver=dhtmlx.DataDriver[c];c=arguments[2]}else{this.data.driver=dhtmlx.DataDriver.xml}dhtmlx.ajax(a,[this._onLoad,c],this)},parse:function(c,a){this.callEvent("onXLS",[]);this.data.driver=dhtmlx.DataDriver[a||"xml"];this._onLoad(c,null)},_onLoad:function(f,c,a){var d=this.data.driver;var e=d.getRecords(d.toObject(f,c))[0];this.data=(d?d.getDetails(e):f);this.callEvent("onXLE",[])},_check_data_feed:function(c){if(!this._settings.dataFeed||this._ignore_feed||!c){return true}var a=this._settings.dataFeed;if(typeof a=="function"){return a.call(this,(c.id||c),c)}a=a+(a.indexOf("?")==-1?"?":"&")+"action=get&id="+encodeURIComponent(c.id||c);this.callEvent("onXLS",[]);dhtmlx.ajax(a,function(e,d){this._ignore_feed=true;this.setValues(dhtmlx.DataDriver.json.toObject(e)[0]);this._ignore_feed=false;this.callEvent("onXLE",[])},this);return false}};dhtmlx.DataDriver={};dhtmlx.DataDriver.json={toObject:function(data){if(!data){data="[]"}if(typeof data=="string"){eval("dhtmlx.temp="+data);return dhtmlx.temp}return data},getRecords:function(a){if(a&&!(a instanceof Array)){return[a]}return a},getDetails:function(a){return a},getInfo:function(a){return{_size:(a.total_count||0),_from:(a.pos||0),_key:(a.dhx_security)}}};dhtmlx.DataDriver.json_ext={toObject:function(data){if(!data){data="[]"}if(typeof data=="string"){var temp;eval("temp="+data);dhtmlx.temp=[];var header=temp.header;for(var i=0;i<temp.data.length;i++){var item={};for(var j=0;j<header.length;j++){if(typeof(temp.data[i][j])!="undefined"){item[header[j]]=temp.data[i][j]}}dhtmlx.temp.push(item)}return dhtmlx.temp}return data},getRecords:function(a){if(a&&!(a instanceof Array)){return[a]}return a},getDetails:function(a){return a},getInfo:function(a){return{_size:(a.total_count||0),_from:(a.pos||0)}}};dhtmlx.DataDriver.html={toObject:function(c){if(typeof c=="string"){var a=null;if(c.indexOf("<")==-1){a=dhtmlx.toNode(c)}if(!a){a=document.createElement("DIV");a.innerHTML=c}return a.getElementsByTagName(this.tag)}return c},getRecords:function(a){if(a.tagName){return a.childNodes}return a},getDetails:function(a){return dhtmlx.DataDriver.xml.tagToObject(a)},getInfo:function(a){return{_size:0,_from:0}},tag:"LI"};dhtmlx.DataDriver.jsarray={toObject:function(data){if(typeof data=="string"){eval("dhtmlx.temp="+data);return dhtmlx.temp}return data},getRecords:function(a){return a},getDetails:function(d){var a={};for(var c=0;c<d.length;c++){a["data"+c]=d[c]}return a},getInfo:function(a){return{_size:0,_from:0}}};dhtmlx.DataDriver.csv={toObject:function(a){return a},getRecords:function(a){return a.split(this.row)},getDetails:function(d){d=this.stringToArray(d);var a={};for(var c=0;c<d.length;c++){a["data"+c]=d[c]}return a},getInfo:function(a){return{_size:0,_from:0}},stringToArray:function(c){c=c.split(this.cell);for(var a=0;a<c.length;a++){c[a]=c[a].replace(/^[ \t\n\r]*(\"|)/g,"").replace(/(\"|)[ \t\n\r]*$/g,"")}return c},row:"\n",cell:","};dhtmlx.DataDriver.xml={toObject:function(c,a){if(a&&(a=this.checkResponse(c,a))){return a}if(typeof c=="string"){return this.fromString(c)}return c},getRecords:function(a){return this.xpath(a,this.records)},records:"/*/item",getDetails:function(a){return this.tagToObject(a,{})},getInfo:function(a){return{_size:(a.documentElement.getAttribute("total_count")||0),_from:(a.documentElement.getAttribute("pos")||0),_key:(a.documentElement.getAttribute("dhx_security"))}},xpath:function(f,m){if(window.XPathResult){var d=f;if(f.nodeName.indexOf("document")==-1){f=f.ownerDocument}var k=[];var c=f.evaluate(m,d,null,XPathResult.ANY_TYPE,null);var l=c.iterateNext();while(l){k.push(l);l=c.iterateNext()}return k}else{var h=true;try{if(typeof(f.selectNodes)=="undefined"){h=false}}catch(g){}if(h){return f.selectNodes(m)}else{var a=m.split("/").pop();return f.getElementsByTagName(a)}}},tagToObject:function(d,l){l=l||{};var f=false;var e=d.attributes;if(e&&e.length){for(var h=0;h<e.length;h++){l[e[h].name]=e[h].value}f=true}var c=d.childNodes;var k={};for(var h=0;h<c.length;h++){if(c[h].nodeType==1){var g=c[h].tagName;if(typeof l[g]!="undefined"){if(!(l[g] instanceof Array)){l[g]=[l[g]]}l[g].push(this.tagToObject(c[h],{}))}else{l[c[h].tagName]=this.tagToObject(c[h],{})}f=true}}if(!f){return this.nodeValue(d)}l.value=this.nodeValue(d);return l},nodeValue:function(a){if(a.firstChild){return a.firstChild.wholeText||a.firstChild.data}return""},fromString:function(c){if(window.DOMParser&&!dhtmlx._isIE){return(new DOMParser()).parseFromString(c,"text/xml")}if(window.ActiveXObject){var a=new ActiveXObject("Microsoft.xmlDOM");a.loadXML(c);return a}dhtmlx.error("Load from xml string is not supported")},checkResponse:function(e,d){if(d&&(d.firstChild&&d.firstChild.tagName!="parsererror")){return d}var c=this.fromString(e.replace(/^[\s]+/,""));if(c){return c}dhtmlx.error("xml can't be parsed",e)}};dhtmlx.DataLoader={_init:function(a){a=a||"";this.name="DataStore";this.data=(a.datastore)||(new dhtmlx.DataStore());this._readyHandler=this.data.attachEvent("onStoreLoad",dhtmlx.bind(this._call_onready,this))},load:function(a,c){dhtmlx.AtomDataLoader.load.apply(this,arguments);if(!this.data.feed){this.data.feed=function(e,d){if(this._load_count){return this._load_count=[e,d]}else{this._load_count=true}this.load(a+((a.indexOf("?")==-1)?"?":"&")+"posStart="+e+"&count="+d,function(){var f=this._load_count;this._load_count=false;if(typeof f=="object"){this.data.feed.apply(this,f)}})}}},_onLoad:function(d,c,a){this.data._parse(this.data.driver.toObject(d,c));this.callEvent("onXLE",[]);if(this._readyHandler){this.data.detachEvent(this._readyHandler);this._readyHandler=null}},dataFeed_setter:function(a){this.data.attachEvent("onBeforeFilter",dhtmlx.bind(function(h,g){if(this._settings.dataFeed){var f={};if(!h&&!f){return}if(typeof h=="function"){if(!g){return}h(g,f)}else{f={text:g}}this.clearAll();var c=this._settings.dataFeed;if(typeof c=="function"){return c.call(this,g,f)}var e=[];for(var d in f){e.push("dhx_filter["+d+"]="+encodeURIComponent(f[d]))}this.load(c+(c.indexOf("?")<0?"?":"&")+e.join("&"),this._settings.datatype);return false}},this));return a},_call_onready:function(){if(this._settings.ready){var a=dhtmlx.toFunctor(this._settings.ready);if(a&&a.call){a.apply(this,arguments)}}}};dhtmlx.DataStore=function(){this.name="DataStore";dhtmlx.extend(this,dhtmlx.EventSystem);this.setDriver("xml");this.pull={};this.order=dhtmlx.toArray()};dhtmlx.DataStore.prototype={setDriver:function(a){dhtmlx.assert(dhtmlx.DataDriver[a],"incorrect DataDriver");this.driver=dhtmlx.DataDriver[a]},_parse:function(f){this.callEvent("onParse",[this.driver,f]);if(this._filter_order){this.filter()}var g=this.driver.getInfo(f);if(g._key){dhtmlx.security_key=g._key}var e=this.driver.getRecords(f);var k=(g._from||0)*1;if(k===0&&this.order[0]){k=this.order.length}var c=0;for(var d=0;d<e.length;d++){var a=this.driver.getDetails(e[d]);var h=this.id(a);if(!this.pull[h]){this.order[c+k]=h;c++}this.pull[h]=a;if(this.extraParser){this.extraParser(a)}if(this._scheme){if(this._scheme.$init){this._scheme.$update(a)}else{if(this._scheme.$update){this._scheme.$update(a)}}}}for(var d=0;d<g._size;d++){if(!this.order[d]){var h=dhtmlx.uid();var a={id:h,$template:"loading"};this.pull[h]=a;this.order[d]=h}}this.callEvent("onStoreLoad",[this.driver,f]);this.refresh()},id:function(a){return a.id||(a.id=dhtmlx.uid())},changeId:function(c,a){dhtmlx.assert(this.pull[c],"Can't change id, for non existing item: "+c);this.pull[a]=this.pull[c];this.pull[a].id=a;this.order[this.order.find(c)]=a;if(this._filter_order){this._filter_order[this._filter_order.find(c)]=a}this.callEvent("onIdChange",[c,a]);if(this._render_change_id){this._render_change_id(c,a)}},get:function(a){return this.item(a)},set:function(c,a){return this.update(c,a)},item:function(a){return this.pull[a]},update:function(c,a){if(this._scheme&&this._scheme.$update){this._scheme.$update(a)}if(this.callEvent("onBeforeUpdate",[c,a])===false){return false}this.pull[c]=a;this.refresh(c)},refresh:function(a){if(this._skip_refresh){return}if(a){this.callEvent("onStoreUpdated",[a,this.pull[a],"update"])}else{this.callEvent("onStoreUpdated",[null,null,null])}},silent:function(a){this._skip_refresh=true;a.call(this);this._skip_refresh=false},getRange:function(e,d){if(e){e=this.indexById(e)}else{e=this.startOffset||0}if(d){d=this.indexById(d)}else{d=Math.min((this.endOffset||Infinity),(this.dataCount()-1));if(d<0){d=0}}if(e>d){var c=d;d=e;e=c}return this.getIndexRange(e,d)},getIndexRange:function(e,d){d=Math.min((d||Infinity),this.dataCount()-1);var a=dhtmlx.toArray();for(var c=(e||0);c<=d;c++){a.push(this.item(this.order[c]))}return a},dataCount:function(){return this.order.length},exists:function(a){return !!(this.pull[a])},move:function(a,e){if(a<0||e<0){dhtmlx.error("DataStore::move","Incorrect indexes");return}var d=this.idByIndex(a);var c=this.item(d);this.order.removeAt(a);this.order.insertAt(d,Math.min(this.order.length,e));this.callEvent("onStoreUpdated",[d,c,"move"])},scheme:function(a){this._scheme=a},sync:function(f,e,a){if(typeof e!="function"){a=e;e=null}if(dhtmlx.debug_bind){this.debug_sync_master=f;dhtmlx.log("[sync] "+this.debug_bind_master.name+"@"+this.debug_bind_master._settings.id+" <= "+this.debug_sync_master.name+"@"+this.debug_sync_master._settings.id)}var d=f;if(f.name!="DataStore"){f=f.data}var c=dhtmlx.bind(function(k,g,h){if(h!="update"||e){k=null}if(!k){this.order=dhtmlx.toArray([].concat(f.order));this._filter_order=null;this.pull=f.pull;if(e){this.silent(e)}if(this._on_sync){this._on_sync()}}if(dhtmlx.debug_bind){dhtmlx.log("[sync:request] "+this.debug_sync_master.name+"@"+this.debug_sync_master._settings.id+" <= "+this.debug_bind_master.name+"@"+this.debug_bind_master._settings.id)}if(!a){this.refresh(k)}else{a=false}},this);f.attachEvent("onStoreUpdated",c);this.feed=function(h,g){d.loadNext(g,h)};c()},add:function(f,a){if(this._scheme){f=f||{};for(var c in this._scheme){f[c]=f[c]||this._scheme[c]}if(this._scheme){if(this._scheme.$init){this._scheme.$update(f)}else{if(this._scheme.$update){this._scheme.$update(f)}}}}var g=this.id(f);var e=this.dataCount();if(dhtmlx.isNotDefined(a)||a<0){a=e}if(a>e){dhtmlx.log("Warning","DataStore:add","Index of out of bounds");a=Math.min(this.order.length,a)}if(this.callEvent("onBeforeAdd",[g,f,a])===false){return false}if(this.exists(g)){return dhtmlx.error("Not unique ID")}this.pull[g]=f;this.order.insertAt(g,a);if(this._filter_order){var d=this._filter_order.length;if(!a&&this.order.length){d=0}this._filter_order.insertAt(g,d)}this.callEvent("onafterAdd",[g,a]);this.callEvent("onStoreUpdated",[g,f,"add"]);return g},remove:function(d){if(d instanceof Array){for(var a=0;a<d.length;a++){this.remove(d[a])}return}if(this.callEvent("onBeforeDelete",[d])===false){return false}if(!this.exists(d)){return dhtmlx.error("Not existing ID",d)}var c=this.item(d);this.order.remove(d);if(this._filter_order){this._filter_order.remove(d)}delete this.pull[d];this.callEvent("onafterdelete",[d]);this.callEvent("onStoreUpdated",[d,c,"delete"])},clearAll:function(){this.pull={};this.order=dhtmlx.toArray();this.feed=null;this._filter_order=null;this.callEvent("onClearAll",[]);this.refresh()},idByIndex:function(a){if(a>=this.order.length||a<0){dhtmlx.log("Warning","DataStore::idByIndex Incorrect index")}return this.order[a]},indexById:function(c){var a=this.order.find(c);return a},next:function(c,a){return this.order[this.indexById(c)+(a||1)]},first:function(){return this.order[0]},last:function(){return this.order[this.order.length-1]},previous:function(c,a){return this.order[this.indexById(c)-(a||1)]},sort:function(g,c,a){var d=g;if(typeof g=="function"){d={as:g,dir:c}}else{if(typeof g=="string"){d={by:g,dir:c,as:a}}}var f=[d.by,d.dir,d.as];if(!this.callEvent("onbeforesort",f)){return}if(this.order.length){var h=dhtmlx.sort.create(d);var e=this.getRange(this.first(),this.last());e.sort(h);this.order=e.map(function(k){return this.id(k)},this)}this.refresh();this.callEvent("onaftersort",f)},filter:function(f,e){if(!this.callEvent("onBeforeFilter",[f,e])){return}if(this._filter_order){this.order=this._filter_order;delete this._filter_order}if(!this.order.length){return}if(f){var c=f;e=e||"";if(typeof f=="string"){f=dhtmlx.Template.fromHTML(f);e=e.toString().toLowerCase();c=function(k,h){return f(k).toLowerCase().indexOf(h)!=-1}}var d=dhtmlx.toArray();for(var a=0;a<this.order.length;a++){var g=this.order[a];if(c(this.item(g),e)){d.push(g)}}this._filter_order=this.order;this.order=d}this.refresh();this.callEvent("onAfterFilter",[])},each:function(d,c){for(var a=0;a<this.order.length;a++){d.call((c||this),this.item(this.order[a]))}},provideApi:function(e,c){this.debug_bind_master=e;if(c){this.mapEvent({onbeforesort:e,onaftersort:e,onbeforeadd:e,onafteradd:e,onbeforedelete:e,onafterdelete:e,onbeforeupdate:e})}var d=["get","set","sort","add","remove","exists","idByIndex","indexById","item","update","refresh","dataCount","filter","next","previous","clearAll","first","last","serialize"];for(var a=0;a<d.length;a++){e[d[a]]=dhtmlx.methodPush(this,d[a])}if(dhtmlx.assert_enabled()){this.assert_event(e)}},serialize:function(){var d=this.order;var a=[];for(var c=0;c<d.length;c++){a.push(this.pull[d[c]])}return a}};dhtmlx.sort={create:function(a){return dhtmlx.sort.dir(a.dir,dhtmlx.sort.by(a.by,a.as))},as:{"int":function(d,c){d=d*1;c=c*1;return d>c?1:(d<c?-1:0)},string_strict:function(d,c){d=d.toString();c=c.toString();return d>c?1:(d<c?-1:0)},string:function(d,c){d=d.toString().toLowerCase();c=c.toString().toLowerCase();return d>c?1:(d<c?-1:0)}},by:function(c,a){if(!c){return a}if(typeof a!="function"){a=dhtmlx.sort.as[a||"string"]}c=dhtmlx.Template.fromHTML(c);return function(e,d){return a(c(e),c(d))}},dir:function(c,a){if(c=="asc"){return a}return function(e,d){return a(e,d)*-1}}};dhtmlx.KeyEvents={_init:function(){dhtmlx.event(this._obj,"keypress",this._onKeyPress,this)},_onKeyPress:function(c){c=c||event;var a=c.which||c.keyCode;this.callEvent((this._edit_id?"onEditKeyPress":"onKeyPress"),[a,c.ctrlKey,c.shiftKey,c])}};dhtmlx.MouseEvents={_init:function(){if(this.on_click){dhtmlx.event(this._obj,"click",this._onClick,this);dhtmlx.event(this._obj,"contextmenu",this._onContext,this)}if(this.on_dblclick){dhtmlx.event(this._obj,"dblclick",this._onDblClick,this)}if(this.on_mouse_move){dhtmlx.event(this._obj,"mousemove",this._onMouse,this);dhtmlx.event(this._obj,(dhtmlx._isIE?"mouseleave":"mouseout"),this._onMouse,this)}},_onClick:function(a){return this._mouseEvent(a,this.on_click,"ItemClick")},_onDblClick:function(a){return this._mouseEvent(a,this.on_dblclick,"ItemDblClick")},_onContext:function(a){var c=dhtmlx.html.locate(a,this._id);if(c&&!this.callEvent("onBeforeContextMenu",[c,a])){return dhtmlx.html.preventEvent(a)}},_onMouse:function(a){if(dhtmlx._isIE){a=document.createEventObject(event)}if(this._mouse_move_timer){window.clearTimeout(this._mouse_move_timer)}this.callEvent("onMouseMoving",[a]);this._mouse_move_timer=window.setTimeout(dhtmlx.bind(function(){if(a.type=="mousemove"){this._onMouseMove(a)}else{this._onMouseOut(a)}},this),500)},_onMouseMove:function(a){if(!this._mouseEvent(a,this.on_mouse_move,"MouseMove")){this.callEvent("onMouseOut",[a||event])}},_onMouseOut:function(a){this.callEvent("onMouseOut",[a||event])},_mouseEvent:function(h,g,c){h=h||event;var a=h.target||h.srcElement;var d="";var k=null;var f=false;while(a&&a.parentNode){if(!f&&a.getAttribute){k=a.getAttribute(this._id);if(k){if(a.getAttribute("userdata")){this.callEvent("onLocateData",[k,a])}if(!this.callEvent("on"+c,[k,h,a])){return}f=true}}d=a.className;if(d){d=d.split(" ");d=d[0]||d[1];if(g[d]){return g[d].call(this,h,k||dhtmlx.html.locate(h,this._id),a)}}a=a.parentNode}return f}};dhtmlx.Settings={_init:function(){this._settings=this.config={}},define:function(c,a){if(typeof c=="object"){return this._parseSeetingColl(c)}return this._define(c,a)},_define:function(c,a){dhtmlx.assert_settings.call(this,c,a);var d=this[c+"_setter"];return this._settings[c]=d?d.call(this,a):a},_parseSeetingColl:function(d){if(d){for(var c in d){this._define(c,d[c])}}},_parseSettings:function(d,a){var c=dhtmlx.extend({},a);if(typeof d=="object"&&!d.tagName){dhtmlx.extend(c,d)}this._parseSeetingColl(c)},_mergeSettings:function(a,d){for(var c in d){switch(typeof a[c]){case"object":a[c]=this._mergeSettings((a[c]||{}),d[c]);break;case"undefined":a[c]=d[c];break;default:break}}return a},_parseContainer:function(c,a,d){if(typeof c=="object"&&!c.tagName){c=c.container}this._obj=this.$view=dhtmlx.toNode(c);if(!this._obj&&d){this._obj=d(c)}dhtmlx.assert(this._obj,"Incorrect html container");this._obj.className+=" "+a;this._obj.onselectstart=function(){return false};this._dataobj=this._obj},_set_type:function(a){if(typeof a=="object"){return this.type_setter(a)}dhtmlx.assert(this.types,"RenderStack :: Types are not defined");dhtmlx.assert(this.types[a],"RenderStack :: Inccorect type name",a);this.type=dhtmlx.extend({},this.types[a]);this.customize()},customize:function(a){if(a){dhtmlx.extend(this.type,a)}this.type._item_start=dhtmlx.Template.fromHTML(this.template_item_start(this.type));this.type._item_end=this.template_item_end(this.type);this.render()},type_setter:function(a){this._set_type(typeof a=="object"?dhtmlx.Type.add(this,a):a);return a},template_setter:function(a){return this.type_setter({template:a})},css_setter:function(a){this._obj.className+=" "+a;return a}};dhtmlx.Template={_cache:{},empty:function(){return""},setter:function(a){return dhtmlx.Template.fromHTML(a)},obj_setter:function(c){var a=dhtmlx.Template.setter(c);var d=this;return function(){return a.apply(d,arguments)}},fromHTML:function(a){if(typeof a=="function"){return a}if(this._cache[a]){return this._cache[a]}a=(a||"").toString();a=a.replace(/[\r\n]+/g,"\\n");a=a.replace(/\{obj\.([^}?]+)\?([^:]*):([^}]*)\}/g,'"+(obj.$1?"$2":"$3")+"');a=a.replace(/\{common\.([^}\(]*)\}/g,'"+common.$1+"');a=a.replace(/\{common\.([^\}\(]*)\(\)\}/g,'"+(common.$1?common.$1(obj):"")+"');a=a.replace(/\{obj\.([^}]*)\}/g,'"+obj.$1+"');a=a.replace(/#([a-z0-9_]+)#/gi,'"+obj.$1+"');a=a.replace(/\{obj\}/g,'"+obj+"');a=a.replace(/\{-obj/g,"{obj");a=a.replace(/\{-common/g,"{common");a='return "'+a+'";';return this._cache[a]=Function("obj","common",a)}};dhtmlx.Type={add:function(d,c){if(!d.types&&d.prototype.types){d=d.prototype}if(dhtmlx.assert_enabled()){this.assert_event(c)}var a=c.name||"default";this._template(c);this._template(c,"edit");this._template(c,"loading");d.types[a]=dhtmlx.extend(dhtmlx.extend({},(d.types[a]||this._default)),c);return a},_default:{css:"default",template:function(){return""},template_edit:function(){return""},template_loading:function(){return"..."},width:150,height:80,margin:5,padding:0},_template:function(d,a){a="template"+(a?("_"+a):"");var c=d[a];if(c&&(typeof c=="string")){if(c.indexOf("->")!=-1){c=c.split("->");switch(c[0]){case"html":c=dhtmlx.html.getValue(c[1]).replace(/\"/g,'\\"');break;case"http":c=new dhtmlx.ajax().sync().get(c[1],{uid:(new Date()).valueOf()}).responseText;break;default:break}}d[a]=dhtmlx.Template.fromHTML(c)}}};dhtmlx.SingleRender={_init:function(){},_toHTML:function(a){return this.type._item_start(a,this.type)+this.type.template(a,this.type)+this.type._item_end},render:function(){if(!this.callEvent||this.callEvent("onBeforeRender",[this.data])){if(this.data){this._dataobj.innerHTML=this._toHTML(this.data)}if(this.callEvent){this.callEvent("onAfterRender",[])}}}};dhtmlx.ui.Tooltip=function(a){this.name="Tooltip";this.version="3.0";if(dhtmlx.assert_enabled()){this._assert()}if(typeof a=="string"){a={template:a}}dhtmlx.extend(this,dhtmlx.Settings);dhtmlx.extend(this,dhtmlx.SingleRender);this._parseSettings(a,{type:"default",dy:0,dx:20});this._dataobj=this._obj=document.createElement("DIV");this._obj.className="dhx_tooltip";dhtmlx.html.insertBefore(this._obj,document.body.firstChild)};dhtmlx.ui.Tooltip.prototype={show:function(a,c){if(this._disabled){return}if(this.data!=a){this.data=a;this.render(a)}this._obj.style.top=c.y+this._settings.dy+"px";this._obj.style.left=c.x+this._settings.dx+"px";this._obj.style.display="block"},hide:function(){this.data=null;this._obj.style.display="none"},disable:function(){this._disabled=true},enable:function(){this._disabled=false},types:{"default":dhtmlx.Template.fromHTML("{obj.id}")},template_item_start:dhtmlx.Template.empty,template_item_end:dhtmlx.Template.empty};dhtmlx.AutoTooltip={tooltip_setter:function(c){var a=new dhtmlx.ui.Tooltip(c);this.attachEvent("onMouseMove",function(f,d){a.show(this.get(f),dhtmlx.html.pos(d))});this.attachEvent("onMouseOut",function(f,d){a.hide()});this.attachEvent("onMouseMoving",function(f,d){a.hide()});return a}};dhtmlx.compat=function(a,c){if(dhtmlx.compat[a]){dhtmlx.compat[a](c)}};(function(){if(!window.dhtmlxError){var c=function(){};window.dhtmlxError={catchError:c,throwError:c};window.convertStringToBoolean=function(d){return !!d};window.dhtmlxEventable=function(d){dhtmlx.extend(d,dhtmlx.EventSystem)};var a={getXMLTopNode:function(d){},doXPath:function(d){return dhtmlx.DataDriver.xml.xpath(this.xml,d)},xmlDoc:{responseXML:true}};dhtmlx.compat.dataProcessor=function(g){var d="_sendData";var e="_in_progress";var h="_tMode";var f="_waitMode";g[d]=function(l,m){if(!l){return}if(m){this[e][m]=(new Date()).valueOf()}if(!this.callEvent("onBeforeDataSending",m?[m,this.getState(m)]:[])){return false}var k=this;var n=this.serverProcessor;if(this[h]!="POST"){dhtmlx.ajax().get(n+((n.indexOf("?")!=-1)?"&":"?")+this.serialize(l,m),"",function(r,o,q){a.xml=dhtmlx.DataDriver.xml.checkResponse(r,o);k.afterUpdate(k,null,null,null,a)})}else{dhtmlx.ajax().post(n,this.serialize(l,m),function(r,o,q){a.xml=dhtmlx.DataDriver.xml.checkResponse(r,o);k.afterUpdate(k,null,null,null,a)})}this[f]++}}}})();if(!dhtmlx.attaches){dhtmlx.attaches={}}dhtmlx.attaches.attachAbstract=function(c,a){var f=document.createElement("DIV");f.id="CustomObject_"+dhtmlx.uid();f.style.width="100%";f.style.height="100%";f.cmp="grid";document.body.appendChild(f);this.attachObject(f.id);a.container=f.id;var e=this.vs[this.av];e.grid=new window[c](a);e.gridId=f.id;e.gridObj=f;e.grid.setSizes=function(){if(this.resize){this.resize()}else{this.render()}};var d="_viewRestore";return this.vs[this[d]()].grid};dhtmlx.attaches.attachDataView=function(a){return this.attachAbstract("dhtmlXDataView",a)};dhtmlx.attaches.attachChart=function(a){return this.attachAbstract("dhtmlXChart",a)};dhtmlx.compat.layout=function(){};function dhtmlXCalendarObject(g,n){this.i={};var d=null;if(typeof(g)=="string"){var e=document.getElementById(g)}else{var e=g}if(e&&typeof(e)=="object"&&e.tagName&&String(e.tagName).toLowerCase()!="input"){d=e}e=null;if(typeof(g)!="object"||!g.length){g=[g]}for(var c=0;c<g.length;c++){if(typeof(g[c])=="string"){g[c]=(document.getElementById(g[c])||null)}if(g[c]!=null&&g[c].tagName&&String(g[c].tagName).toLowerCase()=="input"){this.i[window.dhx4.newId()]={input:g[c]}}else{if(!(g[c] instanceof Array)&&g[c] instanceof Object&&(g[c].input!=null||g[c].button!=null)){if(g[c].input!=null&&typeof(g[c].input)=="string"){g[c].input=document.getElementById(g[c].input)}if(g[c].button!=null&&typeof(g[c].button)=="string"){g[c].button=document.getElementById(g[c].button)}this.i[window.dhx4.newId()]=g[c]}}g[c]=null}this.conf={skin:(n||window.dhx4.skin||(typeof(dhtmlx)!="undefined"?dhtmlx.skin:null)||window.dhx4.skinDetect("dhtmlxcalendar")||"dhx_skyblue"),zi:window.dhx4.newId(),touch:(typeof(window.ontouchstart)!="undefined")};this.setSkin=function(o,a){if(this.conf.skin==o&&!a){return}this.conf.skin=o;this.base.className="dhtmlxcalendar_"+this.conf.skin;this._ifrSize()};this.base=document.createElement("DIV");this.base.style.display="none";this.base.appendChild(document.createElement("DIV"));if(d!=null){this._hasParent=true;d.appendChild(this.base);d=null}else{document.body.appendChild(this.base)}this.setParent=function(a){if(this._hasParent){if(typeof(a)=="object"){a.appendChild(this.base)}else{if(typeof(a)=="string"){document.getElementById(a).appendChild(this.base)}}}};this.setSkin(this.conf.skin,true);if(this.conf.touch){this.base.ontouchstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}a.cancelBubble=true}}else{this.base.onclick=function(a){a=a||event;a.cancelBubble=true};this.base.onmousedown=function(){return false}}this.loadUserLanguage=function(s){if(!this.langData[s]){return}this.lang=s;this.setWeekStartDay(this.langData[this.lang].weekstart);this.setDateFormat(this.langData[this.lang].dateformat||"%Y-%m-%d");if(this.msCont){var r=0;for(var o=0;o<this.msCont.childNodes.length;o++){for(var a=0;a<this.msCont.childNodes[o].childNodes.length;a++){this.msCont.childNodes[o].childNodes[a].innerHTML=this.langData[this.lang].monthesSNames[r++]}}}};this.contMonth=document.createElement("DIV");this.contMonth.className="dhtmlxcalendar_month_cont";this.contMonth.onselectstart=function(a){a=a||event;a.cancelBubble=true;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}return false};this.base.firstChild.appendChild(this.contMonth);var h=document.createElement("UL");h.className="dhtmlxcalendar_line";this.contMonth.appendChild(h);var m=document.createElement("LI");m.className="dhtmlxcalendar_cell dhtmlxcalendar_month_hdr";m.innerHTML="<div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left\";'></div><span></span><div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right\";'></div>";h.appendChild(m);var f=this;m[this.conf.touch?"ontouchstart":"onclick"]=function(r){r=r||event;var o=(r.target||r.srcElement);if(o.className&&o.className.indexOf("dhtmlxcalendar_month_arrow")===0){f._hideSelector();var q=(o.parentNode.firstChild==o?-1:1);var a=new Date(f._activeMonth);f._drawMonth(new Date(f._activeMonth.getFullYear(),f._activeMonth.getMonth()+q,1,0,0,0,0));f._evOnArrowClick([a,new Date(f._activeMonth)]);return}if(o.className&&o.className=="dhtmlxcalendar_month_label_month"){r.cancelBubble=true;f._showSelector("month",Math.round(o.offsetLeft+o.offsetWidth/2),o.offsetTop+o.offsetHeight+2,"selector_month",true);return}if(o.className&&o.className=="dhtmlxcalendar_month_label_year"){r.cancelBubble=true;f._showSelector("year",Math.round(o.offsetLeft+o.offsetWidth/2),o.offsetTop+o.offsetHeight+2,"selector_year",true);return}f._hideSelector()};this.contDays=document.createElement("DIV");this.contDays.className="dhtmlxcalendar_days_cont";this.base.firstChild.appendChild(this.contDays);this.setWeekStartDay=function(a){if(a==0){a=7}this._wStart=Math.min(Math.max((isNaN(a)?1:a),1),7);this._drawDaysOfWeek()};this._drawDaysOfWeek=function(){if(this.contDays.childNodes.length==0){var s=document.createElement("UL");s.className="dhtmlxcalendar_line";this.contDays.appendChild(s)}else{var s=this.contDays.firstChild}var o=this._wStart;var r=this.langData[this.lang].daysSNames;r.push(String(this.langData[this.lang].daysSNames[0]).valueOf());for(var u=0;u<8;u++){if(s.childNodes[u]==null){var a=document.createElement("LI");s.appendChild(a)}else{var a=s.childNodes[u]}if(u==0){a.className="dhtmlxcalendar_cell_wn";a.innerHTML="<div class='dhtmlxcalendar_label'>"+(this.langData[this.lang].weekname||"w")+"</div>"}else{a.className="dhtmlxcalendar_cell"+(o>=6?" dhtmlxcalendar_day_weekday_cell":"")+(u==1?"_first":"");a.innerHTML=r[o];if(++o>7){o=1}}}if(this._activeMonth!=null){this._drawMonth(this._activeMonth)}};this._wStart=this.langData[this.lang].weekstart;this.setWeekStartDay(this._wStart);this.contDates=document.createElement("DIV");this.contDates.className="dhtmlxcalendar_dates_cont";this.base.firstChild.appendChild(this.contDates);this.contDates[this.conf.touch?"ontouchend":"onclick"]=function(u){u=u||event;var o=(u.target||u.srcElement);if(o.parentNode!=null&&o.parentNode._date!=null){o=o.parentNode}if(o._date!=null&&!o._css_dis){var r=f._activeDate.getHours();var q=f._activeDate.getMinutes();var s=o._date;if(f.checkEvent("onBeforeChange")){if(!f.callEvent("onBeforeChange",[new Date(o._date.getFullYear(),o._date.getMonth(),o._date.getDate(),r,q)])){return}}if(f._activeDateCell!=null){f._activeDateCell._css_date=false;f._updateCellStyle(f._activeDateCell._q,f._activeDateCell._w)}var a=(f._activeDate.getFullYear()+"_"+f._activeDate.getMonth()!=s.getFullYear()+"_"+s.getMonth());f._nullDate=false;f._activeDate=new Date(s.getFullYear(),s.getMonth(),s.getDate(),r,q);f._activeDateCell=o;f._activeDateCell._css_date=true;f._activeDateCell._css_hover=false;f._updateCellStyle(f._activeDateCell._q,f._activeDateCell._w);if(a){f._drawMonth(f._activeDate)}if(f._activeInp&&f.i[f._activeInp]&&f.i[f._activeInp].input!=null){f.i[f._activeInp].input.value=f._dateToStr(new Date(f._activeDate.getTime()))}if(!f._hasParent){f._hide()}f._evOnClick([new Date(f._activeDate.getTime())])}};if(!this.conf.touch){this.contDates.onmouseover=function(o){o=o||event;var a=(o.target||o.srcElement);if(a.parentNode!=null&&a.parentNode._date!=null){a=a.parentNode}if(a._date!=null){if(f._lastHover==a||a._css_hover){return}a._css_hover=true;f._updateCellStyle(a._q,a._w);f._lastHover=a;f._evOnMouseOver([new Date(a._date.getFullYear(),a._date.getMonth(),a._date.getDate(),0,0,0,0),o]);a=null}};this.contDates.onmouseout=function(a){f._clearDayHover(a||event)}}this._lastHover=null;this._clearDayHover=function(a){if(!this._lastHover){return}this._lastHover._css_hover=false;this._updateCellStyle(this._lastHover._q,this._lastHover._w);f._evOnMouseOut([new Date(this._lastHover._date.getFullYear(),this._lastHover._date.getMonth(),this._lastHover._date.getDate(),0,0,0,0),a]);this._lastHover=null};for(var c=0;c<6;c++){var h=document.createElement("UL");h.className="dhtmlxcalendar_line";this.contDates.appendChild(h);for(var l=0;l<=7;l++){var m=document.createElement("LI");if(l==0){m.className="dhtmlxcalendar_cell_wn"}else{m.className="dhtmlxcalendar_cell"}h.appendChild(m)}}this.contTime=document.createElement("DIV");this.contTime.className="dhtmlxcalendar_time_cont";this.base.firstChild.appendChild(this.contTime);this.showTime=function(){this.contTime.style.display="";this._ifrSize()};this.hideTime=function(){this.contTime.style.display="none";this._ifrSize()};var h=document.createElement("UL");h.className="dhtmlxcalendar_line";this.contTime.appendChild(h);var m=document.createElement("LI");m.className="dhtmlxcalendar_cell dhtmlxcalendar_time_hdr";m.innerHTML="<div class='dhtmlxcalendar_time_img'></div><span class='dhtmlxcalendar_label_hours'></span><span class='dhtmlxcalendar_label_colon'> : </span><span class='dhtmlxcalendar_label_minutes'></span>";h.appendChild(m);m[this.conf.touch?"ontouchstart":"onclick"]=function(q){q=q||event;var a=(q.target||q.srcElement);if(a.tagName!=null&&a.tagName.toLowerCase()=="span"&&a._par==true&&a.parentNode!=null){a=a.parentNode}if(a.className&&a.className=="dhtmlxcalendar_label_hours"){q.cancelBubble=true;var o=f.contMonth.offsetHeight+f.contDays.offsetHeight+f.contDates.offsetHeight+a.offsetTop;f._showSelector("hours",Math.round(a.offsetLeft+a.offsetWidth/2),o-2,"selector_hours",true);return}if(a.className&&a.className=="dhtmlxcalendar_label_minutes"){q.cancelBubble=true;if(f._minutesInterval==1){var r=f.getFormatedDate("%i");a.innerHTML="<span class='dhtmlxcalendar_selected_date'>"+r.charAt(0)+"</span>"+r.charAt(1);a.firstChild._par=true;f._selectorMode=1}var o=f.contMonth.offsetHeight+f.contDays.offsetHeight+f.contDates.offsetHeight+a.offsetTop;f._showSelector("minutes",Math.round(a.offsetLeft+a.offsetWidth/2),o-2,"selector_minutes",true);return}f._hideSelector()};this._activeMonth=null;this._activeDate=new Date();this._activeDateCell=null;this.setDate=function(o){this._nullDate=(typeof(o)=="undefined"||o===""||!o);if(!(o instanceof Date)){o=this._strToDate(String(o||""));if(o=="Invalid Date"){o=new Date()}}var a=o.getTime();if(this._isOutOfRange(a)){return}this._activeDate=new Date(a);this._drawMonth(this._nullDate?new Date():this._activeDate);this._updateVisibleHours();this._updateVisibleMinutes()};this.getDate=function(o){if(this._nullDate){return null}var a=new Date(this._activeDate.getTime());if(o){return this._dateToStr(a)}return a};this._drawMonth=function(y){if(!(y instanceof Date)){return}if(isNaN(y.getFullYear())){y=new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),1,0,0,0,0)}this._activeMonth=new Date(y.getFullYear(),y.getMonth(),1,0,0,0,0);this._activeDateCell=null;var v=new Date(this._activeMonth.getTime());var r=v.getDay();var D=r-this._wStart;if(D<0){D=D+7}v.setDate(v.getDate()-D);var H=y.getMonth();var I=new Date(this._activeDate.getFullYear(),this._activeDate.getMonth(),this._activeDate.getDate(),0,0,0,0).getTime();var u=0;for(var o=0;o<6;o++){var x=this._wStart;for(var F=0;F<=7;F++){if(F==0){var E=this.getWeekNumber(new Date(v.getFullYear(),v.getMonth(),v.getDate()+u,0,0,0,0));this.contDates.childNodes[o].childNodes[F].innerHTML="<div class='dhtmlxcalendar_label'>"+E+"</div>"}else{var a=new Date(v.getFullYear(),v.getMonth(),v.getDate()+u,0,0,0,0);var C=a.getDay();var s=a.getTime();var A="dhtmlxcalendar_label";if(this._tipData[s]!=null){if(this._tipData[s].usePopup&&typeof(window.dhtmlXPopup)=="function"){this.contDates.childNodes[o].childNodes[F].removeAttribute("title");this._initTooltipPopup()}else{this.contDates.childNodes[o].childNodes[F].setAttribute("title",this._tipData[s].text)}if(this._tipData[s].showIcon){A+=" dhtmlxcalendar_label_title"}}else{this.contDates.childNodes[o].childNodes[F].removeAttribute("title")}this.contDates.childNodes[o].childNodes[F].innerHTML="<div class='"+A+"'>"+a.getDate()+"</div>";this.contDates.childNodes[o].childNodes[F]._date=new Date(s);this.contDates.childNodes[o].childNodes[F]._q=o;this.contDates.childNodes[o].childNodes[F]._w=F;this.contDates.childNodes[o].childNodes[F]._css_month=(a.getMonth()==H);this.contDates.childNodes[o].childNodes[F]._css_date=(!this._nullDate&&s==I);this.contDates.childNodes[o].childNodes[F]._css_weekend=(x>=6);this.contDates.childNodes[o].childNodes[F]._css_dis=this._isOutOfRange(s);this.contDates.childNodes[o].childNodes[F]._css_holiday=(this._holidays[s]==true);this._updateCellStyle(o,F);if(s==I){this._activeDateCell=this.contDates.childNodes[o].childNodes[F]}if(++x>7){x=1}u++}}}this.contMonth.firstChild.firstChild.childNodes[1].innerHTML=this._buildMonthHdr(y)};this._updateCellStyle=function(v,a){var u=this.contDates.childNodes[v].childNodes[a];var o="dhtmlxcalendar_cell dhtmlxcalendar_cell";o+=(u._css_month?"_month":"");o+=(u._css_date?"_date":"");o+=(u._css_weekend?"_weekend":"");o+=(u._css_holiday?"_holiday":"");o+=(u._css_dis?"_dis":"");o+=(u._css_hover&&!u._css_dis?"_hover":"");u.className=o;u=null};this._minutesInterval=5;this._initSelector=function(y,s){if(!this._selCover){this._selCover=document.createElement("DIV");this._selCover.className="dhtmlxcalendar_selector_cover";this.base.firstChild.appendChild(this._selCover)}if(!this._sel){this._sel=document.createElement("DIV");this._sel.className="dhtmlxcalendar_selector_obj";this.base.firstChild.appendChild(this._sel);this._sel.appendChild(document.createElement("TABLE"));this._sel.firstChild.className="dhtmlxcalendar_selector_table";this._sel.firstChild.cellSpacing=0;this._sel.firstChild.cellPadding=0;this._sel.firstChild.border=0;this._sel.firstChild.appendChild(document.createElement("TBODY"));this._sel.firstChild.firstChild.appendChild(document.createElement("TR"));this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD"));this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD"));this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD"));this._sel.firstChild.firstChild.firstChild.childNodes[0].className="dhtmlxcalendar_selector_cell_left";this._sel.firstChild.firstChild.firstChild.childNodes[1].className="dhtmlxcalendar_selector_cell_middle";this._sel.firstChild.firstChild.firstChild.childNodes[2].className="dhtmlxcalendar_selector_cell_right";this._sel.firstChild.firstChild.firstChild.childNodes[0].innerHTML="&nbsp;";this._sel.firstChild.firstChild.firstChild.childNodes[2].innerHTML="&nbsp;";if(!this.conf.touch){this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_left dhtmlxcalendar_selector_cell_left_hover"};this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseout=function(){this.className="dhtmlxcalendar_selector_cell_left"};this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_right dhtmlxcalendar_selector_cell_right_hover"};this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseout=function(){this.className="dhtmlxcalendar_selector_cell_right"};this._sel.onmouseover=function(w){w=w||event;var q=(w.target||w.srcElement);if(q._cell===true){if(f._selHover!=q){f._clearSelHover()}if(String(q.className).match(/^\s{0,}dhtmlxcalendar_selector_cell\s{0,}$/gi)!=null){q.className+=" dhtmlxcalendar_selector_cell_hover";f._selHover=q}}};this._sel.onmouseout=function(){f._clearSelHover()}}this._sel.firstChild.firstChild.firstChild.childNodes[0][this.conf.touch?"ontouchstart":"onclick"]=function(q){q=q||event;q.cancelBubble=true;f._scrollYears(-1)};this._sel.firstChild.firstChild.firstChild.childNodes[2][this.conf.touch?"ontouchstart":"onclick"]=function(q){q=q||event;q.cancelBubble=true;f._scrollYears(1)};this._sel._ta={};this._selHover=null;this._sel.appendChild(document.createElement("DIV"));this._sel.lastChild.className="dhtmlxcalendar_selector_obj_arrow"}if(this._sel._ta[y]==true){return}if(y=="month"){this._msCells={};this.msCont=document.createElement("DIV");this.msCont.className="dhtmlxcalendar_area_"+s;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.msCont);var o=0;for(var a=0;a<4;a++){var x=document.createElement("UL");x.className="dhtmlxcalendar_selector_line";this.msCont.appendChild(x);for(var A=0;A<3;A++){var C=document.createElement("LI");C.innerHTML=this.langData[this.lang].monthesSNames[o];C.className="dhtmlxcalendar_selector_cell";x.appendChild(C);C._month=o;C._cell=true;this._msCells[o++]=C}}this.msCont[this.conf.touch?"ontouchstart":"onclick"]=function(w){w=w||event;w.cancelBubble=true;var q=(w.target||w.srcElement);if(q._month!=null){f._hideSelector();f._updateActiveMonth();f._drawMonth(new Date(f._activeMonth.getFullYear(),q._month,1,0,0,0,0));f._doOnSelectorChange()}}}if(y=="year"){this._ysCells={};this.ysCont=document.createElement("DIV");this.ysCont.className="dhtmlxcalendar_area_"+s;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.ysCont);for(var a=0;a<4;a++){var x=document.createElement("UL");x.className="dhtmlxcalendar_selector_line";this.ysCont.appendChild(x);for(var A=0;A<3;A++){var C=document.createElement("LI");C.className="dhtmlxcalendar_selector_cell";C._cell=true;x.appendChild(C)}}this.ysCont[this.conf.touch?"ontouchstart":"onclick"]=function(w){w=w||event;w.cancelBubble=true;var q=(w.target||w.srcElement);if(q._year!=null){f._hideSelector();f._drawMonth(new Date(q._year,f._activeMonth.getMonth(),1,0,0,0,0));f._doOnSelectorChange()}}}if(y=="hours"){this._hsCells={};this.hsCont=document.createElement("DIV");this.hsCont.className="dhtmlxcalendar_area_"+s;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.hsCont);var o=0;for(var a=0;a<4;a++){var x=document.createElement("UL");x.className="dhtmlxcalendar_selector_line";this.hsCont.appendChild(x);for(var A=0;A<6;A++){var C=document.createElement("LI");C.innerHTML=this._fixLength(o,2);C.className="dhtmlxcalendar_selector_cell";x.appendChild(C);C._hours=o;C._cell=true;this._hsCells[o++]=C}}this.hsCont[this.conf.touch?"ontouchstart":"onclick"]=function(w){w=w||event;w.cancelBubble=true;var q=(w.target||w.srcElement);if(q._hours!=null){f._hideSelector();f._activeDate.setHours(q._hours);f._updateActiveHours();f._updateVisibleHours();f._doOnSelectorChange()}}}if(y=="minutes"){var v=4;var r=3;var u=2;if(this._minutesInterval==1){if(this._selectorMode==1){v=2;r=3;u=1}else{v=2;r=5;u=1;s+="5"}}if(this._minutesInterval==10){v=2}if(this._minutesInterval==15){v=1;r=4;s+="4"}this._rsCells={};this.rsCont=document.createElement("DIV");this.rsCont.className="dhtmlxcalendar_area_"+s;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.rsCont);var o=0;for(var a=0;a<v;a++){var x=document.createElement("UL");x.className="dhtmlxcalendar_selector_line";this.rsCont.appendChild(x);for(var A=0;A<r;A++){var C=document.createElement("LI");C.innerHTML=(u>1?this._fixLength(o,u):o);C.className="dhtmlxcalendar_selector_cell";x.appendChild(C);C._minutes=o;C._cell=true;this._rsCells[o]=C;o+=this._minutesInterval}}this.rsCont[this.conf.touch?"ontouchstart":"onclick"]=function(D){D=D||event;D.cancelBubble=true;var w=(D.target||D.srcElement);if(w._minutes!=null){if(f._minutesInterval==1){var q=f.getFormatedDate("%i");if(f._selectorMode==1){q=w._minutes.toString()+q.charAt(1)}else{q=q.charAt(0)+w._minutes.toString()}f._activeDate.setMinutes(Number(q));f._hideSelector();if(f._selectorMode==1){f._updateVisibleMinutes(true);f._selectorMode=2;f._showSelector("minutes",f._sel._x,f._sel._y,"selector_minutes",true);f._updateActiveMinutes();return}else{f._selectorMode=1}}else{f._hideSelector();f._activeDate.setMinutes(w._minutes);f._updateActiveMinutes()}f._updateVisibleMinutes();f._doOnSelectorChange()}}}this._sel._ta[y]=true};this._showSelector=function(s,o,u,r,a){if(a===true&&this._sel!=null&&this._isSelectorVisible()&&s==this._sel._t){this._hideSelector();return}if(this.conf.skin=="dhx_terrace"){o+=12}if(!this._sel||!this._sel._ta[s]){this._initSelector(s,r)}if(s!=this._sel._t&&this._sel._t=="minutes"&&this._minutesInterval==1){this.contTime.firstChild.firstChild.childNodes[3].innerHTML=this.getFormatedDate("%i")}this._sel._x=o;this._sel._y=u;this._sel.style.visibility="hidden";this._sel.style.display="";this._selCover.style.width=this.base.offsetWidth-2+"px";this._selCover.style.top=this.contMonth.offsetHeight+"px";this._selCover.style.height=this.contDates.offsetHeight+this.contDays.offsetHeight-1+"px";this._selCover.style.display="";this._sel._t=s;this._sel.className="dhtmlxcalendar_selector_obj dhtmlxcalendar_"+r;this._sel.childNodes[0].firstChild.firstChild.childNodes[0].style.display=this._sel.childNodes[0].firstChild.firstChild.childNodes[2].style.display=(s=="year"?"":"none");var q=Math.max(0,o-Math.round(this._sel.offsetWidth/2));if(q+this._sel.offsetWidth>this._sel.parentNode.offsetWidth){q=this._sel.parentNode.offsetWidth-this._sel.offsetWidth}this._sel.style.left=q+"px";if(s=="hours"||s=="minutes"){this._sel.style.top=u-this._sel.offsetHeight+"px"}else{this._sel.style.top=u+"px"}this._sel.childNodes[1].style.width=this._sel.childNodes[0].offsetWidth+"px";this._sel.style.visibility="visible";this._doOnSelectorShow(s)};this._doOnSelectorShow=function(a){if(a=="month"){this._updateActiveMonth()}if(a=="year"){this._updateYearsList(this._activeMonth)}if(a=="hours"){this._updateActiveHours()}if(a=="minutes"){this._updateActiveMinutes()}};this._hideSelector=function(a){if(!this._sel){return}this._sel.style.display="none";this._sel.style.visible="hidden";this._selCover.style.display="none";if(this._sel._t=="minutes"&&this._minutesInterval==1){this.contTime.firstChild.firstChild.childNodes[3].innerHTML=this.getFormatedDate("%i");this._unloadSelector("minutes")}};this._isSelectorVisible=function(){if(!this._sel){return false}return(this._sel.style.display!="none")};this._doOnSelectorChange=function(a){this.callEvent("onChange",[new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),this._activeDate.getDate(),this._activeDate.getHours(),this._activeDate.getMinutes(),this._activeDate.getSeconds()),a===true])};this._clearSelHover=function(){if(!this._selHover){return}this._selHover.className=String(this._selHover.className.replace(/dhtmlxcalendar_selector_cell_hover/gi,""));this._selHover=null};this._unloadSelector=function(q){if(!this._sel){return}if(!this._sel._ta[q]){return}if(q=="month"){this.msCont.onclick=this.msCont.ontouchstart=null;this._msActive=null;for(var o in this._msCells){this._msCells[o]._cell=null;this._msCells[o]._month=null;this._msCells[o].parentNode.removeChild(this._msCells[o]);this._msCells[o]=null}this._msCells=null;while(this.msCont.childNodes.length>0){this.msCont.removeChild(this.msCont.lastChild)}this.msCont.parentNode.removeChild(this.msCont);this.msCont=null}if(q=="year"){this.ysCont.onclick=this.ysCont.ontouchstart=null;for(var o in this._ysCells){this._ysCells[o]._cell=null;this._ysCells[o]._year=null;this._ysCells[o].parentNode.removeChild(this._ysCells[o]);this._ysCells[o]=null}this._ysCells=null;while(this.ysCont.childNodes.length>0){this.ysCont.removeChild(this.ysCont.lastChild)}this.ysCont.parentNode.removeChild(this.ysCont);this.ysCont=null}if(q=="hours"){this.hsCont.onclick=this.hsCont.ontouchstart=null;this._hsActive=null;for(var o in this._hsCells){this._hsCells[o]._cell=null;this._hsCells[o]._hours=null;this._hsCells[o].parentNode.removeChild(this._hsCells[o]);this._hsCells[o]=null}this._hsCells=null;while(this.hsCont.childNodes.length>0){this.hsCont.removeChild(this.hsCont.lastChild)}this.hsCont.parentNode.removeChild(this.hsCont);this.hsCont=null}if(q=="minutes"){this.rsCont.onclick=this.rsCont.ontouchstart=null;this._rsActive=null;for(var o in this._rsCells){this._rsCells[o]._cell=null;this._rsCells[o]._minutes=null;this._rsCells[o].parentNode.removeChild(this._rsCells[o]);this._rsCells[o]=null}this._rsCells=null;while(this.rsCont.childNodes.length>0){this.rsCont.removeChild(this.rsCont.lastChild)}this.rsCont.parentNode.removeChild(this.rsCont);this.rsCont=null}this._sel._ta[q]=null};this.setMinutesInterval=function(a){if(!(a==1||a==5||a==10||a==15)){return}this._minutesInterval=a;this._unloadSelector("minutes")};this._updateActiveMonth=function(){if(typeof(this._msActive)!="undefined"&&typeof(this._msCells[this._msActive])!="undefined"){this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell"}this._msActive=this._activeMonth.getMonth();this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateActiveYear=function(){var a=this._activeMonth.getFullYear();if(this._ysCells[a]){this._ysCells[a].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"}};this._updateYearsList=function(v){for(var r in this._ysCells){this._ysCells[r]=null;delete this._ysCells[r]}var s=12*Math.floor(v.getFullYear()/12);for(var u=0;u<4;u++){for(var o=0;o<3;o++){this.ysCont.childNodes[u].childNodes[o].innerHTML=s;this.ysCont.childNodes[u].childNodes[o]._year=s;this.ysCont.childNodes[u].childNodes[o].className="dhtmlxcalendar_selector_cell";this._ysCells[s++]=this.ysCont.childNodes[u].childNodes[o]}}this._updateActiveYear()};this._scrollYears=function(a){var q=(a<0?this.ysCont.firstChild.firstChild._year:this.ysCont.lastChild.lastChild._year)+a;var o=new Date(q,this._activeMonth.getMonth(),1,0,0,0,0);this._updateYearsList(o)};this._updateActiveHours=function(){if(typeof(this._hsActive)!="undefined"&&typeof(this._hsCells[this._hsActive])!="undefined"){this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell"}this._hsActive=this._activeDate.getHours();this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateVisibleHours=function(){this.contTime.firstChild.firstChild.childNodes[1].innerHTML=this._fixLength(this._activeDate.getHours(),2)};this._updateActiveMinutes=function(){if(this._rsActive!=null&&typeof(this._rsActive)!="undefined"&&typeof(this._rsCells[this._rsActive])!="undefined"){this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell"}if(this._minutesInterval==1){this._rsActive=(this.getFormatedDate("%i").toString()).charAt(this._selectorMode==1?0:1)}else{this._rsActive=this._activeDate.getMinutes()}if(typeof(this._rsCells[this._rsActive])!="undefined"){this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"}};this._updateVisibleMinutes=function(o){var a=this._fixLength(this._activeDate.getMinutes(),2).toString();if(o==true){a=a.charAt(0)+"<span class='dhtmlxcalendar_selected_date'>"+a.charAt(1)+"</span>"}this.contTime.firstChild.firstChild.childNodes[3].innerHTML=a;if(o==true){this.contTime.firstChild.firstChild.childNodes[3].lastChild._par=true}};this._fixLength=function(a,o){while(String(a).length<o){a="0"+String(a)}return a};this._dateFormat="";this._dateFormatRE=null;this.setDateFormat=function(s){var r={};if(this._strToDate!=null){for(var o in this.i){if(this.i[o].input!=null&&this.i[o].input.value.length>0){var u=this._strToDate(this.i[o].input.value,this._dateFormat||this.langData[this.lang].dateformat||"%Y-%m-%d");if(u instanceof Date){r[o]=u}}}}this._dateFormat=s;var q=String(this._dateFormat).replace(/%[a-zA-Z]+/g,function(a){var v=a.replace(/%/,"");switch(v){case"n":case"h":case"j":case"g":case"G":return"\\d{1,2}";case"m":case"d":case"H":case"i":case"s":case"y":return"\\d{2}";case"Y":return"\\d{4}";case"M":return"("+f.langData[f.lang].monthesSNames.join("|").toLowerCase()+"){1,}";case"F":return"("+f.langData[f.lang].monthesFNames.join("|").toLowerCase()+"){1,}";case"D":return"[a-z]{2}";case"a":case"A":return"AM|PM"}return a});this._dateFormatRE=new RegExp(q,"i");for(var o in r){this.i[o].input.value=this._dateToStr(r[o])}r=null};this.setDateFormat(this.langData[this.lang].dateformat||"%Y-%m-%d");this._getInd=function(r,a){for(var o=0;o<a.length;o++){if(a[o].toLowerCase()==r){return o}}return -1};this._updateDateStr=function(o){if(!this._dateFormatRE||!o.match(this._dateFormatRE)){return}if(o==this.getFormatedDate()){return}var a=this._strToDate(o);if(!(a instanceof Date)){return}if(this.checkEvent("onBeforeChange")){if(!this.callEvent("onBeforeChange",[new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds())])){if(this.i!=null&&this._activeInp!=null&&this.i[this._activeInp]!=null&&this.i[this._activeInp].input!=null){this.i[this._activeInp].input.value=this.getFormatedDate()}return}}this._nullDate=false;this._activeDate=a;this._drawMonth(this._nullDate?new Date():this._activeDate);this._updateVisibleMinutes();this._updateVisibleHours();if(this._sel&&this._isSelectorVisible()){this._doOnSelectorShow(this._sel._t)}this._doOnSelectorChange(true)};this.showMonth=function(a){if(typeof(a)=="string"){a=this._strToDate(a)}if(!(a instanceof Date)){return}this._drawMonth(a)};this.setFormatedDate=function(s,u,o,r){var q=this._strToDate(u,s);if(r){return q}this.setDate(q)};this.getFormatedDate=function(o,a){if(!(a&&a instanceof Date)){if(this._nullDate){return""}a=new Date(this._activeDate)}return this._dateToStr(a,o)};this.getWeekNumber=function(s){if(typeof(s)=="string"){s=this._strToDate(s)}if(!(s instanceof Date)){return"Invalid Date"}if(typeof(this._ftDay)=="undefined"){this._ftDay=4}var y=this._wStart;var r=y+7;var x=4;var o=new Date(s.getFullYear(),0,1,0,0,0,0);var q=o.getDay();if(q==0){q=7}if(x<y){x+=7;q+=7}var v=0;if(q>=y&&q<=x){}else{v=1}var u=q-y;var w=new Date(s.getFullYear(),0,1-u+v*7,0,0,0,0);var C=604800000;var a=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1,0,0,0,0);var A=Math.ceil((a.getTime()-w.getTime())/C);return A};this.showWeekNumbers=function(){this.base.firstChild.className="dhtmlxcalendar_wn"};this.hideWeekNumbers=function(){this.base.firstChild.className=""};this.show=function(q){if(!q&&this._hasParent){this._show();return}if(typeof(q)=="object"&&typeof(q._dhtmlxcalendar_uid)!="undefined"&&this.i[q._dhtmlxcalendar_uid]==q){this._show(q._dhtmlxcalendar_uid);return}if(typeof(q)=="undefined"){for(var o in this.i){if(!q){q=o}}}if(!q){return}this._show(q)};this.hide=function(){if(this._isVisible()){this._hide()}};this.isVisible=function(){return this._isVisible()};this._activeInp=null;this.pos="bottom";this.setPosition=function(a,o){this._px=null;this._py=null;if(a=="right"||a=="bottom"){this.pos=a}else{this.pos="int";if(typeof(a)!="undefined"&&!isNaN(a)){this.base.style.left=a+"px";this._px=a}if(typeof(o)!="undefined"&&!isNaN(o)){this.base.style.top=o+"px";this._py=o}this._ifrSize()}};this._show=function(v,a){if(a===true&&this._activeInp==v&&this._isVisible()){this._hide();return}this.base.style.visibility="hidden";this.base.style.display="";if(!v){if(this._px&&this._py){this.base.style.left=this._px+"px";this.base.style.top=this._py+"px"}else{this.base.style.left="0px";this.base.style.top="0px"}}else{if(this.base.className.indexOf("dhtmlxcalendar_in_input")==-1){this.base.className+=" dhtmlxcalendar_in_input"}var r=(this.i[v].input||this.i[v].button);var o=(navigator.appVersion.indexOf("MSIE")!=-1);var s=Math.max((o?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop);var q=s+(o?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0):window.innerHeight);if(this.pos=="right"){this.base.style.left=this._getLeft(r)+r.offsetWidth+"px";this.base.style.top=Math.min(this._getTop(r),q-this.base.offsetHeight)+"px"}else{if(this.pos=="bottom"){var u=this._getTop(r)+r.offsetHeight+1;if(u+this.base.offsetHeight>q){u=this._getTop(r)-this.base.offsetHeight}this.base.style.left=this._getLeft(r)+"px";this.base.style.top=u+"px"}else{this.base.style.left=(this._px||0)+"px";this.base.style.top=(this._py||0)+"px"}}this._activeInp=v;r=null}this._hideSelector();this.base.style.visibility="visible";this.base.style.zIndex=window.dhx4.zim.reserve(this.conf.zi);this._ifrSize();if(this._ifr){this._ifr.style.display=""}this.callEvent("onShow",[])};this._hide=function(){this._hideSelector();this.base.style.display="none";window.dhx4.zim.clear(this.conf.zi);if(this.base.className.indexOf("dhtmlxcalendar_in_input")>=0){this.base.className=this.base.className.replace(/\s{0,}dhtmlxcalendar_in_input/gi,"")}this._activeInp=null;if(this._ifr){this._ifr.style.display="none"}this.callEvent("onHide",[])};this._isVisible=function(){return(this.base.style.display!="none")};this._getLeft=function(a){return this._posGetOffset(a).left};this._getTop=function(a){return this._posGetOffset(a).top};this._posGetOffsetSum=function(a){var q=0,o=0;while(a){q=q+parseInt(a.offsetTop);o=o+parseInt(a.offsetLeft);a=a.offsetParent}return{top:q,left:o}};this._posGetOffsetRect=function(r){var v=r.getBoundingClientRect();var w=document.body;var o=document.documentElement;var a=window.pageYOffset||o.scrollTop||w.scrollTop;var s=window.pageXOffset||o.scrollLeft||w.scrollLeft;var u=o.clientTop||w.clientTop||0;var x=o.clientLeft||w.clientLeft||0;var y=v.top+a-u;var q=v.left+s-x;return{top:Math.round(y),left:Math.round(q)}};this._posGetOffset=function(a){return this[a.getBoundingClientRect?"_posGetOffsetRect":"_posGetOffsetSum"](a)};this._rangeActive=false;this._rangeFrom=null;this._rangeTo=null;this._rangeSet={};this.setInsensitiveDays=function(r){var a=this._extractDates(r);for(var o=0;o<a.length;o++){this._rangeSet[new Date(a[o].getFullYear(),a[o].getMonth(),a[o].getDate(),0,0,0,0).getTime()]=true}this._drawMonth(this._activeMonth)};this.clearInsensitiveDays=function(){this._clearRangeSet();this._drawMonth(this._activeMonth)};this._holidays={};this.setHolidays=function(o){if(o==null){this._clearHolidays()}else{if(o!=null){var a=this._extractDates(o);for(var s=0;s<a.length;s++){this._holidays[new Date(a[s].getFullYear(),a[s].getMonth(),a[s].getDate(),0,0,0,0).getTime()]=true}}}this._drawMonth(this._activeMonth)};this._extractDates=function(s){if(typeof(s)=="string"||s instanceof Date){s=[s]}var o=[];for(var u=0;u<s.length;u++){if(typeof(s[u])=="string"){var v=s[u].split(",");for(var a=0;a<v.length;a++){o.push(this._strToDate(v[a]))}}else{if(s[u] instanceof Date){o.push(s[u])}}}return o};this._clearRange=function(){this._rangeActive=false;this._rangeType=null;this._rangeFrom=null;this._rangeTo=null};this._clearRangeSet=function(){for(var o in this._rangeSet){this._rangeSet[o]=null;delete this._rangeSet[o]}};this._clearHolidays=function(){for(var o in this._holidays){this._holidays[o]=null;delete this._holidays[o]}};this._isOutOfRange=function(o){if(this._rangeSet[o]==true){return true}if(this._rangeActive){if(this._rangeType=="in"&&(o<this._rangeFrom||o>this._rangeTo)){return true}if(this._rangeType=="out"&&(o>=this._rangeFrom&&o<=this._rangeTo)){return true}if(this._rangeType=="from"&&o<this._rangeFrom){return true}if(this._rangeType=="to"&&o>this._rangeTo){return true}}var a=new Date(o);if(this._rangeWeek){if(this._rangeWeekData[a.getDay()]===true){return true}}if(this._rangeMonth){if(this._rangeMonthData[a.getDate()]===true){return true}}if(this._rangeYear){if(this._rangeYearData[a.getMonth()+"_"+a.getDate()]===true){return true}}return false};this.clearSensitiveRange=function(){this._clearRange();this._drawMonth(this._activeMonth)};this.setSensitiveRange=function(r,q,a){var o=false;if(r!=null&&q!=null){if(!(r instanceof Date)){r=this._strToDate(r)}if(!(q instanceof Date)){q=this._strToDate(q)}if(r.getTime()>q.getTime()){return}this._rangeFrom=new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0).getTime();this._rangeTo=new Date(q.getFullYear(),q.getMonth(),q.getDate(),0,0,0,0).getTime();this._rangeActive=true;this._rangeType="in";o=true}if(!o&&r!=null&&q==null){if(!(r instanceof Date)){r=this._strToDate(r)}this._rangeFrom=new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0).getTime();this._rangeTo=null;if(a===true){this._rangeFrom++}this._rangeActive=true;this._rangeType="from";o=true}if(!o&&r==null&&q!=null){if(!(q instanceof Date)){q=this._strToDate(q)}this._rangeFrom=null;this._rangeTo=new Date(q.getFullYear(),q.getMonth(),q.getDate(),0,0,0,0).getTime();if(a===true){this._rangeTo--}this._rangeActive=true;this._rangeType="to";o=true}if(o){this._drawMonth(this._activeMonth)}};this.setInsensitiveRange=function(o,a){if(o!=null&&a!=null){if(!(o instanceof Date)){o=this._strToDate(o)}if(!(a instanceof Date)){a=this._strToDate(a)}if(o.getTime()>a.getTime()){return}this._rangeFrom=new Date(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0,0).getTime();this._rangeTo=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0).getTime();this._rangeActive=true;this._rangeType="out";this._drawMonth(this._activeMonth);return}if(o!=null&&a==null){this.setSensitiveRange(null,o,true);return}if(o==null&&a!=null){this.setSensitiveRange(a,null,true);return}};this.disableDays=function(v,u){if(v=="week"){if(typeof(u)!="object"&&typeof(u.length)=="undefined"){u=[u]}if(!this._rangeWeekData){this._rangeWeekData={}}for(var o in this._rangeWeekData){this._rangeWeekData[o]=false;delete this._rangeWeekData[o]}for(var s=0;s<u.length;s++){this._rangeWeekData[u[s]]=true;if(u[s]==7){this._rangeWeekData[0]=true}}this._rangeWeek=true}if(v=="month"){if(typeof(u)!="object"&&typeof(u.length)=="undefined"){u=[u]}if(!this._rangeMonthData){this._rangeMonthData={}}for(var o in this._rangeMonthData){this._rangeMonthData[o]=false;delete this._rangeMonthData[o]}for(var s=0;s<u.length;s++){this._rangeMonthData[u[s]]=true}this._rangeMonth=true}if(v=="year"){var r=this._extractDates(u);if(!this._rangeYearData){this._rangeYearData={}}for(var o in this._rangeYearData){this._rangeYearData[o]=false;delete this._rangeYearData[o]}for(var s=0;s<r.length;s++){this._rangeYearData[r[s].getMonth()+"_"+r[s].getDate()]=true}this._rangeYear=true}this._drawMonth(this._activeMonth)};this.enableDays=function(a){if(a=="week"){this._rangeWeek=false}if(a=="month"){this._rangeMonth=false}if(a=="year"){this._rangeYear=false}this._drawMonth(this._activeMonth)};this._tipData={};this._tipTM=null;this._tipTMTime=400;this._tipEvs=false;this._tipPopup=null;this._tipCellDate=null;this._tipCellDim=null;this.setTooltip=function(r,v,w,a){var s=this._extractDates(r);for(var u=0;u<s.length;u++){var o=new Date(s[u].getFullYear(),s[u].getMonth(),s[u].getDate(),0,0,0,0).getTime();this._tipData[o]={text:v,showIcon:w,usePopup:a}}this._drawMonth(this._activeMonth)};this.clearTooltip=function(o){var r=this._extractDates(o);for(var s=0;s<r.length;s++){var a=new Date(r[s].getFullYear(),r[s].getMonth(),r[s].getDate(),0,0,0,0).getTime();this._tipData[a]=null;delete this._tipData[a]}this._drawMonth(this._activeMonth)};this._initTooltipPopup=function(){if(this._tipEvs){return}this.attachEvent("onMouseOver",function(o){var a=new Date(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0,0).getTime();if(this._tipData[a]!=null){if(this._tipTM){window.clearTimeout(this._tipTM)}this._tipCellDate=o;this._tipCellDim=this.getCellDimension(o);this._tipText=this._tipData[a].text;this._tipTM=window.setTimeout(this._showTooltipPopup,this._tipTMTime)}});this.attachEvent("onMouseOut",this._hideTooltipPopup);this._tipEvs=true};this._showTooltipPopup=function(r,a,s,o,q){if(!f._tipPopup){f._tipPopup=new dhtmlXPopup({mode:"top"})}f._tipPopup.attachHTML(f._tipText);f._tipPopup.show(f._tipCellDim.x,f._tipCellDim.y,f._tipCellDim.w,f._tipCellDim.h);f.callEvent("onPopupShow",[f._tipCellDate])};this._hideTooltipPopup=function(){if(this._tipTM){window.clearTimeout(this._tipTM)}if(this._tipPopup!=null&&this._tipPopup.isVisible()){this._tipPopup.hide();this.callEvent("onPopupHide",[this._tipCellDate])}};this.getPopup=function(){return this._tipPopup};this.getCellDimension=function(r){if(typeof(r)=="string"){r=this._strToDate(r)}if(!(r instanceof Date)){return null}var s=new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0).getTime();var o=null;for(var u=0;u<this.contDates.childNodes.length;u++){for(var a=0;a<this.contDates.childNodes[u].childNodes.length;a++){var v=this.contDates.childNodes[u].childNodes[a];if(v._date!=null&&v._date.getTime()==s){o={x:this._getLeft(v),y:this._getTop(v),w:v.offsetWidth,h:v.offsetHeight}}v=null}}return o};this._updateFromInput=function(a){if(this._nullInInput&&((a.value).replace(/\s/g,"")).length==0){if(this.checkEvent("onBeforeChange")){if(!this.callEvent("onBeforeChange",[null])){if(this.i!=null&&this._activeInp!=null&&this.i[this._activeInp]!=null&&this.i[this._activeInp].input!=null){this.i[this._activeInp].input.value=this.getFormatedDate()}return}}this.setDate(null)}else{this._updateDateStr(a.value)}a=null};this._doOnClick=function(o){o=o||event;var a=(o.target||o.srcElement);if(a._dhtmlxcalendar_uid&&a._dhtmlxcalendar_uid!=f._activeInp&&f._isVisible()&&f._activeInp){f._hide();return}if(!a._dhtmlxcalendar_uid||!f.i[a._dhtmlxcalendar_uid]){if(f._isSelectorVisible()){f._hideSelector()}else{if(!f._hasParent&&f._isVisible()){f._hide()}}}};this._doOnKeyDown=function(a){a=a||event;if(a.keyCode==27||a.keyCode==13){if(f._isSelectorVisible()){f._hideSelector()}else{if(f._isVisible()&&!f._hasParent){f._hide()}}}};this._doOnInpClick=function(o){o=o||event;var a=(o.target||o.srcElement);if(!a._dhtmlxcalendar_uid){return}if(!f._listenerEnabled){f._updateFromInput(a)}f._show(a._dhtmlxcalendar_uid,true)};this._doOnInpKeyUp=function(o){o=o||event;var a=(o.target||o.srcElement);if(o.keyCode==13||!a._dhtmlxcalendar_uid){return}if(!f._listenerEnabled){f._updateFromInput(a)}};this._doOnBtnClick=function(o){o=o||event;var a=(o.target||o.srcElement);if(!a._dhtmlxcalendar_uid){return}if(f.i[a._dhtmlxcalendar_uid].input!=null){f._updateFromInput(f.i[a._dhtmlxcalendar_uid].input)}f._show(a._dhtmlxcalendar_uid,true)};this._doOnUnload=function(){if(f&&f.unload){f.unload()}};if(typeof(window.addEventListener)=="function"){document.body.addEventListener((this.conf.touch?"touchstart":"click"),f._doOnClick,false);window.addEventListener("keydown",f._doOnKeyDown,false);window.addEventListener("unload",f._doOnUnload,false)}else{document.body.attachEvent("onclick",f._doOnClick);document.body.attachEvent("onkeydown",f._doOnKeyDown);window.attachEvent("onunload",f._doOnUnload)}this.attachObj=function(q){var o=window.dhx4.newId();if(typeof(q)=="string"){this.i[o]={input:document.getElementById(q)}}else{if(typeof(q.tagName)!="undefined"){this.i[o]={input:q}}else{if(typeof(q)=="object"&&(q.input!=null||q.button!=null)){this.i[o]={};if(q.input!=null){this.i[o].input=(typeof(q.input)=="string"?document.getElementById(q.input):q.input)}if(q.button!=null){this.i[o].button=(typeof(q.button)=="string"?document.getElementById(q.button):q.button)}}}}this._attachEventsToObject(o);return o};this.detachObj=function(r){var q=null;if(this.i[r]!=null){q=r}else{if(typeof(r)=="string"){r=document.getElementById(r);q=r._dhtmlxcalendar_uid}else{if(typeof(r.tagName)!="undefined"){q=r._dhtmlxcalendar_uid}else{if(typeof(r)=="object"&&(r.input!=null||r.button!=null)){if(q==null&&r.input!=null){q=(typeof(r.input)=="string"?document.getElementById(r.input):r.input)._dhtmlxcalendar_uid}if(q==null&&r.button!=null){q=(typeof(r.button)=="string"?document.getElementById(r.button):r.button)._dhtmlxcalendar_uid}}}}}if(q!=null&&this.i[q]!=null){this._detachEventsFromObject(q);for(var o in this.i[o]){this.i[q][o]._dhtmlxcalendar_uid=null;this.i[q][o]=null;delete this.i[q][o]}this.i[q]=null;delete this.i[q];return true}return false};this._attachEventsToObject=function(o){if(this.i[o].button!=null){this.i[o].button._dhtmlxcalendar_uid=o;if(typeof(window.addEventListener)=="function"){this.i[o].button.addEventListener((this.conf.touch?"touchstart":"click"),f._doOnBtnClick,false)}else{this.i[o].button.attachEvent("onclick",f._doOnBtnClick)}}else{if(this.i[o].input!=null){this.i[o].input._dhtmlxcalendar_uid=o;if(typeof(window.addEventListener)=="function"){this.i[o].input.addEventListener((this.conf.touch?"touchstart":"click"),f._doOnInpClick,false);this.i[o].input.addEventListener("keyup",f._doOnInpKeyUp,false)}else{this.i[o].input.attachEvent("onclick",f._doOnInpClick);this.i[o].input.attachEvent("onkeyup",f._doOnInpKeyUp)}}}};this._detachEventsFromObject=function(o){if(this.i[o].button!=null){if(typeof(window.addEventListener)=="function"){this.i[o].button.removeEventListener((this.conf.touch?"touchstart":"click"),f._doOnBtnClick,false)}else{this.i[o].button.detachEvent("onclick",f._doOnBtnClick)}}else{if(this.i[o].input!=null){if(typeof(window.addEventListener)=="function"){this.i[o].input.removeEventListener((this.conf.touch?"touchstart":"click"),f._doOnInpClick,false);this.i[o].input.removeEventListener("keyup",f._doOnInpKeyUp,false)}else{this.i[o].input.detachEvent("onclick",f._doOnInpClick);this.i[o].input.detachEvent("onkeyup",f._doOnInpKeyUp)}}}};this.enableListener=function(a){if(!a){return}if(typeof(window.addEventListener)=="function"){a.addEventListener("focus",f._listenerEvFocus,false);a.addEventListener("blur",f._listenerEvBlur,false)}else{a.attachEvent("onfocus",f._listenerEvFocus);a.attachEvent("onblur",f._listenerEvBlur)}a=null};this.disableListener=function(a){if(!a){return}a._f0=false;if(this._tmListener){window.clearTimeout(this._tmListener)}if(typeof(window.addEventListener)=="function"){a.removeEventListener("focus",f._listenerEvFocus,false);a.removeEventListener("blur",f._listenerEvBlur,false)}else{a.detachEvent("onfocus",f._listenerEvFocus);a.detachEvent("onblur",f._listenerEvBlur)}a=null};this._startListener=function(a){if(this._tmListener){window.clearTimeout(this._tmListener)}if(typeof(a._v1)=="undefined"){a._v1=a.value}if(a._v1!=a.value){this._updateFromInput(a);a._v1=a.value}if(a._f0){this._tmListener=window.setTimeout(function(){f._startListener(a)},100)}};this._listenerEvFocus=function(o){o=o||event;var a=o.target||o.srcElement;a._f0=true;f._startListener(a);a=null};this._listenerEvBlur=function(o){o=o||event;var a=o.target||o.srcElement;a._f0=false;a=null};for(var k in this.i){this._attachEventsToObject(k)}window.dhx4._eventable(this);this._evOnArrowClick=function(a){return this.callEvent("onArrowClick",a)};this._evOnClick=function(a){return this.callEvent("onClick",a)};this._evOnMouseOut=function(a){return this.callEvent("onMouseOut",a)};this._evOnMouseOver=function(a){return this.callEvent("onMouseOver",a)};this.unload=function(){this._activeDate=null;this._activeDateCell=null;this._activeInp=null;this._activeMonth=null;this._dateFormat=null;this._dateFormatRE=null;this._lastHover=null;if(this._tmListener){window.clearTimeout(this._tmListener)}this._tmListener=null;if(typeof(window.addEventListener)=="function"){document.body.removeEventListener((this.conf.touch?"touchstart":"click"),f._doOnClick,false);window.removeEventListener("keydown",f._doOnKeyDown,false);window.removeEventListener("unload",f._doOnUnload,false)}else{document.body.detachEvent("onclick",f._doOnClick);document.body.detachEvent("onkeydown",f._doOnKeyDown);window.detachEvent("onunload",f._doOnKeyDown)}this._doOnClick=null;this._doOnKeyDown=null;this._doOnUnload=null;for(var o in this.i){this.i[o]._dhtmlxcalendar_uid=null;this._detachEventsFromObject(o);this.disableListener(this.i[o].input);this.i[o]=null;delete this.i[o]}this.i=null;this._doOnInpClick=null;this._doOnInpKeyUp=null;window.dhx4._eventable(this,"clear");this.contMonth.onselectstart=null;this.contMonth.firstChild.firstChild.onclick=null;this.contMonth.firstChild.firstChild.ontouchstart=null;this.contMonth.firstChild.firstChild.firstChild.onmouseover=null;this.contMonth.firstChild.firstChild.firstChild.onmouseout=null;this.contMonth.firstChild.firstChild.lastChild.onmouseover=null;this.contMonth.firstChild.firstChild.lastChild.onmouseout=null;while(this.contMonth.firstChild.firstChild.childNodes.length>0){this.contMonth.firstChild.firstChild.removeChild(this.contMonth.firstChild.firstChild.lastChild)}this.contMonth.firstChild.removeChild(this.contMonth.firstChild.firstChild);this.contMonth.removeChild(this.contMonth.firstChild);this.contMonth.parentNode.removeChild(this.contMonth);this.contMonth=null;while(this.contDays.firstChild.childNodes.length>0){this.contDays.firstChild.removeChild(this.contDays.firstChild.lastChild)}this.contDays.removeChild(this.contDays.firstChild);this.contDays.parentNode.removeChild(this.contDays);this.contDays=null;this.contDates.onclick=null;this.contDates.ontouchstart=null;this.contDates.onmouseover=null;this.contDates.onmouseout=null;while(this.contDates.childNodes.length>0){while(this.contDates.lastChild.childNodes.length>0){this.contDates.lastChild.lastChild._css_date=null;this.contDates.lastChild.lastChild._css_month=null;this.contDates.lastChild.lastChild._css_weekend=null;this.contDates.lastChild.lastChild._css_hover=null;this.contDates.lastChild.lastChild._date=null;this.contDates.lastChild.lastChild._q=null;this.contDates.lastChild.lastChild._w=null;this.contDates.lastChild.removeChild(this.contDates.lastChild.lastChild)}this.contDates.removeChild(this.contDates.lastChild)}this.contDates.parentNode.removeChild(this.contDates);this.contDates=null;this.contTime.firstChild.firstChild.onclick=null;this.contTime.firstChild.firstChild.ontouchstart=null;while(this.contTime.firstChild.firstChild.childNodes.length>0){this.contTime.firstChild.firstChild.removeChild(this.contTime.firstChild.firstChild.lastChild)}this.contTime.firstChild.removeChild(this.contTime.firstChild.firstChild);this.contTime.removeChild(this.contTime.firstChild);this.contTime.parentNode.removeChild(this.contTime);this.contTime=null;this._lastHover=null;this._unloadSelector("month");this._unloadSelector("year");this._unloadSelector("hours");this._unloadSelector("minutes");if(this._selCover){this._selCover.parentNode.removeChild(this._selCover);this._selCover=null}if(this._sel){for(var o in this._sel._ta){this._sel._ta[o]=null}this._sel._ta=null;this._sel._t=null;this._sel.onmouseover=null;this._sel.onmouseout=null;while(this._sel.firstChild.firstChild.firstChild.childNodes.length>0){this._sel.firstChild.firstChild.firstChild.lastChild.onclick=null;this._sel.firstChild.firstChild.firstChild.lastChild.onmouseover=null;this._sel.firstChild.firstChild.firstChild.lastChild.onmouseout=null;this._sel.firstChild.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild.lastChild)}this._sel.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild);this._sel.firstChild.removeChild(this._sel.firstChild.firstChild);while(this._sel.childNodes.length>0){this._sel.removeChild(this._sel.lastChild)}this._sel.parentNode.removeChild(this._sel);this._sel=null}this.base.onclick=null;this.base.onmousedown=null;this.base.ontouchstart=null;this.base.onmouseout=null;this.base.parentNode.removeChild(this.base);this.base=null;this._clearDayHover=null;this._clearSelHover=null;this._doOnSelectorChange=null;this._doOnSelectorShow=null;this._drawMonth=null;this._fixLength=null;this._getLeft=null;this._getTop=null;this._ifrSize=null;this._hide=null;this._hideSelector=null;this._initSelector=null;this._isSelectorVisible=null;this._isVisible=null;this._posGetOffset=null;this._posGetOffsetRect=null;this._posGetOffsetSum=null;this._scrollYears=null;this._show=null;this._showSelector=null;this._strToDate=null;this._updateActiveHours=null;this._updateActiveMinutes=null;this._updateActiveMonth=null;this._updateActiveYear=null;this._updateCellStyle=null;this._updateDateStr=null;this._updateVisibleHours=null;this._updateVisibleMinutes=null;this._updateYearsList=null;this.enableIframe=null;this.hide=null;this.hideTime=null;this.setDate=null;this.setDateFormat=null;this.setYearsRange=null;this.show=null;this.showTime=null;this.unload=null;if(this._tipPopup!=null){this._tipPopup.unload();this._tipPopup=null}for(var o in this){delete this[o]}o=f=null};this.setDate(this._activeDate);return this}dhtmlXCalendarObject.prototype.lang="en";dhtmlXCalendarObject.prototype.langData={en:{dateformat:"%Y-%m-%d",hdrformat:"%F %Y",monthesFNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthesSNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],daysFNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysSNames:["Su","Mo","Tu","We","Th","Fr","Sa"],weekstart:1,weekname:"w"}};dhtmlXCalendarObject.prototype._buildMonthHdr=function(f){var c=this;var e=function(g){return(String(g).length==1?"0"+String(g):g)};var a=function(g,h){return"<span class='dhtmlxcalendar_month_label_"+g+"'>"+h+"</span>"};var d=String(this.langData[this.lang].hdrformat||("%F %Y")).replace(/%[a-z]/gi,function(g){switch(g){case"%m":return a("month",e(f.getMonth()+1));case"%n":return a("month",f.getMonth()+1);case"%M":return a("month",c.langData[c.lang].monthesSNames[f.getMonth()]);case"%F":return a("month",c.langData[c.lang].monthesFNames[f.getMonth()]);case"%y":return a("year",e(f.getYear()%100));case"%Y":return a("year",f.getFullYear());case"%%":return"%";default:return g}});c=e=a=null;return d};dhtmlXCalendarObject.prototype.enableIframe=function(a){if(a==true){if(!this._ifr){this._ifr=document.createElement("IFRAME");this._ifr.frameBorder=0;this._ifr.border=0;this._ifr.setAttribute("src","javascript:false;");this._ifr.className="dhtmlxcalendar_ifr";this._ifr.onload=function(){this.onload=null;this.contentWindow.document.open("text/html","replace");this.contentWindow.document.write("<html><head><style>html,body{width:100%;height:100%;overflow:hidden;margin:0px;}</style></head><body</body></html>")};this.base.parentNode.insertBefore(this._ifr,this.base);this._ifrSize()}}else{if(this._ifr){this._ifr.parentNode.removeChild(this._ifr);this._ifr=null}}};dhtmlXCalendarObject.prototype._ifrSize=function(){if(this._ifr){this._ifr.style.left=this.base.style.left;this._ifr.style.top=this.base.style.top;this._ifr.style.width=this.base.offsetWidth+"px";this._ifr.style.height=this.base.offsetHeight+"px"}};dhtmlxCalendarObject=dhtmlXCalendarObject;dhtmlXCalendarObject.prototype._strToDate=function(h,y){y=(y||this._dateFormat);y=y.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\\:|]/g,"\\$&");var C=[];var o=[];y=y.replace(/%[a-z]/gi,function(e){switch(e){case"%d":case"%m":case"%y":case"%h":case"%H":case"%i":case"%s":o.push(e);return"(\\d{2})";case"%D":case"%l":case"%M":case"%F":o.push(e);return"([a-z\u0430-\u044F\u0451]{1,})";case"%j":case"%n":case"%g":case"%G":o.push(e);return"(\\d{1,2})";case"%Y":o.push(e);return"(\\d{4})";case"%a":o.push(e);return"(\\[am|pm])";case"%A":o.push(e);return"(\\[AM|PM])"}return e});var D=new RegExp(y);var s=h.match(D);if(s==null||s.length-1!=o.length){return"Invalid Date"}for(var c=1;c<s.length;c++){C.push(s[c])}var d={"%y":1,"%Y":1,"%n":2,"%m":2,"%M":2,"%F":2,"%d":3,"%j":3,"%a":4,"%A":4,"%H":5,"%G":5,"%h":5,"%g":5,"%i":6,"%s":7};var u={};var m={};for(var c=0;c<o.length;c++){if(typeof(d[o[c]])!="undefined"){var g=d[o[c]];if(!u[g]){u[g]=[];m[g]=[]}u[g].push(C[c]);m[g].push(o[c])}}C=[];o=[];for(var c=1;c<=7;c++){if(u[c]!=null){for(var x=0;x<u[c].length;x++){C.push(u[c][x]);o.push(m[c][x])}}}var n=this;var a=new Date();a.setDate(1);a.setMinutes(0);a.setSeconds(0);for(var c=0;c<C.length;c++){switch(o[c]){case"%d":case"%j":case"%n":case"%m":case"%Y":case"%H":case"%G":case"%i":case"%s":if(!isNaN(C[c])){a[{"%d":"setDate","%j":"setDate","%n":"setMonth","%m":"setMonth","%Y":"setFullYear","%H":"setHours","%G":"setHours","%i":"setMinutes","%s":"setSeconds"}[o[c]]](Number(C[c])+(o[c]=="%m"||o[c]=="%n"?-1:0))}break;case"%M":case"%F":var l=this._getInd(C[c].toLowerCase(),n.langData[n.lang][{"%M":"monthesSNames","%F":"monthesFNames"}[o[c]]]);if(l>=0){a.setMonth(l)}break;case"%y":if(!isNaN(C[c])){var A=Number(C[c]);a.setFullYear(A+(A>50?1900:2000))}break;case"%g":case"%h":if(!isNaN(C[c])){var A=Number(C[c]);if(A<=12&&A>=0){a.setHours(A+(this._getInd("pm",C)>=0?(A==12?0:12):(A==12?-12:0)))}}break}}n=null;return a};dhtmlXCalendarObject.prototype._dateToStr=function(g,e){var d=this;if(g instanceof Date){var f=function(h){return(String(h).length==1?"0"+String(h):h)};var a=function(h){switch(h){case"%d":return f(g.getDate());case"%j":return g.getDate();case"%D":return d.langData[d.lang].daysSNames[g.getDay()];case"%l":return d.langData[d.lang].daysFNames[g.getDay()];case"%m":return f(g.getMonth()+1);case"%n":return g.getMonth()+1;case"%M":return d.langData[d.lang].monthesSNames[g.getMonth()];case"%F":return d.langData[d.lang].monthesFNames[g.getMonth()];case"%y":return f(g.getYear()%100);case"%Y":return g.getFullYear();case"%g":return(g.getHours()+11)%12+1;case"%h":return f((g.getHours()+11)%12+1);case"%G":return g.getHours();case"%H":return f(g.getHours());case"%i":return f(g.getMinutes());case"%s":return f(g.getSeconds());case"%a":return(g.getHours()>11?"pm":"am");case"%A":return(g.getHours()>11?"PM":"AM");case"%%":"%";default:return h}};var c=String(e||this._dateFormat).replace(/%[a-zA-Z]/g,a)}d=null;return(c||String(g))};function xmlPointer(a){this.d=a}xmlPointer.prototype={text:function(){if(!_isFF){return this.d.xml}var a=new XMLSerializer();return a.serializeToString(this.d)},get:function(a){return this.d.getAttribute(a)},exists:function(){return !!this.d},content:function(){return this.d.firstChild?(this.d.firstChild.wholeText||this.d.firstChild.data):""},each:function(e,k,h,g){var d=this.d.childNodes;var l=new xmlPointer();if(d.length){for(g=g||0;g<d.length;g++){if(d[g].tagName==e){l.d=d[g];if(k.apply(h,[l,g])==-1){return}}}}},get_all:function(){var d={};var c=this.d.attributes;for(var e=0;e<c.length;e++){d[c[e].name]=c[e].value}return d},sub:function(e){var d=this.d.childNodes;var g=new xmlPointer();if(d.length){for(var f=0;f<d.length;f++){if(d[f].tagName==e){g.d=d[f];return g}}}},up:function(a){return new xmlPointer(this.d.parentNode)},set:function(a,c){this.d.setAttribute(a,c)},clone:function(a){return new xmlPointer(this.d)},sub_exists:function(d){var c=this.d.childNodes;if(c.length){for(var e=0;e<c.length;e++){if(c[e].tagName==d){return true}}}return false},through:function(d,k,n,g,o){var l=this.d.childNodes;if(l.length){for(var e=0;e<l.length;e++){if(l[e].tagName==d&&l[e].getAttribute(k)!=null&&l[e].getAttribute(k)!=""&&(!n||l[e].getAttribute(k)==n)){var h=new xmlPointer(l[e]);g.apply(o,[h,e])}var m=this.d;this.d=l[e];this.through(d,k,n,g,o);this.d=m}}}};function dhtmlXTreeObject(h,f,c,a){if(_isIE){try{document.execCommand("BackgroundImageCache",false,true)}catch(g){}}if(typeof(h)!="object"){this.parentObject=document.getElementById(h)}else{this.parentObject=h}this.parentObject.style.overflow="hidden";this._itim_dg=true;this.dlmtr=",";this.dropLower=false;this.enableIEImageFix();this.xmlstate=0;this.mytype="tree";this.smcheck=true;this.width=f;this.height=c;this.rootId=a;this.childCalc=null;this.def_img_x="18px";this.def_img_y="18px";this.def_line_img_x="18px";this.def_line_img_y="24px";this._dragged=new Array();this._selected=new Array();this.style_pointer="pointer";this._aimgs=true;this.htmlcA=" [";this.htmlcB="]";this.lWin=window;this.cMenu=0;this.mlitems=0;this.iconURL="";this.dadmode=0;this.slowParse=false;this.autoScroll=true;this.hfMode=0;this.nodeCut=new Array();this.XMLsource=0;this.XMLloadingWarning=0;this._idpull={};this._pullSize=0;this.treeLinesOn=true;this.tscheck=false;this.timgen=true;this.dpcpy=false;this._ld_id=null;this._oie_onXLE=[];this.imPath=window.dhx_globalImgPath||"";this.checkArray=new Array("iconUncheckAll.gif","iconCheckAll.gif","iconCheckGray.gif","iconUncheckDis.gif","iconCheckDis.gif","iconCheckDis.gif");this.radioArray=new Array("radio_off.gif","radio_on.gif","radio_on.gif","radio_off.gif","radio_on.gif","radio_on.gif");this.lineArray=new Array("line2.gif","line3.gif","line4.gif","blank.gif","blank.gif","line1.gif");this.minusArray=new Array("minus2.gif","minus3.gif","minus4.gif","minus.gif","minus5.gif");this.plusArray=new Array("plus2.gif","plus3.gif","plus4.gif","plus.gif","plus5.gif");this.imageArray=new Array("leaf.gif","folderOpen.gif","folderClosed.gif");this.cutImg=new Array(0,0,0);this.cutImage="but_cut.gif";dhtmlxEventable(this);this.dragger=new dhtmlDragAndDropObject();this.htmlNode=new dhtmlXTreeItemObject(this.rootId,"",0,this);this.htmlNode.htmlNode.childNodes[0].childNodes[0].style.display="none";this.htmlNode.htmlNode.childNodes[0].childNodes[0].childNodes[0].className="hiddenRow";this.allTree=this._createSelf();this.allTree.appendChild(this.htmlNode.htmlNode);if(dhtmlx.$customScroll){dhtmlx.CustomScroll.enable(this)}if(_isFF){this.allTree.childNodes[0].width="100%";this.allTree.childNodes[0].style.overflow="hidden"}var d=this;this.allTree.onselectstart=new Function("return false;");if(_isMacOS){this.allTree.oncontextmenu=function(k){return d._doContClick(k||window.event,true)}}this.allTree.onmousedown=function(k){return d._doContClick(k||window.event)};this.XMLLoader=new dtmlXMLLoaderObject(this._parseXMLTree,this,true,this.no_cashe);if(_isIE){this.preventIECashing(true)}this.selectionBar=document.createElement("DIV");this.selectionBar.className="selectionBar";this.selectionBar.innerHTML="&nbsp;";this.selectionBar.style.display="none";this.allTree.appendChild(this.selectionBar);if(window.addEventListener){window.addEventListener("unload",function(){try{d.destructor()}catch(k){}},false)}if(window.attachEvent){window.attachEvent("onunload",function(){try{d.destructor()}catch(k){}})}this.setImagesPath=this.setImagePath;this.setIconsPath=this.setIconPath;if(dhtmlx.image_path){this.setImagePath(dhtmlx.image_path)}if(dhtmlx.skin){this.setSkin(dhtmlx.skin)}return this}dhtmlXTreeObject.prototype.setDataMode=function(a){this._datamode=a};dhtmlXTreeObject.prototype._doContClick=function(h,a){if(!a&&h.button!=2){if(this._acMenu){if(this._acMenu.hideContextMenu){this._acMenu.hideContextMenu()}else{this.cMenu._contextEnd()}}return true}var c=(_isIE?h.srcElement:h.target);while((c)&&(c.tagName!="BODY")){if(c.parentObject){break}c=c.parentNode}if((!c)||(!c.parentObject)){return true}var f=c.parentObject;if(!this.callEvent("onRightClick",[f.id,h])){(h.srcElement||h.target).oncontextmenu=function(m){(m||event).cancelBubble=true;return false}}this._acMenu=(f.cMenu||this.cMenu);if(this._acMenu){if(!(this.callEvent("onBeforeContextMenu",[f.id]))){return true}if(!_isMacOS){(h.srcElement||h.target).oncontextmenu=function(m){(m||event).cancelBubble=true;return false}}if(this._acMenu.showContextMenu){var e=window.document.documentElement;var d=window.document.body;var k=new Array((e.scrollLeft||d.scrollLeft),(e.scrollTop||d.scrollTop));if(_isIE){var l=h.clientX+k[0];var g=h.clientY+k[1]}else{var l=h.pageX;var g=h.pageY}this._acMenu.showContextMenu(l-1,g-1);this.contextID=f.id;h.cancelBubble=true;this._acMenu._skip_hide=true}else{c.contextMenuId=f.id;c.contextMenu=this._acMenu;c.a=this._acMenu._contextStart;c.a(c,h);c.a=null}return false}return true};dhtmlXTreeObject.prototype.enableIEImageFix=function(a){if(!a){this._getImg=function(c){return document.createElement((c==this.rootId)?"div":"img")};this._setSrc=function(d,c){d.src=c};this._getSrc=function(c){return c.src}}else{this._getImg=function(){var c=document.createElement("DIV");c.innerHTML="&nbsp;";c.className="dhx_bg_img_fix";return c};this._setSrc=function(d,c){d.style.backgroundImage="url("+c+")"};this._getSrc=function(c){var d=c.style.backgroundImage;return d.substr(4,d.length-5).replace(/(^")|("$)/g,"")}}};dhtmlXTreeObject.prototype.destructor=function(){for(var c in this._idpull){var d=this._idpull[c];if(!d){continue}d.parentObject=null;d.treeNod=null;d.childNodes=null;d.span=null;d.tr.nodem=null;d.tr=null;d.htmlNode.objBelong=null;d.htmlNode=null;this._idpull[c]=null}this.parentObject.innerHTML="";if(this.XMLLoader){this.XMLLoader.destructor()}this.allTree.onselectstart=null;this.allTree.oncontextmenu=null;this.allTree.onmousedown=null;for(var c in this){this[c]=null}};function cObject(){return this}cObject.prototype=new Object;cObject.prototype.clone=function(){function a(){}a.prototype=this;return new a()};function dhtmlXTreeItemObject(g,c,d,a,e,f){this.htmlNode="";this.acolor="";this.scolor="";this.tr=0;this.childsCount=0;this.tempDOMM=0;this.tempDOMU=0;this.dragSpan=0;this.dragMove=0;this.span=0;this.closeble=1;this.childNodes=new Array();this.userData=new cObject();this.checkstate=0;this.treeNod=a;this.label=c;this.parentObject=d;this.actionHandler=e;this.images=new Array(a.imageArray[0],a.imageArray[1],a.imageArray[2]);this.id=a._globalIdStorageAdd(g,this);if(this.treeNod.checkBoxOff){this.htmlNode=this.treeNod._createItem(1,this,f)}else{this.htmlNode=this.treeNod._createItem(0,this,f)}this.htmlNode.objBelong=this;return this}dhtmlXTreeObject.prototype._globalIdStorageAdd=function(c,a){if(this._globalIdStorageFind(c,1,1)){c=c+"_"+(new Date()).valueOf();return this._globalIdStorageAdd(c,a)}this._idpull[c]=a;this._pullSize++;return c};dhtmlXTreeObject.prototype._globalIdStorageSub=function(a){if(this._idpull[a]){this._unselectItem(this._idpull[a]);this._idpull[a]=null;this._pullSize--}if((this._locker)&&(this._locker[a])){this._locker[a]=false}};dhtmlXTreeObject.prototype._globalIdStorageFind=function(g,a,d,e){var f=this._idpull[g];if(f){if((f.unParsed)&&(!d)){this.reParse(f,0)}if(this._srnd&&!f.htmlNode){this._buildSRND(f,d)}if((e)&&(this._edsbpsA)){for(var c=0;c<this._edsbpsA.length;c++){if(this._edsbpsA[c][2]==g){dhtmlxError.throwError("getItem","Requested item still in parsing process.",g);return null}}}return f}if((this.slowParse)&&(g!=0)&&(!a)){return this.preParse(g)}else{return null}};dhtmlXTreeObject.prototype._getSubItemsXML=function(a){var c=[];a.each("item",function(d){c.push(d.get("id"))},this);return c.join(this.dlmtr)};dhtmlXTreeObject.prototype.enableSmartXMLParsing=function(a){this.slowParse=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.findXML=function(c,a,d){};dhtmlXTreeObject.prototype._getAllCheckedXML=function(c,a,e){var d=[];if(e==2){c.through("item","checked",-1,function(f){d.push(f.get("id"))},this)}if(e==1){c.through("item","id",null,function(f){if(f.get("checked")&&(f.get("checked")!=-1)){d.push(f.get("id"))}},this)}if(e==0){c.through("item","id",null,function(f){if(!f.get("checked")||f.get("checked")==0){d.push(f.get("id"))}},this)}if(d.length){return a+(a?this.dlmtr:"")+d.join(this.dlmtr)}if(a){return a}else{return""}};dhtmlXTreeObject.prototype._setSubCheckedXML=function(a,c){var d=a?"1":"";c.through("item","id",null,function(e){if(!e.get("disabled")||e.get("disabled")==0){e.set("checked",d)}},this)};dhtmlXTreeObject.prototype._getAllScraggyItemsXML=function(d,a){var e=[];var c=function(f){if(!f.sub_exists("item")){e.push(f.get("id"))}else{f.each("item",c,this)}};c(d);return e.join(",")};dhtmlXTreeObject.prototype._getAllFatItemsXML=function(d,a){var e=[];var c=function(f){if(!f.sub_exists("item")){return}e.push(f.get("id"));f.each("item",c,this)};c(d);return e.join(",")};dhtmlXTreeObject.prototype._getAllSubItemsXML=function(d,c,a){var c=[];a.through("item","id",null,function(e){c.push(e.get("id"))},this);return c.join(",")};dhtmlXTreeObject.prototype.reParse=function(d){var g=this;if(!this.parsCount){g.callEvent("onXLS",[g,d.id])}this.xmlstate=1;var e=d.unParsed;d.unParsed=0;this.XMLloadingWarning=1;var a=this.parsingOn;var h=this.waitUpdateXML;var k=this.parsedArray;this.parsedArray=new Array();this.waitUpdateXML=false;this.parsingOn=d.id;this.parsedArray=new Array();this.setCheckList="";this._parse(e,d.id,2);var l=this.setCheckList.split(this.dlmtr);for(var f=0;f<this.parsedArray.length;f++){d.htmlNode.childNodes[0].appendChild(this.parsedArray[f])}if(e.get("order")&&e.get("order")!="none"){this._reorderBranch(d,e.get("order"),true)}this.oldsmcheck=this.smcheck;this.smcheck=false;for(var c=0;c<l.length;c++){if(l[c]){this.setCheck(l[c],1)}}this.smcheck=this.oldsmcheck;this.parsingOn=a;this.waitUpdateXML=h;this.parsedArray=k;this.XMLloadingWarning=0;this._redrawFrom(this,d);if(this._srnd&&!d._sready){this.prepareSR(d.id)}this.xmlstate=0;return true};dhtmlXTreeObject.prototype.preParse=function(c){if(!c||!this._p){return null}var a=false;this._p.clone().through("item","id",c,function(e){this._globalIdStorageFind(e.up().get("id"));return a=true},this);if(a){var d=this._globalIdStorageFind(c,true,false);if(!d){dhtmlxError.throwError("getItem","The item "+c+" not operable. Seems you have non-unique|incorrect IDs in tree's XML.",c)}}return d};dhtmlXTreeObject.prototype._escape=function(a){switch(this.utfesc){case"none":return a;break;case"utf8":return encodeURIComponent(a);break;default:return escape(a);break}};dhtmlXTreeObject.prototype._drawNewTr=function(f,d){var e=document.createElement("tr");var c=document.createElement("td");var a=document.createElement("td");c.appendChild(document.createTextNode(" "));a.colSpan=3;a.appendChild(f);e.appendChild(c);e.appendChild(a);return e};dhtmlXTreeObject.prototype.loadXMLString=function(d,c){var a=this;if(!this.parsCount){this.callEvent("onXLS",[a,null])}this.xmlstate=1;if(c){this.XMLLoader.waitCall=c}this.XMLLoader.loadXMLString(d)};dhtmlXTreeObject.prototype.loadXML=function(a,d){if(this._datamode&&this._datamode!="xml"){return this["load"+this._datamode.toUpperCase()](a,d)}var c=this;if(!this.parsCount){this.callEvent("onXLS",[c,this._ld_id])}this._ld_id=null;this.xmlstate=1;this.XMLLoader=new dtmlXMLLoaderObject(this._parseXMLTree,this,true,this.no_cashe);if(d){this.XMLLoader.waitCall=d}this.XMLLoader.loadXML(a)};dhtmlXTreeObject.prototype._attachChildNode=function(h,g,e,k,y,x,w,l,d,q,r){if(q&&q.parentObject){h=q.parentObject}if(((h.XMLload==0)&&(this.XMLsource))&&(!this.XMLloadingWarning)){h.XMLload=1;this._loadDynXML(h.id)}var m=h.childsCount;var A=h.childNodes;if(r&&r.tr.previousSibling){if(r.tr.previousSibling.previousSibling){q=r.tr.previousSibling.nodem}else{l=l.replace("TOP","")+",TOP"}}if(q){var f,v;for(f=0;f<m;f++){if(A[f]==q){for(v=m;v!=f;v--){A[1+v]=A[v]}break}}f++;m=f}if(l){var s=l.split(",");for(var u=0;u<s.length;u++){switch(s[u]){case"TOP":if(h.childsCount>0){q=new Object;q.tr=h.childNodes[0].tr.previousSibling}h._has_top=true;for(f=m;f>0;f--){A[f]=A[f-1]}m=0;break}}}var o;if(!(o=this._idpull[g])||o.span!=-1){o=A[m]=new dhtmlXTreeItemObject(g,e,h,this,k,1);g=A[m].id;h.childsCount++}if(!o.htmlNode){o.label=e;o.htmlNode=this._createItem((this.checkBoxOff?1:0),o);o.htmlNode.objBelong=o}if(y){o.images[0]=y}if(x){o.images[1]=x}if(w){o.images[2]=w}var c=this._drawNewTr(o.htmlNode);if((this.XMLloadingWarning)||(this._hAdI)){o.htmlNode.parentNode.parentNode.style.display="none"}if((q)&&q.tr&&(q.tr.nextSibling)){h.htmlNode.childNodes[0].insertBefore(c,q.tr.nextSibling)}else{if(this.parsingOn==h.id){this.parsedArray[this.parsedArray.length]=c}else{h.htmlNode.childNodes[0].appendChild(c)}}if((q)&&(!q.span)){q=null}if(this.XMLsource){if((d)&&(d!=0)){o.XMLload=0}else{o.XMLload=1}}o.tr=c;c.nodem=o;if(h.itemId==0){c.childNodes[0].className="hiddenRow"}if((h._r_logic)||(this._frbtr)){this._setSrc(o.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0],this.imPath+this.radioArray[0])}if(l){var s=l.split(",");for(var u=0;u<s.length;u++){switch(s[u]){case"SELECT":this.selectItem(g,false);break;case"CALL":this.selectItem(g,true);break;case"CHILD":o.XMLload=0;break;case"CHECKED":if(this.XMLloadingWarning){this.setCheckList+=this.dlmtr+g}else{this.setCheck(g,1)}break;case"HCHECKED":this._setCheck(o,"unsure");break;case"OPEN":o.openMe=1;break}}}if(!this.XMLloadingWarning){if((this._getOpenState(h)<0)&&(!this._hAdI)){this.openItem(h.id)}if(q){this._correctPlus(q);this._correctLine(q)}this._correctPlus(h);this._correctLine(h);this._correctPlus(o);if(h.childsCount>=2){this._correctPlus(A[h.childsCount-2]);this._correctLine(A[h.childsCount-2])}if(h.childsCount!=2){this._correctPlus(A[0])}if(this.tscheck){this._correctCheckStates(h)}if(this._onradh){if(this.xmlstate==1){var a=this.onXLE;this.onXLE=function(n){this._onradh(g);if(a){a(n)}}}else{this._onradh(g)}}}return o};dhtmlXTreeObject.prototype.enableContextMenu=function(a){if(a){this.cMenu=a}};dhtmlXTreeObject.prototype.setItemContextMenu=function(f,e){var a=f.toString().split(this.dlmtr);for(var d=0;d<a.length;d++){var c=this._globalIdStorageFind(a[d]);if(!c){continue}c.cMenu=e}};dhtmlXTreeObject.prototype.insertNewItem=function(e,k,m,d,h,g,f,c,a){var n=this._globalIdStorageFind(e);if(!n){return(-1)}var l=this._attachChildNode(n,k,m,d,h,g,f,c,a);if(!this._idpull[this.rootId].XMLload){this._idpull[this.rootId].XMLload=1}if((!this.XMLloadingWarning)&&(this.childCalc)){this._fixChildCountLabel(n)}return l};dhtmlXTreeObject.prototype.insertNewChild=function(e,k,l,d,h,g,f,c,a){return this.insertNewItem(e,k,l,d,h,g,f,c,a)};dhtmlXTreeObject.prototype._parseXMLTree=function(f,e,l,k,g){var h=new xmlPointer(g.getXMLTopNode("tree"));f._parse(h);f._p=h};dhtmlXTreeObject.prototype._parseItem=function(g,m,f,k){var d;if(this._srnd&&(!this._idpull[d=g.get("id")]||!this._idpull[d].span)){this._addItemSRND(m.id,d,g);return}var h=g.get_all();if((typeof(this.waitUpdateXML)=="object")&&(!this.waitUpdateXML[h.id])){this._parse(g,h.id,1);return}if((h.text===null)||(typeof(h.text)=="undefined")){h.text=g.sub("itemtext");if(h.text){h.text=h.text.content()}}var o=[];if(h.select){o.push("SELECT")}if(h.top){o.push("TOP")}if(h.call){this.nodeAskingCall=h.id}if(h.checked==-1){o.push("HCHECKED")}else{if(h.checked){o.push("CHECKED")}}if(h.open){o.push("OPEN")}if(this.waitUpdateXML){if(this._globalIdStorageFind(h.id)){var l=this.updateItem(h.id,h.text,h.im0,h.im1,h.im2,h.checked,h.child)}else{if(this.npl==0){o.push("TOP")}else{f=m.childNodes[this.npl]}var l=this._attachChildNode(m,h.id,h.text,0,h.im0,h.im1,h.im2,o.join(","),h.child,0,f);h.id=l.id;f=null}}else{var l=this._attachChildNode(m,h.id,h.text,0,h.im0,h.im1,h.im2,o.join(","),h.child,(k||0),f)}if(h.tooltip){l.span.parentNode.parentNode.title=h.tooltip}if(h.style){if(l.span.style.cssText){l.span.style.cssText+=(";"+h.style)}else{l.span.setAttribute("style",l.span.getAttribute("style")+"; "+h.style)}}if(h.radio){l._r_logic=true}if(h.nocheckbox){var n=l.span.parentNode.previousSibling.previousSibling;n.style.display="none";l.nocheckbox=true}if(h.disabled){if(h.checked!=null){this._setCheck(l,h.checked)}this.disableCheckbox(l,1)}l._acc=h.child||0;if(this.parserExtension){this.parserExtension._parseExtension.call(this,g,h,(m?m.id:0))}this.setItemColor(l,h.aCol,h.sCol);if(h.locked=="1"){this.lockItem(l.id,true,true)}if((h.imwidth)||(h.imheight)){this.setIconSize(h.imwidth,h.imheight,l)}if((h.closeable=="0")||(h.closeable=="1")){this.setItemCloseable(l,h.closeable)}var e="";if(h.topoffset){this.setItemTopOffset(l,h.topoffset)}if((!this.slowParse)||(typeof(this.waitUpdateXML)=="object")){if(g.sub_exists("item")){e=this._parse(g,h.id,1)}}else{if((!l.childsCount)&&g.sub_exists("item")){l.unParsed=g.clone()}g.each("userdata",function(a){this.setUserData(h.id,a.get("name"),a.content())},this)}if(e!=""){this.nodeAskingCall=e}g.each("userdata",function(a){this.setUserData(g.get("id"),a.get("name"),a.content())},this)};dhtmlXTreeObject.prototype._parse=function(d,g,a,c){if(this._srnd&&!this.parentObject.offsetHeight){var r=this;return window.setTimeout(function(){r._parse(d,g,a,c)},100)}if(!d.exists()){return}this.skipLock=true;if(!g){g=d.get("id");var o=d.get("dhx_security");if(o){dhtmlx.security_key=o}if(d.get("radio")){this.htmlNode._r_logic=true}this.parsingOn=g;this.parsedArray=new Array();this.setCheckList="";this.nodeAskingCall=""}var q=this._globalIdStorageFind(g);if(!q){return dhtmlxError.throwError("DataStructure","XML refers to not existing parent")}this.parsCount=this.parsCount?(this.parsCount+1):1;this.XMLloadingWarning=1;if((q.childsCount)&&(!c)&&(!this._edsbps)&&(!q._has_top)){var h=0}else{var h=0}this.npl=0;d.each("item",function(s,n){q.XMLload=1;this._parseItem(s,q,0,h);if((this._edsbps)&&(this.npl==this._edsbpsC)){this._distributedStart(d,n+1,g,a,q.childsCount);return -1}this.npl++},this,c);if(!a){d.each("userdata",function(n){this.setUserData(d.get("id"),n.get("name"),n.content())},this);q.XMLload=1;if(this.waitUpdateXML){this.waitUpdateXML=false;for(var f=q.childsCount-1;f>=0;f--){if(q.childNodes[f]._dmark){this.deleteItem(q.childNodes[f].id)}}}var l=this._globalIdStorageFind(this.parsingOn);for(var f=0;f<this.parsedArray.length;f++){q.htmlNode.childNodes[0].appendChild(this.parsedArray[f])}this.parsedArray=[];this.lastLoadedXMLId=g;this.XMLloadingWarning=0;var m=this.setCheckList.split(this.dlmtr);for(var e=0;e<m.length;e++){if(m[e]){this.setCheck(m[e],1)}}if((this.XMLsource)&&(this.tscheck)&&(this.smcheck)&&(q.id!=this.rootId)){if(q.checkstate===0){this._setSubChecked(0,q)}else{if(q.checkstate===1){this._setSubChecked(1,q)}}}this._redrawFrom(this,null,c);if(d.get("order")&&d.get("order")!="none"){this._reorderBranch(q,d.get("order"),true)}if(this.nodeAskingCall!=""){this.callEvent("onClick",[this.nodeAskingCall,this.getSelectedItemId()])}if(this._branchUpdate){this._branchUpdateNext(d)}}if(this.parsCount==1){this.parsingOn=null;if(this._srnd&&q.id!=this.rootId){this.prepareSR(q.id);if(this.XMLsource){this.openItem(q.id)}}d.through("item","open",null,function(n){this.openItem(n.get("id"))},this);if((!this._edsbps)||(!this._edsbpsA.length)){var k=this;window.setTimeout(function(){k.callEvent("onXLE",[k,g])},1);this.xmlstate=0}this.skipLock=false}this.parsCount--;var k=this;if(this._edsbps){window.setTimeout(function(){k._distributedStep(g)},this._edsbpsD)}if(!a&&this.onXLE){this.onXLE(this,g)}return this.nodeAskingCall};dhtmlXTreeObject.prototype._branchUpdateNext=function(a){a.each("item",function(e){var d=e.get("id");if(this._idpull[d]&&(!this._idpull[d].XMLload)){return}this._branchUpdate++;this.smartRefreshItem(e.get("id"),e)},this);this._branchUpdate--};dhtmlXTreeObject.prototype.checkUserData=function(c,d){if((c.nodeType==1)&&(c.tagName=="userdata")){var a=c.getAttribute("name");if((a)&&(c.childNodes[0])){this.setUserData(d,a,c.childNodes[0].data)}}};dhtmlXTreeObject.prototype._redrawFrom=function(k,c,h,d){if(!c){var f=k._globalIdStorageFind(k.lastLoadedXMLId);k.lastLoadedXMLId=-1;if(!f){return 0}}else{f=c}var g=0;for(var e=(h?h-1:0);e<f.childsCount;e++){if((!this._branchUpdate)||(this._getOpenState(f)==1)){if((!c)||(d==1)){f.childNodes[e].htmlNode.parentNode.parentNode.style.display=""}}if(f.childNodes[e].openMe==1){this._openItem(f.childNodes[e]);f.childNodes[e].openMe=0}k._redrawFrom(k,f.childNodes[e]);if(this.childCalc!=null){if((f.childNodes[e].unParsed)||((!f.childNodes[e].XMLload)&&(this.XMLsource))){if(f.childNodes[e]._acc){f.childNodes[e].span.innerHTML=f.childNodes[e].label+this.htmlcA+f.childNodes[e]._acc+this.htmlcB}else{f.childNodes[e].span.innerHTML=f.childNodes[e].label}}if((f.childNodes[e].childNodes.length)&&(this.childCalc)){if(this.childCalc==1){f.childNodes[e].span.innerHTML=f.childNodes[e].label+this.htmlcA+f.childNodes[e].childsCount+this.htmlcB}if(this.childCalc==2){var a=f.childNodes[e].childsCount-(f.childNodes[e].pureChilds||0);if(a){f.childNodes[e].span.innerHTML=f.childNodes[e].label+this.htmlcA+a+this.htmlcB}if(f.pureChilds){f.pureChilds++}else{f.pureChilds=1}}if(this.childCalc==3){f.childNodes[e].span.innerHTML=f.childNodes[e].label+this.htmlcA+f.childNodes[e]._acc+this.htmlcB}if(this.childCalc==4){var a=f.childNodes[e]._acc;if(a){f.childNodes[e].span.innerHTML=f.childNodes[e].label+this.htmlcA+a+this.htmlcB}}}else{if(this.childCalc==4){g++}}g+=f.childNodes[e]._acc;if(this.childCalc==3){g++}}}if((!f.unParsed)&&((f.XMLload)||(!this.XMLsource))){f._acc=g}k._correctLine(f);k._correctPlus(f);if((this.childCalc)&&(!c)){k._fixChildCountLabel(f)}};dhtmlXTreeObject.prototype._createSelf=function(){var a=document.createElement("div");a.className="containerTableStyle";a.style.width=this.width;a.style.height=this.height;this.parentObject.appendChild(a);return a};dhtmlXTreeObject.prototype._xcloseAll=function(c){if(c.unParsed){return}if(this.rootId!=c.id){if(!c.htmlNode){return}var e=c.htmlNode.childNodes[0].childNodes;var a=e.length;for(var d=1;d<a;d++){e[d].style.display="none"}this._correctPlus(c)}for(var d=0;d<c.childsCount;d++){if(c.childNodes[d].childsCount){this._xcloseAll(c.childNodes[d])}}};dhtmlXTreeObject.prototype._xopenAll=function(a){this._HideShow(a,2);for(var c=0;c<a.childsCount;c++){this._xopenAll(a.childNodes[c])}};dhtmlXTreeObject.prototype._correctPlus=function(c){if(!c.htmlNode){return}var d=c.htmlNode.childNodes[0].childNodes[0].childNodes[0].lastChild;var f=c.htmlNode.childNodes[0].childNodes[0].childNodes[2].childNodes[0];var a=this.lineArray;if((this.XMLsource)&&(!c.XMLload)){var a=this.plusArray;this._setSrc(f,this.iconURL+c.images[2]);if(this._txtimg){return(d.innerHTML="[+]")}}else{if((c.childsCount)||(c.unParsed)){if((c.htmlNode.childNodes[0].childNodes[1])&&(c.htmlNode.childNodes[0].childNodes[1].style.display!="none")){if(!c.wsign){var a=this.minusArray}this._setSrc(f,this.iconURL+c.images[1]);if(this._txtimg){return(d.innerHTML="[-]")}}else{if(!c.wsign){var a=this.plusArray}this._setSrc(f,this.iconURL+c.images[2]);if(this._txtimg){return(d.innerHTML="[+]")}}}else{this._setSrc(f,this.iconURL+c.images[0])}}var e=2;if(!c.treeNod.treeLinesOn){this._setSrc(d,this.imPath+a[3])}else{if(c.parentObject){e=this._getCountStatus(c.id,c.parentObject)}this._setSrc(d,this.imPath+a[e])}};dhtmlXTreeObject.prototype._correctLine=function(c){if(!c.htmlNode){return}var a=c.parentObject;if(a){if((this._getLineStatus(c.id,a)==0)||(!this.treeLinesOn)){for(var d=1;d<=c.childsCount;d++){if(!c.htmlNode.childNodes[0].childNodes[d]){break}c.htmlNode.childNodes[0].childNodes[d].childNodes[0].style.backgroundImage="";c.htmlNode.childNodes[0].childNodes[d].childNodes[0].style.backgroundRepeat=""}}else{for(var d=1;d<=c.childsCount;d++){if(!c.htmlNode.childNodes[0].childNodes[d]){break}c.htmlNode.childNodes[0].childNodes[d].childNodes[0].style.backgroundImage="url("+this.imPath+this.lineArray[5]+")";c.htmlNode.childNodes[0].childNodes[d].childNodes[0].style.backgroundRepeat="repeat-y"}}}};dhtmlXTreeObject.prototype._getCountStatus=function(c,a){if(a.childsCount<=1){if(a.id==this.rootId){return 4}else{return 0}}if(a.childNodes[0].id==c){if(a.id==this.rootId){return 2}else{return 1}}if(a.childNodes[a.childsCount-1].id==c){return 0}return 1};dhtmlXTreeObject.prototype._getLineStatus=function(c,a){if(a.childNodes[a.childsCount-1].id==c){return 0}return 1};dhtmlXTreeObject.prototype._HideShow=function(c,f){if((this.XMLsource)&&(!c.XMLload)){if(f==1){return}c.XMLload=1;this._loadDynXML(c.id);return}if(c.unParsed){this.reParse(c)}var e=c.htmlNode.childNodes[0].childNodes;var a=e.length;if(a>1){if(((e[1].style.display!="none")||(f==1))&&(f!=2)){this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0";nodestyle="none"}else{nodestyle=""}for(var d=1;d<a;d++){e[d].style.display=nodestyle}}this._correctPlus(c)};dhtmlXTreeObject.prototype._getOpenState=function(a){if(!a.htmlNode){return 0}var c=a.htmlNode.childNodes[0].childNodes;if(c.length<=1){return 0}if(c[1].style.display!="none"){return 1}else{return -1}};dhtmlXTreeObject.prototype.onRowClick2=function(){var a=this.parentObject.treeNod;if(!a.callEvent("onDblClick",[this.parentObject.id,a])){return false}if((this.parentObject.closeble)&&(this.parentObject.closeble!="0")){a._HideShow(this.parentObject)}else{a._HideShow(this.parentObject,2)}if(a.checkEvent("onOpenEnd")){if(!a.xmlstate){a.callEvent("onOpenEnd",[this.parentObject.id,a._getOpenState(this.parentObject)])}else{a._oie_onXLE.push(a.onXLE);a.onXLE=a._epnFHe}}return false};dhtmlXTreeObject.prototype.onRowClick=function(){var a=this.parentObject.treeNod;if(!a.callEvent("onOpenStart",[this.parentObject.id,a._getOpenState(this.parentObject)])){return 0}if((this.parentObject.closeble)&&(this.parentObject.closeble!="0")){a._HideShow(this.parentObject)}else{a._HideShow(this.parentObject,2)}if(a.checkEvent("onOpenEnd")){if(!a.xmlstate){a.callEvent("onOpenEnd",[this.parentObject.id,a._getOpenState(this.parentObject)])}else{a._oie_onXLE.push(a.onXLE);a.onXLE=a._epnFHe}}};dhtmlXTreeObject.prototype._epnFHe=function(c,d,a){if(d!=this.rootId){this.callEvent("onOpenEnd",[d,c.getOpenState(d)])}c.onXLE=c._oie_onXLE.pop();if(!a&&!c._oie_onXLE.length){if(c.onXLE){c.onXLE(c,d)}}};dhtmlXTreeObject.prototype.onRowClickDown=function(c){c=c||window.event;var a=this.parentObject.treeNod;a._selectItem(this.parentObject,c)};dhtmlXTreeObject.prototype.getSelectedItemId=function(){var c=new Array();for(var a=0;a<this._selected.length;a++){c[a]=this._selected[a].id}return(c.join(this.dlmtr))};dhtmlXTreeObject.prototype._selectItem=function(h,k){if(this.checkEvent("onSelect")){this._onSSCFold=this.getSelectedItemId()}if((!this._amsel)||(!k)||((!k.ctrlKey)&&(!k.metaKey)&&(!k.shiftKey))){this._unselectItems()}if((h.i_sel)&&(this._amsel)&&(k)&&(k.ctrlKey||k.metaKey)){this._unselectItem(h)}else{if((!h.i_sel)&&((!this._amselS)||(this._selected.length==0)||(this._selected[0].parentObject==h.parentObject))){if((this._amsel)&&(k)&&(k.shiftKey)&&(this._selected.length!=0)&&(this._selected[this._selected.length-1].parentObject==h.parentObject)){var f=this._getIndex(this._selected[this._selected.length-1]);var d=this._getIndex(h);if(d<f){var m=f;f=d;d=m}for(var g=f;g<=d;g++){if(!h.parentObject.childNodes[g].i_sel){this._markItem(h.parentObject.childNodes[g])}}}else{this._markItem(h)}}}if(this.checkEvent("onSelect")){var l=this.getSelectedItemId();if(l!=this._onSSCFold){this.callEvent("onSelect",[l])}}};dhtmlXTreeObject.prototype._markItem=function(a){if(a.scolor){a.span.style.color=a.scolor}a.span.className="selectedTreeRow";a.i_sel=true;this._selected[this._selected.length]=a};dhtmlXTreeObject.prototype.getIndexById=function(c){var a=this._globalIdStorageFind(c);if(!a){return null}return this._getIndex(a)};dhtmlXTreeObject.prototype._getIndex=function(a){var d=a.parentObject;for(var c=0;c<d.childsCount;c++){if(d.childNodes[c]==a){return c}}};dhtmlXTreeObject.prototype._unselectItem=function(c){if((c)&&(c.i_sel)){c.span.className="standartTreeRow";if(c.acolor){c.span.style.color=c.acolor}c.i_sel=false;for(var a=0;a<this._selected.length;a++){if(!this._selected[a].i_sel){this._selected.splice(a,1);break}}}};dhtmlXTreeObject.prototype._unselectItems=function(){for(var a=0;a<this._selected.length;a++){var c=this._selected[a];c.span.className="standartTreeRow";if(c.acolor){c.span.style.color=c.acolor}c.i_sel=false}this._selected=new Array()};dhtmlXTreeObject.prototype.onRowSelect=function(f,d,h){f=f||window.event;var c=this.parentObject;if(d){c=d.parentObject}var a=c.treeNod;var g=a.getSelectedItemId();if((!f)||(!f.skipUnSel)){a._selectItem(c,f)}if(!h){if(c.actionHandler){c.actionHandler(c.id,g)}else{a.callEvent("onClick",[c.id,g])}}};dhtmlXTreeObject.prototype._correctCheckStates=function(f){if(!this.tscheck){return}if(!f){return}if(f.id==this.rootId){return}var d=f.childNodes;var c=0;var a=0;if(f.childsCount==0){return}for(var e=0;e<f.childsCount;e++){if(d[e].dscheck){continue}if(d[e].checkstate==0){c=1}else{if(d[e].checkstate==1){a=1}else{c=1;a=1;break}}}if((c)&&(a)){this._setCheck(f,"unsure")}else{if(c){this._setCheck(f,false)}else{this._setCheck(f,true)}}this._correctCheckStates(f.parentObject)};dhtmlXTreeObject.prototype.onCheckBoxClick=function(a){if(!this.treeNod.callEvent("onBeforeCheck",[this.parentObject.id,this.parentObject.checkstate])){return}if(this.parentObject.dscheck){return true}if(this.treeNod.tscheck){if(this.parentObject.checkstate==1){this.treeNod._setSubChecked(false,this.parentObject)}else{this.treeNod._setSubChecked(true,this.parentObject)}}else{if(this.parentObject.checkstate==1){this.treeNod._setCheck(this.parentObject,false)}else{this.treeNod._setCheck(this.parentObject,true)}}this.treeNod._correctCheckStates(this.parentObject.parentObject);return this.treeNod.callEvent("onCheck",[this.parentObject.id,this.parentObject.checkstate])};dhtmlXTreeObject.prototype._createItem=function(o,n,k){var q=document.createElement("table");q.cellSpacing=0;q.cellPadding=0;q.border=0;if(this.hfMode){q.style.tableLayout="fixed"}q.style.margin=0;q.style.padding=0;var h=document.createElement("tbody");var m=document.createElement("tr");var e=document.createElement("td");e.className="standartTreeImage";if(this._txtimg){var f=document.createElement("div");e.appendChild(f);f.className="dhx_tree_textSign"}else{var f=this._getImg(n.id);f.border="0";if(f.tagName=="IMG"){f.align="absmiddle"}e.appendChild(f);f.style.padding=0;f.style.margin=0;f.style.width=this.def_line_img_x;f.style.height=this.def_line_img_y}var d=document.createElement("td");var l=this._getImg(this.cBROf?this.rootId:n.id);l.checked=0;this._setSrc(l,this.imPath+this.checkArray[0]);l.style.width="18px";l.style.height="18px";if(!o){d.style.display="none"}d.appendChild(l);if((!this.cBROf)&&(l.tagName=="IMG")){l.align="absmiddle"}l.onclick=this.onCheckBoxClick;l.treeNod=this;l.parentObject=n;if(!window._KHTMLrv){d.width="20px"}else{d.width="16px"}var c=document.createElement("td");c.className="standartTreeImage";var g=this._getImg(this.timgen?n.id:this.rootId);g.onmousedown=this._preventNsDrag;g.ondragstart=this._preventNsDrag;g.border="0";if(this._aimgs){g.parentObject=n;if(g.tagName=="IMG"){g.align="absmiddle"}g.onclick=this.onRowSelect}if(!k){this._setSrc(g,this.iconURL+this.imageArray[0])}c.appendChild(g);g.style.padding=0;g.style.margin=0;if(this.timgen){c.style.width=g.style.width=this.def_img_x;g.style.height=this.def_img_y}else{g.style.width="0px";g.style.height="0px";if(_isOpera||window._KHTMLrv){c.style.display="none"}}var a=document.createElement("td");a.className="standartTreeRow";n.span=document.createElement("span");n.span.className="standartTreeRow";if(this.mlitems){n.span.style.width=this.mlitems;n.span.style.display="block"}else{a.noWrap=true}if(_isIE&&_isIE>7){a.style.width="999999px"}else{if(!window._KHTMLrv){a.style.width="100%"}}n.span.innerHTML=n.label;a.appendChild(n.span);a.parentObject=n;e.parentObject=n;a.onclick=this.onRowSelect;e.onclick=this.onRowClick;a.ondblclick=this.onRowClick2;if(this.ettip){m.title=n.label}if(this.dragAndDropOff){if(this._aimgs){this.dragger.addDraggableItem(c,this);c.parentObject=n}this.dragger.addDraggableItem(a,this)}n.span.style.paddingLeft="5px";n.span.style.paddingRight="5px";a.style.verticalAlign="";a.style.fontSize="10pt";a.style.cursor=this.style_pointer;m.appendChild(e);m.appendChild(d);m.appendChild(c);m.appendChild(a);h.appendChild(m);q.appendChild(h);if(this.ehlt||this.checkEvent("onMouseIn")||this.checkEvent("onMouseOut")){m.onmousemove=this._itemMouseIn;m[(_isIE)?"onmouseleave":"onmouseout"]=this._itemMouseOut}return q};dhtmlXTreeObject.prototype.setImagePath=function(a){this.imPath=a;this.iconURL=a};dhtmlXTreeObject.prototype.setIconPath=function(a){this.iconURL=a};dhtmlXTreeObject.prototype._getLeafCount=function(e){var d=0;for(var c=0;c<e.childsCount;c++){if(e.childNodes[c].childsCount==0){d++}}return d};dhtmlXTreeObject.prototype._getChildCounterValue=function(c){var a=this._globalIdStorageFind(c);if(!a){return 0}if((a.unParsed)||((!a.XMLload)&&(this.XMLsource))){return a._acc}switch(this.childCalc){case 1:return a.childsCount;break;case 2:return this._getLeafCount(a);break;case 3:return a._acc;break;case 4:return a._acc;break}};dhtmlXTreeObject.prototype._fixChildCountLabel=function(g,e){if(this.childCalc==null){return}if((g.unParsed)||((!g.XMLload)&&(this.XMLsource))){if(g._acc){g.span.innerHTML=g.label+this.htmlcA+g._acc+this.htmlcB}else{g.span.innerHTML=g.label}return}switch(this.childCalc){case 1:if(g.childsCount!=0){g.span.innerHTML=g.label+this.htmlcA+g.childsCount+this.htmlcB}else{g.span.innerHTML=g.label}break;case 2:var f=this._getLeafCount(g);if(f!=0){g.span.innerHTML=g.label+this.htmlcA+f+this.htmlcB}else{g.span.innerHTML=g.label}break;case 3:if(g.childsCount!=0){var d=0;for(var c=0;c<g.childsCount;c++){if(!g.childNodes[c]._acc){g.childNodes[c]._acc=0}d+=g.childNodes[c]._acc*1}d+=g.childsCount*1;g.span.innerHTML=g.label+this.htmlcA+d+this.htmlcB;g._acc=d}else{g.span.innerHTML=g.label;g._acc=0}if((g.parentObject)&&(g.parentObject!=this.htmlNode)){this._fixChildCountLabel(g.parentObject)}break;case 4:if(g.childsCount!=0){var d=0;for(var c=0;c<g.childsCount;c++){if(!g.childNodes[c]._acc){g.childNodes[c]._acc=1}d+=g.childNodes[c]._acc*1}g.span.innerHTML=g.label+this.htmlcA+d+this.htmlcB;g._acc=d}else{g.span.innerHTML=g.label;g._acc=1}if((g.parentObject)&&(g.parentObject!=this.htmlNode)){this._fixChildCountLabel(g.parentObject)}break}};dhtmlXTreeObject.prototype.setChildCalcMode=function(a){switch(a){case"child":this.childCalc=1;break;case"leafs":this.childCalc=2;break;case"childrec":this.childCalc=3;break;case"leafsrec":this.childCalc=4;break;case"disabled":this.childCalc=null;break;default:this.childCalc=4}};dhtmlXTreeObject.prototype.setChildCalcHTML=function(c,a){this.htmlcA=c;this.htmlcB=a};dhtmlXTreeObject.prototype.setOnRightClickHandler=function(a){this.attachEvent("onRightClick",a)};dhtmlXTreeObject.prototype.setOnClickHandler=function(a){this.attachEvent("onClick",a)};dhtmlXTreeObject.prototype.setOnSelectStateChange=function(a){this.attachEvent("onSelect",a)};dhtmlXTreeObject.prototype.setXMLAutoLoading=function(a){this.XMLsource=a};dhtmlXTreeObject.prototype.setOnCheckHandler=function(a){this.attachEvent("onCheck",a)};dhtmlXTreeObject.prototype.setOnOpenHandler=function(a){this.attachEvent("onOpenStart",a)};dhtmlXTreeObject.prototype.setOnOpenStartHandler=function(a){this.attachEvent("onOpenStart",a)};dhtmlXTreeObject.prototype.setOnOpenEndHandler=function(a){this.attachEvent("onOpenEnd",a)};dhtmlXTreeObject.prototype.setOnDblClickHandler=function(a){this.attachEvent("onDblClick",a)};dhtmlXTreeObject.prototype.openAllItems=function(c){var a=this._globalIdStorageFind(c);if(!a){return 0}this._xopenAll(a)};dhtmlXTreeObject.prototype.getOpenState=function(c){var a=this._globalIdStorageFind(c);if(!a){return""}return this._getOpenState(a)};dhtmlXTreeObject.prototype.closeAllItems=function(c){if(c===window.undefined){c=this.rootId}var a=this._globalIdStorageFind(c);if(!a){return 0}this._xcloseAll(a);this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0"};dhtmlXTreeObject.prototype.setUserData=function(e,c,d){var a=this._globalIdStorageFind(e,0,true);if(!a){return}if(c=="hint"){a.htmlNode.childNodes[0].childNodes[0].title=d}if(typeof(a.userData["t_"+c])=="undefined"){if(!a._userdatalist){a._userdatalist=c}else{a._userdatalist+=","+c}}a.userData["t_"+c]=d};dhtmlXTreeObject.prototype.getUserData=function(d,c){var a=this._globalIdStorageFind(d,0,true);if(!a){return}return a.userData["t_"+c]};dhtmlXTreeObject.prototype.getItemColor=function(d){var a=this._globalIdStorageFind(d);if(!a){return 0}var c=new Object();if(a.acolor){c.acolor=a.acolor}if(a.scolor){c.scolor=a.scolor}return c};dhtmlXTreeObject.prototype.setItemColor=function(d,c,e){if((d)&&(d.span)){var a=d}else{var a=this._globalIdStorageFind(d)}if(!a){return 0}else{if(a.i_sel){if(e){a.span.style.color=e}}else{if(c){a.span.style.color=c}}if(e){a.scolor=e}if(c){a.acolor=c}}};dhtmlXTreeObject.prototype.getItemText=function(c){var a=this._globalIdStorageFind(c);if(!a){return 0}return(a.htmlNode.childNodes[0].childNodes[0].childNodes[3].childNodes[0].innerHTML)};dhtmlXTreeObject.prototype.getParentId=function(c){var a=this._globalIdStorageFind(c);if((!a)||(!a.parentObject)){return""}return a.parentObject.id};dhtmlXTreeObject.prototype.changeItemId=function(c,d){if(c==d){return}var a=this._globalIdStorageFind(c);if(!a){return 0}a.id=d;a.span.contextMenuId=d;this._idpull[d]=this._idpull[c];delete this._idpull[c]};dhtmlXTreeObject.prototype.doCut=function(){if(this.nodeCut){this.clearCut()}this.nodeCut=(new Array()).concat(this._selected);for(var a=0;a<this.nodeCut.length;a++){var c=this.nodeCut[a];c._cimgs=new Array();c._cimgs[0]=c.images[0];c._cimgs[1]=c.images[1];c._cimgs[2]=c.images[2];c.images[0]=c.images[1]=c.images[2]=this.cutImage;this._correctPlus(c)}};dhtmlXTreeObject.prototype.doPaste=function(d){var a=this._globalIdStorageFind(d);if(!a){return 0}for(var c=0;c<this.nodeCut.length;c++){if(this._checkPNodes(a,this.nodeCut[c])){continue}this._moveNode(this.nodeCut[c],a)}this.clearCut()};dhtmlXTreeObject.prototype.clearCut=function(){for(var a=0;a<this.nodeCut.length;a++){var c=this.nodeCut[a];c.images[0]=c._cimgs[0];c.images[1]=c._cimgs[1];c.images[2]=c._cimgs[2];this._correctPlus(c)}this.nodeCut=new Array()};dhtmlXTreeObject.prototype._moveNode=function(a,c){var g=this.dadmodec;if(g==1){var f=c;if(this.dadmodefix<0){while(true){f=this._getPrevNode(f);if((f==-1)){f=this.htmlNode;break}if((f.tr==0)||(f.tr.style.display=="")||(!f.parentObject)){break}}var e=f;var d=c}else{if((f.tr)&&(f.tr.nextSibling)&&(f.tr.nextSibling.nodem)&&(this._getOpenState(f)<1)){f=f.tr.nextSibling.nodem}else{f=this._getNextNode(f);if((f==-1)){f=this.htmlNode}}var d=f;var e=c}if(this._getNodeLevel(e,0)>this._getNodeLevel(d,0)){if(!this.dropLower){return this._moveNodeTo(a,e.parentObject)}else{if(d.id!=this.rootId){return this._moveNodeTo(a,d.parentObject,d)}else{return this._moveNodeTo(a,this.htmlNode,null)}}}else{return this._moveNodeTo(a,d.parentObject,d)}}else{return this._moveNodeTo(a,c)}};dhtmlXTreeObject.prototype._fixNodesCollection=function(k,g){var c=0;var e=0;var h=k.childNodes;var a=k.childsCount-1;if(g==h[a]){return}for(var f=0;f<a;f++){if(h[f]==h[a]){h[f]=h[f+1];h[f+1]=h[a]}}for(var f=0;f<a+1;f++){if(c){var d=h[f];h[f]=c;c=d}else{if(h[f]==g){c=h[f];h[f]=h[a]}}}};dhtmlXTreeObject.prototype._recreateBranch=function(g,k,f,a){var c;var l="";if(f){for(c=0;c<k.childsCount;c++){if(k.childNodes[c]==f){break}}if(c!=0){f=k.childNodes[c-1]}else{l="TOP";f=""}}var d=this._onradh;this._onradh=null;var h=this._attachChildNode(k,g.id,g.label,0,g.images[0],g.images[1],g.images[2],l,0,f);h._userdatalist=g._userdatalist;h.userData=g.userData.clone();if(g._attrs){h._attrs={};for(var e in g._attrs){h._attrs[e]=g._attrs[e]}}h.XMLload=g.XMLload;if(d){this._onradh=d;this._onradh(h.id)}if(g.treeNod.dpcpy){g.treeNod._globalIdStorageFind(g.id)}else{h.unParsed=g.unParsed}this._correctPlus(h);for(var c=0;c<g.childsCount;c++){this._recreateBranch(g.childNodes[c],h,0,1)}if((!a)&&(this.childCalc)){this._redrawFrom(this,k)}return h};dhtmlXTreeObject.prototype._moveNodeTo=function(o,r,n){if(o.treeNod._nonTrivialNode){return o.treeNod._nonTrivialNode(this,r,n,o)}if(this._checkPNodes(r,o)){return false}if(r.mytype){var h=(o.treeNod.lWin!=r.lWin)}else{var h=(o.treeNod.lWin!=r.treeNod.lWin)}if(!this.callEvent("onDrag",[o.id,r.id,(n?n.id:null),o.treeNod,r.treeNod])){return false}if((r.XMLload==0)&&(this.XMLsource)){r.XMLload=1;this._loadDynXML(r.id)}this.openItem(r.id);var d=o.treeNod;var l=o.parentObject.childsCount;var m=o.parentObject;if((h)||(d.dpcpy)){var e=o.id;o=this._recreateBranch(o,r,n);if(!d.dpcpy){d.deleteItem(e)}}else{var f=r.childsCount;var q=r.childNodes;if(f==0){r._open=true}d._unselectItem(o);q[f]=o;o.treeNod=r.treeNod;r.childsCount++;var k=this._drawNewTr(q[f].htmlNode);if(!n){r.htmlNode.childNodes[0].appendChild(k);if(this.dadmode==1){this._fixNodesCollection(r,n)}}else{r.htmlNode.childNodes[0].insertBefore(k,n.tr);this._fixNodesCollection(r,n);q=r.childNodes}}if((!d.dpcpy)&&(!h)){var a=o.tr;if((document.all)&&(navigator.appVersion.search(/MSIE\ 5\.0/gi)!=-1)){window.setTimeout(function(){a.parentNode.removeChild(a)},250)}else{o.parentObject.htmlNode.childNodes[0].removeChild(o.tr)}if((!n)||(r!=o.parentObject)){for(var g=0;g<m.childsCount;g++){if(m.childNodes[g].id==o.id){m.childNodes[g]=0;break}}}else{m.childNodes[m.childsCount-1]=0}d._compressChildList(m.childsCount,m.childNodes);m.childsCount--}if((!h)&&(!d.dpcpy)){o.tr=k;k.nodem=o;o.parentObject=r;if(d!=r.treeNod){if(o.treeNod._registerBranch(o,d)){return}this._clearStyles(o);this._redrawFrom(this,o.parentObject);if(this._onradh){this._onradh(o.id)}}this._correctPlus(r);this._correctLine(r);this._correctLine(o);this._correctPlus(o);if(n){this._correctPlus(n)}else{if(r.childsCount>=2){this._correctPlus(q[r.childsCount-2]);this._correctLine(q[r.childsCount-2])}}this._correctPlus(q[r.childsCount-1]);if(this.tscheck){this._correctCheckStates(r)}if(d.tscheck){d._correctCheckStates(m)}}if(l>1){d._correctPlus(m.childNodes[l-2]);d._correctLine(m.childNodes[l-2])}d._correctPlus(m);d._correctLine(m);this._fixChildCountLabel(r);d._fixChildCountLabel(m);this.callEvent("onDrop",[o.id,r.id,(n?n.id:null),d,r.treeNod]);return o.id};dhtmlXTreeObject.prototype._clearStyles=function(a){if(!a.htmlNode){return}var e=a.htmlNode.childNodes[0].childNodes[0].childNodes[1];var c=e.nextSibling.nextSibling;a.span.innerHTML=a.label;a.i_sel=false;if(a._aimgs){this.dragger.removeDraggableItem(e.nextSibling)}if(this.checkBoxOff){e.childNodes[0].style.display="";e.childNodes[0].onclick=this.onCheckBoxClick;this._setSrc(e.childNodes[0],this.imPath+this.checkArray[a.checkstate])}else{e.style.display="none"}e.childNodes[0].treeNod=this;this.dragger.removeDraggableItem(c);if(this.dragAndDropOff){this.dragger.addDraggableItem(c,this)}if(this._aimgs){this.dragger.addDraggableItem(e.nextSibling,this)}c.childNodes[0].className="standartTreeRow";c.onclick=this.onRowSelect;c.ondblclick=this.onRowClick2;e.previousSibling.onclick=this.onRowClick;this._correctLine(a);this._correctPlus(a);for(var d=0;d<a.childsCount;d++){this._clearStyles(a.childNodes[d])}};dhtmlXTreeObject.prototype._registerBranch=function(c,a){if(a){a._globalIdStorageSub(c.id)}c.id=this._globalIdStorageAdd(c.id,c);c.treeNod=this;for(var d=0;d<c.childsCount;d++){this._registerBranch(c.childNodes[d],a)}return 0};dhtmlXTreeObject.prototype.enableThreeStateCheckboxes=function(a){this.tscheck=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.setOnMouseInHandler=function(a){this.ehlt=true;this.attachEvent("onMouseIn",a)};dhtmlXTreeObject.prototype.setOnMouseOutHandler=function(a){this.ehlt=true;this.attachEvent("onMouseOut",a)};dhtmlXTreeObject.prototype.enableMercyDrag=function(a){this.dpcpy=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.enableTreeImages=function(a){this.timgen=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.enableFixedMode=function(a){this.hfMode=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.enableCheckBoxes=function(c,a){this.checkBoxOff=convertStringToBoolean(c);this.cBROf=(!(this.checkBoxOff||convertStringToBoolean(a)))};dhtmlXTreeObject.prototype.setStdImages=function(a,d,c){this.imageArray[0]=a;this.imageArray[1]=d;this.imageArray[2]=c};dhtmlXTreeObject.prototype.enableTreeLines=function(a){this.treeLinesOn=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.setImageArrays=function(e,a,g,f,d,c){switch(e){case"plus":this.plusArray[0]=a;this.plusArray[1]=g;this.plusArray[2]=f;this.plusArray[3]=d;this.plusArray[4]=c;break;case"minus":this.minusArray[0]=a;this.minusArray[1]=g;this.minusArray[2]=f;this.minusArray[3]=d;this.minusArray[4]=c;break}};dhtmlXTreeObject.prototype.openItem=function(c){this.skipLock=true;var a=this._globalIdStorageFind(c);if(!a){return 0}else{return this._openItem(a)}this.skipLock=false};dhtmlXTreeObject.prototype._openItem=function(a){var c=this._getOpenState(a);if((c<0)||(((this.XMLsource)&&(!a.XMLload)))){if(!this.callEvent("onOpenStart",[a.id,c])){return 0}this._HideShow(a,2);if(this.checkEvent("onOpenEnd")){if(this.onXLE==this._epnFHe){this._epnFHe(this,a.id,true)}if(!this.xmlstate||!this.XMLsource){this.callEvent("onOpenEnd",[a.id,this._getOpenState(a)])}else{this._oie_onXLE.push(this.onXLE);this.onXLE=this._epnFHe}}}else{if(this._srnd){this._HideShow(a,2)}}if(a.parentObject&&!this._skip_open_parent){this._openItem(a.parentObject)}};dhtmlXTreeObject.prototype.closeItem=function(c){if(this.rootId==c){return 0}this.skipLock=true;var a=this._globalIdStorageFind(c);if(!a){return 0}if(a.closeble){this._HideShow(a,1)}this.skipLock=false};dhtmlXTreeObject.prototype.getLevel=function(c){var a=this._globalIdStorageFind(c);if(!a){return 0}return this._getNodeLevel(a,0)};dhtmlXTreeObject.prototype.setItemCloseable=function(d,a){a=convertStringToBoolean(a);if((d)&&(d.span)){var c=d}else{var c=this._globalIdStorageFind(d)}if(!c){return 0}c.closeble=a};dhtmlXTreeObject.prototype._getNodeLevel=function(a,c){if(a.parentObject){return this._getNodeLevel(a.parentObject,c+1)}return(c)};dhtmlXTreeObject.prototype.hasChildren=function(c){var a=this._globalIdStorageFind(c);if(!a){return 0}else{if((this.XMLsource)&&(!a.XMLload)){return true}else{return a.childsCount}}};dhtmlXTreeObject.prototype._getLeafCount=function(e){var d=0;for(var c=0;c<e.childsCount;c++){if(e.childNodes[c].childsCount==0){d++}}return d};dhtmlXTreeObject.prototype.setItemText=function(e,d,c){var a=this._globalIdStorageFind(e);if(!a){return 0}a.label=d;a.span.innerHTML=d;if(this.childCalc){this._fixChildCountLabel(a)}a.span.parentNode.parentNode.title=c||""};dhtmlXTreeObject.prototype.getItemTooltip=function(c){var a=this._globalIdStorageFind(c);if(!a){return""}return(a.span.parentNode.parentNode._dhx_title||a.span.parentNode.parentNode.title||"")};dhtmlXTreeObject.prototype.refreshItem=function(c){if(!c){c=this.rootId}var a=this._globalIdStorageFind(c);this.deleteChildItems(c);this._loadDynXML(c)};dhtmlXTreeObject.prototype.setItemImage2=function(e,a,f,d){var c=this._globalIdStorageFind(e);if(!c){return 0}c.images[1]=f;c.images[2]=d;c.images[0]=a;this._correctPlus(c)};dhtmlXTreeObject.prototype.setItemImage=function(d,a,e){var c=this._globalIdStorageFind(d);if(!c){return 0}if(e){c.images[1]=a;c.images[2]=e}else{c.images[0]=a}this._correctPlus(c)};dhtmlXTreeObject.prototype.getSubItems=function(d){var a=this._globalIdStorageFind(d,0,1);if(!a){return 0}if(a.unParsed){return(this._getSubItemsXML(a.unParsed))}var c="";for(i=0;i<a.childsCount;i++){if(!c){c=""+a.childNodes[i].id}else{c+=this.dlmtr+a.childNodes[i].id}}return c};dhtmlXTreeObject.prototype._getAllScraggyItems=function(d){var e="";for(var c=0;c<d.childsCount;c++){if((d.childNodes[c].unParsed)||(d.childNodes[c].childsCount>0)){if(d.childNodes[c].unParsed){var a=this._getAllScraggyItemsXML(d.childNodes[c].unParsed,1)}else{var a=this._getAllScraggyItems(d.childNodes[c])}if(a){if(e){e+=this.dlmtr+a}else{e=a}}}else{if(!e){e=""+d.childNodes[c].id}else{e+=this.dlmtr+d.childNodes[c].id}}}return e};dhtmlXTreeObject.prototype._getAllFatItems=function(d){var e="";for(var c=0;c<d.childsCount;c++){if((d.childNodes[c].unParsed)||(d.childNodes[c].childsCount>0)){if(!e){e=""+d.childNodes[c].id}else{e+=this.dlmtr+d.childNodes[c].id}if(d.childNodes[c].unParsed){var a=this._getAllFatItemsXML(d.childNodes[c].unParsed,1)}else{var a=this._getAllFatItems(d.childNodes[c])}if(a){e+=this.dlmtr+a}}}return e};dhtmlXTreeObject.prototype._getAllSubItems=function(g,f,e){if(e){c=e}else{var c=this._globalIdStorageFind(g)}if(!c){return 0}f="";for(var d=0;d<c.childsCount;d++){if(!f){f=""+c.childNodes[d].id}else{f+=this.dlmtr+c.childNodes[d].id}var a=this._getAllSubItems(0,f,c.childNodes[d]);if(a){f+=this.dlmtr+a}}if(c.unParsed){f=this._getAllSubItemsXML(g,f,c.unParsed)}return f};dhtmlXTreeObject.prototype.selectItem=function(e,d,c){d=convertStringToBoolean(d);var a=this._globalIdStorageFind(e);if((!a)||(!a.parentObject)){return 0}if(this.XMLloadingWarning){a.parentObject.openMe=1}else{this._openItem(a.parentObject)}var f=null;if(c){f=new Object;f.ctrlKey=true;if(a.i_sel){f.skipUnSel=true}}if(d){this.onRowSelect(f,a.htmlNode.childNodes[0].childNodes[0].childNodes[3],false)}else{this.onRowSelect(f,a.htmlNode.childNodes[0].childNodes[0].childNodes[3],true)}};dhtmlXTreeObject.prototype.getSelectedItemText=function(){var c=new Array();for(var a=0;a<this._selected.length;a++){c[a]=this._selected[a].span.innerHTML}return(c.join(this.dlmtr))};dhtmlXTreeObject.prototype._compressChildList=function(a,d){a--;for(var c=0;c<a;c++){if(d[c]==0){d[c]=d[c+1];d[c+1]=0}}};dhtmlXTreeObject.prototype._deleteNode=function(h,f,l){if((!f)||(!f.parentObject)){return 0}var a=0;var c=0;if(f.tr.nextSibling){a=f.tr.nextSibling.nodem}if(f.tr.previousSibling){c=f.tr.previousSibling.nodem}var g=f.parentObject;var d=g.childsCount;var k=g.childNodes;for(var e=0;e<d;e++){if(k[e].id==h){if(!l){g.htmlNode.childNodes[0].removeChild(k[e].tr)}k[e]=0;break}}this._compressChildList(d,k);if(!l){g.childsCount--}if(a){this._correctPlus(a);this._correctLine(a)}if(c){this._correctPlus(c);this._correctLine(c)}if(this.tscheck){this._correctCheckStates(g)}if(!l){this._globalIdStorageRecSub(f)}};dhtmlXTreeObject.prototype.setCheck=function(d,c){var a=this._globalIdStorageFind(d,0,1);if(!a){return}if(c==="unsure"){this._setCheck(a,c)}else{c=convertStringToBoolean(c);if((this.tscheck)&&(this.smcheck)){this._setSubChecked(c,a)}else{this._setCheck(a,c)}}if(this.smcheck){this._correctCheckStates(a.parentObject)}};dhtmlXTreeObject.prototype._setCheck=function(a,d){if(!a){return}if(((a.parentObject._r_logic)||(this._frbtr))&&(d)){if(this._frbtrs){if(this._frbtrL){this.setCheck(this._frbtrL.id,0)}this._frbtrL=a}else{for(var c=0;c<a.parentObject.childsCount;c++){this._setCheck(a.parentObject.childNodes[c],0)}}}var e=a.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];if(d=="unsure"){a.checkstate=2}else{if(d){a.checkstate=1}else{a.checkstate=0}}if(a.dscheck){a.checkstate=a.dscheck}this._setSrc(e,this.imPath+((a.parentObject._r_logic||this._frbtr)?this.radioArray:this.checkArray)[a.checkstate])};dhtmlXTreeObject.prototype.setSubChecked=function(d,c){var a=this._globalIdStorageFind(d);this._setSubChecked(c,a);this._correctCheckStates(a.parentObject)};dhtmlXTreeObject.prototype._setSubChecked=function(d,a){d=convertStringToBoolean(d);if(!a){return}if(((a.parentObject._r_logic)||(this._frbtr))&&(d)){for(var c=0;c<a.parentObject.childsCount;c++){this._setSubChecked(0,a.parentObject.childNodes[c])}}if(a.unParsed){this._setSubCheckedXML(d,a.unParsed)}if(a._r_logic||this._frbtr){this._setSubChecked(d,a.childNodes[0])}else{for(var c=0;c<a.childsCount;c++){this._setSubChecked(d,a.childNodes[c])}}var e=a.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];if(d){a.checkstate=1}else{a.checkstate=0}if(a.dscheck){a.checkstate=a.dscheck}this._setSrc(e,this.imPath+((a.parentObject._r_logic||this._frbtr)?this.radioArray:this.checkArray)[a.checkstate])};dhtmlXTreeObject.prototype.isItemChecked=function(c){var a=this._globalIdStorageFind(c);if(!a){return}return a.checkstate};dhtmlXTreeObject.prototype.deleteChildItems=function(e){var a=this._globalIdStorageFind(e);if(!a){return}var c=a.childsCount;for(var d=0;d<c;d++){this._deleteNode(a.childNodes[0].id,a.childNodes[0])}};dhtmlXTreeObject.prototype.deleteItem=function(d,a){if((!this._onrdlh)||(this._onrdlh(d))){var c=this._deleteItem(d,a);if(c){this._fixChildCountLabel(c)}}this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0"};dhtmlXTreeObject.prototype._deleteItem=function(g,c,f){c=convertStringToBoolean(c);var a=this._globalIdStorageFind(g);if(!a){return}var d=this.getParentId(g);var e=a.parentObject;this._deleteNode(g,a,f);if(this._editCell&&this._editCell.id==g){this._editCell=null}this._correctPlus(e);this._correctLine(e);if((c)&&(d!=this.rootId)){this.selectItem(d,1)}return e};dhtmlXTreeObject.prototype._globalIdStorageRecSub=function(a){for(var c=0;c<a.childsCount;c++){this._globalIdStorageRecSub(a.childNodes[c]);this._globalIdStorageSub(a.childNodes[c].id)}this._globalIdStorageSub(a.id);var d=a;d.span=null;d.tr.nodem=null;d.tr=null;d.htmlNode=null};dhtmlXTreeObject.prototype.insertNewNext=function(k,n,m,d,g,f,e,c,a){var h=this._globalIdStorageFind(k);if((!h)||(!h.parentObject)){return(0)}var l=this._attachChildNode(0,n,m,d,g,f,e,c,a,h);if((!this.XMLloadingWarning)&&(this.childCalc)){this._fixChildCountLabel(h.parentObject)}return l};dhtmlXTreeObject.prototype.getItemIdByIndex=function(d,a){var c=this._globalIdStorageFind(d);if((!c)||(a>=c.childsCount)){return null}return c.childNodes[a].id};dhtmlXTreeObject.prototype.getChildItemIdByIndex=function(d,a){var c=this._globalIdStorageFind(d);if((!c)||(a>=c.childsCount)){return null}return c.childNodes[a].id};dhtmlXTreeObject.prototype.setDragHandler=function(a){this.attachEvent("onDrag",a)};dhtmlXTreeObject.prototype._clearMove=function(){if(this._lastMark){this._lastMark.className=this._lastMark.className.replace(/dragAndDropRow/g,"");this._lastMark=null}this.selectionBar.style.display="none";this.allTree.className=this.allTree.className.replace(" selectionBox","")};dhtmlXTreeObject.prototype.enableDragAndDrop=function(c,a){if(c=="temporary_disabled"){this.dADTempOff=false;c=true}else{this.dADTempOff=true}this.dragAndDropOff=convertStringToBoolean(c);if(this.dragAndDropOff){this.dragger.addDragLanding(this.allTree,this)}if(arguments.length>1){this._ddronr=(!convertStringToBoolean(a))}};dhtmlXTreeObject.prototype._setMove=function(f,d,h){if(f.parentObject.span){var e=getAbsoluteTop(f);var c=getAbsoluteTop(this.allTree)-this.allTree.scrollTop;this.dadmodec=this.dadmode;this.dadmodefix=0;if(this.dadmode==2){var g=h-e+(document.body.scrollTop||document.documentElement.scrollTop)-2-f.offsetHeight/2;if((Math.abs(g)-f.offsetHeight/6)>0){this.dadmodec=1;if(g<0){this.dadmodefix=0-f.offsetHeight}}else{this.dadmodec=0}}if(this.dadmodec==0){var a=f.parentObject.span;a.className+=" dragAndDropRow";this._lastMark=a}else{this._clearMove();this.selectionBar.style.top=(e-c+((parseInt(f.parentObject.span.parentNode.previousSibling.childNodes[0].style.height)||18)-1)+this.dadmodefix)+"px";this.selectionBar.style.left="5px";if(this.allTree.offsetWidth>20){this.selectionBar.style.width=(this.allTree.offsetWidth-(_isFF?30:25))+"px"}this.selectionBar.style.display=""}this._autoScroll(null,e,c)}};dhtmlXTreeObject.prototype._autoScroll=function(d,c,a){if(this.autoScroll){if(d){c=getAbsoluteTop(d);a=getAbsoluteTop(this.allTree)-this.allTree.scrollTop}if((c-a-parseInt(this.allTree.scrollTop))>(parseInt(this.allTree.offsetHeight)-50)){this.allTree.scrollTop=parseInt(this.allTree.scrollTop)+20}if((c-a)<(parseInt(this.allTree.scrollTop)+30)){this.allTree.scrollTop=parseInt(this.allTree.scrollTop)-20}}};dhtmlXTreeObject.prototype._createDragNode=function(g,f){if(!this.dADTempOff){return null}var d=g.parentObject;if(!this.callEvent("onBeforeDrag",[d.id,f])){return null}if(!d.i_sel){this._selectItem(d,f)}this._checkMSelectionLogic();var c=document.createElement("div");var h=new Array();if(this._itim_dg){for(var a=0;a<this._selected.length;a++){h[a]="<table cellspacing='0' cellpadding='0'><tr><td><img width='18px' height='18px' src='"+this._getSrc(this._selected[a].span.parentNode.previousSibling.childNodes[0])+"'></td><td>"+this._selected[a].span.innerHTML+"</td></tr></table>"}}else{h=this.getSelectedItemText().split(this.dlmtr)}c.innerHTML=h.join("");c.style.position="absolute";c.className="dragSpanDiv";this._dragged=(new Array()).concat(this._selected);return c};dhtmlXTreeObject.prototype._focusNode=function(a){var c=getAbsoluteTop(a.htmlNode)-getAbsoluteTop(this.allTree);if((c>(this.allTree.offsetHeight-30))||(c<0)){this.allTree.scrollTop=c+this.allTree.scrollTop}};dhtmlXTreeObject.prototype._preventNsDrag=function(a){if((a)&&(a.preventDefault)){a.preventDefault();return false}return false};dhtmlXTreeObject.prototype._drag=function(h,k,a){if(this._autoOpenTimer){clearTimeout(this._autoOpenTimer)}if(!a.parentObject){a=this.htmlNode.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];this.dadmodec=0}this._clearMove();var g=h.parentObject.treeNod;if((g)&&(g._clearMove)){g._clearMove("")}if((!this.dragMove)||(this.dragMove())){if((!g)||(!g._clearMove)||(!g._dragged)){var e=new Array(h.parentObject)}else{var e=g._dragged}var c=a.parentObject;for(var f=0;f<e.length;f++){var d=this._moveNode(e[f],c);if((this.dadmodec)&&(d!==false)){c=this._globalIdStorageFind(d,true,true)}if((d)&&(!this._sADnD)){this.selectItem(d,0,1)}}}if(g){g._dragged=new Array()}};dhtmlXTreeObject.prototype._dragIn=function(g,e,a,k){if(!this.dADTempOff){return 0}var h=e.parentObject;var c=g.parentObject;if((!c)&&(this._ddronr)){return}if(!this.callEvent("onDragIn",[h.id,c?c.id:null,h.treeNod,this])){if(c){this._autoScroll(g)}return 0}if(!c){this.allTree.className+=" selectionBox"}else{if(h.childNodes==null){this._setMove(g,a,k);return g}var f=h.treeNod;for(var d=0;d<f._dragged.length;d++){if(this._checkPNodes(c,f._dragged[d])){this._autoScroll(g);return 0}}this.selectionBar.parentNode.removeChild(this.selectionBar);c.span.parentNode.appendChild(this.selectionBar);this._setMove(g,a,k);if(this._getOpenState(c)<=0){this._autoOpenId=c.id;this._autoOpenTimer=window.setTimeout(new callerFunction(this._autoOpenItem,this),1000)}}return g};dhtmlXTreeObject.prototype._autoOpenItem=function(c,a){a.openItem(a._autoOpenId)};dhtmlXTreeObject.prototype._dragOut=function(a){this._clearMove();if(this._autoOpenTimer){clearTimeout(this._autoOpenTimer)}};dhtmlXTreeObject.prototype._getNextNode=function(a,c){if((!c)&&(a.childsCount)){return a.childNodes[0]}if(a==this.htmlNode){return -1}if((a.tr)&&(a.tr.nextSibling)&&(a.tr.nextSibling.nodem)){return a.tr.nextSibling.nodem}return this._getNextNode(a.parentObject,true)};dhtmlXTreeObject.prototype._lastChild=function(a){if(a.childsCount){return this._lastChild(a.childNodes[a.childsCount-1])}else{return a}};dhtmlXTreeObject.prototype._getPrevNode=function(a,c){if((a.tr)&&(a.tr.previousSibling)&&(a.tr.previousSibling.nodem)){return this._lastChild(a.tr.previousSibling.nodem)}if(a.parentObject){return a.parentObject}else{return -1}};dhtmlXTreeObject.prototype.findItem=function(a,d,c){var e=this._findNodeByLabel(a,d,(c?this.htmlNode:null));if(e){this.selectItem(e.id,true);this._focusNode(e);return e.id}else{return null}};dhtmlXTreeObject.prototype.findItemIdByLabel=function(a,d,c){var e=this._findNodeByLabel(a,d,(c?this.htmlNode:null));if(e){return e.id}else{return null}};dhtmlXTreeObject.prototype.findStrInXML=function(c,d,f){if(!c.childNodes&&c.item){return this.findStrInJSON(c,d,f)}if(!c.childNodes){return false}for(var a=0;a<c.childNodes.length;a++){if(c.childNodes[a].nodeType==1){var e=c.childNodes[a].getAttribute(d);if(!e&&c.childNodes[a].tagName=="itemtext"){e=c.childNodes[a].firstChild.data}if((e)&&(e.toLowerCase().search(f)!=-1)){return true}if(this.findStrInXML(c.childNodes[a],d,f)){return true}}}return false};dhtmlXTreeObject.prototype.findStrInJSON=function(c,d,f){for(var a=0;a<c.item.length;a++){var e=c.item[a].text;if((e)&&(e.toLowerCase().search(f)!=-1)){return true}if(c.item[a].item&&this.findStrInJSON(c.item[a],d,f)){return true}}return false};dhtmlXTreeObject.prototype._findNodeByLabel=function(a,f,e){var a=a.replace(new RegExp("^( )+"),"").replace(new RegExp("( )+$"),"");a=new RegExp(a.replace(/([\^\.\?\*\+\\\[\]\(\)]{1})/gi,"\\$1").replace(/ /gi,".*"),"gi");if(!e){e=this._selected[0];if(!e){e=this.htmlNode}}var c=e;if(!f){if((e.unParsed)&&(this.findStrInXML(e.unParsed.d,"text",a))){this.reParse(e)}e=this._getNextNode(c);if(e==-1){e=this.htmlNode.childNodes[0]}}else{var d=this._getPrevNode(c);if(d==-1){d=this._lastChild(this.htmlNode)}if((d.unParsed)&&(this.findStrInXML(d.unParsed.d,"text",a))){this.reParse(d);e=this._getPrevNode(c)}else{e=d}if(e==-1){e=this._lastChild(this.htmlNode)}}while((e)&&(e!=c)){if((e.label)&&(e.label.search(a)!=-1)){return(e)}if(!f){if(e==-1){if(c==this.htmlNode){break}e=this.htmlNode.childNodes[0]}if((e.unParsed)&&(this.findStrInXML(e.unParsed.d,"text",a))){this.reParse(e)}e=this._getNextNode(e);if(e==-1){e=this.htmlNode}}else{var d=this._getPrevNode(e);if(d==-1){d=this._lastChild(this.htmlNode)}if((d.unParsed)&&(this.findStrInXML(d.unParsed.d,"text",a))){this.reParse(d);e=this._getPrevNode(e)}else{e=d}if(e==-1){e=this._lastChild(this.htmlNode)}}}return null};dhtmlXTreeObject.prototype.moveItem=function(k,c,l,a){var f=this._globalIdStorageFind(k);if(!f){return(0)}var g=null;switch(c){case"right":alert("Not supported yet");break;case"item_child":var d=(a||this)._globalIdStorageFind(l);if(!d){return(0)}g=(a||this)._moveNodeTo(f,d,0);break;case"item_sibling":var d=(a||this)._globalIdStorageFind(l);if(!d){return(0)}g=(a||this)._moveNodeTo(f,d.parentObject,d);break;case"item_sibling_next":var d=(a||this)._globalIdStorageFind(l);if(!d){return(0)}if((d.tr)&&(d.tr.nextSibling)&&(d.tr.nextSibling.nodem)){g=(a||this)._moveNodeTo(f,d.parentObject,d.tr.nextSibling.nodem)}else{g=(a||this)._moveNodeTo(f,d.parentObject)}break;case"left":if(f.parentObject.parentObject){g=this._moveNodeTo(f,f.parentObject.parentObject,f.parentObject)}break;case"up":var h=this._getPrevNode(f);if((h==-1)||(!h.parentObject)){return null}g=this._moveNodeTo(f,h.parentObject,h);break;case"up_strict":var h=this._getIndex(f);if(h!=0){g=this._moveNodeTo(f,f.parentObject,f.parentObject.childNodes[h-1])}break;case"down_strict":var h=this._getIndex(f);var e=f.parentObject.childsCount-2;if(h==e){g=this._moveNodeTo(f,f.parentObject)}else{if(h<e){g=this._moveNodeTo(f,f.parentObject,f.parentObject.childNodes[h+2])}}break;case"down":var h=this._getNextNode(this._lastChild(f));if((h==-1)||(!h.parentObject)){return}if(h.parentObject==f.parentObject){var h=this._getNextNode(h)}if(h==-1){g=this._moveNodeTo(f,f.parentObject)}else{if((h==-1)||(!h.parentObject)){return}g=this._moveNodeTo(f,h.parentObject,h)}break}if(_isIE&&_isIE<8){this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0"}return g};dhtmlXTreeObject.prototype.setDragBehavior=function(c,a){this._sADnD=(!convertStringToBoolean(a));switch(c){case"child":this.dadmode=0;break;case"sibling":this.dadmode=1;break;case"complex":this.dadmode=2;break}};dhtmlXTreeObject.prototype._loadDynXML=function(d,c){c=c||this.XMLsource;var a=(new Date()).valueOf();this._ld_id=d;if(this.xmlalb=="function"){if(c){c(this._escape(d))}}else{if(this.xmlalb=="name"){this.loadXML(c+this._escape(d))}else{if(this.xmlalb=="xmlname"){this.loadXML(c+this._escape(d)+".xml?uid="+a)}else{this.loadXML(c+getUrlSymbol(c)+"uid="+a+"&id="+this._escape(d))}}}};dhtmlXTreeObject.prototype.enableMultiselection=function(c,a){this._amsel=convertStringToBoolean(c);this._amselS=convertStringToBoolean(a)};dhtmlXTreeObject.prototype._checkMSelectionLogic=function(){var d=new Array();for(var c=0;c<this._selected.length;c++){for(var a=0;a<this._selected.length;a++){if((c!=a)&&(this._checkPNodes(this._selected[a],this._selected[c]))){d[d.length]=this._selected[a]}}}for(var c=0;c<d.length;c++){this._unselectItem(d[c])}};dhtmlXTreeObject.prototype._checkPNodes=function(c,a){if(this._dcheckf){return false}if(a==c){return 1}if(c.parentObject){return this._checkPNodes(c.parentObject,a)}else{return 0}};dhtmlXTreeObject.prototype.disableDropCheck=function(a){this._dcheckf=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.enableDistributedParsing=function(d,c,a){this._edsbps=convertStringToBoolean(d);this._edsbpsA=new Array();this._edsbpsC=c||10;this._edsbpsD=a||250};dhtmlXTreeObject.prototype.getDistributedParsingState=function(){return(!((!this._edsbpsA)||(!this._edsbpsA.length)))};dhtmlXTreeObject.prototype.getItemParsingState=function(d){var c=this._globalIdStorageFind(d,true,true);if(!c){return 0}if(this._edsbpsA){for(var a=0;a<this._edsbpsA.length;a++){if(this._edsbpsA[a][2]==d){return -1}}}return 1};dhtmlXTreeObject.prototype._distributedStart=function(c,f,e,d,a){if(!this._edsbpsA){this._edsbpsA=new Array()}this._edsbpsA[this._edsbpsA.length]=[c,f,e,d,a]};dhtmlXTreeObject.prototype._distributedStep=function(e){var c=this;if((!this._edsbpsA)||(!this._edsbpsA.length)){c.XMLloadingWarning=0;return}var f=this._edsbpsA[0];this.parsedArray=new Array();this._parse(f[0],f[2],f[3],f[1]);var a=this._globalIdStorageFind(f[2]);this._redrawFrom(this,a,f[4],this._getOpenState(a));var d=this.setCheckList.split(this.dlmtr);for(var g=0;g<d.length;g++){if(d[g]){this.setCheck(d[g],1)}}this._edsbpsA=(new Array()).concat(this._edsbpsA.slice(1));if((!this._edsbpsA.length)){window.setTimeout(function(){if(c.onXLE){c.onXLE(c,e)}c.callEvent("onXLE",[c,e])},1);c.xmlstate=0}};dhtmlXTreeObject.prototype.enableTextSigns=function(a){this._txtimg=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.preventIECaching=function(a){this.no_cashe=convertStringToBoolean(a);this.XMLLoader.rSeed=this.no_cashe};dhtmlXTreeObject.prototype.preventIECashing=dhtmlXTreeObject.prototype.preventIECaching;dhtmlXTreeObject.prototype.disableCheckbox=function(d,c){if(typeof(d)!="object"){var a=this._globalIdStorageFind(d,0,1)}else{var a=d}if(!a){return}a.dscheck=convertStringToBoolean(c)?(((a.checkstate||0)%3)+3):((a.checkstate>2)?(a.checkstate-3):a.checkstate);this._setCheck(a);if(a.dscheck<3){a.dscheck=false}};dhtmlXTreeObject.prototype.smartRefreshBranch=function(c,a){this._branchUpdate=1;this.smartRefreshItem(c,a)};dhtmlXTreeObject.prototype.smartRefreshItem=function(e,d){var a=this._globalIdStorageFind(e);for(var c=0;c<a.childsCount;c++){a.childNodes[c]._dmark=true}this.waitUpdateXML=true;if(d&&d.exists){this._parse(d,e)}else{this._loadDynXML(e,d)}};dhtmlXTreeObject.prototype.refreshItems=function(c,d){var e=c.toString().split(this.dlmtr);this.waitUpdateXML=new Array();for(var a=0;a<e.length;a++){this.waitUpdateXML[e[a]]=true}this.loadXML((d||this.XMLsource)+getUrlSymbol(d||this.XMLsource)+"ids="+this._escape(c))};dhtmlXTreeObject.prototype.updateItem=function(h,g,e,d,c,f,k){var a=this._globalIdStorageFind(h);a.userData=new cObject();if(g){a.label=g}a.images=new Array(e||this.imageArray[0],d||this.imageArray[1],c||this.imageArray[2]);this.setItemText(h,g);if(f){this._setCheck(a,true)}if(k=="1"&&!this.hasChildren(h)){a.XMLload=0}this._correctPlus(a);a._dmark=false;return a};dhtmlXTreeObject.prototype.setDropHandler=function(a){this.attachEvent("onDrop",a)};dhtmlXTreeObject.prototype.setOnLoadingStart=function(a){this.attachEvent("onXLS",a)};dhtmlXTreeObject.prototype.setOnLoadingEnd=function(a){this.attachEvent("onXLE",a)};dhtmlXTreeObject.prototype.setXMLAutoLoadingBehaviour=function(a){this.xmlalb=a};dhtmlXTreeObject.prototype.enableSmartCheckboxes=function(a){this.smcheck=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.getXMLState=function(){return(this.xmlstate==1)};dhtmlXTreeObject.prototype.setItemTopOffset=function(g,e){var d;if(typeof(g)!="object"){d=this._globalIdStorageFind(g)}else{d=g}var f=d.span.parentNode.parentNode;d.span.style.paddingBottom="1px";for(var c=0;c<f.childNodes.length;c++){if(c!=0){if(_isIE){f.childNodes[c].style.height="18px";f.childNodes[c].style.paddingTop=parseInt(e)+"px"}else{f.childNodes[c].style.height=18+parseInt(e)+"px"}}else{var a=f.childNodes[c].firstChild;if(f.childNodes[c].firstChild.tagName!="DIV"){a=document.createElement("DIV");f.childNodes[c].insertBefore(a,f.childNodes[c].firstChild)}a.style.height=parseInt(e)+"px";if((d.parentObject.id!=this.rootId||d.parentObject.childNodes[0]!=d)&&this.treeLinesOn){a.style.backgroundImage="url("+this.imPath+this.lineArray[5]+")"}a.innerHTML="&nbsp;";a.style.overflow="hidden";if(parseInt(e)==0){f.childNodes[c].removeChild(a)}}if(!_isIE){f.childNodes[c].style.verticalAlign="bottom"}if(_isIE){this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0"}}};dhtmlXTreeObject.prototype.setIconSize=function(e,c,f){if(f){if((f)&&(f.span)){var a=f}else{var a=this._globalIdStorageFind(f)}if(!a){return(0)}var d=a.span.parentNode.previousSibling.childNodes[0];if(e){d.style.width=e;if(window._KHTMLrv){d.parentNode.style.width=e}}if(c){d.style.height=c;if(window._KHTMLrv){d.parentNode.style.height=c}}}else{this.def_img_x=e;this.def_img_y=c}};dhtmlXTreeObject.prototype.getItemImage=function(f,e,c){var d=this._globalIdStorageFind(f);if(!d){return""}var a=d.images[e||0];if(c){a=this.iconURL+a}return a};dhtmlXTreeObject.prototype.enableRadioButtons=function(e,d){if(arguments.length==1){this._frbtr=convertStringToBoolean(e);this.checkBoxOff=this.checkBoxOff||this._frbtr;return}var c=this._globalIdStorageFind(e);if(!c){return""}d=convertStringToBoolean(d);if((d)&&(!c._r_logic)){c._r_logic=true;for(var a=0;a<c.childsCount;a++){this._setCheck(c.childNodes[a],c.childNodes[a].checkstate)}}if((!d)&&(c._r_logic)){c._r_logic=false;for(var a=0;a<c.childsCount;a++){this._setCheck(c.childNodes[a],c.childNodes[a].checkstate)}}};dhtmlXTreeObject.prototype.enableSingleRadioMode=function(a){this._frbtrs=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.openOnItemAdded=function(a){this._hAdI=!convertStringToBoolean(a)};dhtmlXTreeObject.prototype.openOnItemAdding=function(a){this._hAdI=!convertStringToBoolean(a)};dhtmlXTreeObject.prototype.enableMultiLineItems=function(a){if(a===true){this.mlitems="100%"}else{this.mlitems=a}};dhtmlXTreeObject.prototype.enableAutoTooltips=function(a){this.ettip=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.clearSelection=function(a){if(a){this._unselectItem(this._globalIdStorageFind(a))}else{this._unselectItems()}};dhtmlXTreeObject.prototype.showItemSign=function(e,c){var a=this._globalIdStorageFind(e);if(!a){return 0}var d=a.span.parentNode.previousSibling.previousSibling.previousSibling;if(!convertStringToBoolean(c)){this._openItem(a);a.closeble=false;a.wsign=true}else{a.closeble=true;a.wsign=false}this._correctPlus(a)};dhtmlXTreeObject.prototype.showItemCheckbox=function(f,e){if(!f){for(var c in this._idpull){this.showItemCheckbox(this._idpull[c],e)}}if(typeof(f)!="object"){f=this._globalIdStorageFind(f,0,0)}if(!f){return 0}f.nocheckbox=!convertStringToBoolean(e);var d=f.span.parentNode.previousSibling.previousSibling.childNodes[0];d.parentNode.style.display=(!f.nocheckbox)?"":"none"};dhtmlXTreeObject.prototype.setListDelimeter=function(a){this.dlmtr=a};dhtmlXTreeObject.prototype.setEscapingMode=function(a){this.utfesc=a};dhtmlXTreeObject.prototype.enableHighlighting=function(a){this.ehlt=true;this.ehlta=convertStringToBoolean(a)};dhtmlXTreeObject.prototype._itemMouseOut=function(){var c=this.childNodes[3].parentObject;var a=c.treeNod;a.callEvent("onMouseOut",[c.id]);if(c.id==a._l_onMSI){a._l_onMSI=null}if(!a.ehlta){return}c.span.className=c.span.className.replace("_lor","")};dhtmlXTreeObject.prototype._itemMouseIn=function(){var c=this.childNodes[3].parentObject;var a=c.treeNod;if(a._l_onMSI!=c.id){a.callEvent("onMouseIn",[c.id])}a._l_onMSI=c.id;if(!a.ehlta){return}c.span.className=c.span.className.replace("_lor","");c.span.className=c.span.className.replace(/((standart|selected)TreeRow)/,"$1_lor")};dhtmlXTreeObject.prototype.enableActiveImages=function(a){this._aimgs=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.focusItem=function(c){var a=this._globalIdStorageFind(c);if(!a){return(0)}this._focusNode(a)};dhtmlXTreeObject.prototype.getAllSubItems=function(a){return this._getAllSubItems(a)};dhtmlXTreeObject.prototype.getAllChildless=function(){return this._getAllScraggyItems(this.htmlNode)};dhtmlXTreeObject.prototype.getAllLeafs=dhtmlXTreeObject.prototype.getAllChildless;dhtmlXTreeObject.prototype._getAllScraggyItems=function(d){var e="";for(var c=0;c<d.childsCount;c++){if((d.childNodes[c].unParsed)||(d.childNodes[c].childsCount>0)){if(d.childNodes[c].unParsed){var a=this._getAllScraggyItemsXML(d.childNodes[c].unParsed,1)}else{var a=this._getAllScraggyItems(d.childNodes[c])}if(a){if(e){e+=this.dlmtr+a}else{e=a}}}else{if(!e){e=""+d.childNodes[c].id}else{e+=this.dlmtr+d.childNodes[c].id}}}return e};dhtmlXTreeObject.prototype._getAllFatItems=function(d){var e="";for(var c=0;c<d.childsCount;c++){if((d.childNodes[c].unParsed)||(d.childNodes[c].childsCount>0)){if(!e){e=""+d.childNodes[c].id}else{e+=this.dlmtr+d.childNodes[c].id}if(d.childNodes[c].unParsed){var a=this._getAllFatItemsXML(d.childNodes[c].unParsed,1)}else{var a=this._getAllFatItems(d.childNodes[c])}if(a){e+=this.dlmtr+a}}}return e};dhtmlXTreeObject.prototype.getAllItemsWithKids=function(){return this._getAllFatItems(this.htmlNode)};dhtmlXTreeObject.prototype.getAllFatItems=dhtmlXTreeObject.prototype.getAllItemsWithKids;dhtmlXTreeObject.prototype.getAllChecked=function(){return this._getAllChecked("","",1)};dhtmlXTreeObject.prototype.getAllUnchecked=function(a){if(a){a=this._globalIdStorageFind(a)}return this._getAllChecked(a,"",0)};dhtmlXTreeObject.prototype.getAllPartiallyChecked=function(){return this._getAllChecked("","",2)};dhtmlXTreeObject.prototype.getAllCheckedBranches=function(){var a=[this._getAllChecked("","",1)];var c=this._getAllChecked("","",2);if(c){a.push(c)}return a.join(this.dlmtr)};dhtmlXTreeObject.prototype._getAllChecked=function(e,d,f){if(!e){e=this.htmlNode}if(e.checkstate==f){if(!e.nocheckbox){if(d){d+=this.dlmtr+e.id}else{d=""+e.id}}}var a=e.childsCount;for(var c=0;c<a;c++){d=this._getAllChecked(e.childNodes[c],d,f)}if(e.unParsed){d=this._getAllCheckedXML(e.unParsed,d,f)}if(d){return d}else{return""}};dhtmlXTreeObject.prototype.setItemStyle=function(e,d,c){var c=c||false;var a=this._globalIdStorageFind(e);if(!a){return 0}if(!a.span.style.cssText){a.span.setAttribute("style",a.span.getAttribute("style")+"; "+d)}else{a.span.style.cssText=c?d:a.span.style.cssText+";"+d}};dhtmlXTreeObject.prototype.enableImageDrag=function(a){this._itim_dg=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.setOnDragIn=function(a){this.attachEvent("onDragIn",a)};dhtmlXTreeObject.prototype.enableDragAndDropScrolling=function(a){this.autoScroll=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.setSkin=function(a){var c=this.parentObject.className.replace(/dhxtree_[^ ]*/gi,"");this.parentObject.className=c+" dhxtree_"+a;if(a=="dhx_terrace"||a=="dhx_web"){this.enableTreeLines(false)}};(function(){dhtmlx.extend_api("dhtmlXTreeObject",{_init:function(a){return[a.parent,(a.width||"100%"),(a.height||"100%"),(a.root_id||0)]},auto_save_selection:"enableAutoSavingSelected",auto_tooltip:"enableAutoTooltips",checkbox:"enableCheckBoxes",checkbox_3_state:"enableThreeStateCheckboxes",checkbox_smart:"enableSmartCheckboxes",context_menu:"enableContextMenu",distributed_parsing:"enableDistributedParsing",drag:"enableDragAndDrop",drag_copy:"enableMercyDrag",drag_image:"enableImageDrag",drag_scroll:"enableDragAndDropScrolling",editor:"enableItemEditor",hover:"enableHighlighting",images:"enableTreeImages",image_fix:"enableIEImageFix",image_path:"setImagePath",lines:"enableTreeLines",loading_item:"enableLoadingItem",multiline:"enableMultiLineItems",multiselect:"enableMultiselection",navigation:"enableKeyboardNavigation",radio:"enableRadioButtons",radio_single:"enableSingleRadioMode",rtl:"enableRTL",search:"enableKeySearch",smart_parsing:"enableSmartXMLParsing",smart_rendering:"enableSmartRendering",text_icons:"enableTextSigns",xml:"loadXML",skin:"setSkin"},{})})();dhtmlXTreeObject.prototype._dp_init=function(a){a.attachEvent("insertCallback",function(e,g,c){var d=this._loader.doXPath(".//item",e);var f=d[0].getAttribute("text");this.obj.insertNewItem(c,g,f,0,0,0,0,"CHILD")});a.attachEvent("updateCallback",function(e,g,c){var d=this._loader.doXPath(".//item",e);var f=d[0].getAttribute("text");this.obj.setItemText(g,f);if(this.obj.getParentId(g)!=c){this.obj.moveItem(g,"item_child",c)}this.setUpdated(g,true,"updated")});a.attachEvent("deleteCallback",function(d,e,c){this.obj.setUserData(e,this.action_param,"true_deleted");this.obj.deleteItem(e,false)});a._methods=["setItemStyle","","changeItemId","deleteItem"];this.attachEvent("onEdit",function(c,d){if(c==3){a.setUpdated(d,true)}return true});this.attachEvent("onDrop",function(g,f,e,d,c){if(d==c){a.setUpdated(g,true)}});this._onrdlh=function(c){var d=a.getState(c);if(d=="inserted"){a.set_invalid(c,false);a.setUpdated(c,false);return true}if(d=="true_deleted"){a.setUpdated(c,false);return true}a.setUpdated(c,true,"deleted");return false};this._onradh=function(c){a.setUpdated(c,true,"inserted")};a._getRowData=function(f){var e={};var g=this.obj._globalIdStorageFind(f);var d=g.parentObject;var c=0;for(c=0;c<d.childsCount;c++){if(d.childNodes[c]==g){break}}e.tr_id=g.id;e.tr_pid=d.id;e.tr_order=c;e.tr_text=g.span.innerHTML;d=(g._userdatalist||"").split(",");for(c=0;c<d.length;c++){e[d[c]]=g.userData["t_"+d[c]]}return e}};dhtmlXTreeObject.prototype.makeDraggable=function(c,a){if(typeof(c)!="object"){c=document.getElementById(c)}dragger=new dhtmlDragAndDropObject();dropper=new dhx_dragSomethingInTree();dragger.addDraggableItem(c,dropper);c.dragLanding=null;c.ondragstart=dropper._preventNsDrag;c.onselectstart=new Function("return false;");c.parentObject=new Object;c.parentObject.img=c;c.parentObject.treeNod=dropper;dropper._customDrop=a};dhtmlXTreeObject.prototype.makeDragable=dhtmlXTreeObject.prototype.makeDraggable;dhtmlXTreeObject.prototype.makeAllDraggable=function(c){var d=document.getElementsByTagName("div");for(var a=0;a<d.length;a++){if(d[a].getAttribute("dragInDhtmlXTree")){this.makeDragable(d[a],c)}}};function dhx_dragSomethingInTree(){this.lWin=window;this._createDragNode=function(c){var a=document.createElement("div");a.style.position="absolute";a.innerHTML=(c.innerHTML||c.value);a.className="dragSpanDiv";return a};this._preventNsDrag=function(a){(a||window.event).cancelBubble=true;if((a)&&(a.preventDefault)){a.preventDefault();return false}return false};this._nonTrivialNode=function(c,d,a,e){if(this._customDrop){return this._customDrop(c,e.img.id,d.id,a?a.id:null)}var f=(e.img.getAttribute("image")||"");var h=e.img.id||"new";var g=(e.img.getAttribute("text")||(_isIE?e.img.innerText:e.img.textContent));c[a?"insertNewNext":"insertNewItem"](a?a.id:d.id,h,g,"",f,f,f)}}dhtmlXTreeObject.prototype.enableItemEditor=function(a){this._eItEd=convertStringToBoolean(a);if(!this._eItEdFlag){this._edn_click_IE=true;this._edn_dblclick=true;this._ie_aFunc=this.aFunc;this._ie_dblclickFuncHandler=this.dblclickFuncHandler;this.setOnDblClickHandler(function(d,c){if(this._edn_dblclick){this._editItem(d,c)}return true});this.setOnClickHandler(function(d,c){this._stopEditItem(d,c);if((this.ed_hist_clcik==d)&&(this._edn_click_IE)){this._editItem(d,c)}this.ed_hist_clcik=d;return true});this._eItEdFlag=true}};dhtmlXTreeObject.prototype.setOnEditHandler=function(a){this.attachEvent("onEdit",a)};dhtmlXTreeObject.prototype.setEditStartAction=function(a,c){this._edn_click_IE=convertStringToBoolean(a);this._edn_dblclick=convertStringToBoolean(c)};dhtmlXTreeObject.prototype._stopEdit=function(c,g){if(this._editCell){this.dADTempOff=this.dADTempOffEd;if(this._editCell.id!=c){var e=true;if(!g){e=this.callEvent("onEdit",[2,this._editCell.id,this,this._editCell.span.childNodes[0].value])}else{e=false;this.callEvent("onEditCancel",[this._editCell.id,this._editCell._oldValue])}if(e===true){e=this._editCell.span.childNodes[0].value}else{if(e===false){e=this._editCell._oldValue}}var f=(e!=this._editCell._oldValue);this._editCell.span.innerHTML=e;this._editCell.label=this._editCell.span.innerHTML;var d=this._editCell.i_sel?"selectedTreeRow":"standartTreeRow";this._editCell.span.className=d;this._editCell.span.parentNode.className="standartTreeRow";this._editCell.span.style.paddingRight=this._editCell.span.style.paddingLeft="5px";this._editCell.span.onclick=this._editCell.span.ondblclick=function(){};var h=this._editCell.id;if(this.childCalc){this._fixChildCountLabel(this._editCell)}this._editCell=null;if(!g){this.callEvent("onEdit",[3,h,this,f])}if(this._enblkbrd){this.parentObject.lastChild.focus();this.parentObject.lastChild.focus()}}}};dhtmlXTreeObject.prototype._stopEditItem=function(c,a){this._stopEdit(c)};dhtmlXTreeObject.prototype.stopEdit=function(a){if(this._editCell){this._stopEdit(this._editCell.id+"_non",a)}};dhtmlXTreeObject.prototype.editItem=function(a){this._editItem(a,this)};dhtmlXTreeObject.prototype._editItem=function(f,a){if(this._eItEd){this._stopEdit();var d=this._globalIdStorageFind(f);if(!d){return}var e=this.callEvent("onEdit",[0,f,this,d.span.innerHTML]);if(e===true){e=(typeof d.span.innerText!="undefined"?d.span.innerText:d.span.textContent)}else{if(e===false){return}}this.dADTempOffEd=this.dADTempOff;this.dADTempOff=false;this._editCell=d;d._oldValue=e;d.span.innerHTML="<input type='text' class='intreeeditRow' />";d.span.style.paddingRight=d.span.style.paddingLeft="0px";d.span.onclick=d.span.ondblclick=function(g){(g||event).cancelBubble=true};d.span.childNodes[0].value=e;d.span.childNodes[0].onselectstart=function(g){(g||event).cancelBubble=true;return true};d.span.childNodes[0].onmousedown=function(g){(g||event).cancelBubble=true;return true};d.span.childNodes[0].focus();d.span.childNodes[0].focus();d.span.onclick=function(g){(g||event).cancelBubble=true;return false};d.span.className="";d.span.parentNode.className="";var c=this;d.span.childNodes[0].onkeydown=function(g){if(!g){g=window.event}if(g.keyCode==13){g.cancelBubble=true;c._stopEdit(window.undefined)}else{if(g.keyCode==27){c._stopEdit(window.undefined,true)}}(g||event).cancelBubble=true};this.callEvent("onEdit",[1,f,this])}};function jsonPointer(c,a){this.d=c;this.dp=a}jsonPointer.prototype={text:function(){var a=function(f){var e=[];for(var d=0;d<f.length;d++){e.push("{"+c(f[d])+"}")}return e.join(",")};var c=function(f){var e=[];for(var d in f){if(typeof(f[d])=="object"){if(d.length){e.push('"'+d+'":['+a(f[d])+"]")}else{e.push('"'+d+'":{'+c(f[d])+"}")}}else{e.push('"'+d+'":"'+f[d]+'"')}}return e.join(",")};return"{"+c(this.d)+"}"},get:function(a){return this.d[a]},exists:function(){return !!this.d},content:function(){return this.d.content},each:function(e,k,h){var d=this.d[e];var l=new jsonPointer();if(d){for(var g=0;g<d.length;g++){l.d=d[g];k.apply(h,[l,g])}}},get_all:function(){return this.d},sub:function(a){return new jsonPointer(this.d[a],this.d)},sub_exists:function(a){return !!this.d[a]},each_x:function(e,l,k,h,g){var d=this.d[e];var m=new jsonPointer(0,this.d);if(d){for(g=g||0;g<d.length;g++){if(d[g][l]){m.d=d[g];if(k.apply(h,[m,g])==-1){return}}}}},up:function(a){return new jsonPointer(this.dp,this.d)},set:function(a,c){this.d[a]=c},clone:function(a){return new jsonPointer(this.d,this.dp)},through:function(d,k,n,g,o){var l=this.d[d];if(l.length){for(var e=0;e<l.length;e++){if(l[e][k]!=null&&l[e][k]!=""&&(!n||l[e][k]==n)){var h=new jsonPointer(l[e],this.d);g.apply(o,[h,e])}var m=this.d;this.d=l[e];if(this.sub_exists(d)){this.through(d,k,n,g,o)}this.d=m}}}};dhtmlXTreeObject.prototype.loadJSArrayFile=function(file,afterCall){if(!this.parsCount){this.callEvent("onXLS",[this,this._ld_id])}this._ld_id=null;this.xmlstate=1;var that=this;this.XMLLoader=new dtmlXMLLoaderObject(function(){eval("var z="+arguments[4].xmlDoc.responseText);that.loadJSArray(z)},this,true,this.no_cashe);if(afterCall){this.XMLLoader.waitCall=afterCall}this.XMLLoader.loadXML(file)};dhtmlXTreeObject.prototype.loadCSV=function(a,d){if(!this.parsCount){this.callEvent("onXLS",[this,this._ld_id])}this._ld_id=null;this.xmlstate=1;var c=this;this.XMLLoader=new dtmlXMLLoaderObject(function(){c.loadCSVString(arguments[4].xmlDoc.responseText)},this,true,this.no_cashe);if(d){this.XMLLoader.waitCall=d}this.XMLLoader.loadXML(a)};dhtmlXTreeObject.prototype.loadJSArray=function(a,e){var h=[];for(var c=0;c<a.length;c++){if(!h[a[c][1]]){h[a[c][1]]=[]}h[a[c][1]].push({id:a[c][0],text:a[c][2]})}var g={id:this.rootId};var d=function(m,l){if(h[m.id]){m.item=h[m.id];for(var k=0;k<m.item.length;k++){l(m.item[k],l)}}};d(g,d);this.loadJSONObject(g,e)};dhtmlXTreeObject.prototype.loadCSVString=function(a,h){var l=[];var c=a.split("\n");for(var e=0;e<c.length;e++){var d=c[e].split(",");if(!l[d[1]]){l[d[1]]=[]}l[d[1]].push({id:d[0],text:d[2]})}var k={id:this.rootId};var g=function(o,n){if(l[o.id]){o.item=l[o.id];for(var m=0;m<o.item.length;m++){n(o.item[m],n)}}};g(k,g);this.loadJSONObject(k,h)};dhtmlXTreeObject.prototype.loadJSONObject=function(a,c){if(!this.parsCount){this.callEvent("onXLS",[this,null])}this.xmlstate=1;var d=new jsonPointer(a);this._parse(d);this._p=d;if(c){c()}};dhtmlXTreeObject.prototype.loadJSON=function(file,afterCall){if(!this.parsCount){this.callEvent("onXLS",[this,this._ld_id])}this._ld_id=null;this.xmlstate=1;var that=this;this.XMLLoader=new dtmlXMLLoaderObject(function(){try{eval("var t="+arguments[4].xmlDoc.responseText)}catch(e){dhtmlxError.throwError("LoadXML","Incorrect JSON",[(arguments[4].xmlDoc),this]);return}var p=new jsonPointer(t);that._parse(p);that._p=p},this,true,this.no_cashe);if(afterCall){this.XMLLoader.waitCall=afterCall}this.XMLLoader.loadXML(file)};dhtmlXTreeObject.prototype.serializeTreeToJSON=function(){var a=['{"id":"'+this.rootId+'", "item":['];var d=[];for(var c=0;c<this.htmlNode.childsCount;c++){d.push(this._serializeItemJSON(this.htmlNode.childNodes[c]))}a.push(d.join(","));a.push("]}");return a.join("")};dhtmlXTreeObject.prototype._serializeItemJSON=function(h){var a=[];if(h.unParsed){return(h.unParsed.text())}if(this._selected.length){var d=this._selected[0].id}else{d=""}var g=h.span.innerHTML;g=g.replace(/\"/g,'\\"',g);if(!this._xfullXML){a.push('{ "id":"'+h.id+'", '+(this._getOpenState(h)==1?' "open":"1", ':"")+(d==h.id?' "select":"1",':"")+' "text":"'+g+'"'+(((this.XMLsource)&&(h.XMLload==0))?', "child":"1" ':""))}else{a.push('{ "id":"'+h.id+'", '+(this._getOpenState(h)==1?' "open":"1", ':"")+(d==h.id?' "select":"1",':"")+' "text":"'+g+'", "im0":"'+h.images[0]+'", "im1":"'+h.images[1]+'", "im2":"'+h.images[2]+'" '+(h.acolor?(', "aCol":"'+h.acolor+'" '):"")+(h.scolor?(', "sCol":"'+h.scolor+'" '):"")+(h.checkstate==1?', "checked":"1" ':(h.checkstate==2?', "checked":"-1"':""))+(h.closeable?', "closeable":"1" ':"")+(((this.XMLsource)&&(h.XMLload==0))?', "child":"1" ':""))}if((this._xuserData)&&(h._userdatalist)){a.push(', "userdata":[');var f=h._userdatalist.split(",");var e=[];for(var c=0;c<f.length;c++){e.push('{ "name":"'+f[c]+'" , "content":"'+h.userData["t_"+f[c]]+'" }')}a.push(e.join(","));a.push("]")}if(h.childsCount){a.push(', "item":[');var e=[];for(var c=0;c<h.childsCount;c++){e.push(this._serializeItemJSON(h.childNodes[c]))}a.push(e.join(","));a.push("]\n")}a.push("}\n");return a.join("")};function dhtmlXTreeFromHTML(obj){if(typeof(obj)!="object"){obj=document.getElementById(obj)}var n=obj;var id=n.id;var cont="";for(var j=0;j<obj.childNodes.length;j++){if(obj.childNodes[j].nodeType=="1"){if(obj.childNodes[j].tagName=="XMP"){var cHead=obj.childNodes[j];for(var m=0;m<cHead.childNodes.length;m++){cont+=cHead.childNodes[m].data}}else{if(obj.childNodes[j].tagName.toLowerCase()=="ul"){cont=dhx_li2trees(obj.childNodes[j],new Array(),0)}}break}}obj.innerHTML="";var t=new dhtmlXTreeObject(obj,"100%","100%",0);var z_all=new Array();for(b in t){z_all[b.toLowerCase()]=b}var atr=obj.attributes;for(var a=0;a<atr.length;a++){if((atr[a].name.indexOf("set")==0)||(atr[a].name.indexOf("enable")==0)){var an=atr[a].name;if(!t[an]){an=z_all[atr[a].name]}t[an].apply(t,atr[a].value.split(","))}}if(typeof(cont)=="object"){t.XMLloadingWarning=1;for(var i=0;i<cont.length;i++){var n=t.insertNewItem(cont[i][0],cont[i][3],cont[i][1]);if(cont[i][2]){t._setCheck(n,cont[i][2])}}t.XMLloadingWarning=0;t.lastLoadedXMLId=0;t._redrawFrom(t)}else{t.loadXMLString("<tree id='0'>"+cont+"</tree>")}window[id]=t;var oninit=obj.getAttribute("oninit");if(oninit){eval(oninit)}return t}function dhx_init_trees(){var c=document.getElementsByTagName("div");for(var a=0;a<c.length;a++){if(c[a].className=="dhtmlxTree"){dhtmlXTreeFromHTML(c[a])}}}function dhx_li2trees(n,g,d){for(var h=0;h<n.childNodes.length;h++){var m=n.childNodes[h];if((m.nodeType==1)&&(m.tagName.toLowerCase()=="li")){var l="";var k=null;var a=m.getAttribute("checked");for(var f=0;f<m.childNodes.length;f++){var e=m.childNodes[f];if(e.nodeType==3){l+=e.data}else{if(e.tagName.toLowerCase()!="ul"){l+=dhx_outer_html(e)}else{k=e}}}g[g.length]=[d,l,a,(m.id||(g.length+1))];if(k){g=dhx_li2trees(k,g,(m.id||g.length))}}}return g}function dhx_outer_html(c){if(c.outerHTML){return c.outerHTML}var a=document.createElement("DIV");a.appendChild(c.cloneNode(true));a=a.innerHTML;return a}if(window.addEventListener){window.addEventListener("load",dhx_init_trees,false)}else{if(window.attachEvent){window.attachEvent("onload",dhx_init_trees)}}dhtmlXTreeObject.prototype.parserExtension={_parseExtension:function(e,c,d){this._idpull[c.id]._attrs=c}};dhtmlXTreeObject.prototype.getAttribute=function(d,a){this._globalIdStorageFind(d);var c=this._idpull[d]._attrs;return c?c[a]:window.undefined};dhtmlXTreeObject.prototype.setAttribute=function(e,a,d){this._globalIdStorageFind(e);var c=(this._idpull[e]._attrs)||{};c[a]=d;this._idpull[e]._attrs=c};dhtmlXTreeObject.prototype.enableKeyboardNavigation=function(d){this._enblkbrd=convertStringToBoolean(d);if(this._enblkbrd){if(_isFF){var c=window.getComputedStyle(this.parentObject,null)["position"];if((c!="absolute")&&(c!="relative")){this.parentObject.style.position="relative"}}this._navKeys=[["up",38],["down",40],["open",39],["close",37],["call",13],["edit",113]];var a=this;var c=document.createElement("INPUT");c.className="a_dhx_hidden_input";c.autocomplete="off";if(window._KHTMLrv){c.style.color="white"}this.parentObject.appendChild(c);this.parentObject[_isOpera?"onkeypress":"onkeydown"]=function(f){if(a.callEvent("onKeyPress",[(f||window.event).keyCode,(f||window.event)])){return a._onKeyDown(f||window.event)}};this.parentObject.onclick=function(f){if(_isFF||_isIE){c.select()}if(window._KHTMLrv||_isOpera){c.focus()}}}else{this.parentObject.onkeydown=null}};dhtmlXTreeObject.prototype._onKeyDown=function(d){if(window.globalActiveDHTMLGridObject&&globalActiveDHTMLGridObject.isActive){return true}var a=this;for(var c=0;c<this._navKeys.length;c++){if(this._navKeys[c][1]==d.keyCode){this["_onkey_"+this._navKeys[c][0]].apply(this,[this.getSelectedItemId()]);if(d.preventDefault){d.preventDefault()}(d||event).cancelBubble=true;return false}}if(this._textSearch){return this._searchItemByKey(d)}return true};dhtmlXTreeObject.prototype._onkey_up=function(d){var a=this._globalIdStorageFind(d);if(!a){return}var c=this._getPrevVisibleNode(a);if(c.id==this.rootId){return}this.focusItem(c.id);this.selectItem(c.id,false)};dhtmlXTreeObject.prototype._onkey_down=function(d){var a=this._globalIdStorageFind(d);if(!a){return}var c=this._getNextVisibleNode(a);if(c.id==this.rootId){return}this.focusItem(c.id);this.selectItem(c.id,false)};dhtmlXTreeObject.prototype._onkey_open=function(a){this.openItem(a)};dhtmlXTreeObject.prototype._onkey_close=function(a){this.closeItem(a)};dhtmlXTreeObject.prototype._onkey_call=function(a){if(this.stopEdit){this.stopEdit();this.parentObject.lastChild.focus();this.parentObject.lastChild.focus();this.selectItem(a,true)}else{this.selectItem(this.getSelectedItemId(),true)}};dhtmlXTreeObject.prototype._onkey_edit=function(a){if(this.editItem){this.editItem(a)}};dhtmlXTreeObject.prototype._getNextVisibleNode=function(a,c){if((!c)&&(this._getOpenState(a)>0)){return a.childNodes[0]}if((a.tr)&&(a.tr.nextSibling)&&(a.tr.nextSibling.nodem)){return a.tr.nextSibling.nodem}if(a.parentObject){return this._getNextVisibleNode(a.parentObject,1)}return a};dhtmlXTreeObject.prototype._getPrevVisibleNode=function(a){if((a.tr)&&(a.tr.previousSibling)&&(a.tr.previousSibling.nodem)){return this._lastVisibleChild(a.tr.previousSibling.nodem)}if(a.parentObject){return a.parentObject}else{return a}};dhtmlXTreeObject.prototype._lastVisibleChild=function(a){if(this._getOpenState(a)>0){return this._lastVisibleChild(a.childNodes[a.childsCount-1])}else{return a}};dhtmlXTreeObject.prototype._searchItemByKey=function(c){if(c.keyCode==8){this._textSearchString="";return true}var a=String.fromCharCode(c.keyCode).toUpperCase();if(a.match(/[A-Z,a-z,0-9\ ]/)){this._textSearchString+=a;this._textSearchInProgress=true;if(!(this.getSelectedItemText()||"").match(RegExp("^"+this._textSearchString,"i"))){this.findItem(this._textSearchString,0)}this._textSearchInProgress=false;if(c.preventDefault){c.preventDefault()}(c||event).cancelBubble=true;return false}return true};dhtmlXTreeObject.prototype.assignKeys=function(a){this._navKeys=a};dhtmlXTreeObject.prototype.enableKeySearch=function(c){this._textSearch=convertStringToBoolean(c);if(!this._textSearch){return}this._textSearchString="";var a=this;this._markItem2=this._markItem;this._markItem=function(d){if(!a._textSearchInProgress){a._textSearchString=""}a._markItem2(d)}};dhtmlXTreeObject.prototype.enableLoadingItem=function(a){this.attachEvent("onXLS",this._showFakeItem);this.attachEvent("onXLE",this._hideFakeItem);this._tfi_text=a||"Loading..."};dhtmlXTreeObject.prototype._showFakeItem=function(a,d){if((d===null)||(this._globalIdStorageFind("fake_load_xml_"+d))){return}var c=this.XMLsource;this.XMLsource=null;this.insertNewItem(d,"fake_load_xml_"+d,this._tfi_text);this.XMLsource=c};dhtmlXTreeObject.prototype._hideFakeItem=function(a,c){if(c===null){return}this.deleteItem("fake_load_xml_"+c)};dhtmlXTreeObject.prototype.isLocked=function(a){if(!this._locker){this._init_lock()}return(this._locker[a]==true)};dhtmlXTreeObject.prototype._lockItem=function(a,f,c){if(!this._locker){this._init_lock()}if(f){if(this._locker[a.id]==true){return}this._locker[a.id]=true;a.bIm0=a.images[0];a.bIm1=a.images[1];a.bIm2=a.images[2];a.images[0]=this.lico0;a.images[1]=this.lico1;a.images[2]=this.lico2;var e=a.span.parentNode;var d=e.previousSibling;this.dragger.removeDraggableItem(e);this.dragger.removeDraggableItem(d)}else{if(this._locker[a.id]!=true){return}this._locker[a.id]=false;a.images[0]=a.bIm0;a.images[1]=a.bIm1;a.images[2]=a.bIm2;var e=a.span.parentNode;var d=e.previousSibling;this.dragger.addDraggableItem(e,this);this.dragger.addDraggableItem(d,this)}if(!c){this._correctPlus(a)}};dhtmlXTreeObject.prototype.lockItem=function(d,c){if(!this._locker){this._init_lock()}this._lockOn=false;var a=this._globalIdStorageFind(d);this._lockOn=true;this._lockItem(a,convertStringToBoolean(c))};dhtmlXTreeObject.prototype.setLockedIcons=function(d,c,a){if(!this._locker){this._init_lock()}this.lico0=d;this.lico1=c;this.lico2=a};dhtmlXTreeObject.prototype._init_lock=function(){this._locker=new Array();this._locker_count="0";this._lockOn=true;this._globalIdStorageFindA=this._globalIdStorageFind;this._globalIdStorageFind=this._lockIdFind;if(this._serializeItem){this._serializeItemA=this._serializeItem;this._serializeItem=this._serializeLockItem;this._serializeTreeA=this.serializeTree;this.serializeTree=this._serializeLockTree}this.setLockedIcons(this.imageArray[0],this.imageArray[1],this.imageArray[2])};dhtmlXTreeObject.prototype._lockIdFind=function(d,a,c){if(!this.skipLock){if((!c)&&(this._lockOn==true)&&(this._locker[d]==true)){return null}}return this._globalIdStorageFindA(d,a,c)};dhtmlXTreeObject.prototype._serializeLockItem=function(a){if(this._locker[a.id]==true){return""}return this._serializeItemA(a)};dhtmlXTreeObject.prototype._serializeLockTree=function(){var a=this._serializeTreeA();return a.replace(/<item[^>]+locked\=\"1\"[^>]+\/>/g,"")};dhtmlXTreeObject.prototype._moveNodeToA=dhtmlXTreeObject.prototype._moveNodeTo;dhtmlXTreeObject.prototype._moveNodeTo=function(a,d,c){if((d.treeNod.isLocked)&&(d.treeNod.isLocked(d.id))){return false}return this._moveNodeToA(a,d,c)};dhtmlXTreeObject.prototype.lockTree=function(a){if(convertStringToBoolean(a)){this._initTreeLocker()}else{if(this._TreeLocker){this._TreeLocker.parentNode.removeChild(this._TreeLocker);this._TreeLocker=null}}};dhtmlXTreeObject.prototype._initTreeLocker=function(a){if(this._TreeLocker){return}this.parentObject.style.overflow="hidden";if(this.parentObject.style.position!="absolute"){this.parentObject.style.position="relative"}var c=document.createElement("div");c.style.position="absolute";c.style.left="0px";c.style.top="0px";c.className="dhx_tree_opacity";c.style.width=this.allTree.offsetWidth+"px";c.style.backgroundColor="#FFFFFF";c.style.height=this.allTree.offsetHeight+"px";this._TreeLocker=c;this.parentObject.appendChild(this._TreeLocker)};dhtmlXTreeObject.prototype.enableRTL=function(c){var a=convertStringToBoolean(c);if(((a)&&(!this.rtlMode))||((!a)&&(this.rtlMode))){this.rtlMode=a;this._switchToRTL(this.rtlMode)}};dhtmlXTreeObject.prototype._switchToRTL=function(a){if(a){this.allTree.className=this._ltr_line=this.lineArray;this._ltr_min=this.minusArray;this._ltr_plus=this.plusArray;this.lineArray=new Array("line2_rtl.gif","line3_rtl.gif","line4_rtl.gif","blank.gif","blank.gif","line1_rtl.gif");this.minusArray=new Array("minus2_rtl.gif","minus3_rtl.gif","minus4_rtl.gif","minus.gif","minus5_rtl.gif");this.plusArray=new Array("plus2_rtl.gif","plus3_rtl.gif","plus4_rtl.gif","plus.gif","plus5_rtl.gif");this.allTree.className="containerTableStyleRTL"}else{this.allTree.className="containerTableStyle";this.lineArray=this._ltr_line;this.minusArray=this._ltr_min;this.plusArray=this._ltr_plus}if(this.htmlNode.childsCount){this._redrawFrom(this,this.htmlNode)}};dhtmlXTreeObject.prototype.sortTree=function(e,c,d){var a=this._globalIdStorageFind(e);if(!a){return false}this._reorderBranch(a,(c.toString().toLowerCase()=="asc"),convertStringToBoolean(d))};dhtmlXTreeObject.prototype.setCustomSortFunction=function(a){this._csfunca=a};dhtmlXTreeObject.prototype._reorderBranch=function(h,c,k){var a=[];var g=h.childsCount;if(!g){return}var f=h.childNodes[0].tr.parentNode;for(var e=0;e<g;e++){a[e]=h.childNodes[e];f.removeChild(a[e].tr)}var d=this;if(c==1){if(this._csfunca){a.sort(function(m,l){return d._csfunca(m.id,l.id)})}else{a.sort(function(m,l){return((m.span.innerHTML.toUpperCase()>l.span.innerHTML.toUpperCase())?1:((m.span.innerHTML.toUpperCase()==l.span.innerHTML.toUpperCase())?0:-1))})}}else{if(this._csfunca){a.sort(function(m,l){return d._csfunca(l.id,m.id)})}else{a.sort(function(m,l){return((m.span.innerHTML.toUpperCase()<l.span.innerHTML.toUpperCase())?1:((m.span.innerHTML.toUpperCase()==l.span.innerHTML.toUpperCase())?0:-1))})}}for(var e=0;e<g;e++){f.appendChild(a[e].tr);h.childNodes[e]=a[e];if((k)&&(a[e].unParsed)){a[e].unParsed.set("order",c?1:-1)}else{if((k)&&(a[e].childsCount)){this._reorderBranch(a[e],c,k)}}}for(var e=0;e<g;e++){this._correctPlus(a[e]);this._correctLine(a[e])}};dhtmlXTreeObject.prototype._reorderXMLBranch=function(g){var h=g.getAttribute("order");if(h=="none"){return}var c=(h==1);var f=g.childNodes.length;if(!f){return}var a=new Array();var d=0;for(var e=0;e<f;e++){if(g.childNodes[e].nodeType==1){a[d]=g.childNodes[e];d++}}for(var e=f-1;e!=0;e--){g.removeChild(g.childNodes[e])}if(c){a.sort(function(l,k){return((l.getAttribute("text")>k.getAttribute("text"))?1:((l.getAttribute("text")==k.getAttribute("text"))?0:-1))})}else{a.sort(function(l,k){return((l.getAttribute("text")<k.getAttribute("text"))?1:((l.getAttribute("text")==k.getAttribute("text"))?0:-1))})}for(var e=0;e<d;e++){a[e].setAttribute("order",h);g.appendChild(a[e])}g.setAttribute("order","none")};dhtmlXTreeObject.prototype._serEnts=[["&","&amp;"],["<","&lt;"],[">","&gt;"]];dhtmlXTreeObject.prototype.registerXMLEntity=function(a,c){this._serEnts[this._serEnts.length]=[a,c,new RegExp(a,"g")]};dhtmlXTreeObject.prototype.setSerializationLevel=function(a,c,f,g,d){this._xuserData=convertStringToBoolean(a);this._xfullXML=convertStringToBoolean(c);this._dtd=d;this._xescapeEntities=convertStringToBoolean(f);if(convertStringToBoolean(g)){this._apreUC="<![CDATA[";this._apstUC="]]>"}else{}for(var e=0;e<this._serEnts.length;e++){this._serEnts[e][2]=new RegExp(this._serEnts[e][0],"g")}};dhtmlXTreeObject.prototype.serializeTree=function(){if(this.stopEdit){this.stopEdit()}this._apreUC=this._apreUC||"";this._apstUC=this._apstUC||"";var a='<?xml version="1.0"?>';if(this._dtd){a+='<!DOCTYPE tree SYSTEM "'+this._dtd+'">'}a+='<tree id="'+this.rootId+'">';if((this._xuserData)&&(this._idpull[this.rootId]._userdatalist)){var d=this._idpull[this.rootId]._userdatalist.split(",");for(var c=0;c<d.length;c++){a+='<userdata name="'+d[c]+'">'+this._apreUC+this._idpull[this.rootId].userData["t_"+d[c]]+this._apstUC+"</userdata>"}}for(var c=0;c<this.htmlNode.childsCount;c++){a+=this._serializeItem(this.htmlNode.childNodes[c])}a+="</tree>";return a};dhtmlXTreeObject.prototype._serializeItem=function(h){if(h.unParsed){if(document.all){return h.unParsed.d.xml}else{var a=new XMLSerializer();return a.serializeToString(h.unParsed.d)}}var c="";if(this._selected.length){var e=this._selected[0].id}else{e='"'}var g=h.span.innerHTML;if(this._xescapeEntities){for(var d=0;d<this._serEnts.length;d++){g=g.replace(this._serEnts[d][2],this._serEnts[d][1])}}if(!this._xfullXML){c='<item id="'+h.id+'" '+(this._getOpenState(h)==1?' open="1" ':"")+(e==h.id?' select="1"':"")+' text="'+g+'"'+(((this.XMLsource)&&(h.XMLload==0))?' child="1" ':"")+">"}else{c='<item id="'+h.id+'" '+(this._getOpenState(h)==1?' open="1" ':"")+(e==h.id?' select="1"':"")+' text="'+g+'" im0="'+h.images[0]+'" im1="'+h.images[1]+'" im2="'+h.images[2]+'" '+(h.acolor?('aCol="'+h.acolor+'" '):"")+(h.scolor?('sCol="'+h.scolor+'" '):"")+(h.checkstate==1?'checked="1" ':(h.checkstate==2?'checked="-1"':""))+(h.closeable?'closeable="1" ':"")+(((this.XMLsource)&&(h.XMLload==0))?' child="1" ':"")+">"}if((this._xuserData)&&(h._userdatalist)){var f=h._userdatalist.split(",");for(var d=0;d<f.length;d++){c+='<userdata name="'+f[d]+'">'+this._apreUC+h.userData["t_"+f[d]]+this._apstUC+"</userdata>"}}for(var d=0;d<h.childsCount;d++){c+=this._serializeItem(h.childNodes[d])}c+="</item>";return c};dhtmlXTreeObject.prototype.saveSelectedItem=function(c,a){c=c||"";this.setCookie("treeStateSelected"+c,this.getSelectedItemId(),a)};dhtmlXTreeObject.prototype.restoreSelectedItem=function(a){a=a||"";var c=this.getCookie("treeStateSelected"+a);this.selectItem(c,false)};dhtmlXTreeObject.prototype.enableAutoSavingSelected=function(a,c){this.assMode=convertStringToBoolean(a);if((this.assMode)&&(!this.oldOnSelect)){this.oldOnSelect=this.onRowSelect;this.onRowSelect=function(f,d,g){if(!d){d=this}d.parentObject.treeNod.oldOnSelect(f,d,g);if(d.parentObject.treeNod.assMode){d.parentObject.treeNod.saveSelectedItem(d.parentObject.treeNod.assCookieName)}}}this.assCookieName=c};dhtmlXTreeObject.prototype.saveState=function(d,c){var f=this._escape(this.serializeTree());var a=4000;if(f.length>a){if(navigator.appName.indexOf("Microsoft")!=-1){return false}this.setCookie("treeStatex"+d,Math.ceil(f.length/a));for(var e=0;e<Math.ceil(f.length/a);e++){this.setCookie("treeStatex"+d+"x"+e,f.substr(e*a,a),c)}}else{this.setCookie("treeStatex"+d,f,c)}var f=this.getCookie("treeStatex"+d);if(!f){this.setCookie("treeStatex"+d,"",c);return false}return true};dhtmlXTreeObject.prototype.loadState=function(a){var e=this.getCookie("treeStatex"+a);if(!e){return false}if(e.length){if(e.toString().length<4){var d="";for(var c=0;c<e;c++){d+=this.getCookie("treeStatex"+a+"x"+c)}e=d}this.loadXMLString((this.utfesc=="utf8")?decodeURI(e):unescape(e))}return true};dhtmlXTreeObject.prototype.setCookie=function(c,d,a){var e=c+"="+d+(a?("; "+a):"");document.cookie=e};dhtmlXTreeObject.prototype.getCookie=function(c){var d=c+"=";if(document.cookie.length>0){var e=document.cookie.indexOf(d);if(e!=-1){e+=d.length;var a=document.cookie.indexOf(";",e);if(a==-1){a=document.cookie.length}return document.cookie.substring(e,a)}}};dhtmlXTreeObject.prototype.saveOpenStates=function(c,a){var e=[];for(var d=0;d<this.htmlNode.childsCount;d++){e=e.concat(this._collectOpenStates(this.htmlNode.childNodes[d]))}e=e.join(this.dlmtr);this.setCookie("treeOpenStatex"+c,e,a)};dhtmlXTreeObject.prototype.loadOpenStates=function(c){for(var d=0;d<this.htmlNode.childsCount;d++){this._xcloseAll(this.htmlNode.childNodes[d])}this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0";var f=getCookie("treeOpenStatex"+c);if(f){var a=f.split(this.dlmtr);for(var d=0;d<a.length;d++){var e=this._globalIdStorageFind(a[d]);if(e){if((this.XMLsource)&&(!e.XMLload)&&(e.id!=this.rootId)){this._delayedLoad(e,"loadOpenStates('"+c+"')");return}else{this.openItem(a[d])}}}}this.callEvent("onAllOpenDynamic",[])};dhtmlXTreeObject.prototype._delayedLoad=function(c,a){this.afterLoadMethod=a;this.onLoadReserve=this.onXLE;this.onXLE=this._delayedLoadStep2;this._loadDynXML(c.id)};dhtmlXTreeObject.prototype._delayedLoadStep2=function(tree){tree.onXLE=tree.onLoadReserve;window.setTimeout(function(){dhtmlx.temp=tree;eval("dhtmlx.temp."+tree.afterLoadMethod)},100);if(tree.onXLE){tree.onXLE(tree)}tree.callEvent("onXLE",[tree])};dhtmlXTreeObject.prototype._collectOpenStates=function(c){var d=[];if(this._getOpenState(c)==1){d.push(c.id);for(var a=0;a<c.childsCount;a++){d=d.concat(this._collectOpenStates(c.childNodes[a]))}}return d};function setCookie(a,c){document.cookie=a+"="+c}function getCookie(c){var d=c+"=";if(document.cookie.length>0){var e=document.cookie.indexOf(d);if(e!=-1){e+=d.length;var a=document.cookie.indexOf(";",e);if(a==-1){a=document.cookie.length}return(document.cookie.substring(e,a))}}}dhtmlXTreeObject.prototype.openAllItemsDynamic=function(a){this.ClosedElem=new Array();this.G_node=null;var c=this._globalIdStorageFind(a||this.rootId);if(c.id!=this.rootId&&this.getOpenState(c.id)!=0){this.openItem(a)}this._openAllNodeChilds(c,0);if(this.ClosedElem.length>0){this.onLoadReserve=this.onXLE;this.onXLE=this._loadAndOpen;this._loadAndOpen(this)}};dhtmlXTreeObject.prototype._openAllNodeChilds=function(c){if((c.XMLload==0)||(c.unParsed)){this.ClosedElem.push(c)}for(var a=0;a<c.childsCount;a++){if(this._getOpenState(c.childNodes[a])<0){this._HideShow(c.childNodes[a],2)}if(c.childNodes[a].childsCount>0){this._openAllNodeChilds(c.childNodes[a])}if((c.childNodes[a].XMLload==0)||(c.childNodes[a].unParsed)){this.ClosedElem.push(c.childNodes[a])}}};dhtmlXTreeObject.prototype._loadAndOpen=function(a){if(a.G_node){a._openItem(a.G_node);a._openAllNodeChilds(a.G_node);a.G_node=null}if(a.ClosedElem.length>0){a.G_node=a.ClosedElem.shift()}if(a.G_node){if(a.G_node.unParsed){a.reParse(a.G_node)}else{window.setTimeout(function(){a._loadDynXML(a.G_node.id)},100)}}else{a.onXLE=a.onLoadReserve;if(a.onXLE){a.onXLE(a)}a.callEvent("onAllOpenDynamic",[a])}};dhtmlXTreeObject.prototype.openItemsDynamic=function(c,a){if(this.onXLE==this._stepOpen){return}this._opnItmsDnmcFlg=convertStringToBoolean(a);this.onLoadReserve=this.onXLE;this.onXLE=this._stepOpen;this.ClosedElem=c.split(",").reverse();this._stepOpen(this)};dhtmlXTreeObject.prototype._stepOpen=function(c){if(!c.ClosedElem.length){c.onXLE=c.onLoadReserve;if(c._opnItmsDnmcFlg){c.selectItem(c.G_node,true)}if((c.onXLE)&&(arguments[1])){c.onXLE.apply(c,arguments)}c.callEvent("onOpenDynamicEnd",[]);return}c.G_node=c.ClosedElem.pop();c.skipLock=true;var a=c._globalIdStorageFind(c.G_node);if(a){if(a.XMLload===0){c.openItem(c.G_node)}else{c.openItem(c.G_node);c._stepOpen(c)}}c.skipLock=false};var globalActiveDHTMLGridObject;String.prototype._dhx_trim=function(){return this.replace(/&nbsp;/g," ").replace(/(^[ \t]*)|([ \t]*$)/g,"")};function dhtmlxArray(a){return dhtmlXHeir((a||new Array()),dhtmlxArray._master)}dhtmlxArray._master={_dhx_find:function(c){for(var a=0;a<this.length;a++){if(c==this[a]){return a}}return -1},_dhx_insertAt:function(d,c){this[this.length]=null;for(var a=this.length-1;a>=d;a--){this[a]=this[a-1]}this[d]=c},_dhx_removeAt:function(a){this.splice(a,1)},_dhx_swapItems:function(a,d){var c=this[a];this[a]=this[d];this[d]=c}};function dhtmlXGridObject(id){if(_isIE){try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}}if(id){if(typeof(id)=="object"){this.entBox=id;if(!this.entBox.id){this.entBox.id="cgrid2_"+this.uid()}}else{this.entBox=document.getElementById(id)}}else{this.entBox=document.createElement("DIV");this.entBox.id="cgrid2_"+this.uid()}this.entBox.innerHTML="";dhtmlxEventable(this);var self=this;this._wcorr=0;this.fontWidth=7;this.cell=null;this.row=null;this.iconURL="";this.editor=null;this._f2kE=true;this._dclE=true;this.combos=new Array(0);this.defVal=new Array(0);this.rowsAr={};this.rowsBuffer=dhtmlxArray();this.rowsCol=dhtmlxArray();this._data_cache={};this._ecache={};this._ud_enabled=true;this.xmlLoader=new dtmlXMLLoaderObject(this.doLoadDetails,this,true,this.no_cashe);this._maskArr=[];this.selectedRows=dhtmlxArray();this.UserData={};this._sizeFix=this._borderFix=0;this.entBox.className+=" gridbox";this.entBox.style.width=this.entBox.getAttribute("width")||(window.getComputedStyle?(this.entBox.style.width||window.getComputedStyle(this.entBox,null)["width"]):(this.entBox.currentStyle?this.entBox.currentStyle.width:this.entBox.style.width||0))||"100%";this.entBox.style.height=this.entBox.getAttribute("height")||(window.getComputedStyle?(this.entBox.style.height||window.getComputedStyle(this.entBox,null)["height"]):(this.entBox.currentStyle?this.entBox.currentStyle.height:this.entBox.style.height||0))||"100%";this.entBox.style.cursor="default";this.entBox.onselectstart=function(){return false};var t_creator=function(name){var t=document.createElement("TABLE");t.cellSpacing=t.cellPadding=0;t.style.cssText="width:100%;table-layout:fixed;";t.className=name.substr(2);return t};this.obj=t_creator("c_obj");this.hdr=t_creator("c_hdr");this.hdr.style.marginRight="20px";this.hdr.style.paddingRight="20px";this.objBox=document.createElement("DIV");this.objBox.style.width="100%";this.objBox.style.overflow="auto";this.objBox.appendChild(this.obj);this.objBox.className="objbox";if(dhtmlx.$customScroll){dhtmlx.CustomScroll.enable(this)}this.hdrBox=document.createElement("DIV");this.hdrBox.style.width="100%";this.hdrBox.style.height="25px";this.hdrBox.style.overflow="hidden";this.hdrBox.className="xhdr";this.preloadImagesAr=new Array(0);this.sortImg=document.createElement("DIV");this.sortImg.style.display="none";this.hdrBox.appendChild(this.sortImg);this.hdrBox.appendChild(this.hdr);this.hdrBox.style.position="relative";this.entBox.appendChild(this.hdrBox);this.entBox.appendChild(this.objBox);this.entBox.grid=this;this.objBox.grid=this;this.hdrBox.grid=this;this.obj.grid=this;this.hdr.grid=this;this.cellWidthPX=[];this.cellWidthPC=[];this.cellWidthType=this.entBox.cellwidthtype||"px";this.delim=this.entBox.delimiter||",";this._csvDelim=",";this.hdrLabels=[];this.columnIds=[];this.columnColor=[];this._hrrar=[];this.cellType=dhtmlxArray();this.cellAlign=[];this.initCellWidth=[];this.fldSort=[];this._srdh=(_isIE&&(document.compatMode!="BackCompat")?22:20);this.imgURL=window.dhx_globalImgPath||"";this.isActive=false;this.isEditable=true;this.useImagesInHeader=false;this.pagingOn=false;this.rowsBufferOutSize=0;dhtmlxEvent(window,"unload",function(){try{if(self.destructor){self.destructor()}}catch(e){}});this.setSkin=function(name){this.skin_name=name;if(this._imgURL){this.setImagePath(this._imgURL)}var classname=this.entBox.className.split(" gridbox")[0];this.entBox.className=classname+" gridbox gridbox_"+name+(_isIE?" isIE":" isModern");this.skin_h_correction=0;this.enableAlterCss("ev_"+name,"odd_"+name,this.isTreeGrid());this._fixAlterCss();switch(name){case"clear":this._topMb=document.createElement("DIV");this._topMb.className="topMumba";this._topMb.innerHTML="<img style='left:0px'   src='"+this.imgURL+"skinC_top_left.gif'><img style='right:20px' src='"+this.imgURL+"skinC_top_right.gif'>";this.entBox.appendChild(this._topMb);this._botMb=document.createElement("DIV");this._botMb.className="bottomMumba";this._botMb.innerHTML="<img style='left:0px'   src='"+this.imgURL+"skinD_bottom_left.gif'><img style='right:20px' src='"+this.imgURL+"skinD_bottom_right.gif'>";this.entBox.appendChild(this._botMb);if(this.entBox.style.position!="absolute"){this.entBox.style.position="relative"}this.skin_h_correction=20;break;case"dhx_terrace":this._srdh=33;this.forceDivInHeader=true;break;case"dhx_skyblue":case"dhx_web":case"glassy_blue":case"dhx_black":case"dhx_blue":case"modern":case"light":this._srdh=29;this.forceDivInHeader=true;break;case"xp":this.forceDivInHeader=true;if((_isIE)&&(document.compatMode!="BackCompat")){this._srdh=26}else{this._srdh=22}break;case"mt":if((_isIE)&&(document.compatMode!="BackCompat")){this._srdh=26}else{this._srdh=22}break;case"gray":if((_isIE)&&(document.compatMode!="BackCompat")){this._srdh=22}break;case"sbdark":break}if(_isIE&&this.hdr){var d=this.hdr.parentNode;d.removeChild(this.hdr);d.appendChild(this.hdr)}this.setSizes()};if(_isIE){this.preventIECaching(true)}if(window.dhtmlDragAndDropObject){this.dragger=new dhtmlDragAndDropObject()}this._doOnScroll=function(e,mode){this.callEvent("onScroll",[this.objBox.scrollLeft,this.objBox.scrollTop]);this.doOnScroll(e,mode)};this.doOnScroll=function(e,mode){this.hdrBox.scrollLeft=this.objBox.scrollLeft;if(this.ftr){this.ftr.parentNode.scrollLeft=this.objBox.scrollLeft}if(mode){return}if(this._srnd){if(this._dLoadTimer){window.clearTimeout(this._dLoadTimer)}this._dLoadTimer=window.setTimeout(function(){if(self._update_srnd_view){self._update_srnd_view()}},100)}};this.attachToObject=function(obj){obj.appendChild(this.globalBox?this.globalBox:this.entBox);this.setSizes()};this.init=function(fl){if((this.isTreeGrid())&&(!this._h2)){this._h2=new dhtmlxHierarchy();if((this._fake)&&(!this._realfake)){this._fake._h2=this._h2}this._tgc={imgURL:null}}if(!this._hstyles){return}if(!this.skin_name){this.setSkin("dhx_skyblue")}this.editStop();this.lastClicked=null;this.resized=null;this.fldSorted=this.r_fldSorted=null;this.cellWidthPX=[];this.cellWidthPC=[];if(this.hdr.rows.length>0){var temp=this.xmlFileUrl;this.clearAll(true);this.xmlFileUrl=temp}var hdrRow=this.hdr.insertRow(0);for(var i=0;i<this.hdrLabels.length;i++){hdrRow.appendChild(document.createElement("TH"));hdrRow.childNodes[i]._cellIndex=i;hdrRow.childNodes[i].style.height="0px"}if(_isIE&&_isIE<8&&document.body.style.msTouchAction==this.undefined){hdrRow.style.position="absolute"}else{hdrRow.style.height="auto"}var hdrRow=this.hdr.insertRow(_isKHTML?2:1);hdrRow._childIndexes=new Array();var col_ex=0;for(var i=0;i<this.hdrLabels.length;i++){hdrRow._childIndexes[i]=i-col_ex;if((this.hdrLabels[i]==this.splitSign)&&(i!=0)){if(_isKHTML){hdrRow.insertCell(i-col_ex)}hdrRow.cells[i-col_ex-1].colSpan=(hdrRow.cells[i-col_ex-1].colSpan||1)+1;hdrRow.childNodes[i-col_ex-1]._cellIndex++;col_ex++;hdrRow._childIndexes[i]=i-col_ex;continue}hdrRow.insertCell(i-col_ex);hdrRow.childNodes[i-col_ex]._cellIndex=i;hdrRow.childNodes[i-col_ex]._cellIndexS=i;this.setColumnLabel(i,this.hdrLabels[i])}if(col_ex==0){hdrRow._childIndexes=null}this._cCount=this.hdrLabels.length;if(_isIE){window.setTimeout(function(){if(self.setSizes){self.setSizes()}},1)}if(!this.obj.firstChild){this.obj.appendChild(document.createElement("TBODY"))}var tar=this.obj.firstChild;if(!tar.firstChild){tar.appendChild(document.createElement("TR"));tar=tar.firstChild;if(_isIE&&_isIE<8&&document.body.style.msTouchAction==this.undefined){tar.style.position="absolute"}else{tar.style.height="auto"}for(var i=0;i<this.hdrLabels.length;i++){tar.appendChild(document.createElement("TH"));tar.childNodes[i].style.height="0px"}}this._c_order=null;if(this.multiLine!=true){this.obj.className+=" row20px"}this.sortImg.style.position="absolute";this.sortImg.style.display="none";this.sortImg.className="dhxgrid_sort_desc";this.sortImg.defLeft=0;if(this.noHeader){this.hdrBox.style.display="none"}else{this.noHeader=false}if(this._ivizcol){this.setColHidden()}this.attachHeader();this.attachHeader(0,0,"_aFoot");this.setSizes();if(fl){this.parseXML()}this.obj.scrollTop=0;if(this.dragAndDropOff){this.dragger.addDragLanding(this.entBox,this)}if(this._initDrF){this._initD()}if(this._init_point){this._init_point()}};this.setColumnSizes=function(gridWidth){var summ=0;var fcols=[];var fix=0;for(var i=0;i<this._cCount;i++){if((this.initCellWidth[i]=="*")&&!this._hrrar[i]){this._awdth=false;fcols.push(i);continue}if(this.cellWidthType=="%"){if(typeof this.cellWidthPC[i]=="undefined"){this.cellWidthPC[i]=this.initCellWidth[i]}var cwidth=(gridWidth*this.cellWidthPC[i]/100)||0;if(fix>0.5){cwidth++;fix--}var rwidth=this.cellWidthPX[i]=Math.floor(cwidth);var fix=fix+cwidth-rwidth}else{if(typeof this.cellWidthPX[i]=="undefined"){this.cellWidthPX[i]=this.initCellWidth[i]}}if(!this._hrrar[i]){summ+=this.cellWidthPX[i]*1}}if(fcols.length){var ms=Math.floor((gridWidth-summ)/fcols.length);if(ms<0){ms=1}for(var i=0;i<fcols.length;i++){var next=Math.max((this._drsclmW?(this._drsclmW[fcols[i]]||0):0),ms);this.cellWidthPX[fcols[i]]=next;summ+=next}if(gridWidth>summ){var last=fcols[fcols.length-1];this.cellWidthPX[last]=this.cellWidthPX[last]+(gridWidth-summ);summ=gridWidth}this._setAutoResize()}this.obj.style.width=summ+"px";this.hdr.style.width=summ+"px";if(this.ftr){this.ftr.style.width=summ+"px"}this.chngCellWidth();return summ};this.setSizes=function(){if((!this.hdr.rows[0])){return}var quirks=this.quirks=(_isIE&&document.compatMode=="BackCompat");var outerBorder=(this.entBox.offsetWidth-this.entBox.clientWidth)/2;if(!this.dontSetSizes){if(this.globalBox){var splitOuterBorder=(this.globalBox.offsetWidth-this.globalBox.clientWidth)/2;if(this._delta_x&&!this._realfake){var ow=this.globalBox.clientWidth;this.globalBox.style.width=this._delta_x;this.entBox.style.width=Math.max(0,(this.globalBox.clientWidth+(quirks?splitOuterBorder*2:0))-this._fake.entBox.clientWidth)+"px";if(ow!=this.globalBox.clientWidth){this._fake._correctSplit(this._fake.entBox.clientWidth)}}if(this._delta_y&&!this._realfake){this.globalBox.style.height=this._delta_y;this.entBox.style.overflow=this._fake.entBox.style.overflow="hidden";this.entBox.style.height=this._fake.entBox.style.height=this.globalBox.clientHeight+(quirks?splitOuterBorder*2:0)+"px"}}else{if(this._delta_x){if(this.entBox.parentNode&&this.entBox.parentNode.tagName=="TD"){this.entBox.style.width="1px";this.entBox.style.width=parseInt(this._delta_x)*this.entBox.parentNode.clientWidth/100-outerBorder*2+"px"}else{this.entBox.style.width=this._delta_x}}if(this._delta_y){this.entBox.style.height=this._delta_y}}}window.clearTimeout(this._sizeTime);if(!this.entBox.offsetWidth&&(!this.globalBox||!this.globalBox.offsetWidth)){this._sizeTime=window.setTimeout(function(){if(self.setSizes){self.setSizes()}},250);return}var border_x=((!this._wthB)&&((this.entBox.cmp||this._delta_x)&&(this.skin_name||"").indexOf("dhx")==0&&!quirks)?2:0);var border_y=((!this._wthB)&&((this.entBox.cmp||this._delta_y)&&(this.skin_name||"").indexOf("dhx")==0&&!quirks)?2:0);if(this._sizeFix){border_x-=this._sizeFix;border_y-=this._sizeFix}var isVScroll=this.parentGrid?false:(this.objBox.scrollHeight>this.objBox.offsetHeight);var scrfix=dhtmlx.$customScroll?0:18;var gridWidth=this.entBox.clientWidth-(this.skin_h_correction||0)*(quirks?0:1)-border_x;var gridWidthActive=this.entBox.clientWidth-(this.skin_h_correction||0)-border_x;var gridHeight=this.entBox.clientHeight-border_y;var summ=this.setColumnSizes(gridWidthActive-(isVScroll?scrfix:0)-(this._correction_x||0));var isHScroll=this.parentGrid?false:((this.objBox.scrollWidth>this.objBox.offsetWidth)||(this.objBox.style.overflowX=="scroll"));var headerHeight=this.hdr.clientHeight;var footerHeight=this.ftr?this.ftr.clientHeight:0;var newWidth=gridWidth;var newHeight=gridHeight-headerHeight-footerHeight;if(this._awdth&&this._awdth[0]&&this._awdth[1]==99999){isHScroll=0}if(this._ahgr){if(this._ahgrMA){newHeight=this.entBox.parentNode.clientHeight-headerHeight-footerHeight}else{newHeight=this.obj.offsetHeight+(isHScroll?scrfix:0)+(this._correction_y||0)}if(this._ahgrM){if(this._ahgrF){newHeight=Math.min(this._ahgrM,newHeight+headerHeight+footerHeight)-headerHeight-footerHeight}else{newHeight=Math.min(this._ahgrM,newHeight)}}if(isVScroll&&newHeight>=this.obj.scrollHeight+(isHScroll?scrfix:0)){isVScroll=false;this.setColumnSizes(gridWidthActive-(this._correction_x||0))}}if((this._awdth)&&(this._awdth[0])){if(this.cellWidthType=="%"){this.cellWidthType="px"}if(this._fake){summ+=this._fake.entBox.clientWidth}var newWidth=Math.min(Math.max(summ+(isVScroll?scrfix:0),this._awdth[2]),this._awdth[1])+(this._correction_x||0);this.objBox.style.overflowX=(!isVScroll&&this.objBox.scrollWidth<=newWidth)?"hidden":"auto";if(this._fake){newWidth-=this._fake.entBox.clientWidth}}newHeight=Math.max(0,newHeight);this._ff_size_delta=(this._ff_size_delta==0.1)?0.2:0.1;if(!_isFF){this._ff_size_delta=0}if(!this.dontSetSizes){this.entBox.style.width=Math.max(0,newWidth+(quirks?2:0)*outerBorder+this._ff_size_delta)+"px";this.entBox.style.height=newHeight+(quirks?2:0)*outerBorder+headerHeight+footerHeight+"px"}this.objBox.style.height=newHeight+((quirks&&!isVScroll)?2:0)*outerBorder+"px";this.hdrBox.style.height=headerHeight+"px";if(newHeight!=gridHeight){this.doOnScroll(0,!this._srnd)}var ext=this["setSizes_"+this.skin_name];if(ext){ext.call(this)}this.setSortImgPos();if(headerHeight!=this.hdr.clientHeight&&this._ahgr){this.setSizes()}this.callEvent("onSetSizes",[])};this.setSizes_clear=function(){var y=this.hdr.offsetHeight;var x=this.entBox.offsetWidth;var y2=y+this.objBox.offsetHeight;this._topMb.style.top=(y||0)+"px";this._topMb.style.width=(x+20)+"px";this._botMb.style.top=(y2-3)+"px";this._botMb.style.width=(x+20)+"px"};this.chngCellWidth=function(){if((_isOpera)&&(this.ftr)){this.ftr.width=this.objBox.scrollWidth+"px"}var l=this._cCount;for(var i=0;i<l;i++){this.hdr.rows[0].cells[i].style.width=this.cellWidthPX[i]+"px";this.obj.rows[0].childNodes[i].style.width=this.cellWidthPX[i]+"px";if(this.ftr){this.ftr.rows[0].cells[i].style.width=this.cellWidthPX[i]+"px"}}};this.setDelimiter=function(delim){this.delim=delim};this.setInitWidthsP=function(wp){this.cellWidthType="%";this.initCellWidth=wp.split(this.delim.replace(/px/gi,""));if(!arguments[1]){this._setAutoResize()}};this._setAutoResize=function(){if(this._realfake){return}var el=window;var self=this;dhtmlxEvent(window,"resize",function(){window.clearTimeout(self._resize_timer);if(self._setAutoResize){self._resize_timer=window.setTimeout(function(){if(self.setSizes){self.setSizes()}if(self._fake){self._fake._correctSplit()}},100)}})};this.setInitWidths=function(wp){this.cellWidthType="px";this.initCellWidth=wp.split(this.delim);if(_isFF){for(var i=0;i<this.initCellWidth.length;i++){if(this.initCellWidth[i]!="*"){this.initCellWidth[i]=parseInt(this.initCellWidth[i])}}}};this.enableMultiline=function(state){this.multiLine=convertStringToBoolean(state)};this.enableMultiselect=function(state){this.selMultiRows=convertStringToBoolean(state)};this.setImagePath=function(path){this._imgURL=path;this.imgURL=path+"dhxgrid_"+(this.skin_name||"dhx_skyblue").replace("dhx_","")+"/";this.iconTree=this.imgURL+"tree/"};this.setImagesPath=this.setImagePath;this.setIconPath=function(path){this.iconURL=path};this.setIconsPath=this.setIconPath;this.changeCursorState=function(ev){var el=ev.target||ev.srcElement;if(el.tagName!="TD"){el=this.getFirstParentOfType(el,"TD")}if(!el){return}if((el.tagName=="TD")&&(this._drsclmn)&&(!this._drsclmn[el._cellIndex])){return el.style.cursor="default"}var check=(ev.layerX||0)+(((!_isIE)&&(ev.target.tagName=="DIV"))?el.offsetLeft:0);if((el.offsetWidth-(ev.offsetX||(parseInt(this.getPosition(el,this.hdrBox))-check)*-1))<(_isOpera?20:10)){el.style.cursor="E-resize"}else{el.style.cursor="default"}if(_isOpera){this.hdrBox.scrollLeft=this.objBox.scrollLeft}};this.startColResize=function(ev){if(this.resized){this.stopColResize()}this.resized=null;var el=ev.target||ev.srcElement;if(el.tagName!="TD"){el=this.getFirstParentOfType(el,"TD")}var x=ev.clientX;var tabW=this.hdr.offsetWidth;var startW=parseInt(el.offsetWidth);if(el.tagName=="TD"&&el.style.cursor!="default"){if((this._drsclmn)&&(!this._drsclmn[el._cellIndex])){return}self._old_d_mm=document.body.onmousemove;self._old_d_mu=document.body.onmouseup;document.body.onmousemove=function(e){if(self){self.doColResize(e||window.event,el,startW,x,tabW)}};document.body.onmouseup=function(){if(self){self.stopColResize()}}}};this.stopColResize=function(){document.body.onmousemove=self._old_d_mm||"";document.body.onmouseup=self._old_d_mu||"";this.setSizes();this.doOnScroll(0,1);this.callEvent("onResizeEnd",[this])};this.doColResize=function(ev,el,startW,x,tabW){el.style.cursor="E-resize";this.resized=el;var fcolW=startW+(ev.clientX-x);var wtabW=tabW+(ev.clientX-x);if(!(this.callEvent("onResize",[el._cellIndex,fcolW,this]))){return}if(_isIE){this.objBox.scrollLeft=this.hdrBox.scrollLeft}if(el.colSpan>1){var a_sizes=new Array();for(var i=0;i<el.colSpan;i++){a_sizes[i]=Math.round(fcolW*this.hdr.rows[0].childNodes[el._cellIndexS+i].offsetWidth/el.offsetWidth)}for(var i=0;i<el.colSpan;i++){this._setColumnSizeR(el._cellIndexS+i*1,a_sizes[i])}}else{this._setColumnSizeR(el._cellIndex,fcolW)}this.doOnScroll(0,1);this.setSizes();if(this._fake&&this._awdth){this._fake._correctSplit()}};this._setColumnSizeR=function(ind,fcolW){if(fcolW>((this._drsclmW&&!this._notresize)?(this._drsclmW[ind]||10):10)){this.obj.rows[0].childNodes[ind].style.width=fcolW+"px";this.hdr.rows[0].childNodes[ind].style.width=fcolW+"px";if(this.ftr){this.ftr.rows[0].childNodes[ind].style.width=fcolW+"px"}if(this.cellWidthType=="px"){this.cellWidthPX[ind]=fcolW}else{var gridWidth=parseInt(this.entBox.offsetWidth);if(this.objBox.scrollHeight>this.objBox.offsetHeight){gridWidth-=17}var pcWidth=Math.round(fcolW/gridWidth*100);this.cellWidthPC[ind]=pcWidth}if(this.sortImg.style.display!="none"){this.setSortImgPos()}}};this.setSortImgState=function(state,ind,order,row){order=(order||"asc").toLowerCase();if(!convertStringToBoolean(state)){this.sortImg.style.display="none";this.fldSorted=this.r_fldSorted=null;return}if(order=="asc"){this.sortImg.className="dhxgrid_sort_asc"}else{this.sortImg.className="dhxgrid_sort_desc"}this.sortImg.style.display="";this.fldSorted=this.hdr.rows[0].childNodes[ind];var r=this.hdr.rows[row||1];if(!r){return}for(var i=0;i<r.childNodes.length;i++){if(r.childNodes[i]._cellIndexS==ind){this.r_fldSorted=r.childNodes[i];return this.setSortImgPos()}}return this.setSortImgState(state,ind,order,(row||1)+1)};this.setSortImgPos=function(ind,mode,hRowInd,el){if(this._hrrar&&this._hrrar[this.r_fldSorted?this.r_fldSorted._cellIndex:ind]){return}if(!el){if(!ind){var el=this.r_fldSorted}else{var el=this.hdr.rows[hRowInd||0].cells[ind]}}if(el!=null){var pos=this.getPosition(el,this.hdrBox);var wdth=el.offsetWidth;this.sortImg.style.left=Number(pos[0]+wdth-13)+"px";this.sortImg.defLeft=parseInt(this.sortImg.style.left);this.sortImg.style.top=Number(pos[1]+5)+"px";if((!this.useImagesInHeader)&&(!mode)){this.sortImg.style.display="inline"}this.sortImg.style.left=this.sortImg.defLeft+"px"}};this.setActive=function(fl){if(arguments.length==0){var fl=true}if(fl==true){if(globalActiveDHTMLGridObject&&(globalActiveDHTMLGridObject!=this)){globalActiveDHTMLGridObject.editStop();globalActiveDHTMLGridObject.callEvent("onBlur",[globalActiveDHTMLGridObject])}globalActiveDHTMLGridObject=this;this.isActive=true}else{this.isActive=false;this.callEvent("onBlur",[this])}};this._doClick=function(ev){var selMethod=0;var el=this.getFirstParentOfType(_isIE?ev.srcElement:ev.target,"TD");if(!el||!el.parentNode||!el.parentNode.idd){return}var fl=true;if(this.markedCells){var markMethod=0;if(ev.shiftKey||ev.metaKey){markMethod=1}if(ev.ctrlKey){markMethod=2}this.doMark(el,markMethod);return true}if(this.selMultiRows!=false){if(ev.shiftKey&&this.row!=null&&this.selectedRows.length){selMethod=1}if(ev.ctrlKey||ev.metaKey){selMethod=2}}this.doClick(el,fl,selMethod,false)};this._doContClick=function(ev){var el=this.getFirstParentOfType(_isIE?ev.srcElement:ev.target,"TD");if((!el)||(typeof(el.parentNode.idd)=="undefined")){this.callEvent("onEmptyClick",[ev]);return true}if(ev.button==2||(_isMacOS&&ev.ctrlKey)){if(!this.callEvent("onRightClick",[el.parentNode.idd,el._cellIndex,ev])){var z=function(e){(e||event).cancelBubble=true;return false};(ev.srcElement||ev.target).oncontextmenu=z;return z(ev)}if(this._ctmndx){if(!(this.callEvent("onBeforeContextMenu",[el.parentNode.idd,el._cellIndex,this]))){return true}if(_isIE){ev.srcElement.oncontextmenu=function(){event.cancelBubble=true;return false}}if(this._ctmndx.showContextMenu){var dEl0=window.document.documentElement;var dEl1=window.document.body;var corrector=new Array((dEl0.scrollLeft||dEl1.scrollLeft),(dEl0.scrollTop||dEl1.scrollTop));if(_isIE){var x=ev.clientX+corrector[0];var y=ev.clientY+corrector[1]}else{var x=ev.pageX;var y=ev.pageY}this._ctmndx.showContextMenu(x-1,y-1);this.contextID=this._ctmndx.contextMenuZoneId=el.parentNode.idd+"_"+el._cellIndex;this._ctmndx._skip_hide=true}else{el.contextMenuId=el.parentNode.idd+"_"+el._cellIndex;el.contextMenu=this._ctmndx;el.a=this._ctmndx._contextStart;el.a(el,ev);el.a=null}ev.cancelBubble=true;return false}}else{if(this._ctmndx){if(this._ctmndx.hideContextMenu){this._ctmndx.hideContextMenu()}else{this._ctmndx._contextEnd()}}}return true};this.doClick=function(el,fl,selMethod,show){if(!this.selMultiRows){selMethod=0}var psid=this.row?this.row.idd:0;this.setActive(true);if(!selMethod){selMethod=0}if(this.cell!=null){this.cell.className=this.cell.className.replace(/cellselected/g,"")}if(el.tagName=="TD"){if(this.checkEvent("onSelectStateChanged")){var initial=this.getSelectedId()}var prow=this.row;if(selMethod==1){var elRowIndex=this.rowsCol._dhx_find(el.parentNode);var lcRowIndex=this.rowsCol._dhx_find(this.lastClicked);if(elRowIndex>lcRowIndex){var strt=lcRowIndex;var end=elRowIndex}else{var strt=elRowIndex;var end=lcRowIndex}for(var i=0;i<this.rowsCol.length;i++){if((i>=strt&&i<=end)){if(this.rowsCol[i]&&(!this.rowsCol[i]._sRow)){if(this.rowsCol[i].className.indexOf("rowselected")==-1&&(this._realfake||this.callEvent("onBeforeSelect",[this.rowsCol[i].idd,psid,el._cellIndex]))){this.rowsCol[i].className+=" rowselected";this.selectedRows[this.selectedRows.length]=this.rowsCol[i]}}else{this.clearSelection();return this.doClick(el,fl,0,show)}}}}else{if(selMethod==2){if(el.parentNode.className.indexOf("rowselected")!=-1){el.parentNode.className=el.parentNode.className.replace(/rowselected/g,"");this.selectedRows._dhx_removeAt(this.selectedRows._dhx_find(el.parentNode));var skipRowSelection=true;show=false}}}this.editStop();if(typeof(el.parentNode.idd)=="undefined"){return true}if((!skipRowSelection)&&(!el.parentNode._sRow)){if(this._realfake||this.callEvent("onBeforeSelect",[el.parentNode.idd,psid,el._cellIndex])){if(this.getSelectedRowId()!=el.parentNode.idd){if(selMethod==0){this.clearSelection()}this.cell=el;if((prow==el.parentNode)&&(this._chRRS)){fl=false}this.row=el.parentNode;this.row.className+=" rowselected";if(this.selectedRows._dhx_find(this.row)==-1){this.selectedRows[this.selectedRows.length]=this.row}}else{this.cell=el;this.row=el.parentNode}}else{fl=false}}if(this.cell&&this.cell.parentNode.className.indexOf("rowselected")!=-1){this.cell.className=this.cell.className.replace(/cellselected/g,"")+" cellselected"}if(selMethod!=1){if(!this.row){return}}this.lastClicked=el.parentNode;var rid=this.row.idd;var cid=this.cell;if(fl&&typeof(rid)!="undefined"&&cid&&!skipRowSelection){self.onRowSelectTime=setTimeout(function(){if(self.callEvent){self.callEvent("onRowSelect",[rid,cid._cellIndex])}},100)}else{this.callEvent("onRowSelectRSOnly",[rid])}if(this.checkEvent("onSelectStateChanged")){var afinal=this.getSelectedId();if(initial!=afinal){this.callEvent("onSelectStateChanged",[afinal,initial])}}}this.isActive=true;if(show!==false&&this.cell&&this.cell.parentNode.idd){this.moveToVisible(this.cell)}};this.selectAll=function(){this.clearSelection();var coll=this.rowsBuffer;if(this.pagingOn){coll=this.rowsCol}for(var i=0;i<coll.length;i++){this.render_row(i).className+=" rowselected"}this.selectedRows=dhtmlxArray([].concat(coll));if(this.selectedRows.length){this.row=this.selectedRows[0];this.cell=this.row.cells[0]}if((this._fake)&&(!this._realfake)){this._fake.selectAll()}};this.selectCell=function(r,cInd,fl,preserve,edit,show){if(!fl){fl=false}if(typeof(r)!="object"){r=this.render_row(r)}if(!r||r==-1){return null}if(r._childIndexes){var c=r.childNodes[r._childIndexes[cInd]]}else{var c=r.childNodes[cInd]}if(!c){c=r.childNodes[0]}if(!this.markedCells){if(preserve){this.doClick(c,fl,3,show)}else{this.doClick(c,fl,0,show)}}else{this.doMark(c,preserve?2:0)}if(edit){this.editCell()}};this.moveToVisible=function(cell_obj,onlyVScroll){if(this.pagingOn){var newPage=Math.floor(this.getRowIndex(cell_obj.parentNode.idd)/this.rowsBufferOutSize)+1;if(newPage!=this.currentPage){this.changePage(newPage)}}try{if(cell_obj.offsetHeight){var distance=cell_obj.offsetLeft+cell_obj.offsetWidth+20;var scrollLeft=0;if(distance>(this.objBox.offsetWidth+this.objBox.scrollLeft)){if(cell_obj.offsetLeft>this.objBox.scrollLeft){scrollLeft=cell_obj.offsetLeft-(this.objBox.offsetWidth-cell_obj.offsetWidth)+5}}else{if(cell_obj.offsetLeft<this.objBox.scrollLeft){distance-=cell_obj.offsetWidth*2/3;if(distance<this.objBox.scrollLeft){scrollLeft=cell_obj.offsetLeft-5}}}if((scrollLeft)&&(!onlyVScroll)){this.objBox.scrollLeft=scrollLeft}}if(!cell_obj.offsetHeight){var mask=this._realfake?this._fake.rowsAr[cell_obj.parentNode.idd]:cell_obj.parentNode;distance=this.rowsBuffer._dhx_find(mask)*this._srdh}else{distance=cell_obj.offsetTop}var distancemax=distance+cell_obj.offsetHeight+38;if(distancemax>(this.objBox.offsetHeight+this.objBox.scrollTop)){var scrollTop=distance}else{if(distance<this.objBox.scrollTop){var scrollTop=distance-5}}if(scrollTop){this.objBox.scrollTop=scrollTop}}catch(er){}};this.editCell=function(){if(this.editor&&this.cell==this.editor.cell){return}this.editStop();if((this.isEditable!=true)||(!this.cell)){return false}var c=this.cell;if(c.parentNode._locked){return false}this.editor=this.cells4(c);if(this.editor!=null){if(this.editor.isDisabled()){this.editor=null;return false}if(this.callEvent("onEditCell",[0,this.row.idd,this.cell._cellIndex])!=false&&this.editor.edit){this._Opera_stop=(new Date).valueOf();c.className+=" editable";this.editor.edit();this.callEvent("onEditCell",[1,this.row.idd,this.cell._cellIndex])}else{this.editor=null}}};this.editStop=function(mode){if(_isOpera){if(this._Opera_stop){if((this._Opera_stop*1+50)>(new Date).valueOf()){return}this._Opera_stop=null}}if(this.editor&&this.editor!=null){this.editor.cell.className=this.editor.cell.className.replace("editable","");if(mode){var t=this.editor.val;this.editor.detach();this.editor.setValue(t);this.editor=null;this.callEvent("onEditCancel",[this.row.idd,this.cell._cellIndex,t]);return}if(this.editor.detach()){this.cell.wasChanged=true}var g=this.editor;this.editor=null;var z=this.callEvent("onEditCell",[2,this.row.idd,this.cell._cellIndex,g.getValue(),g.val]);if((typeof(z)=="string")||(typeof(z)=="number")){g[g.setImage?"setLabel":"setValue"](z)}else{if(!z){g[g.setImage?"setLabel":"setValue"](g.val)}}if(this._ahgr&&this.multiLine){this.setSizes()}}};this._nextRowCell=function(row,dir,pos){row=this._nextRow((this._groups?this.rowsCol:this.rowsBuffer)._dhx_find(row),dir);if(!row){return null}return row.childNodes[row._childIndexes?row._childIndexes[pos]:pos]};this._getNextCell=function(acell,dir,i){acell=acell||this.cell;var arow=acell.parentNode;if(this._tabOrder){i=this._tabOrder[acell._cellIndex];if(typeof i!="undefined"){if(i<0){acell=this._nextRowCell(arow,dir,Math.abs(i)-1)}else{acell=arow.childNodes[i]}}}else{var i=acell._cellIndex+dir;if(i>=0&&i<this._cCount){if(arow._childIndexes){i=arow._childIndexes[acell._cellIndex]+dir}acell=arow.childNodes[i]}else{acell=this._nextRowCell(arow,dir,(dir==1?0:(this._cCount-1)))}}if(!acell){if((dir==1)&&this.tabEnd){this.tabEnd.focus();this.tabEnd.focus();this.setActive(false)}if((dir==-1)&&this.tabStart){this.tabStart.focus();this.tabStart.focus();this.setActive(false)}return null}if(acell.style.display!="none"&&(!this.smartTabOrder||!this.cells(acell.parentNode.idd,acell._cellIndex).isDisabled())){return acell}return this._getNextCell(acell,dir)};this._nextRow=function(ind,dir){var r=this.render_row(ind+dir);if(!r||r==-1){return null}if(r&&r.style.display=="none"){return this._nextRow(ind+dir,dir)}return r};this.scrollPage=function(dir){if(!this.rowsBuffer.length){return}var master=this._realfake?this._fake:this;var new_ind=Math.floor((master._r_select||this.getRowIndex(this.row.idd)||0)+(dir)*this.objBox.offsetHeight/(this._srdh||20));if(new_ind<0){new_ind=0}if(new_ind>=this.rowsBuffer.length){new_ind=this.rowsBuffer.length-1}if(this._srnd&&!this.rowsBuffer[new_ind]){this.objBox.scrollTop+=Math.floor((dir)*this.objBox.offsetHeight/(this._srdh||20))*(this._srdh||20);if(this._fake){this._fake.objBox.scrollTop=this.objBox.scrollTop}master._r_select=new_ind}else{this.selectCell(new_ind,this.cell._cellIndex,true,false,false,(this.multiLine||this._srnd));if(!this.multiLine&&!this._srnd&&!this._realfake){this.objBox.scrollTop=this.getRowById(this.getRowId(new_ind)).offsetTop;if(this._fake){this._fake.objBox.scrollTop=this.objBox.scrollTop}}master._r_select=null}};this.doKey=function(ev){if(!ev){return true}if((ev.target||ev.srcElement).value!==window.undefined){var zx=(ev.target||ev.srcElement);if((!zx.parentNode)||(zx.parentNode.className.indexOf("editable")==-1)){return true}}if((globalActiveDHTMLGridObject)&&(this!=globalActiveDHTMLGridObject)){return globalActiveDHTMLGridObject.doKey(ev)}if(this.isActive==false){return true}if(this._htkebl){return true}if(!this.callEvent("onKeyPress",[ev.keyCode,ev.ctrlKey,ev.shiftKey,ev])){return false}var code="k"+ev.keyCode+"_"+(ev.ctrlKey?1:0)+"_"+(ev.shiftKey?1:0);if(this.cell){if(this._key_events[code]){if(false===this._key_events[code].call(this)){return true}if(ev.preventDefault){ev.preventDefault()}ev.cancelBubble=true;return false}if(this._key_events.k_other){this._key_events.k_other.call(this,ev)}}return true};this.selectRow=function(r,fl,preserve,show){if(typeof(r)!="object"){r=this.render_row(r)}this.selectCell(r,0,fl,preserve,false,show)};this.wasDblClicked=function(ev){var el=this.getFirstParentOfType(_isIE?ev.srcElement:ev.target,"TD");if(el){var rowId=el.parentNode.idd;return this.callEvent("onRowDblClicked",[rowId,el._cellIndex,ev])}};this._onHeaderClick=function(e,el){var that=this.grid;el=el||that.getFirstParentOfType(_isIE?event.srcElement:e.target,"TD");if(this.grid.resized==null){if(!(this.grid.callEvent("onHeaderClick",[el._cellIndexS,(e||window.event)]))){return false}that.sortField(el._cellIndexS,false,el)}this.grid.resized=null};this.deleteSelectedRows=function(){var num=this.selectedRows.length;if(num==0){return}var tmpAr=this.selectedRows;this.selectedRows=dhtmlxArray();for(var i=num-1;i>=0;i--){var node=tmpAr[i];if(!this.deleteRow(node.idd,node)){this.selectedRows[this.selectedRows.length]=node}else{if(node==this.row){var ind=i}}}if(ind){try{if(ind+1>this.rowsCol.length){ind--}this.selectCell(ind,0,true)}catch(er){this.row=null;this.cell=null}}};this.getSelectedRowId=function(){var selAr=new Array(0);var uni={};for(var i=0;i<this.selectedRows.length;i++){var id=this.selectedRows[i].idd;if(uni[id]){continue}selAr[selAr.length]=id;uni[id]=true}if(selAr.length==0){return null}else{return selAr.join(this.delim)}};this.getSelectedCellIndex=function(){if(this.cell!=null){return this.cell._cellIndex}else{return -1}};this.getColWidth=function(ind){return parseInt(this.cellWidthPX[ind])};this.setColWidth=function(ind,value){if(value=="*"){this.initCellWidth[ind]="*"}else{if(this._hrrar[ind]){return}if(this.cellWidthType=="px"){this.cellWidthPX[ind]=parseInt(value)}else{this.cellWidthPC[ind]=parseInt(value)}}this.setSizes()};this.getRowIndex=function(row_id){for(var i=0;i<this.rowsBuffer.length;i++){if(this.rowsBuffer[i]&&this.rowsBuffer[i].idd==row_id){return i}}return -1};this.getRowId=function(ind){return this.rowsBuffer[ind]?this.rowsBuffer[ind].idd:this.undefined};this.setRowId=function(ind,row_id){this.changeRowId(this.getRowId(ind),row_id)};this.changeRowId=function(oldRowId,newRowId){if(oldRowId==newRowId){return}var row=this.rowsAr[oldRowId];row.idd=newRowId;if(this.UserData[oldRowId]){this.UserData[newRowId]=this.UserData[oldRowId];this.UserData[oldRowId]=null}if(this._h2&&this._h2.get[oldRowId]){this._h2.get[newRowId]=this._h2.get[oldRowId];this._h2.get[newRowId].id=newRowId;delete this._h2.get[oldRowId]}this.rowsAr[oldRowId]=null;this.rowsAr[newRowId]=row;for(var i=0;i<row.childNodes.length;i++){if(row.childNodes[i]._code){row.childNodes[i]._code=this._compileSCL(row.childNodes[i]._val,row.childNodes[i])}}if(this._mat_links&&this._mat_links[oldRowId]){var a=this._mat_links[oldRowId];delete this._mat_links[oldRowId];for(var c in a){for(var i=0;i<a[c].length;i++){this._compileSCL(a[c][i].original,a[c][i])}}}this.callEvent("onRowIdChange",[oldRowId,newRowId])};this.setColumnIds=function(ids){this.columnIds=ids.split(this.delim)};this.setColumnId=function(ind,id){this.columnIds[ind]=id};this.getColIndexById=function(id){for(var i=0;i<this.columnIds.length;i++){if(this.columnIds[i]==id){return i}}};this.getColumnId=function(cin){return this.columnIds[cin]};this.getColumnLabel=function(cin,ind,hdr){var z=(hdr||this.hdr).rows[(ind||0)+1];for(var i=0;i<z.cells.length;i++){if(z.cells[i]._cellIndexS==cin){return(_isIE?z.cells[i].innerText:z.cells[i].textContent)}}return""};this.getColLabel=this.getColumnLabel;this.getFooterLabel=function(cin,ind){return this.getColumnLabel(cin,ind,this.ftr)};this.setRowTextBold=function(row_id){var r=this.getRowById(row_id);if(r){r.style.fontWeight="bold"}};this.setRowTextStyle=function(row_id,styleString){var r=this.getRowById(row_id);if(!r){return}for(var i=0;i<r.childNodes.length;i++){var pfix=r.childNodes[i]._attrs.style||"";if((this._hrrar)&&(this._hrrar[i])){pfix="display:none;"}if(_isIE){r.childNodes[i].style.cssText=pfix+"width:"+r.childNodes[i].style.width+";"+styleString}else{r.childNodes[i].style.cssText=pfix+"width:"+r.childNodes[i].style.width+";"+styleString}}};this.setRowColor=function(row_id,color){var r=this.getRowById(row_id);for(var i=0;i<r.childNodes.length;i++){r.childNodes[i].bgColor=color}};this.setCellTextStyle=function(row_id,ind,styleString){var r=this.getRowById(row_id);if(!r){return}var cell=r.childNodes[r._childIndexes?r._childIndexes[ind]:ind];if(!cell){return}var pfix="";if((this._hrrar)&&(this._hrrar[ind])){pfix="display:none;"}if(_isIE){cell.style.cssText=pfix+"width:"+cell.style.width+";"+styleString}else{cell.style.cssText=pfix+"width:"+cell.style.width+";"+styleString}};this.setRowTextNormal=function(row_id){var r=this.getRowById(row_id);if(r){r.style.fontWeight="normal"}};this.doesRowExist=function(row_id){if(this.getRowById(row_id)!=null){return true}else{return false}};this.getColumnsNum=function(){return this._cCount};this.moveRowUp=function(row_id){var r=this.getRowById(row_id);if(this.isTreeGrid()){return this.moveRowUDTG(row_id,-1)}var rInd=this.rowsCol._dhx_find(r);if((r.previousSibling)&&(rInd!=0)){r.parentNode.insertBefore(r,r.previousSibling);this.rowsCol._dhx_swapItems(rInd,rInd-1);this.setSizes();var bInd=this.rowsBuffer._dhx_find(r);this.rowsBuffer._dhx_swapItems(bInd,bInd-1);if(this._cssEven){this._fixAlterCss(rInd-1)}}};this.moveRowDown=function(row_id){var r=this.getRowById(row_id);if(this.isTreeGrid()){return this.moveRowUDTG(row_id,1)}var rInd=this.rowsCol._dhx_find(r);if(r.nextSibling){this.rowsCol._dhx_swapItems(rInd,rInd+1);if(r.nextSibling.nextSibling){r.parentNode.insertBefore(r,r.nextSibling.nextSibling)}else{r.parentNode.appendChild(r)}this.setSizes();var bInd=this.rowsBuffer._dhx_find(r);this.rowsBuffer._dhx_swapItems(bInd,bInd+1);if(this._cssEven){this._fixAlterCss(rInd)}}};this.getCombo=function(col_ind){if(!this.combos[col_ind]){this.combos[col_ind]=new dhtmlXGridComboObject()}return this.combos[col_ind]};this.setUserData=function(row_id,name,value){if(!row_id){row_id="gridglobaluserdata"}if(!this.UserData[row_id]){this.UserData[row_id]=new Hashtable()}this.UserData[row_id].put(name,value)};this.getUserData=function(row_id,name){if(!row_id){row_id="gridglobaluserdata"}this.getRowById(row_id);var z=this.UserData[row_id];return(z?z.get(name):"")};this.setEditable=function(fl){this.isEditable=convertStringToBoolean(fl)};this.selectRowById=function(row_id,multiFL,show,call){if(!call){call=false}this.selectCell(this.getRowById(row_id),0,call,multiFL,false,show)};this.clearSelection=function(){this.editStop();for(var i=0;i<this.selectedRows.length;i++){var r=this.rowsAr[this.selectedRows[i].idd];if(r){r.className=r.className.replace(/rowselected/g,"")}}this.selectedRows=dhtmlxArray();this.row=null;if(this.cell!=null){this.cell.className=this.cell.className.replace(/cellselected/g,"");this.cell=null}this.callEvent("onSelectionCleared",[])};this.copyRowContent=function(from_row_id,to_row_id){var frRow=this.getRowById(from_row_id);if(!this.isTreeGrid()){for(var i=0;i<frRow.cells.length;i++){this.cells(to_row_id,i).setValue(this.cells(from_row_id,i).getValue())}}else{this._copyTreeGridRowContent(frRow,from_row_id,to_row_id)}if(!_isIE){this.getRowById(from_row_id).cells[0].height=frRow.cells[0].offsetHeight}};this.setFooterLabel=function(c,label,ind){return this.setColumnLabel(c,label,ind,this.ftr)};this.setColumnLabel=function(c,label,ind,hdr){var z=(hdr||this.hdr).rows[ind||1];var col=(z._childIndexes?z._childIndexes[c]:c);if(!z.cells[col]){return}if(!this.useImagesInHeader){var hdrHTML="<div class='hdrcell'>";if(label.indexOf("img:[")!=-1){var imUrl=label.replace(/.*\[([^>]+)\].*/,"$1");label=label.substr(label.indexOf("]")+1,label.length);hdrHTML+="<img width='18px' height='18px' align='absmiddle' src='"+imUrl+"' hspace='2'>"}hdrHTML+=label;hdrHTML+="</div>";z.cells[col].innerHTML=hdrHTML;if(this._hstyles[col]){z.cells[col].style.cssText=this._hstyles[col]}}else{z.cells[col].style.textAlign="left";z.cells[col].innerHTML="<img src='"+label+"'>";var a=new Image();a.src=""+label.replace(/(\.[a-z]+)/,".des$1");this.preloadImagesAr[this.preloadImagesAr.length]=a;var b=new Image();b.src=""+label.replace(/(\.[a-z]+)/,".asc$1");this.preloadImagesAr[this.preloadImagesAr.length]=b}if((label||"").indexOf("#")!=-1){var t=label.match(/(^|{)#([^}]+)(}|$)/);if(t){var tn="_in_header_"+t[2];if(this[tn]){this[tn]((this.forceDivInHeader?z.cells[col].firstChild:z.cells[col]),col,label.split(t[0]))}}}};this.setColLabel=function(a,b,ind,c){return this.setColumnLabel(a,b,(ind||0)+1,c)};this.clearAll=function(header){if(!this.obj.rows[0]){return}if(this._h2){this._h2=new dhtmlxHierarchy();if(this._fake){if(this._realfake){this._h2=this._fake._h2}else{this._fake._h2=this._h2}}}this.limit=this._limitC=0;this.editStop(true);if(this._dLoadTimer){window.clearTimeout(this._dLoadTimer)}if(this._dload){this.objBox.scrollTop=0;this.limit=this._limitC||0;this._initDrF=true}var len=this.rowsCol.length;len=this.obj.rows.length;for(var i=len-1;i>0;i--){var t_r=this.obj.rows[i];t_r.parentNode.removeChild(t_r)}if(header){this._master_row=null;this.obj.rows[0].parentNode.removeChild(this.obj.rows[0]);for(var i=this.hdr.rows.length-1;i>=0;i--){var t_r=this.hdr.rows[i];t_r.parentNode.removeChild(t_r)}if(this.ftr){this.ftr.parentNode.removeChild(this.ftr);this.ftr=null}this._aHead=this.ftr=this.cellWidth=this._aFoot=null;this.cellType=dhtmlxArray();this._hrrar=[];this.columnIds=[];this.combos=[];this._strangeParams=[];this.defVal=[];this._ivizcol=null}this.row=null;this.cell=null;this.rowsCol=dhtmlxArray();this.rowsAr={};this._RaSeCol=[];this.rowsBuffer=dhtmlxArray();this.UserData=[];this.selectedRows=dhtmlxArray();if(this.pagingOn||this._srnd){this.xmlFileUrl=""}if(this.pagingOn){this.changePage(1)}if(this._contextCallTimer){window.clearTimeout(this._contextCallTimer)}if(this._sst){this.enableStableSorting(true)}this._fillers=this.undefined;this.setSortImgState(false);this.setSizes();this.callEvent("onClearAll",[])};this.sortField=function(ind,repeatFl,r_el){if(this.getRowsNum()==0){return false}var el=this.hdr.rows[0].cells[ind];if(!el){return}if(el.tagName=="TH"&&(this.fldSort.length-1)>=el._cellIndex&&this.fldSort[el._cellIndex]!="na"){var data=this.getSortingState();var sortType=(data[0]==ind&&data[1]=="asc")?"des":"asc";if(!this.callEvent("onBeforeSorting",[ind,this.fldSort[ind],sortType])){return}this.sortImg.className="dhxgrid_sort_"+(sortType=="asc"?"asc":"desc");if(this.useImagesInHeader){var cel=this.hdr.rows[1].cells[el._cellIndex].firstChild;if(this.fldSorted!=null){var celT=this.hdr.rows[1].cells[this.fldSorted._cellIndex].firstChild;celT.src=celT.src.replace(/(\.asc\.)|(\.des\.)/,".")}cel.src=cel.src.replace(/(\.[a-z]+)$/,"."+sortType+"$1")}this.sortRows(el._cellIndex,this.fldSort[el._cellIndex],sortType);this.fldSorted=el;this.r_fldSorted=r_el;var c=this.hdr.rows[1];var c=r_el.parentNode;var real_el=c._childIndexes?c._childIndexes[el._cellIndex]:el._cellIndex;this.setSortImgPos(false,false,false,r_el)}};this.setCustomSorting=function(func,col){if(!this._customSorts){this._customSorts=new Array()}this._customSorts[col]=(typeof(func)=="string")?eval(func):func;this.fldSort[col]="cus"};this.enableHeaderImages=function(fl){this.useImagesInHeader=fl};this.setHeader=function(hdrStr,splitSign,styles){if(typeof(hdrStr)!="object"){var arLab=this._eSplit(hdrStr)}else{arLab=[].concat(hdrStr)}var arWdth=new Array(0);var arTyp=new dhtmlxArray(0);var arAlg=new Array(0);var arVAlg=new Array(0);var arSrt=new Array(0);for(var i=0;i<arLab.length;i++){arWdth[arWdth.length]=Math.round(100/arLab.length);arTyp[arTyp.length]="ed";arAlg[arAlg.length]="left";arVAlg[arVAlg.length]="middle";arSrt[arSrt.length]="na"}this.splitSign=splitSign||"#cspan";this.hdrLabels=arLab;this.cellWidth=arWdth;if(!this.initCellWidth.length){this.setInitWidthsP(arWdth.join(this.delim),true)}this.cellType=arTyp;this.cellAlign=arAlg;this.cellVAlign=arVAlg;this.fldSort=arSrt;this._hstyles=styles||[]};this._eSplit=function(str){if(![].push){return str.split(this.delim)}var a="r"+(new Date()).valueOf();var z=this.delim.replace(/([\|\+\*\^])/g,"\\$1");return(str||"").replace(RegExp(z,"g"),a).replace(RegExp("\\\\"+a,"g"),this.delim).split(a)};this.getColType=function(cInd){return this.cellType[cInd]};this.getColTypeById=function(cID){return this.cellType[this.getColIndexById(cID)]};this.setColTypes=function(typeStr){this.cellType=dhtmlxArray(typeStr.split(this.delim));this._strangeParams=new Array();for(var i=0;i<this.cellType.length;i++){if((this.cellType[i].indexOf("[")!=-1)){var z=this.cellType[i].split(/[\[\]]+/g);this.cellType[i]=z[0];this.defVal[i]=z[1];if(z[1].indexOf("=")==0){this.cellType[i]="math";this._strangeParams[i]=z[0]}}if(!window["eXcell_"+this.cellType[i]]){dhtmlxError.throwError("Configuration","Incorrect cell type: "+this.cellType[i],[this,this.cellType[i]])}}};this.setColSorting=function(sortStr){this.fldSort=sortStr.split(this.delim);var check={str:1,"int":1,date:1};for(var i=0;i<this.fldSort.length;i++){if((!check[this.fldSort[i]])&&(typeof(window[this.fldSort[i]])=="function")){if(!this._customSorts){this._customSorts=new Array()}this._customSorts[i]=window[this.fldSort[i]];this.fldSort[i]="cus"}}};this.setColAlign=function(alStr){this.cellAlign=alStr.split(this.delim);for(var i=0;i<this.cellAlign.length;i++){this.cellAlign[i]=this.cellAlign[i]._dhx_trim()}};this.setColVAlign=function(valStr){this.cellVAlign=valStr.split(this.delim)};this.setNoHeader=function(fl){this.noHeader=convertStringToBoolean(fl)};this.showRow=function(rowID){this.getRowById(rowID);if(this._h2){this.openItem(this._h2.get[rowID].parent.id)}var c=this.getRowById(rowID).childNodes[0];while(c&&c.style.display=="none"){c=c.nextSibling}if(c){this.moveToVisible(c,true)}};this.setStyle=function(ss_header,ss_grid,ss_selCell,ss_selRow){this.ssModifier=[ss_header,ss_grid,ss_selCell,ss_selCell,ss_selRow];var prefs=["#"+this.entBox.id+" table.hdr td","#"+this.entBox.id+" table.obj td","#"+this.entBox.id+" table.obj tr.rowselected td.cellselected","#"+this.entBox.id+" table.obj td.cellselected","#"+this.entBox.id+" table.obj tr.rowselected td"];var index=0;while(!_isIE){try{var temp=document.styleSheets[index].cssRules.length}catch(e){index++;continue}break}for(var i=0;i<prefs.length;i++){if(this.ssModifier[i]){if(_isIE){document.styleSheets[0].addRule(prefs[i],this.ssModifier[i])}else{document.styleSheets[index].insertRule(prefs[i]+(" { "+this.ssModifier[i]+" }"),document.styleSheets[index].cssRules.length)}}}};this.setColumnColor=function(clr){this.columnColor=clr.split(this.delim)};this.enableAlterCss=function(cssE,cssU,perLevel,levelUnique){if(cssE||cssU){this.attachEvent("onGridReconstructed",function(){this._fixAlterCss();if(this._fake){this._fake._fixAlterCss()}})}this._cssSP=perLevel;this._cssSU=levelUnique;this._cssEven=cssE;this._cssUnEven=cssU};this._fixAlterCss=function(ind){if(this._h2&&(this._cssSP||this._cssSU)){return this._fixAlterCssTGR(ind)}if(!this._cssEven&&!this._cssUnEven){return}ind=ind||0;var j=ind;for(var i=ind;i<this.rowsCol.length;i++){if(!this.rowsCol[i]){continue}if(this.rowsCol[i].style.display!="none"){if(this.rowsCol[i]._cntr){j=1;continue}if(this.rowsCol[i].className.indexOf("rowselected")!=-1){if(j%2==1){this.rowsCol[i].className=this._cssUnEven+" rowselected "+(this.rowsCol[i]._css||"")}else{this.rowsCol[i].className=this._cssEven+" rowselected "+(this.rowsCol[i]._css||"")}}else{if(j%2==1){this.rowsCol[i].className=this._cssUnEven+" "+(this.rowsCol[i]._css||"")}else{this.rowsCol[i].className=this._cssEven+" "+(this.rowsCol[i]._css||"")}}j++}}};this.clearChangedState=function(){for(var i=0;i<this.rowsCol.length;i++){var row=this.rowsCol[i];if(row&&row.childNodes){var cols=row.childNodes.length;for(var j=0;j<cols;j++){row.childNodes[j].wasChanged=false}}}};this.getChangedRows=function(and_added){var res=new Array();this.forEachRow(function(id){var row=this.rowsAr[id];if(row.tagName!="TR"){return}var cols=row.childNodes.length;if(and_added&&row._added){res[res.length]=row.idd}else{for(var j=0;j<cols;j++){if(row.childNodes[j].wasChanged){res[res.length]=row.idd;break}}}});return res.join(this.delim)};this._sUDa=false;this._sAll=false;this.setSerializationLevel=function(userData,fullXML,config,changedAttr,onlyChanged,asCDATA){this._sUDa=userData;this._sAll=fullXML;this._sConfig=config;this._chAttr=changedAttr;this._onlChAttr=onlyChanged;this._asCDATA=asCDATA};this.setSerializableColumns=function(list){if(!list){this._srClmn=null;return}this._srClmn=(list||"").split(",");for(var i=0;i<this._srClmn.length;i++){this._srClmn[i]=convertStringToBoolean(this._srClmn[i])}};this._serialise=function(rCol,inner,closed){this.editStop();var out=[];var close="</"+this.xml.s_row+">";if(this.isTreeGrid()){this._h2.forEachChildF(0,function(el){var temp=this._serializeRow(this.render_row_tree(-1,el.id));out.push(temp);if(temp){return true}else{return false}},this,function(){out.push(close)})}else{for(var i=0;i<this.rowsBuffer.length;i++){if(this.rowsBuffer[i]){if(this._chAttr&&this.rowsBuffer[i]._locator){continue}var temp=this._serializeRow(this.render_row(i));out.push(temp);if(temp){out.push(close)}}}}return[out.join("")]};this._serializeRow=function(r,i){var out=[];var ra=this.xml.row_attrs;var ca=this.xml.cell_attrs;out.push("<"+this.xml.s_row);out.push(" id='"+r.idd+"'");if((this._sAll)&&this.selectedRows._dhx_find(r)!=-1){out.push(" selected='1'")}if(this._h2&&this._h2.get[r.idd].state=="minus"){out.push(" open='1'")}if(ra.length){for(var i=0;i<ra.length;i++){out.push(" "+ra[i]+"='"+r._attrs[ra[i]]+"'")}}out.push(">");if(this._sUDa&&this.UserData[r.idd]){keysAr=this.UserData[r.idd].getKeys();for(var ii=0;ii<keysAr.length;ii++){out.push("<userdata name='"+keysAr[ii]+"'>"+(this._asCDATA?"<![CDATA[":"")+this.UserData[r.idd].get(keysAr[ii])+(this._asCDATA?"]]>":"")+"</userdata>")}}var changeFl=false;for(var jj=0;jj<this._cCount;jj++){if((!this._srClmn)||(this._srClmn[jj])){var zx=this.cells3(r,jj);out.push("<cell");if(ca.length){for(var i=0;i<ca.length;i++){out.push(" "+ca[i]+"='"+zx.cell._attrs[ca[i]]+"'")}}zxVal=zx[this._agetm]();if(this._asCDATA){zxVal="<![CDATA["+zxVal+"]]>"}if((this._ecspn)&&(zx.cell.colSpan)&&zx.cell.colSpan>1){out.push(' colspan="'+zx.cell.colSpan+'" ')}if(this._chAttr){if(zx.wasChanged()){out.push(' changed="1"');changeFl=true}}else{if((this._onlChAttr)&&(zx.wasChanged())){changeFl=true}}if(this._sAll&&this.cellType[jj]=="tree"){out.push((this._h2?(" image='"+this._h2.get[r.idd].image+"'"):"")+">"+zxVal+"</cell>")}else{out.push(">"+zxVal+"</cell>")}if((this._ecspn)&&(zx.cell.colSpan)){for(var u=0;u<zx.cell.colSpan-1;u++){out.push("<cell/>");jj++}}}}if((this._onlChAttr)&&(!changeFl)&&(!r._added)){return""}return out.join("")};this._serialiseConfig=function(){var out="<head>";for(var i=0;i<this.hdr.rows[0].cells.length;i++){if(this._srClmn&&!this._srClmn[i]){continue}var sort=this.fldSort[i];if(sort=="cus"){sort=this._customSorts[i].toString();sort=sort.replace(/function[\ ]*/,"").replace(/\([^\f]*/,"")}out+="<column width='"+this.getColWidth(i)+"' align='"+this.cellAlign[i]+"' type='"+this.cellType[i]+"' sort='"+(sort||"na")+"' color='"+this.columnColor[i]+"'"+(this.columnIds[i]?(" id='"+this.columnIds[i]+"'"):"")+">";if(this._asCDATA){out+="<![CDATA["+this.getHeaderCol(i)+"]]>"}else{out+=this.getHeaderCol(i)}var z=this.getCombo(i);if(z){for(var j=0;j<z.keys.length;j++){out+="<option value='"+z.keys[j]+"'>"+z.values[j]+"</option>"}}out+="</column>"}return out+="</head>"};this.serialize=function(){var out='<?xml version="1.0"?><rows>';if(this._mathSerialization){this._agetm="getMathValue"}else{this._agetm="getValue"}if(this._sUDa&&this.UserData.gridglobaluserdata){var keysAr=this.UserData.gridglobaluserdata.getKeys();for(var i=0;i<keysAr.length;i++){out+="<userdata name='"+keysAr[i]+"'>"+this.UserData.gridglobaluserdata.get(keysAr[i])+"</userdata>"}}if(this._sConfig){out+=this._serialiseConfig()}out+=this._serialise();out+="</rows>";return out};this.getPosition=function(oNode,pNode){if(!pNode){var pos=getOffset(oNode);return[pos.left,pos.top]}pNode=pNode||document.body;var oCurrentNode=oNode;var iLeft=0;var iTop=0;while((oCurrentNode)&&(oCurrentNode!=pNode)){iLeft+=oCurrentNode.offsetLeft-oCurrentNode.scrollLeft;iTop+=oCurrentNode.offsetTop-oCurrentNode.scrollTop;oCurrentNode=oCurrentNode.offsetParent}if(pNode==document.body){if(_isIE){iTop+=document.body.offsetTop||document.documentElement.offsetTop;iLeft+=document.body.offsetLeft||document.documentElement.offsetLeft}else{if(!_isFF){iLeft+=document.body.offsetLeft;iTop+=document.body.offsetTop}}}return[iLeft,iTop]};this.getFirstParentOfType=function(obj,tag){while(obj&&obj.tagName!=tag&&obj.tagName!="BODY"){obj=obj.parentNode}return obj};this.objBox.onscroll=function(){this.grid._doOnScroll()};this.objBox.ontouchend=function(){this.hdrBox.scrollLeft=this.objBox.scrollLeft};this.hdrBox.onscroll=function(){if(this._try_header_sync){return}this._try_header_sync=true;if(Math.abs(this.grid.objBox.scrollLeft-this.scrollLeft)>1){this.grid.objBox.scrollLeft=this.scrollLeft}this._try_header_sync=false};if((!_isOpera)||(_OperaRv>8.5)){this.hdr.onmousemove=function(e){this.grid.changeCursorState(e||window.event)};this.hdr.onmousedown=function(e){return this.grid.startColResize(e||window.event)}}this.obj.onmousemove=this._drawTooltip;this.objBox.onclick=function(e){(e||event).cancelBubble=true};this.obj.onclick=function(e){this.grid._doClick(e||window.event);if(this.grid._sclE){this.grid.editCell(e||window.event)}else{this.grid.editStop()}(e||event).cancelBubble=true};if(_isMacOS){this.entBox.oncontextmenu=function(e){e.cancelBubble=true;if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}var that=this.grid;if(that._realfake){that=that._fake}return that._doContClick(e||window.event)}}else{this.entBox.onmousedown=function(e){return this.grid._doContClick(e||window.event)};this.entBox.oncontextmenu=function(e){if(this.grid._ctmndx){(e||event).cancelBubble=true}return !this.grid._ctmndx}}this.obj.ondblclick=function(e){if(!this.grid.wasDblClicked(e||window.event)){return false}if(this.grid._dclE){var row=this.grid.getFirstParentOfType((_isIE?event.srcElement:e.target),"TR");if(row==this.grid.row){this.grid.editCell(e||window.event)}}(e||event).cancelBubble=true;if(_isOpera){return false}};this.hdr.onclick=this._onHeaderClick;this.sortImg.onclick=function(){self._onHeaderClick.apply({grid:self},[null,self.r_fldSorted])};this.hdr.ondblclick=this._onHeaderDblClick;if(!document.body._dhtmlxgrid_onkeydown){dhtmlxEvent(document,"keydown",function(e){if(globalActiveDHTMLGridObject){return globalActiveDHTMLGridObject.doKey(e||window.event)}});document.body._dhtmlxgrid_onkeydown=true}dhtmlxEvent(document.body,"click",function(){if(self.editStop){self.editStop()}if(self.isActive){self.setActive(false)}});if(this.entBox.style.height.toString().indexOf("%")!=-1){this._delta_y=this.entBox.style.height}if(this.entBox.style.width.toString().indexOf("%")!=-1){this._delta_x=this.entBox.style.width}if(this._delta_x||this._delta_y){this._setAutoResize()}this.setColHidden=this.setColumnsVisibility;this.enableCollSpan=this.enableColSpan;this.setMultiselect=this.enableMultiselect;this.setMultiLine=this.enableMultiline;this.deleteSelectedItem=this.deleteSelectedRows;this.getSelectedId=this.getSelectedRowId;this.getHeaderCol=this.getColumnLabel;this.isItemExists=this.doesRowExist;this.getColumnCount=this.getColumnsNum;this.setSelectedRow=this.selectRowById;this.setHeaderCol=this.setColumnLabel;this.preventIECashing=this.preventIECaching;this.enableAutoHeigth=this.enableAutoHeight;this.getUID=this.uid;if(dhtmlx.image_path){this.setImagePath(dhtmlx.image_path)}if(dhtmlx.skin){this.setSkin(dhtmlx.skin)}return this}dhtmlXGridObject.prototype={getRowAttribute:function(c,a){return this.getRowById(c)._attrs[a]},setRowAttribute:function(d,a,c){this.getRowById(d)._attrs[a]=c},isTreeGrid:function(){return(this.cellType._dhx_find("tree")!=-1)},setRowHidden:function(h,d){var c=convertStringToBoolean(d);var g=this.getRowById(h);if(!g){return}if(g.expand===""){this.collapseKids(g)}if((d)&&(g.style.display!="none")){g.style.display="none";var e=this.selectedRows._dhx_find(g);if(e!=-1){g.className=g.className.replace("rowselected","");for(var a=0;a<g.childNodes.length;a++){g.childNodes[a].className=g.childNodes[a].className.replace(/cellselected/g,"")}this.selectedRows._dhx_removeAt(e)}this.callEvent("onGridReconstructed",[])}if((!d)&&(g.style.display=="none")){g.style.display="";this.callEvent("onGridReconstructed",[])}this.callEvent("onRowHide",[h,d]);this.setSizes()},setColumnHidden:function(d,c){if(!this.hdr.rows.length){if(!this._ivizcol){this._ivizcol=[]}return this._ivizcol[d]=c}if((this.fldSorted)&&(this.fldSorted.cellIndex==d)&&(c)){this.sortImg.style.display="none"}var a=convertStringToBoolean(c);if(a){if(!this._hrrar){this._hrrar=new Array()}else{if(this._hrrar[d]){return}}this._hrrar[d]="display:none;";this._hideShowColumn(d,"none")}else{if((!this._hrrar)||(!this._hrrar[d])){return}this._hrrar[d]="";this._hideShowColumn(d,"")}if((this.fldSorted)&&(this.fldSorted.cellIndex==d)&&(!c)){this.sortImg.style.display="inline"}this.setSortImgPos();this.callEvent("onColumnHidden",[d,c])},isColumnHidden:function(a){if((this._hrrar)&&(this._hrrar[a])){return true}return false},setColumnsVisibility:function(c){if(c){this._ivizcol=c.split(this.delim)}if(this.hdr.rows.length&&this._ivizcol){for(var a=0;a<this._ivizcol.length;a++){this.setColumnHidden(a,this._ivizcol[a])}}},_fixHiddenRowsAll:function(k,d,a,c,g){g=g||"_cellIndex";var h=k.rows.length;for(var f=0;f<h;f++){var l=k.rows[f].childNodes;if(l.length!=this._cCount){for(var e=0;e<l.length;e++){if(l[e][g]==d){l[e].style[a]=c;break}}}else{l[d].style[a]=c}}},_hideShowColumn:function(f,e){var a=f;if(this.hdr.rows[1]&&(this.hdr.rows[1]._childIndexes)&&(this.hdr.rows[1]._childIndexes[f]!=f)){a=this.hdr.rows[1]._childIndexes[f]}if(e=="none"){this.hdr.rows[0].cells[f]._oldWidth=this.hdr.rows[0].cells[f].style.width||(this.initCellWidth[f]+"px");this.hdr.rows[0].cells[f]._oldWidthP=this.cellWidthPC[f];this.obj.rows[0].cells[f].style.width="0px";var c={rows:[this.obj.rows[0]]};this.forEachRow(function(g){if(this.rowsAr[g].tagName=="TR"){c.rows.push(this.rowsAr[g])}});this._fixHiddenRowsAll(c,f,"display","none");if(this.isTreeGrid()){this._fixHiddenRowsAllTG(f,"none")}if((_isOpera&&_OperaRv<9)||_isKHTML||(_isFF)){this._fixHiddenRowsAll(this.hdr,f,"display","none","_cellIndexS")}if(this.ftr){this._fixHiddenRowsAll(this.ftr.childNodes[0],f,"display","none")}this._fixHiddenRowsAll(this.hdr,f,"whiteSpace","nowrap","_cellIndexS");if(!this.cellWidthPX.length&&!this.cellWidthPC.length){this.cellWidthPX=[].concat(this.initCellWidth)}if(this.cellWidthPX[f]){this.cellWidthPX[f]=0}if(this.cellWidthPC[f]){this.cellWidthPC[f]=0}}else{if(this.hdr.rows[0].cells[f]._oldWidth){var d=this.hdr.rows[0].cells[f];if(_isOpera||_isKHTML||(_isFF)){this._fixHiddenRowsAll(this.hdr,f,"display","","_cellIndexS")}if(this.ftr){this._fixHiddenRowsAll(this.ftr.childNodes[0],f,"display","")}var c={rows:[this.obj.rows[0]]};this.forEachRow(function(g){if(this.rowsAr[g].tagName=="TR"){c.rows.push(this.rowsAr[g])}});this._fixHiddenRowsAll(c,f,"display","");if(this.isTreeGrid()){this._fixHiddenRowsAllTG(f,"")}this._fixHiddenRowsAll(this.hdr,f,"whiteSpace","normal","_cellIndexS");if(d._oldWidthP){this.cellWidthPC[f]=d._oldWidthP}if(d._oldWidth){this.cellWidthPX[f]=parseInt(d._oldWidth)}}}this.setSizes();if((!_isIE)&&(!_isFF)){this.obj.border=1;this.obj.border=0}},enableColSpan:function(a){this._ecspn=convertStringToBoolean(a)},enableRowsHover:function(c,a){this._unsetRowHover(false,true);this._hvrCss=a;if(convertStringToBoolean(c)){if(!this._elmnh){this.obj._honmousemove=this.obj.onmousemove;this.obj.onmousemove=this._setRowHover;if(_isIE){this.obj.onmouseleave=this._unsetRowHover}else{this.obj.onmouseout=this._unsetRowHover}this._elmnh=true}}else{if(this._elmnh){this.obj.onmousemove=this.obj._honmousemove;if(_isIE){this.obj.onmouseleave=null}else{this.obj.onmouseout=null}this._elmnh=false}}},enableEditEvents:function(c,d,a){this._sclE=convertStringToBoolean(c);this._dclE=convertStringToBoolean(d);this._f2kE=convertStringToBoolean(a)},enableLightMouseNavigation:function(a){if(convertStringToBoolean(a)){if(!this._elmn){this.entBox._onclick=this.entBox.onclick;this.entBox.onclick=function(){return true};this.obj._onclick=this.obj.onclick;this.obj.onclick=function(d){var f=this.grid.getFirstParentOfType(d?d.target:event.srcElement,"TD");if(!f){return}this.grid.editStop();this.grid.doClick(f);this.grid.editCell();(d||event).cancelBubble=true};this.obj._onmousemove=this.obj.onmousemove;this.obj.onmousemove=this._autoMoveSelect;this._elmn=true}}else{if(this._elmn){this.entBox.onclick=this.entBox._onclick;this.obj.onclick=this.obj._onclick;this.obj.onmousemove=this.obj._onmousemove;this._elmn=false}}},_unsetRowHover:function(d,f){if(f){that=this}else{that=this.grid}if((that._lahRw)&&(that._lahRw!=f)){for(var a=0;a<that._lahRw.childNodes.length;a++){that._lahRw.childNodes[a].className=that._lahRw.childNodes[a].className.replace(that._hvrCss,"")}that._lahRw=null}},_setRowHover:function(d){var f=this.grid.getFirstParentOfType(d?d.target:event.srcElement,"TD");if(f&&f.parentNode!=this.grid._lahRw){this.grid._unsetRowHover(0,f);f=f.parentNode;if(!f.idd||f.idd=="__filler__"){return}for(var a=0;a<f.childNodes.length;a++){f.childNodes[a].className+=" "+this.grid._hvrCss}this.grid._lahRw=f}this._honmousemove(d)},_autoMoveSelect:function(a){if(!this.grid.editor){var d=this.grid.getFirstParentOfType(a?a.target:event.srcElement,"TD");if(d.parentNode.idd){this.grid.doClick(d,true,0)}}this._onmousemove(a)},enableDistributedParsing:function(d,a,c){if(convertStringToBoolean(d)){this._ads_count=a||10;this._ads_time=c||250}else{this._ads_count=0}},destructor:function(){this.editStop(true);if(this._sizeTime){this._sizeTime=window.clearTimeout(this._sizeTime)}this.entBox.className=(this.entBox.className||"").replace(/gridbox.*/,"");if(this.formInputs){for(var d=0;d<this.formInputs.length;d++){this.parentForm.removeChild(this.formInputs[d])}}var c;this.xmlLoader=this.xmlLoader.destructor();for(var d=0;d<this.rowsCol.length;d++){if(this.rowsCol[d]){this.rowsCol[d].grid=null}}for(d in this.rowsAr){if(this.rowsAr[d]){this.rowsAr[d]=null}}this.rowsCol=new dhtmlxArray();this.rowsAr={};this.entBox.innerHTML="";var e=function(){};this.entBox.onclick=this.entBox.onmousedown=this.entBox.onbeforeactivate=this.entBox.onbeforedeactivate=this.entBox.onbeforedeactivate=this.entBox.onselectstart=e;this.setSizes=this._update_srnd_view=this.callEvent=e;this.entBox.grid=this.objBox.grid=this.hdrBox.grid=this.obj.grid=this.hdr.grid=null;if(this._fake){this.globalBox.innerHTML="";this._fake.setSizes=this._fake._update_srnd_view=this._fake.callEvent=e;this.globalBox.onclick=this.globalBox.onmousedown=this.globalBox.onbeforeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onselectstart=e}for(c in this){if((this[c])&&(this[c].m_obj)){this[c].m_obj=null}this[c]=null}if(this==globalActiveDHTMLGridObject){globalActiveDHTMLGridObject=null}return null},getSortingState:function(){var a=new Array();if(this.fldSorted){a[0]=this.fldSorted._cellIndex;a[1]=(this.sortImg.className=="dhxgrid_sort_desc"?"des":"asc")}return a},enableAutoHeight:function(d,c,a){this._ahgr=convertStringToBoolean(d);this._ahgrF=convertStringToBoolean(a);this._ahgrM=c||null;if(arguments.length==1){this.objBox.style.overflowY=d?"hidden":"auto"}if(c=="auto"){this._ahgrM=null;this._ahgrMA=true;this._setAutoResize()}},enableStableSorting:function(a){this._sst=convertStringToBoolean(a);this.rowsCol.stablesort=function(g){var f=this.length-1;for(var e=0;e<this.length-1;e++){for(var d=0;d<f;d++){if(g(this[d],this[d+1])>0){var c=this[d];this[d]=this[d+1];this[d+1]=c}}f--}}},enableKeyboardSupport:function(a){this._htkebl=!convertStringToBoolean(a)},enableContextMenu:function(a){this._ctmndx=a},setScrollbarWidthCorrection:function(a){},enableTooltips:function(c){this._enbTts=c.split(",");for(var a=0;a<this._enbTts.length;a++){this._enbTts[a]=convertStringToBoolean(this._enbTts[a])}},enableResizing:function(c){this._drsclmn=c.split(",");for(var a=0;a<this._drsclmn.length;a++){this._drsclmn[a]=convertStringToBoolean(this._drsclmn[a])}},setColumnMinWidth:function(a,c){if(arguments.length==2){if(!this._drsclmW){this._drsclmW=new Array()}this._drsclmW[c]=a}else{this._drsclmW=a.split(",")}},enableCellIds:function(a){this._enbCid=convertStringToBoolean(a)},lockRow:function(a,d){var c=this.getRowById(a);if(c){c._locked=convertStringToBoolean(d);if((this.cell)&&(this.cell.parentNode.idd==a)){this.editStop()}}},_getRowArray:function(f){var e=new Array();for(var d=0;d<f.childNodes.length;d++){var c=this.cells3(f,d);e[d]=c.getValue()}return e},setDateFormat:function(c,a){this._dtmask=c;this._dtmask_inc=a},setNumberFormat:function(k,d,f,h){var e=k.replace(/[^0\,\.]*/g,"");var a=e.indexOf(".");if(a>-1){a=e.length-a-1}var c=e.indexOf(",");if(c>-1){c=e.length-a-2-c}if(typeof f!="string"){f=this.i18n.decimal_separator}if(typeof h!="string"){h=this.i18n.group_separator}var l=k.split(e)[0];var g=k.split(e)[1];this._maskArr[d]=[a,c,l,g,f,h]},_aplNFb:function(f,e){var c=this._maskArr[e];if(!c){return f}var d=parseFloat(f.toString().replace(/[^0-9]*/g,""));if(f.toString().substr(0,1)=="-"){d=d*-1}if(c[0]>0){d=d/Math.pow(10,c[0])}return d},_aplNF:function(g,f){var d=this._maskArr[f];if(!d){return g}var h=(parseFloat(g)<0?"-":"")+d[2];g=Math.abs(Math.round(parseFloat(g)*Math.pow(10,d[0]>0?d[0]:0))).toString();g=(g.length<d[0]?Math.pow(10,d[0]+1-g.length).toString().substr(1,d[0]+1)+g.toString():g).split("").reverse();g[d[0]]=(g[d[0]]||"0")+d[4];if(d[1]>0){for(var e=(d[0]>0?0:1)+d[0]+d[1];e<g.length;e+=d[1]){g[e]+=d[5]}}return h+g.reverse().join("")+d[3]},_launchCommands:function(a){for(var e=0;e<a.length;e++){var d=new Array();for(var c=0;c<a[e].childNodes.length;c++){if(a[e].childNodes[c].nodeType==1){d[d.length]=a[e].childNodes[c].firstChild.data}}this[a[e].getAttribute("command")].apply(this,d)}},_parseHead:function(f){var e=this.xmlLoader.doXPath("./head",f);if(e.length){var g=this.xmlLoader.doXPath("./column",e[0]);var h=this.xmlLoader.doXPath("./settings",e[0]);var w="setInitWidths";var q=false;if(h[0]){for(var k=0;k<h[0].childNodes.length;k++){switch(h[0].childNodes[k].tagName){case"colwidth":if(h[0].childNodes[k].firstChild&&h[0].childNodes[k].firstChild.data=="%"){w="setInitWidthsP"}break;case"splitat":q=(h[0].childNodes[k].firstChild?h[0].childNodes[k].firstChild.data:false);break}}}this._launchCommands(this.xmlLoader.doXPath("./beforeInit/call",e[0]));if(g.length>0){if(this.hdr.rows.length>0){this.clearAll(true)}var a=[[],[],[],[],[],[],[],[],[]];var o=["","width","type","align","sort","color","format","hidden","id"];var n=["",w,"setColTypes","setColAlign","setColSorting","setColumnColor","","","setColumnIds"];for(var v=0;v<g.length;v++){for(var u=1;u<o.length;u++){a[u].push(g[v].getAttribute(o[u]))}a[0].push((g[v].firstChild?g[v].firstChild.data:"").replace(/^\s*((\s\S)*.+)\s*$/gi,"$1"))}this.setHeader(a[0]);for(var v=0;v<n.length;v++){if(n[v]){this[n[v]](a[v].join(this.delim))}}for(var v=0;v<g.length;v++){if((this.cellType[v].indexOf("co")==0)||(this.cellType[v]=="clist")){var l=this.xmlLoader.doXPath("./option",g[v]);if(l.length){var r=new Array();if(this.cellType[v]=="clist"){for(var u=0;u<l.length;u++){r[r.length]=l[u].firstChild?l[u].firstChild.data:""}this.registerCList(v,r)}else{var x=this.getCombo(v);for(var u=0;u<l.length;u++){x.put(l[u].getAttribute("value"),l[u].firstChild?l[u].firstChild.data:"")}}}}else{if(a[6][v]){if((this.cellType[v].toLowerCase().indexOf("calendar")!=-1)||(this.fldSort[v]=="date")){this.setDateFormat(a[6][v])}else{this.setNumberFormat(a[6][v],v)}}}}this.init();var d=a[7].join(this.delim);if(this.setColHidden&&d.replace(/,/g,"")!=""){this.setColHidden(d)}if((q)&&(this.splitAt)){this.splitAt(q)}}this._launchCommands(this.xmlLoader.doXPath("./afterInit/call",e[0]))}var c=this.xmlLoader.doXPath("//rows/userdata",f);if(c.length>0){if(!this.UserData.gridglobaluserdata){this.UserData.gridglobaluserdata=new Hashtable()}for(var u=0;u<c.length;u++){var y="";for(var m=0;m<c[u].childNodes.length;m++){y+=c[u].childNodes[m].nodeValue}this.UserData.gridglobaluserdata.put(c[u].getAttribute("name"),y)}}},getCheckedRows:function(a){var c=new Array();this.forEachRowA(function(e){var d=this.cells(e,a);if(d.changeState&&d.getValue()!=0){c.push(e)}},true);return c.join(",")},checkAll:function(){var c=arguments.length?arguments[0]:1;for(var a=0;a<this.getColumnsNum();a++){if(this.getColType(a)=="ch"){this.setCheckedRows(a,c)}}},uncheckAll:function(){this.checkAll(0)},setCheckedRows:function(c,a){this.forEachRowA(function(d){if(this.cells(d,c).isCheckbox()){this.cells(d,c).setValue(a)}})},_drawTooltip:function(g){var h=this.grid.getFirstParentOfType(g?g.target:event.srcElement,"TD");if(!h||((this.grid.editor)&&(this.grid.editor.cell==h))){return true}var f=h.parentNode;if(!f.idd||f.idd=="__filler__"){return}var d=(g?g.target:event.srcElement);if(f.idd==window.unknown){return true}if(!this.grid.callEvent("onMouseOver",[f.idd,h._cellIndex,(g||window.event)])){return true}if((this.grid._enbTts)&&(!this.grid._enbTts[h._cellIndex])){if(d.title){d.title=""}return true}if(h._cellIndex>=this.grid._cCount){return}var a=this.grid.cells3(f,h._cellIndex);if(!a||!a.cell||!a.cell._attrs){return}if(d._title){a.cell.title=""}if(!a.cell._attrs.title){d._title=true}if(a){d.title=a.cell._attrs.title||(a.getTitle?a.getTitle():(a.getValue()||"").toString().replace(/<[^>]*>/gi,""))}return true},enableCellWidthCorrection:function(a){if(_isFF){this._wcorr=parseInt(a)}},getAllRowIds:function(d){var a=[];for(var c=0;c<this.rowsBuffer.length;c++){if(this.rowsBuffer[c]){a.push(this.rowsBuffer[c].idd)}}return a.join(d||this.delim)},getAllItemIds:function(){return this.getAllRowIds()},setColspan:function(d,s,e){if(!this._ecspn){return}var a=this.getRowById(d);if((a._childIndexes)&&(a.childNodes[a._childIndexes[s]])){var h=a._childIndexes[s];var f=a.childNodes[h];var g=f.colSpan;f.colSpan=1;if((g)&&(g!=1)){for(var l=1;l<g;l++){var q=document.createElement("TD");if(f.nextSibling){a.insertBefore(q,f.nextSibling)}else{a.appendChild(q)}a._childIndexes[s+l]=h+l;q._cellIndex=s+l;q.style.textAlign=this.cellAlign[l];q.style.verticalAlign=this.cellVAlign[l];f=q;this.cells3(a,s+l).setValue("")}}for(var o=s*1+1*g;o<a._childIndexes.length;o++){a._childIndexes[o]+=(g-1)*1}}if((e)&&(e>1)){if(a._childIndexes){var h=a._childIndexes[s]}else{var h=s;a._childIndexes=new Array();for(var o=0;o<a.childNodes.length;o++){a._childIndexes[o]=o}}a.childNodes[h].colSpan=e;for(var o=1;o<e;o++){a._childIndexes[a.childNodes[h+1]._cellIndex]=h;a.removeChild(a.childNodes[h+1])}var k=a.childNodes[a._childIndexes[s]]._cellIndex;for(var o=k*1+1*e;o<a._childIndexes.length;o++){a._childIndexes[o]-=(e-1)}}},preventIECaching:function(a){this.no_cashe=convertStringToBoolean(a);this.xmlLoader.rSeed=this.no_cashe},enableColumnAutoSize:function(a){this._eCAS=convertStringToBoolean(a)},_onHeaderDblClick:function(d){var c=this.grid;var a=c.getFirstParentOfType(_isIE?event.srcElement:d.target,"TD");if(!c._eCAS){return false}c.adjustColumnSize(a._cellIndexS)},adjustColumnSize:function(h,c){if(this._hrrar&&this._hrrar[h]){return}this._notresize=true;var d=0;this._setColumnSizeR(h,20);for(var f=1;f<this.hdr.rows.length;f++){var n=this.hdr.rows[f];n=n.childNodes[(n._childIndexes)?n._childIndexes[h]:h];if((n)&&((!n.colSpan)||(n.colSpan<2))&&n._cellIndex==h){if((n.childNodes[0])&&(n.childNodes[0].className=="hdrcell")){n=n.childNodes[0]}d=Math.max(d,n.scrollWidth)}}var e=this.obj.rows.length;var k=0;var q=this.cellType._dhx_find("tree");for(var g=1;g<e;g++){var o=this.obj.rows[g];if(!this.rowsAr[o.idd]){continue}if(o._childIndexes&&o._childIndexes[h]!=h||!o.childNodes[h]){continue}k=(o.childNodes[h].innerText||o.childNodes[h].textContent||"").length*this.fontWidth;if(this._h2&&h==q){k+=this._h2.get[o.idd].level*22}if(k>d){d=k}}d+=20+(c||0);this._setColumnSizeR(h,d);this._notresize=false;this.setSizes()},detachHeader:function(a,d){d=d||this.hdr;var c=d.rows[a+1];if(c){c.parentNode.removeChild(c)}this.setSizes()},detachFooter:function(a){this.detachHeader(a,this.ftr)},attachHeader:function(a,e,c){if(typeof(a)=="string"){a=this._eSplit(a)}if(typeof(e)=="string"){e=e.split(this.delim)}c=c||"_aHead";if(this.hdr.rows.length){if(a){this._createHRow([a,e],this[(c=="_aHead")?"hdr":"ftr"])}else{if(this[c]){for(var d=0;d<this[c].length;d++){this.attachHeader.apply(this,this[c][d])}}}}else{if(!this[c]){this[c]=new Array()}this[c][this[c].length]=[a,e,c]}},_createHRow:function(d,m){if(!m){if(this.entBox.style.position!="absolute"){this.entBox.style.position="relative"}var h=document.createElement("DIV");h.className="c_ftr".substr(2);this.entBox.appendChild(h);var q=document.createElement("TABLE");q.cellPadding=q.cellSpacing=0;if(!_isIE||_isIE==8){q.width="100%";q.style.paddingRight="20px"}q.style.marginRight="20px";q.style.tableLayout="fixed";h.appendChild(q);q.appendChild(document.createElement("TBODY"));this.ftr=m=q;var g=q.insertRow(0);var a=((this.hdrLabels.length<=1)?d[0].length:this.hdrLabels.length);for(var e=0;e<a;e++){g.appendChild(document.createElement("TH"));g.childNodes[e]._cellIndex=e}if(_isIE&&_isIE<8){g.style.position="absolute"}else{g.style.height="auto"}}var f=d[1];var h=document.createElement("TR");m.rows[0].parentNode.appendChild(h);for(var e=0;e<d[0].length;e++){if(d[0][e]=="#cspan"){var k=h.cells[h.cells.length-1];k.colSpan=(k.colSpan||1)+1;continue}if((d[0][e]=="#rspan")&&(m.rows.length>1)){var s=m.rows.length-2;var r=false;var k=null;while(!r){var k=m.rows[s];for(var c=0;c<k.cells.length;c++){if(k.cells[c]._cellIndex==e){r=c+1;break}}s--}k=k.cells[r-1];k.rowSpan=(k.rowSpan||1)+1;continue}var l=document.createElement("TD");l._cellIndex=l._cellIndexS=e;if(this._hrrar&&this._hrrar[e]&&!_isIE){l.style.display="none"}if(typeof d[0][e]=="object"){l.appendChild(d[0][e])}else{if(this.forceDivInHeader){l.innerHTML="<div class='hdrcell'>"+(d[0][e]||"&nbsp;")+"</div>"}else{l.innerHTML=(d[0][e]||"&nbsp;")}if((d[0][e]||"").indexOf("#")!=-1){var q=d[0][e].match(/(^|{)#([^}]+)(}|$)/);if(q){var n="_in_header_"+q[2];if(this[n]){this[n]((this.forceDivInHeader?l.firstChild:l),e,d[0][e].split(q[0]))}}}}if(f){l.style.cssText=f[e]}h.appendChild(l)}var o=m;if(_isKHTML){if(m._kTimer){window.clearTimeout(m._kTimer)}m._kTimer=window.setTimeout(function(){m.rows[1].style.display="none";window.setTimeout(function(){m.rows[1].style.display=""},1)},500)}},attachFooter:function(a,c){this.attachHeader(a,c,"_aFoot")},setCellExcellType:function(d,a,c){this.changeCellType(this.getRowById(d),a,c)},changeCellType:function(d,e,c){c=c||this.cellType[e];var f=this.cells3(d,e);var a=f.getValue();f.cell._cellType=c;var f=this.cells3(d,e);f.setValue(a)},setRowExcellType:function(d,c){var e=this.rowsAr[d];for(var a=0;a<e.childNodes.length;a++){this.changeCellType(e,a,c)}},setColumnExcellType:function(a,d){for(var c=0;c<this.rowsBuffer.length;c++){if(this.rowsBuffer[c]&&this.rowsBuffer[c].tagName=="TR"){this.changeCellType(this.rowsBuffer[c],a,d)}}if(this.cellType[a]=="math"){this._strangeParams[c]=d}else{this.cellType[a]=d}},forEachRow:function(d){for(var c in this.rowsAr){if(this.rowsAr[c]&&this.rowsAr[c].idd){d.apply(this,[this.rowsAr[c].idd])}}},forEachRowA:function(d){for(var c=0;c<this.rowsBuffer.length;c++){if(this.rowsBuffer[c]){d.call(this,this.render_row(c).idd)}}},forEachCell:function(d,c){var e=this.getRowById(d);if(!e){return}for(var a=0;a<this._cCount;a++){c(this.cells3(e,a),a)}},enableAutoWidth:function(d,a,c){this._awdth=[convertStringToBoolean(d),parseInt(a||99999),parseInt(c||0)];if(arguments.length==1){this.objBox.style.overflowX=d?"hidden":"auto"}},updateFromXML:function(a,e,c,d){if(typeof e=="undefined"){e=true}this._refresh_mode=[true,e,c];this.load(a,d)},_refreshFromXML:function(e){if(this._f_rowsBuffer){this.filterBy(0,"")}reset=false;if(window.eXcell_tree){eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue;eXcell_tree.prototype.setValue=function(o){var n=this.grid._h2.get[this.cell.parentNode.idd];if(n&&this.cell.parentNode.valTag){this.setLabel(o)}else{this.setValueX(o)}}}var m=this.cellType._dhx_find("tree");e.getXMLTopNode("rows");var f=e.doXPath("//rows")[0].getAttribute("parent")||0;var h={};if(this._refresh_mode[2]){if(m!=-1){this._h2.forEachChild(f,function(n){h[n.id]=true},this)}else{this.forEachRow(function(n){h[n]=true})}}var l=e.doXPath("//row");for(var d=0;d<l.length;d++){var k=l[d];var a=k.getAttribute("id");h[a]=false;var f=k.parentNode.getAttribute("id")||f;if(this.rowsAr[a]&&this.rowsAr[a].tagName!="TR"){if(this._h2){this._h2.get[a].buff.data=k}else{this.rowsBuffer[this.getRowIndex(a)].data=k}this.rowsAr[a]=k}else{if(this.rowsAr[a]){this._process_xml_row(this.rowsAr[a],k,-1);this._postRowProcessing(this.rowsAr[a],true);if(this._fake&&this._fake.rowsAr[a]){this._fake._process_xml_row(this._fake.rowsAr[a],k,-1)}}else{if(this._refresh_mode[1]){var g={idd:a,data:k,_parser:this._process_xml_row,_locator:this._get_xml_data};var c=this.rowsBuffer.length;if(this._refresh_mode[1]=="top"){this.rowsBuffer.unshift(g);c=0}else{this.rowsBuffer.push(g)}if(this._h2){reset=true;(this._h2.add(a,(k.parentNode.getAttribute("id")||k.parentNode.getAttribute("parent")))).buff=this.rowsBuffer[this.rowsBuffer.length-1]}else{if(this._srnd){reset=true}}this.rowsAr[a]=k;k=this.render_row(c);this._insertRowAt(k,c?-1:0)}}}}if(this._refresh_mode[2]){for(a in h){if(h[a]&&this.rowsAr[a]){this.deleteRow(a)}}}this._refresh_mode=null;if(window.eXcell_tree){eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX}if(reset){if(this._h2){this._renderSort()}else{this.render_dataset()}}if(this._f_rowsBuffer){this._f_rowsBuffer=null;this.filterByAll()}},getCustomCombo:function(d,c){var a=this.cells(d,c).cell;if(!a._combo){a._combo=new dhtmlXGridComboObject()}return a._combo},setTabOrder:function(c){var e=c.split(this.delim);this._tabOrder=[];var a=this._cCount||c.length;for(var d=0;d<a;d++){e[d]={c:parseInt(e[d]),ind:d}}e.sort(function(g,f){return(g.c>f.c?1:-1)});for(var d=0;d<a;d++){if(!e[d+1]||(typeof e[d].c=="undefined")){this._tabOrder[e[d].ind]=(e[0].ind+1)*-1}else{this._tabOrder[e[d].ind]=e[d+1].ind}}},i18n:{loading:"Loading",decimal_separator:".",group_separator:","},_key_events:{k13_1_0:function(){var a=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[a+1],this.cell._cellIndex,true)},k13_0_1:function(){var a=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[a-1],this.cell._cellIndex,true)},k13_0_0:function(){this.editStop();this.callEvent("onEnter",[(this.row?this.row.idd:null),(this.cell?this.cell._cellIndex:null)]);this._still_active=true},k9_0_0:function(){this.editStop();if(!this.callEvent("onTab",[true])){return true}var a=this._getNextCell(null,1);if(a){this.selectCell(a.parentNode,a._cellIndex,(this.row!=a.parentNode),false,true);this._still_active=true}},k9_0_1:function(){this.editStop();if(!this.callEvent("onTab",[false])){return false}var a=this._getNextCell(null,-1);if(a){this.selectCell(a.parentNode,a._cellIndex,(this.row!=a.parentNode),false,true);this._still_active=true}},k113_0_0:function(){if(this._f2kE){this.editCell()}},k32_0_0:function(){var a=this.cells4(this.cell);if(!a.changeState||(a.changeState()===false)){return false}},k27_0_0:function(){this.editStop(true)},k33_0_0:function(){if(this.pagingOn){this.changePage(this.currentPage-1)}else{this.scrollPage(-1)}},k34_0_0:function(){if(this.pagingOn){this.changePage(this.currentPage+1)}else{this.scrollPage(1)}},k37_0_0:function(){if(!this.editor&&this.isTreeGrid()){this.collapseKids(this.row)}else{return false}},k39_0_0:function(){if(!this.editor&&this.isTreeGrid()){this.expandKids(this.row)}else{return false}},k40_0_0:function(){var c=this._realfake?this._fake:this;if(this.editor&&this.editor.combo){this.editor.shiftNext()}else{if(!this.row.idd){return}var a=Math.max((c._r_select||0),this.getRowIndex(this.row.idd));var d=this._nextRow(a,1);if(d){c._r_select=null;this.selectCell(d,this.cell._cellIndex,true);if(c.pagingOn){c.showRow(d.idd)}}else{if(!this.callEvent("onLastRow",[])){return false}this._key_events.k34_0_0.apply(this,[]);if(this.pagingOn&&this.rowsCol[a+1]){this.selectCell(a+1,0,true)}}}this._still_active=true},k38_0_0:function(){var c=this._realfake?this._fake:this;if(this.editor&&this.editor.combo){this.editor.shiftPrev()}else{if(!this.row.idd){return}var a=this.getRowIndex(this.row.idd)+1;if(a!=-1&&(!this.pagingOn||(a!=1))){var d=this._nextRow(a-1,-1);this.selectCell(d,this.cell._cellIndex,true);if(c.pagingOn&&d){c.showRow(d.idd)}}else{this._key_events.k33_0_0.apply(this,[])}}this._still_active=true}},_build_master_row:function(){var d=document.createElement("DIV");var c=["<table><tr>"];for(var a=0;a<this._cCount;a++){c.push("<td></td>")}c.push("</tr></table>");d.innerHTML=c.join("");this._master_row=d.firstChild.rows[0]},_prepareRow:function(a){if(!this._master_row){this._build_master_row()}var d=this._master_row.cloneNode(true);for(var c=0;c<d.childNodes.length;c++){d.childNodes[c]._cellIndex=c;if(this._enbCid){d.childNodes[c].id="c_"+a+"_"+c}if(this.dragAndDropOff){this.dragger.addDraggableItem(d.childNodes[c],this)}}d.idd=a;d.grid=this;return d},_process_jsarray_row:function(c,d){c._attrs={};for(var a=0;a<c.childNodes.length;a++){c.childNodes[a]._attrs={}}this._fillRow(c,(this._c_order?this._swapColumns(d):d));return c},_get_jsarray_data:function(c,a){return c[a]},_process_json_row:function(a,c){c=this._c_order?this._swapColumns(c.data):c.data;return this._process_some_row(a,c)},_process_some_row:function(c,d){c._attrs={};for(var a=0;a<c.childNodes.length;a++){c.childNodes[a]._attrs={}}this._fillRow(c,d);return c},_get_json_data:function(c,a){return c.data[a]},_process_js_row:function(d,e){var a=[];for(var c=0;c<this.columnIds.length;c++){a[c]=e[this.columnIds[c]];if(!a[c]&&a[c]!==0){a[c]=""}}this._process_some_row(d,a);d._attrs=e;return d},_get_js_data:function(c,a){return c[this.columnIds[a]]},_process_csv_row:function(c,d){c._attrs={};for(var a=0;a<c.childNodes.length;a++){c.childNodes[a]._attrs={}}this._fillRow(c,(this._c_order?this._swapColumns(d.split(this.csv.cell)):d.split(this.csv.cell)));return c},_get_csv_data:function(c,a){return c.split(this.csv.cell)[a]},_process_store_row:function(f,e){var a=[];for(var d=0;d<this.columnIds.length;d++){a[d]=e[this.columnIds[d]]}for(var c=0;c<f.childNodes.length;c++){f.childNodes[c]._attrs={}}f._attrs=e;this._fillRow(f,a)},_process_xml_row:function(a,g){var n=this.xmlLoader.doXPath(this.xml.cell,g);var l=[];a._attrs=this._xml_attrs(g);if(this._ud_enabled){var m=this.xmlLoader.doXPath("./userdata",g);for(var f=m.length-1;f>=0;f--){var k="";for(var d=0;d<m[f].childNodes.length;d++){k+=m[f].childNodes[d].nodeValue}this.setUserData(a.idd,m[f].getAttribute("name"),k)}}for(var d=0;d<n.length;d++){var e=n[this._c_order?this._c_order[d]:d];if(!e){continue}var c=a._childIndexes?a._childIndexes[d]:d;var h=e.getAttribute("type");if(a.childNodes[c]){if(h){a.childNodes[c]._cellType=h}a.childNodes[c]._attrs=this._xml_attrs(e)}if(!e.getAttribute("xmlcontent")){if(e.firstChild){e=e.firstChild.data}else{e=""}}l.push(e)}for(d<n.length;d<a.childNodes.length;d++){a.childNodes[d]._attrs={}}if(a.parentNode&&a.parentNode.tagName=="row"){a._attrs.parent=a.parentNode.getAttribute("idd")}this._fillRow(a,l);return a},_get_xml_data:function(c,a){c=c.firstChild;while(true){if(!c){return""}if(c.tagName=="cell"){a--}if(a<0){break}c=c.nextSibling}return(c.firstChild?c.firstChild.data:"")},_fillRow:function(e,g){if(this.editor){this.editStop()}for(var c=0;c<e.childNodes.length;c++){if((c<g.length)||(this.defVal[c])){var d=e.childNodes[c]._cellIndex;var f=g[d];var a=this.cells4(e.childNodes[c]);if((this.defVal[d])&&((f=="")||(typeof(f)=="undefined"))){f=this.defVal[d]}if(a){a.setValue(f)}}else{e.childNodes[c].innerHTML="&nbsp;";e.childNodes[c]._clearCell=true}}return e},_postRowProcessing:function(g,k){if(g._attrs["class"]){g._css=g.className=g._attrs["class"]}if(g._attrs.locked){g._locked=true}if(g._attrs.bgColor){g.bgColor=g._attrs.bgColor}var h=0;for(var d=0;d<g.childNodes.length;d++){var l=g.childNodes[d];var f=l._cellIndex;var e=l._attrs.style||g._attrs.style;if(e){l.style.cssText+=";"+e}if(l._attrs["class"]){l.className=l._attrs["class"]}e=l._attrs.align||this.cellAlign[f];if(e){l.align=e}l.vAlign=l._attrs.valign||this.cellVAlign[f];var a=l._attrs.bgColor||this.columnColor[f];if(a){l.bgColor=a}if(l._attrs.colspan&&!k){this.setColspan(g.idd,d+h,l._attrs.colspan);h+=(l._attrs.colspan-1)}if(this._hrrar&&this._hrrar[f]&&!k){l.style.display="none"}}this.callEvent("onRowCreated",[g.idd,g,null])},load:function(a,d,c){this.callEvent("onXLS",[this]);if(arguments.length==2&&typeof d!="function"){c=d;d=null}c=c||"xml";if(!this.xmlFileUrl){this.xmlFileUrl=a}this._data_type=c;this.xmlLoader=new dtmlXMLLoaderObject(this.doLoadDetails,this,true,this.no_cashe);this.xmlLoader.onloadAction=function(g,e,k,h,f){if(!g.callEvent){return}f=g["_process_"+c](f);if(!g._contextCallTimer){g.callEvent("onXLE",[g,0,0,f])}if(d){d();d=null}};this.xmlLoader.loadXML(a)},loadXMLString:function(d,c){var a=new dtmlXMLLoaderObject(function(){});a.loadXMLString(d);this.parse(a,c,"xml")},loadXML:function(a,c){this.load(a,c,"xml")},parse:function(d,c,a){if(arguments.length==2&&typeof c!="function"){a=c;c=null}a=a||"xml";this._data_type=a;d=this["_process_"+a](d);if(!this._contextCallTimer){this.callEvent("onXLE",[this,0,0,d])}if(c){c()}},xml:{top:"rows",row:"./row",cell:"./cell",s_row:"row",s_cell:"cell",row_attrs:[],cell_attrs:[]},csv:{row:"\n",cell:","},_xml_attrs:function(c){var d={};if(c.attributes.length){for(var a=0;a<c.attributes.length;a++){d[c.attributes[a].name]=c.attributes[a].value}}return d},_process_xml:function(e){if(!e.doXPath){var n=new dtmlXMLLoaderObject(function(){});if(typeof e=="string"){n.loadXMLString(e)}else{if(e.responseXML){n.xmlDoc=e}else{n.xmlDoc={}}n.xmlDoc.responseXML=e}e=n}if(this._refresh_mode){return this._refreshFromXML(e)}this._parsing=true;var k=e.getXMLTopNode(this.xml.top);if(k.tagName!=this.xml.top){return}var m=k.getAttribute("dhx_security");if(m){dhtmlx.security_key=m}this._parseHead(k);var o=e.doXPath(this.xml.row,k);var g=parseInt(e.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0);var l=parseInt(e.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0);var l=Math.min(l,32000000/this._srdh);var f=false;if(l&&l!=this.rowsBuffer.length){if(!this.rowsBuffer[l-1]){if(this.rowsBuffer.length){f=true}this.rowsBuffer[l-1]=null}if(l<this.rowsBuffer.length){this.rowsBuffer.splice(l,this.rowsBuffer.length-l);f=true}}if(this.isTreeGrid()){return this._process_tree_xml(e)}for(var c=0;c<o.length;c++){if(this.rowsBuffer[c+g]){continue}var a=o[c].getAttribute("id")||(c+g+1);this.rowsBuffer[c+g]={idd:a,data:o[c],_parser:this._process_xml_row,_locator:this._get_xml_data};this.rowsAr[a]=o[c]}this.callEvent("onDataReady",[]);if(f&&this._srnd){var d=this.objBox.scrollTop;this._reset_view();this.objBox.scrollTop=d}else{this.render_dataset()}this._parsing=false;return e.xmlDoc.responseXML?e.xmlDoc.responseXML:e.xmlDoc},_process_jsarray:function(data){this._parsing=true;if(data&&data.xmlDoc){eval("dhtmlx.temp="+data.xmlDoc.responseText+";");data=dhtmlx.temp}for(var i=0;i<data.length;i++){var id=i+1;this.rowsBuffer.push({idd:id,data:data[i],_parser:this._process_jsarray_row,_locator:this._get_jsarray_data});this.rowsAr[id]=data[i]}this.render_dataset();this._parsing=false},_process_csv:function(e){this._parsing=true;if(e.xmlDoc){e=e.xmlDoc.responseText}e=e.replace(/\r/g,"");e=e.split(this.csv.row);if(this._csvHdr){this.clearAll();var d=e.splice(0,1)[0].split(this.csv.cell);if(!this._csvAID){d.splice(0,1)}this.setHeader(d.join(this.delim));this.init()}for(var c=0;c<e.length;c++){if(!e[c]&&c==e.length-1){continue}if(this._csvAID){var f=c+1;this.rowsBuffer.push({idd:f,data:e[c],_parser:this._process_csv_row,_locator:this._get_csv_data})}else{var a=e[c].split(this.csv.cell);var f=a.splice(0,1)[0];this.rowsBuffer.push({idd:f,data:a,_parser:this._process_jsarray_row,_locator:this._get_jsarray_data})}this.rowsAr[f]=e[c]}this.render_dataset();this._parsing=false},_process_js:function(a){return this._process_json(a,"js")},_process_json:function(data,mode){this._parsing=true;if(data&&data.xmlDoc){eval("dhtmlx.temp="+data.xmlDoc.responseText+";");data=dhtmlx.temp}if(mode=="js"){if(data.data){data=data.data}for(var i=0;i<data.length;i++){var row=data[i];var id=row.id||(i+1);this.rowsBuffer.push({idd:id,data:row,_parser:this._process_js_row,_locator:this._get_js_data});this.rowsAr[id]=data[i]}}else{for(var i=0;i<data.rows.length;i++){var id=data.rows[i].id;this.rowsBuffer.push({idd:id,data:data.rows[i],_parser:this._process_json_row,_locator:this._get_json_data});this.rowsAr[id]=data.rows[i]}}if(data.dhx_security){dhtmlx.security_key=data.dhx_security}this.render_dataset();this._parsing=false},render_dataset:function(e,a){if(this._srnd){if(this._fillers){return this._update_srnd_view()}a=Math.min((this._get_view_size()+(this._srnd_pr||0)),this.rowsBuffer.length)}if(this.pagingOn){e=Math.max((e||0),(this.currentPage-1)*this.rowsBufferOutSize);a=Math.min(this.currentPage*this.rowsBufferOutSize,this.rowsBuffer.length)}else{e=e||0;a=a||this.rowsBuffer.length}for(var d=e;d<a;d++){var g=this.render_row(d);if(g==-1){if(this.xmlFileUrl){if(this.callEvent("onDynXLS",[d,(this._dpref?this._dpref:(a-d))])){this.load(this.xmlFileUrl+getUrlSymbol(this.xmlFileUrl)+"posStart="+d+"&count="+(this._dpref?this._dpref:(a-d)),this._data_type)}}a=d;break}if(!g.parentNode||!g.parentNode.tagName){this._insertRowAt(g,d);if(g._attrs.selected||g._attrs.select){this.selectRow(g,g._attrs.call?true:false,true);g._attrs.selected=g._attrs.select=null}}if(this._ads_count&&d-e==this._ads_count){var f=this;this._context_parsing=this._context_parsing||this._parsing;return this._contextCallTimer=window.setTimeout(function(){f._contextCallTimer=null;f.render_dataset(d,a);if(!f._contextCallTimer){if(f._context_parsing){f.callEvent("onXLE",[])}else{f._fixAlterCss()}f.callEvent("onDistributedEnd",[]);f._context_parsing=false}},this._ads_time)}}if(this._ads_count&&d==a){this.callEvent("onDistributedEnd",[])}if(this._srnd&&!this._fillers){var c=this.rowsBuffer.length-a;this._fillers=[];if(this._fake){this._fake._fillers=[]}while(c>0){var k=(_isIE||window._FFrv)?Math.min(c,50000):c;var h=this._add_filler(a,k);if(h){this._fillers.push(h)}c-=k;a+=k}}this.setSizes()},render_row:function(c){if(!this.rowsBuffer[c]){return -1}if(this.rowsBuffer[c]._parser){var a=this.rowsBuffer[c];if(this.rowsAr[a.idd]&&this.rowsAr[a.idd].tagName=="TR"){return this.rowsBuffer[c]=this.rowsAr[a.idd]}var d=this._prepareRow(a.idd);this.rowsBuffer[c]=d;this.rowsAr[a.idd]=d;a._parser.call(this,d,a.data);this._postRowProcessing(d);return d}return this.rowsBuffer[c]},_get_cell_value:function(c,a,d){if(c._locator){if(this._c_order){a=this._c_order[a]}return c._locator.call(this,c.data,a)}return this.cells3(c,a)[d?d:"getValue"]()},sortRows:function(d,g,c){this.editStop();c=(c||"asc").toLowerCase();g=(g||this.fldSort[d]);d=d||0;if(this.isTreeGrid()){this.sortTreeRows(d,g,c)}else{var a={};var f=this.cellType[d];var h="getValue";if(f=="link"){h="getContent"}if(f=="dhxCalendar"||f=="dhxCalendarA"){h="getDate"}for(var e=0;e<this.rowsBuffer.length;e++){a[this.rowsBuffer[e].idd]=this._get_cell_value(this.rowsBuffer[e],d,h)}this._sortRows(d,g,c,a)}this.callEvent("onAfterSorting",[d,g,c])},_sortCore:function(d,g,c,a,f){var e="sort";if(this._sst){f.stablesort=this.rowsCol.stablesort;e="stablesort"}if(g.length>4){g=window[g]}if(g=="cus"){var h=this._customSorts[d];f[e](function(l,k){return h(a[l.idd],a[k.idd],c,l.idd,k.idd)})}else{if(typeof(g)=="function"){f[e](function(l,k){return g(a[l.idd],a[k.idd],c,l.idd,k.idd)})}else{if(g=="str"){f[e](function(l,k){if(c=="asc"){return a[l.idd]>a[k.idd]?1:(a[l.idd]<a[k.idd]?-1:0)}else{return a[l.idd]<a[k.idd]?1:(a[l.idd]>a[k.idd]?-1:0)}})}else{if(g=="int"){f[e](function(m,l){var k=parseFloat(a[m.idd]);k=isNaN(k)?-99999999999999:k;var n=parseFloat(a[l.idd]);n=isNaN(n)?-99999999999999:n;if(c=="asc"){return k-n}else{return n-k}})}else{if(g=="date"){f[e](function(m,l){var k=Date.parse(a[m.idd])||(Date.parse("01/01/1900"));var n=Date.parse(a[l.idd])||(Date.parse("01/01/1900"));if(c=="asc"){return k-n}else{return n-k}})}}}}}},_sortRows:function(d,e,c,a){this._sortCore(d,e,c,a,this.rowsBuffer);this._reset_view();this.callEvent("onGridReconstructed",[])},_reset_view:function(d){if(!this.obj.rows[0]){return}if(this._lahRw){this._unsetRowHover(0,true)}this.callEvent("onResetView",[]);var a=this.obj.rows[0].parentNode;var e=a.removeChild(a.childNodes[0],true);if(_isKHTML){for(var c=a.parentNode.childNodes.length-1;c>=0;c--){if(a.parentNode.childNodes[c].tagName=="TR"){a.parentNode.removeChild(a.parentNode.childNodes[c],true)}}}else{if(_isIE){for(var c=a.childNodes.length-1;c>=0;c--){a.childNodes[c].removeNode(true)}}else{a.innerHTML=""}}a.appendChild(e);this.rowsCol=dhtmlxArray();if(this._sst){this.enableStableSorting(true)}this._fillers=this.undefined;if(!d){if(_isIE&&this._srnd){this.render_dataset()}else{this.render_dataset()}}},deleteRow:function(c,e){if(!e){e=this.getRowById(c)}if(!e){return}this.editStop();if(!this._realfake){if(this.callEvent("onBeforeRowDeleted",[c])==false){return false}}var a=0;if(this.cellType._dhx_find("tree")!=-1&&!this._realfake){a=this._h2.get[c].parent.id;this._removeTrGrRow(e)}else{if(e.parentNode){e.parentNode.removeChild(e)}var h=this.rowsCol._dhx_find(e);if(h!=-1){this.rowsCol._dhx_removeAt(h)}for(var d=0;d<this.rowsBuffer.length;d++){if(this.rowsBuffer[d]&&this.rowsBuffer[d].idd==c){this.rowsBuffer._dhx_removeAt(d);h=d;break}}}this.rowsAr[c]=null;for(var d=0;d<this.selectedRows.length;d++){if(this.selectedRows[d].idd==c){this.selectedRows._dhx_removeAt(d)}}if(this._srnd){for(var d=0;d<this._fillers.length;d++){var g=this._fillers[d];if(!g){continue}if(g[0]>=h){this._update_fillers(d,0,-1)}else{if(g[0]+g[1]>h){this._update_fillers(d,-1,0)}}}this._update_srnd_view()}if(this.pagingOn){this.changePage()}if(!this._realfake){this.callEvent("onAfterRowDeleted",[c,a])}this.callEvent("onGridReconstructed",[]);if(this._ahgr){this.setSizes()}return true},_addRow:function(h,k,c){if(c==-1||typeof c=="undefined"){c=this.rowsBuffer.length}if(typeof k=="string"){k=k.split(this.delim)}var l=this._prepareRow(h);l._attrs={};for(var d=0;d<l.childNodes.length;d++){l.childNodes[d]._attrs={}}this.rowsAr[l.idd]=l;if(this._h2){this._h2.get[l.idd].buff=l}this._fillRow(l,k);this._postRowProcessing(l);if(this._skipInsert){this._skipInsert=false;return this.rowsAr[l.idd]=l}if(this.pagingOn){this.rowsBuffer._dhx_insertAt(c,l);this.rowsAr[l.idd]=l;return l}if(this._fillers){this.rowsCol._dhx_insertAt(c,null);this.rowsBuffer._dhx_insertAt(c,l);if(this._fake){this._fake.rowsCol._dhx_insertAt(c,null)}this.rowsAr[l.idd]=l;var m=false;for(var e=0;e<this._fillers.length;e++){var g=this._fillers[e];if(g&&g[0]<=c&&(g[0]+g[1])>=c){g[1]=g[1]+1;var a=g[2].firstChild.style.height=parseInt(g[2].firstChild.style.height)+this._srdh+"px";m=true;if(this._fake){this._fake._fillers[e][1]++;this._fake._fillers[e][2].firstChild.style.height=a}}if(g&&g[0]>c){g[0]=g[0]+1;if(this._fake){this._fake._fillers[e][0]++}}}if(!m){this._fillers.push(this._add_filler(c,1,(c==0?{parentNode:this.obj.rows[0].parentNode,nextSibling:(this.rowsCol[1])}:this.rowsCol[c-1])))}return l}this.rowsBuffer._dhx_insertAt(c,l);return this._insertRowAt(l,c)},addRow:function(a,e,d){var c=this._addRow(a,e,d);if(!this.dragContext){this.callEvent("onRowAdded",[a])}if(this.pagingOn){this.changePage(this.currentPage)}if(this._srnd){this._update_srnd_view()}c._added=true;if(this._ahgr){this.setSizes()}this.callEvent("onGridReconstructed",[]);return c},_insertRowAt:function(d,e,c){this.rowsAr[d.idd]=d;if(this._skipInsert){this._skipInsert=false;return d}if((e<0)||((!e)&&(parseInt(e)!==0))){e=this.rowsCol.length}else{if(e>this.rowsCol.length){e=this.rowsCol.length}}if(this._cssEven){var a=d.className.replace(this._cssUnEven,"");if((this._cssSP?this.getLevel(d.idd):e)%2==1){d.className=a+" "+this._cssUnEven+(this._cssSU?(" "+this._cssUnEven+"_"+this.getLevel(d.idd)):"")}else{d.className=a+" "+this._cssEven+(this._cssSU?(" "+this._cssEven+"_"+this.getLevel(d.idd)):"")}}if(!c){if((e==(this.obj.rows.length-1))||(!this.rowsCol[e])){if(_isKHTML){this.obj.appendChild(d)}else{this.obj.firstChild.appendChild(d)}}else{this.rowsCol[e].parentNode.insertBefore(d,this.rowsCol[e])}}this.rowsCol._dhx_insertAt(e,d);this.callEvent("onRowInserted",[d,e]);return d},getRowById:function(d){var c=this.rowsAr[d];if(c){if(c.tagName!="TR"){for(var a=0;a<this.rowsBuffer.length;a++){if(this.rowsBuffer[a]&&this.rowsBuffer[a].idd==d){return this.render_row(a)}}if(this._h2){return this.render_row(null,c.idd)}}return c}return null},cellById:function(c,a){return this.cells(c,a)},cells:function(e,d){if(arguments.length==0){return this.cells4(this.cell)}else{var f=this.getRowById(e)}var a=(f._childIndexes?f.childNodes[f._childIndexes[d]]:f.childNodes[d]);if(!a&&f._childIndexes){a=f.firstChild||{}}return this.cells4(a)},cellByIndex:function(c,a){return this.cells2(c,a)},cells2:function(e,d){var f=this.render_row(e);var a=(f._childIndexes?f.childNodes[f._childIndexes[d]]:f.childNodes[d]);if(!a&&f._childIndexes){a=f.firstChild||{}}return this.cells4(a)},cells3:function(d,c){var a=(d._childIndexes?d.childNodes[d._childIndexes[c]]:d.childNodes[c]);return this.cells4(a)},cells4:function(a){var c=window["eXcell_"+(a._cellType||this.cellType[a._cellIndex])];if(c){return new c(a)}},cells5:function(a,d){var d=d||(a._cellType||this.cellType[a._cellIndex]);if(!this._ecache[d]){if(!window["eXcell_"+d]){var c=eXcell_ro}else{var c=window["eXcell_"+d]}this._ecache[d]=new c(a)}this._ecache[d].cell=a;return this._ecache[d]},dma:function(a){if(!this._ecache){this._ecache={}}if(a&&!this._dma){this._dma=this.cells4;this.cells4=this.cells5}else{if(!a&&this._dma){this.cells4=this._dma;this._dma=null}}},getRowsNum:function(){return this.rowsBuffer.length},enableEditTabOnly:function(a){if(arguments.length>0){this.smartTabOrder=convertStringToBoolean(a)}else{this.smartTabOrder=true}},setExternalTabOrder:function(f,a){var c=this;this.tabStart=(typeof(f)=="object")?f:document.getElementById(f);var d=this.tabStart.onkeydown;this.tabStart.onkeydown=function(h){if(d){d.call(this,h)}var g=(h||window.event);if(g.keyCode==9&&!g.shiftKey){g.cancelBubble=true;c.selectCell(0,0,0,0,1);if(c.smartTabOrder&&c.cells2(0,0).isDisabled()){c._key_events.k9_0_0.call(c)}this.blur();return false}};if(_isOpera){this.tabStart.onkeypress=this.tabStart.onkeydown}this.tabEnd=(typeof(a)=="object")?a:document.getElementById(a);var e=this.tabEnd.onkeydown;this.tabEnd.onkeydown=this.tabEnd.onkeypress=function(h){if(e){e.call(this,h)}var g=(h||window.event);if(g.keyCode==9&&g.shiftKey){g.cancelBubble=true;c.selectCell((c.getRowsNum()-1),(c.getColumnCount()-1),0,0,1);if(c.smartTabOrder&&c.cells2((c.getRowsNum()-1),(c.getColumnCount()-1)).isDisabled()){c._key_events.k9_0_1.call(c)}this.blur();return false}};if(_isOpera){this.tabEnd.onkeypress=this.tabEnd.onkeydown}},uid:function(){if(!this._ui_seed){this._ui_seed=(new Date()).valueOf()}return this._ui_seed++},clearAndLoad:function(){var a=this._pgn_skin;this._pgn_skin=null;this.clearAll();this._pgn_skin=a;this.load.apply(this,arguments)},getStateOfView:function(){if(this.pagingOn){var a=(this.currentPage-1)*this.rowsBufferOutSize;return[this.currentPage,a,Math.min(a+this.rowsBufferOutSize,this.rowsBuffer.length),this.rowsBuffer.length]}return[Math.floor(this.objBox.scrollTop/this._srdh),Math.ceil(parseInt(this.objBox.offsetHeight)/this._srdh),this.rowsBuffer.length]}};(function(){function e(h,k){this[h]=k}function g(h,k){this[h].call(this,k)}function d(h,k){this[h].call(this,k.join(this.delim))}function a(h,m){for(var l=0;l<m.length;l++){if(typeof m[l]=="object"){var n=this.getCombo(l);for(var k in m[l]){n.put(k,m[l][k])}}}}function f(l,u,o){var w=1;var s=[];function v(k,h,x){if(!s[h]){s[h]=[]}if(typeof x=="object"){x.toString=function(){return this.text}}s[h][k]=x}for(var q=0;q<u.length;q++){if(typeof(u[q])=="object"&&u[q].length){for(var n=0;n<u[q].length;n++){v(q,n,u[q][n])}}else{v(q,0,u[q])}}for(var q=0;q<s.length;q++){for(var n=0;n<s[0].length;n++){var r=s[q][n];s[q][n]=(r||"").toString()||"&nbsp;";if(r&&r.colspan){for(var m=1;m<r.colspan;m++){v(n+m,q,"#cspan")}}if(r&&r.rowspan){for(var m=1;m<r.rowspan;m++){v(n,q+m,"#rspan")}}}}this.setHeader(s[0]);for(var q=1;q<s.length;q++){this.attachHeader(s[q])}}var c=[{name:"label",def:"&nbsp;",operation:"setHeader",type:f},{name:"id",def:"",operation:"columnIds",type:e},{name:"width",def:"*",operation:"setInitWidths",type:d},{name:"align",def:"left",operation:"cellAlign",type:e},{name:"valign",def:"middle",operation:"cellVAlign",type:e},{name:"sort",def:"na",operation:"fldSort",type:e},{name:"type",def:"ro",operation:"setColTypes",type:d},{name:"options",def:"",operation:"",type:a}];dhtmlx.extend_api("dhtmlXGridObject",{_init:function(h){return[h.parent]},image_path:"setImagePath",columns:"columns",rows:"rows",headers:"headers",skin:"setSkin",smart_rendering:"enableSmartRendering",css:"enableAlterCss",auto_height:"enableAutoHeight",save_hidden:"enableAutoHiddenColumnsSaving",save_cookie:"enableAutoSaving",save_size:"enableAutoSizeSaving",auto_width:"enableAutoWidth",block_selection:"enableBlockSelection",csv_id:"enableCSVAutoID",csv_header:"enableCSVHeader",cell_ids:"enableCellIds",colspan:"enableColSpan",column_move:"enableColumnMove",context_menu:"enableContextMenu",distributed:"enableDistributedParsing",drag:"enableDragAndDrop",drag_order:"enableDragOrder",tabulation:"enableEditTabOnly",header_images:"enableHeaderImages",header_menu:"enableHeaderMenu",keymap:"enableKeyboardSupport",mouse_navigation:"enableLightMouseNavigation",markers:"enableMarkedCells",math_editing:"enableMathEditing",math_serialization:"enableMathSerialization",drag_copy:"enableMercyDrag",multiline:"enableMultiline",multiselect:"enableMultiselect",save_column_order:"enableOrderSaving",hover:"enableRowsHover",rowspan:"enableRowspan",smart:"enableSmartRendering",save_sorting:"enableSortingSaving",stable_sorting:"enableStableSorting",undo:"enableUndoRedo",csv_cell:"setCSVDelimiter",date_format:"setDateFormat",drag_behavior:"setDragBehavior",editable:"setEditable",without_header:"setNoHeader",submit_changed:"submitOnlyChanged",submit_serialization:"submitSerialization",submit_selected:"submitOnlySelected",submit_id:"submitOnlyRowID",xml:"load"},{columns:function(n){for(var h=0;h<c.length;h++){var m=[];for(var k=0;k<n.length;k++){m[k]=n[k][c[h].name]||c[h].def}var l=c[h].type||g;l.call(this,c[h].operation,m,n)}this.init()},rows:function(h){},headers:function(k){for(var h=0;h<k.length;h++){this.attachHeader(k[h])}}})})();dhtmlXGridObject.prototype._dp_init=function(a){a.attachEvent("insertCallback",function(c,e){if(this.obj._h2){this.obj.addRow(e,d,null,parent)}else{this.obj.addRow(e,[],0)}var d=this.obj.getRowById(e);if(d){this.obj._process_xml_row(d,c.firstChild);this.obj._postRowProcessing(d)}});a.attachEvent("updateCallback",function(c,e){var d=this.obj.getRowById(e);if(d){this.obj._process_xml_row(d,c.firstChild);this.obj._postRowProcessing(d)}});a.attachEvent("deleteCallback",function(c,d){this.obj.setUserData(d,this.action_param,"true_deleted");this.obj.deleteRow(d)});a._methods=["setRowTextStyle","setCellTextStyle","changeRowId","deleteRow"];this.attachEvent("onEditCell",function(e,f,d){if(a._columns&&!a._columns[d]){return true}var c=this.cells(f,d);if(e==1){if(c.isCheckbox()){a.setUpdated(f,true)}}else{if(e==2){if(c.wasChanged()){a.setUpdated(f,true)}}}return true});this.attachEvent("onRowPaste",function(c){a.setUpdated(c,true)});this.attachEvent("onUndo",function(c){a.setUpdated(c,true)});this.attachEvent("onRowIdChange",function(e,c){var d=a.findRow(e);if(d<a.updatedRows.length){a.updatedRows[d]=c}});this.attachEvent("onSelectStateChanged",function(c){if(a.updateMode=="row"){a.sendData()}return true});this.attachEvent("onEnter",function(d,c){if(a.updateMode=="row"){a.sendData()}return true});this.attachEvent("onBeforeRowDeleted",function(c){if(!this.rowsAr[c]){return true}if(this.dragContext&&a.dnd){window.setTimeout(function(){a.setUpdated(c,true)},1);return true}var d=a.getState(c);if(this._h2){this._h2.forEachChild(c,function(e){a.setUpdated(e.id,false);a.markRow(e.id,true,"deleted")},this)}if(d=="inserted"){a.set_invalid(c,false);a.setUpdated(c,false);return true}if(d=="deleted"){return false}if(d=="true_deleted"){a.setUpdated(c,false);return true}a.setUpdated(c,true,"deleted");return false});this.attachEvent("onBindUpdate",function(c){if(typeof c=="object"){c=c.id}a.setUpdated(c,true)});this.attachEvent("onRowAdded",function(c){if(this.dragContext&&a.dnd){return true}a.setUpdated(c,true,"inserted");return true});a._getRowData=function(e,n){var h=[];h.gr_id=e;if(this.obj.isTreeGrid()){h.gr_pid=this.obj.getParentId(e)}var d=this.obj.getRowById(e);for(var k=0;k<this.obj._cCount;k++){if(this.obj._c_order){var l=this.obj._c_order[k]}else{var l=k}var m=this.obj.cells(d.idd,k);if(this._changed&&!m.wasChanged()){continue}if(this._endnm){h[this.obj.getColumnId(k)]=m.getValue()}else{h["c"+l]=m.getValue()}}var f=this.obj.UserData[e];if(f){for(var g=0;g<f.keys.length;g++){if(f.keys[g]&&f.keys[g].indexOf("__")!=0){h[f.keys[g]]=f.values[g]}}}var f=this.obj.UserData.gridglobaluserdata;if(f){for(var g=0;g<f.keys.length;g++){h[f.keys[g]]=f.values[g]}}return h};a._clearUpdateFlag=function(d){var e=this.obj.getRowById(d);if(e){for(var c=0;c<this.obj._cCount;c++){this.obj.cells(d,c).cell.wasChanged=false}}};a.checkBeforeUpdate=function(g){var f=true;var c=[];for(var e=0;e<this.obj._cCount;e++){if(this.mandatoryFields[e]){var d=this.mandatoryFields[e].call(this.obj,this.obj.cells(g,e).getValue(),g,e);if(typeof d=="string"){this.messages.push(d);f=false}else{f&=d;c[e]=!d}}}if(!f){this.set_invalid(g,"invalid",c);this.setUpdated(g,false)}return f}};function dhtmlXGridCellObject(a){this.destructor=function(){this.cell.obj=null;this.cell=null;this.grid=null;this.base=null;return null};this.cell=a;this.getValue=function(){if((this.cell.firstChild)&&(this.cell.firstChild.tagName=="TEXTAREA")){return this.cell.firstChild.value}else{return this.cell.innerHTML._dhx_trim()}};this.getMathValue=function(){if(this.cell.original){return this.cell.original}else{return this.getValue()}};this.getFont=function(){arOut=new Array(3);if(this.cell.style.fontFamily){arOut[0]=this.cell.style.fontFamily}if(this.cell.style.fontWeight=="bold"||this.cell.parentNode.style.fontWeight=="bold"){arOut[1]="bold"}if(this.cell.style.fontStyle=="italic"||this.cell.parentNode.style.fontWeight=="italic"){arOut[1]+="italic"}if(this.cell.style.fontSize){arOut[2]=this.cell.style.fontSize}else{arOut[2]=""}return arOut.join("-")};this.getTextColor=function(){if(this.cell.style.color){return this.cell.style.color}else{return"#000000"}};this.getBgColor=function(){if(this.cell.bgColor){return this.cell.bgColor}else{return"#FFFFFF"}};this.getHorAlign=function(){if(this.cell.style.textAlign){return this.cell.style.textAlign}else{if(this.cell.style.textAlign){return this.cell.style.textAlign}else{return"left"}}};this.getWidth=function(){return this.cell.scrollWidth};this.setFont=function(c){fntAr=c.split("-");this.cell.style.fontFamily=fntAr[0];this.cell.style.fontSize=fntAr[fntAr.length-1];if(fntAr.length==3){if(/bold/.test(fntAr[1])){this.cell.style.fontWeight="bold"}if(/italic/.test(fntAr[1])){this.cell.style.fontStyle="italic"}if(/underline/.test(fntAr[1])){this.cell.style.textDecoration="underline"}}};this.setTextColor=function(c){this.cell.style.color=c};this.setBgColor=function(c){if(c==""){c=null}this.cell.bgColor=c};this.setHorAlign=function(c){if(c.length==1){if(c=="c"){this.cell.style.textAlign="center"}else{if(c=="l"){this.cell.style.textAlign="left"}else{this.cell.style.textAlign="right"}}}else{this.cell.style.textAlign=c}};this.wasChanged=function(){if(this.cell.wasChanged){return true}else{return false}};this.isCheckbox=function(){var c=this.cell.firstChild;if(c&&c.tagName=="INPUT"){type=c.type;if(type=="radio"||type=="checkbox"){return true}else{return false}}else{return false}};this.isChecked=function(){if(this.isCheckbox()){return this.cell.firstChild.checked}};this.isDisabled=function(){return this.cell._disabled};this.setChecked=function(c){if(this.isCheckbox()){if(c!="true"&&c!=1){c=false}this.cell.firstChild.checked=c}};this.setDisabled=function(c){if(c!="true"&&c!=1){c=false}if(this.isCheckbox()){this.cell.firstChild.disabled=c;if(this.disabledF){this.disabledF(c)}}this.cell._disabled=c}}dhtmlXGridCellObject.prototype={getAttribute:function(a){return this.cell._attrs[a]},setAttribute:function(a,c){this.cell._attrs[a]=c},getInput:function(){if(this.obj&&(this.obj.tagName=="INPUT"||this.obj.tagName=="TEXTAREA")){return this.obj}var a=(this.obj||this.cell).getElementsByTagName("TEXTAREA");if(!a.length){a=(this.obj||this.cell).getElementsByTagName("INPUT")}return a[0]}};dhtmlXGridCellObject.prototype.setValue=function(a){if((typeof(a)!="number")&&(!a||a.toString()._dhx_trim()=="")){a="&nbsp;";this.cell._clearCell=true}else{this.cell._clearCell=false}this.setCValue(a)};dhtmlXGridCellObject.prototype.getTitle=function(){return(_isIE?this.cell.innerText:this.cell.textContent)};dhtmlXGridCellObject.prototype.setCValue=function(c,a){this.cell.innerHTML=c;this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,(arguments.length>1?a:c)])};dhtmlXGridCellObject.prototype.setCTxtValue=function(a){this.cell.innerHTML="";this.cell.appendChild(document.createTextNode(a));this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,a])};dhtmlXGridCellObject.prototype.setLabel=function(a){this.cell.innerHTML=a};dhtmlXGridCellObject.prototype.getMath=function(){if(this._val){return this.val}else{return this.getValue()}};function eXcell(){this.obj=null;this.val=null;this.changeState=function(){return false};this.edit=function(){this.val=this.getValue()};this.detach=function(){return false};this.getPosition=function(e){var a=e;var d=0;var c=0;while(a.tagName!="BODY"){d+=a.offsetLeft;c+=a.offsetTop;a=a.offsetParent}return new Array(d,c)}}eXcell.prototype=new dhtmlXGridCellObject;function eXcell_ed(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid}this.edit=function(){this.cell.atag=((!this.grid.multiLine)&&(_isKHTML||_isMacOS||_isFF))?"INPUT":"TEXTAREA";this.val=this.getValue();this.obj=document.createElement(this.cell.atag);this.obj.setAttribute("autocomplete","off");this.obj.style.height=(this.cell.offsetHeight-(_isIE?4:4))+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.style.textAlign;this.obj.onclick=function(c){(c||event).cancelBubble=true};this.obj.onmousedown=function(c){(c||event).cancelBubble=true};this.obj.value=this.val;this.cell.innerHTML="";this.cell.appendChild(this.obj);this.obj.onselectstart=function(c){if(!c){c=event}c.cancelBubble=true;return true};if(_isIE){this.obj.focus();this.obj.blur()}this.obj.focus()};this.getValue=function(){if((this.cell.firstChild)&&((this.cell.atag)&&(this.cell.firstChild.tagName==this.cell.atag))){return this.cell.firstChild.value}if(this.cell._clearCell){return""}return this.cell.innerHTML.toString()._dhx_trim()};this.detach=function(){this.setValue(this.obj.value);return this.val!=this.getValue()}}eXcell_ed.prototype=new eXcell;function eXcell_edtxt(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid}this.getValue=function(){if((this.cell.firstChild)&&((this.cell.atag)&&(this.cell.firstChild.tagName==this.cell.atag))){return this.cell.firstChild.value}if(this.cell._clearCell){return""}return(_isIE?this.cell.innerText:this.cell.textContent)};this.setValue=function(c){if(!c||c.toString()._dhx_trim()==""){c=" ";this.cell._clearCell=true}else{this.cell._clearCell=false}this.setCTxtValue(c)}}eXcell_edtxt.prototype=new eXcell_ed;function eXcell_edn(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid}this.getValue=function(){if((this.cell.firstChild)&&(this.cell.firstChild.tagName=="TEXTAREA")){return this.cell.firstChild.value}if(this.cell._clearCell){return""}return this.cell._orig_value||this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)};this.detach=function(){var c=this.obj.value;this.setValue(c);return this.val!=this.getValue()}}eXcell_edn.prototype=new eXcell_ed;eXcell_edn.prototype.setValue=function(a){if(!a||a.toString()._dhx_trim()==""){this.cell._clearCell=true;return this.setCValue("&nbsp;",0)}else{this.cell._clearCell=false;this.cell._orig_value=a}this.setCValue(this.grid._aplNF(a,this.cell._cellIndex),a)};function eXcell_ch(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid}this.disabledF=function(c){if((c==true)||(c==1)){this.cell.innerHTML=this.cell.innerHTML.replace("item_chk0.","item_chk0_dis.").replace("item_chk1.","item_chk1_dis.")}else{this.cell.innerHTML=this.cell.innerHTML.replace("item_chk0_dis.","item_chk0.").replace("item_chk1_dis.","item_chk1.")}};this.changeState=function(c){if(c===true&&!this.grid.isActive){if(window.globalActiveDHTMLGridObject!=null&&window.globalActiveDHTMLGridObject!=this.grid&&window.globalActiveDHTMLGridObject.isActive){window.globalActiveDHTMLGridObject.setActive(false)}this.grid.setActive(true)}if((!this.grid.isEditable)||(this.cell.parentNode._locked)||(this.isDisabled())){return}if(this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])){this.val=this.getValue();if(this.val=="1"){this.setValue("0")}else{this.setValue("1")}this.cell.wasChanged=true;this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")]);this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")])}else{this.editor=null}};this.getValue=function(){return this.cell.chstate?this.cell.chstate.toString():"0"};this.isCheckbox=function(){return true};this.isChecked=function(){if(this.getValue()=="1"){return true}else{return false}};this.setChecked=function(c){this.setValue(c.toString())};this.detach=function(){return this.val!=this.getValue()};this.edit=null}eXcell_ch.prototype=new eXcell;eXcell_ch.prototype.setValue=function(c){this.cell.style.verticalAlign="middle";if(c){c=c.toString()._dhx_trim();if((c=="false")||(c=="0")){c=""}}if(c){c="1";this.cell.chstate="1"}else{c="0";this.cell.chstate="0"}var a=this;this.setCValue("<img src='"+this.grid.imgURL+"item_chk"+c+".gif' onclick='new eXcell_ch(this.parentNode).changeState(true); (arguments[0]||event).cancelBubble=true; '>",this.cell.chstate)};function eXcell_ra(a){this.base=eXcell_ch;this.base(a);this.grid=a.parentNode.grid;this.disabledF=function(c){if((c==true)||(c==1)){this.cell.innerHTML=this.cell.innerHTML.replace("radio_chk0.","radio_chk0_dis.").replace("radio_chk1.","radio_chk1_dis.")}else{this.cell.innerHTML=this.cell.innerHTML.replace("radio_chk0_dis.","radio_chk0.").replace("radio_chk1_dis.","radio_chk1.")}};this.changeState=function(c){if(c===false&&this.getValue()==1){return}if((!this.grid.isEditable)||(this.cell.parentNode._locked)||(this.isDisabled())){return}if(this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])!=false){this.val=this.getValue();if(this.val=="1"){this.setValue("0")}else{this.setValue("1")}this.cell.wasChanged=true;this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")]);this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")])}else{this.editor=null}};this.edit=null}eXcell_ra.prototype=new eXcell_ch;eXcell_ra.prototype.setValue=function(c){this.cell.style.verticalAlign="middle";if(c){c=c.toString()._dhx_trim();if((c=="false")||(c=="0")){c=""}}if(c){if(!this.grid._RaSeCol){this.grid._RaSeCol=[]}if(this.grid._RaSeCol[this.cell._cellIndex]){var a=this.grid.cells4(this.grid._RaSeCol[this.cell._cellIndex]);a.setValue("0");if(this.grid.rowsAr[a.cell.parentNode.idd]){this.grid.callEvent("onEditCell",[1,a.cell.parentNode.idd,a.cell._cellIndex])}}this.grid._RaSeCol[this.cell._cellIndex]=this.cell;c="1";this.cell.chstate="1"}else{c="0";this.cell.chstate="0"}this.setCValue("<img src='"+this.grid.imgURL+"radio_chk"+c+".gif' onclick='new eXcell_ra(this.parentNode).changeState(false);'>",this.cell.chstate)};function eXcell_txt(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid}this.edit=function(){this.val=this.getValue();this.obj=document.createElement("TEXTAREA");this.obj.className="dhx_textarea";this.obj.onclick=function(f){(f||event).cancelBubble=true};var d=this.grid.getPosition(this.cell);this.obj.value=this.val;this.obj.style.display="";this.obj.style.textAlign=this.cell.style.textAlign;if(_isFF){var c=document.createElement("DIV");c.appendChild(this.obj);c.style.overflow="auto";c.className="dhx_textarea";this.obj.style.margin="0px 0px 0px 0px";this.obj.style.border="0px";this.obj=c}document.body.appendChild(this.obj);if(_isOpera){this.obj.onkeypress=function(f){if(f.keyCode==9){return false}}}this.obj.onkeydown=function(g){var f=(g||event);if(f.keyCode==9){globalActiveDHTMLGridObject.entBox.focus();globalActiveDHTMLGridObject.doKey({keyCode:f.keyCode,shiftKey:f.shiftKey,srcElement:"0"});return false}};this.obj.style.left=d[0]+"px";this.obj.style.top=d[1]+this.cell.offsetHeight+"px";if(this.cell.offsetWidth<200){var e=200}else{var e=this.cell.offsetWidth}this.obj.style.width=e+(_isFF?18:16)+"px";if(_isFF){this.obj.firstChild.style.width=parseInt(this.obj.style.width)+"px";this.obj.firstChild.style.height=this.obj.offsetHeight-3+"px"}if(_isIE){this.obj.select();this.obj.value=this.obj.value}if(_isFF){this.obj.firstChild.focus()}else{this.obj.focus()}};this.detach=function(){var c="";if(_isFF){c=this.obj.firstChild.value}else{c=this.obj.value}if(c==""){this.cell._clearCell=true}else{this.cell._clearCell=false}this.setValue(c);document.body.removeChild(this.obj);this.obj=null;return this.val!=this.getValue()};this.getValue=function(){if(this.obj){if(_isFF){return this.obj.firstChild.value}else{return this.obj.value}}if(this.cell._clearCell){return""}if(typeof this.cell._brval!="undefined"){return this.cell._brval}if((!this.grid.multiLine)){return this.cell._brval||this.cell.innerHTML}else{return this.cell._brval||this.cell.innerHTML.replace(/<br[^>]*>/gi,"\n")._dhx_trim()}}}eXcell_txt.prototype=new eXcell;function eXcell_txttxt(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid}this.getValue=function(){if((this.cell.firstChild)&&(this.cell.firstChild.tagName=="TEXTAREA")){return this.cell.firstChild.value}if(this.cell._clearCell){return""}if((!this.grid.multiLine)&&this.cell._brval){return this.cell._brval}return(_isIE?this.cell.innerText:this.cell.textContent)};this.setValue=function(c){this.cell._brval=c;if(!c||c.toString()._dhx_trim()==""){c=" ";this.cell._clearCell=true}else{this.cell._clearCell=false}this.setCTxtValue(c)}}eXcell_txttxt.prototype=new eXcell_txt;eXcell_txt.prototype.setValue=function(a){this.cell._brval=a;if(!a||a.toString()._dhx_trim()==""){a="&nbsp;";this.cell._clearCell=true}else{this.cell._clearCell=false}if((!this.grid.multiLine)||this.cell._clearCell){this.setCValue(a,this.cell._brval)}else{this.setCValue(a.replace(/\n/g,"<br/>"),a)}};function eXcell_co(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid;this.combo=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex));this.editable=true}this.shiftNext=function(){var c=this.list.options[this.list.selectedIndex+1];if(c){c.selected=true}this.obj.value=this.list.options[this.list.selectedIndex].text;return true};this.shiftPrev=function(){if(this.list.selectedIndex!=0){var c=this.list.options[this.list.selectedIndex-1];if(c){c.selected=true}this.obj.value=this.list.options[this.list.selectedIndex].text}return true};this.edit=function(){this.val=this.getValue();this.text=this.getText()._dhx_trim();var e=this.grid.getPosition(this.cell);this.obj=document.createElement("TEXTAREA");this.obj.className="dhx_combo_edit";this.obj.style.height=(this.cell.offsetHeight-4)+"px";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.style.textAlign;this.obj.onclick=function(l){(l||event).cancelBubble=true};this.obj.onmousedown=function(l){(l||event).cancelBubble=true};this.obj.value=this.text;this.obj.onselectstart=function(l){if(!l){l=event}l.cancelBubble=true;return true};var g=this;this.obj.onkeyup=function(n){var m=(n||event).keyCode;if(m==38||m==40||m==9){return}var o=this.readonly?String.fromCharCode(m):this.value;var q=g.list.options;for(var l=0;l<q.length;l++){if(q[l].text.indexOf(o)==0){return q[l].selected=true}}};this.list=document.createElement("SELECT");this.list.className="dhx_combo_select";this.list.style.width=this.cell.offsetWidth+"px";this.list.style.left=e[0]+"px";this.list.style.top=e[1]+this.cell.offsetHeight+"px";this.list.onclick=function(n){var m=n||window.event;var l=m.target||m.srcElement;if(l.tagName=="OPTION"){l=l.parentNode}g.editable=false;g.grid.editStop();m.cancelBubble=true};var c=this.combo.getKeys();var f=false;var k=0;for(var d=0;d<c.length;d++){var h=this.combo.get(c[d]);this.list.options[this.list.options.length]=new Option(h,c[d]);if(c[d]==this.val){k=this.list.options.length-1;f=true}}if(f==false){this.list.options[this.list.options.length]=new Option(this.text,this.val===null?"":this.val);k=this.list.options.length-1}document.body.appendChild(this.list);this.list.size="6";this.cstate=1;if(this.editable){this.cell.innerHTML=""}else{this.obj.style.width="1px";this.obj.style.height="1px"}this.cell.appendChild(this.obj);this.list.options[k].selected=true;if((!_isFF)||(this.editable)){this.obj.focus();this.obj.focus()}if(!this.editable){this.obj.style.visibility="hidden";this.list.focus();this.list.onkeydown=function(l){l=l||window.event;g.grid.setActive(true);if(l.keyCode<30){return g.grid.doKey({target:g.cell,keyCode:l.keyCode,shiftKey:l.shiftKey,ctrlKey:l.ctrlKey})}}}};this.getValue=function(){return((this.cell.combo_value==window.undefined)?"":this.cell.combo_value)};this.detach=function(){if(this.val!=this.getValue()){this.cell.wasChanged=true}if(this.list.parentNode!=null){if(this.editable){var c=this.list.options[this.list.selectedIndex];if(c&&c.text==this.obj.value){this.setValue(this.list.value)}else{var d=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex));var e=d.values._dhx_find(this.obj.value);if(e!=-1){this.setValue(d.keys[e])}else{this.setValue(this.cell.combo_value=this.obj.value)}}}else{this.setValue(this.list.value)}}if(this.list.parentNode){this.list.parentNode.removeChild(this.list)}if(this.obj.parentNode){this.obj.parentNode.removeChild(this.obj)}return this.val!=this.getValue()}}eXcell_co.prototype=new eXcell;eXcell_co.prototype.getText=function(){return this.cell.innerHTML};eXcell_co.prototype.setValue=function(e){if(typeof(e)=="object"){var d=this.grid.xmlLoader.doXPath("./option",e);if(d.length){this.cell._combo=new dhtmlXGridComboObject()}for(var c=0;c<d.length;c++){this.cell._combo.put(d[c].getAttribute("value"),d[c].firstChild?d[c].firstChild.data:"")}e=e.firstChild.data}if((e||"").toString()._dhx_trim()==""){e=null}this.cell.combo_value=e;if(e!==null){var a=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(e);this.setCValue(a===null?e:a,e)}else{this.setCValue("&nbsp;",e)}};function eXcell_coro(a){this.base=eXcell_co;this.base(a);this.editable=false}eXcell_coro.prototype=new eXcell_co;function eXcell_cotxt(a){this.base=eXcell_co;this.base(a)}eXcell_cotxt.prototype=new eXcell_co;eXcell_cotxt.prototype.getText=function(){return(_isIE?this.cell.innerText:this.cell.textContent)};eXcell_cotxt.prototype.setValue=function(d){if(typeof(d)=="object"){var c=this.grid.xmlLoader.doXPath("./option",d);if(c.length){this.cell._combo=new dhtmlXGridComboObject()}for(var a=0;a<c.length;a++){this.cell._combo.put(c[a].getAttribute("value"),c[a].firstChild?c[a].firstChild.data:"")}d=d.firstChild.data}if((d||"").toString()._dhx_trim()==""){d=null}if(d!==null){this.setCTxtValue((this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(d)||d,d)}else{this.setCTxtValue(" ",d)}this.cell.combo_value=d};function eXcell_corotxt(a){this.base=eXcell_co;this.base(a);this.editable=false}eXcell_corotxt.prototype=new eXcell_cotxt;function eXcell_cp(a){try{this.cell=a;this.grid=this.cell.parentNode.grid}catch(c){}this.edit=function(){this.val=this.getValue();this.obj=document.createElement("SPAN");this.obj.style.border="1px solid black";this.obj.style.position="absolute";var d=this.grid.getPosition(this.cell);this.colorPanel(4,this.obj);document.body.appendChild(this.obj);this.obj.style.left=d[0]+"px";this.obj.style.zIndex=1000;this.obj.style.top=d[1]+this.cell.offsetHeight+"px"};this.toolDNum=function(d){if(d.length==1){d="0"+d}return d};this.colorPanel=function(l,q){var h=document.createElement("TABLE");q.appendChild(h);h.cellSpacing=0;h.editor_obj=this;h.style.cursor="default";h.onclick=function(u){var s=u||window.event;var n=s.target||s.srcElement;var r=n.parentNode.parentNode.parentNode.editor_obj;r.setValue(n._bg);r.grid.editStop()};var f=256/l;for(var g=0;g<=(256/f);g++){var d=h.insertRow(g);for(var k=0;k<=(256/f);k++){for(var e=0;e<=(256/f);e++){R=new Number(f*g)-(g==0?0:1);G=new Number(f*k)-(k==0?0:1);B=new Number(f*e)-(e==0?0:1);var o=this.toolDNum(R.toString(16))+""+this.toolDNum(G.toString(16))+""+this.toolDNum(B.toString(16));var m=d.insertCell(k);m.width="10px";m.innerHTML="&nbsp;";m.title=o.toUpperCase();m.style.backgroundColor="#"+o;m._bg="#"+o;if(this.val!=null&&"#"+o.toUpperCase()==this.val.toUpperCase()){m.style.border="2px solid white"}}}}};this.getValue=function(){return this.cell.firstChild._bg||""};this.getRed=function(){return Number(parseInt(this.getValue().substr(1,2),16))};this.getGreen=function(){return Number(parseInt(this.getValue().substr(3,2),16))};this.getBlue=function(){return Number(parseInt(this.getValue().substr(5,2),16))};this.detach=function(){if(this.obj.offsetParent!=null){document.body.removeChild(this.obj)}return this.val!=this.getValue()}}eXcell_cp.prototype=new eXcell;eXcell_cp.prototype.setValue=function(a){this.setCValue("<div style='width:100%;height:"+((this.grid.multiLine?this.cell.offsetHeight-2:16))+";background-color:"+(a||"")+";border:0px;'>&nbsp;</div>",a);this.cell.firstChild._bg=a};function eXcell_img(a){try{this.cell=a;this.grid=this.cell.parentNode.grid}catch(c){}this.getValue=function(){if(this.cell.firstChild.tagName=="IMG"){return this.cell.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"")}else{if(this.cell.firstChild.tagName=="A"){var d=this.cell.firstChild.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"");d+="^"+this.cell.lnk;if(this.cell.trg){d+="^"+this.cell.trg}return d}}};this.isDisabled=function(){return true}}eXcell_img.prototype=new eXcell;eXcell_img.prototype.getTitle=function(){return this.cell._brval};eXcell_img.prototype.setValue=function(d){var c=d;if((d||"").indexOf("^")!=-1){var a=d.split("^");d=a[0];c=this.cell._attrs.title||a[1];if(a.length>2){this.cell.lnk=a[2];if(a[3]){this.cell.trg=a[3]}}this.cell.titFl="1"}this.setCValue("<img src='"+this.grid.iconURL+(d||"")._dhx_trim()+"' border='0'>",d);if(this.cell.lnk){this.cell.innerHTML="<a href='"+this.cell.lnk+"' target='"+this.cell.trg+"'>"+this.cell.innerHTML+"</a>"}this.cell._brval=c};function eXcell_price(a){this.base=eXcell_ed;this.base(a);this.getValue=function(){if(this.cell.childNodes.length>1){return this.cell.childNodes[1].innerHTML.toString()._dhx_trim()}else{return"0"}}}eXcell_price.prototype=new eXcell_ed;eXcell_price.prototype.setValue=function(c){if(isNaN(parseFloat(c))){c=this.val||0}var a="green";if(c<0){a="red"}this.setCValue("<span>$</span><span style='padding-right:2px;color:"+a+";'>"+c+"</span>",c)};function eXcell_dyn(a){this.base=eXcell_ed;this.base(a);this.getValue=function(){return this.cell.firstChild.childNodes[1].innerHTML.toString()._dhx_trim()}}eXcell_dyn.prototype=new eXcell_ed;eXcell_dyn.prototype.setValue=function(d){if(!d||isNaN(Number(d))){if(d!==""){d=0}}if(d>0){var c="green";var a="dyn_up.gif"}else{if(d==0){var c="black";var a="dyn_.gif"}else{var c="red";var a="dyn_down.gif"}}this.setCValue("<div style='position:relative;padding-right:2px; width:100%;overflow:hidden; white-space:nowrap;'><img src='"+this.grid.imgURL+""+a+"' height='15' style='position:absolute;top:0px;left:0px;'><span style=' padding-left:20px; width:100%;color:"+c+";'>"+d+"</span></div>",d)};function eXcell_ro(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid}this.edit=function(){};this.isDisabled=function(){return true};this.getValue=function(){return this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()}}eXcell_ro.prototype=new eXcell;window.eXcell_hidden=function(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid}this.edit=function(){};this.isDisabled=function(){return true};this.getValue=function(){return this.cell.val}};eXcell_hidden.prototype=new eXcell;eXcell_hidden.prototype.setValue=function(a){this.cell.val=a};function eXcell_ron(a){this.cell=a;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return true};this.getValue=function(){return this.cell._clearCell?"":this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex).toString()}}eXcell_ron.prototype=new eXcell;eXcell_ron.prototype.setValue=function(a){if(a===0){}else{if(!a||a.toString()._dhx_trim()==""){this.setCValue("&nbsp;");return this.cell._clearCell=true}}this.cell._clearCell=false;this.setCValue(a?this.grid._aplNF(a,this.cell._cellIndex):"0")};function eXcell_rotxt(a){this.cell=a;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return true};this.setValue=function(c){if(!c){c=" ";this.cell._clearCell=true}else{this.cell._clearCell=false}this.setCTxtValue(c)};this.getValue=function(){if(this.cell._clearCell){return""}return(_isIE?this.cell.innerText:this.cell.textContent)}}eXcell_rotxt.prototype=new eXcell;function dhtmlXGridComboObject(){this.keys=new dhtmlxArray();this.values=new dhtmlxArray();this.put=function(c,d){for(var a=0;a<this.keys.length;a++){if(this.keys[a]==c){this.values[a]=d;return true}}this.values[this.values.length]=d;this.keys[this.keys.length]=c};this.get=function(c){for(var a=0;a<this.keys.length;a++){if(this.keys[a]==c){return this.values[a]}}return null};this.clear=function(){this.keys=new dhtmlxArray();this.values=new dhtmlxArray()};this.remove=function(c){for(var a=0;a<this.keys.length;a++){if(this.keys[a]==c){this.keys._dhx_removeAt(a);this.values._dhx_removeAt(a);return true}}};this.size=function(){var a=0;for(var c=0;c<this.keys.length;c++){if(this.keys[c]!=null){a++}}return a};this.getKeys=function(){var a=new Array(0);for(var c=0;c<this.keys.length;c++){if(this.keys[c]!=null){a[a.length]=this.keys[c]}}return a};this.save=function(){this._save=new Array();for(var a=0;a<this.keys.length;a++){this._save[a]=[this.keys[a],this.values[a]]}};this.restore=function(){if(this._save){this.keys[a]=new Array();this.values[a]=new Array();for(var a=0;a<this._save.length;a++){this.keys[a]=this._save[a][0];this.values[a]=this._save[a][1]}}};return this}function Hashtable(){this.keys=new dhtmlxArray();this.values=new dhtmlxArray();return this}Hashtable.prototype=new dhtmlXGridComboObject;dhtmlXGridObject.prototype.enableDragAndDrop=function(a){if(a=="temporary_disabled"){this.dADTempOff=false;a=true}else{this.dADTempOff=true}this.dragAndDropOff=convertStringToBoolean(a);this._drag_validate=true;if(a){this.objBox.ondragstart=function(c){(c||event).cancelBubble=true;return false}}};dhtmlXGridObject.prototype.setDragBehavior=function(a){this.dadmodec=this.dadmodefix=0;switch(a){case"child":this.dadmode=0;this._sbmod=false;break;case"sibling":this.dadmode=1;this._sbmod=false;break;case"sibling-next":this.dadmode=1;this._sbmod=true;break;case"complex":this.dadmode=2;this._sbmod=false;break;case"complex-next":this.dadmode=2;this._sbmod=true;break}};dhtmlXGridObject.prototype.enableDragOrder=function(a){this._dndorder=convertStringToBoolean(a)};dhtmlXGridObject.prototype._checkParent=function(e,c){var d=this._h2.get[e.idd].parent;if(!d.parent){return}for(var a=0;a<c.length;a++){if(c[a]==d.id){return true}}return this._checkParent(this.rowsAr[d.id],c)};dhtmlXGridObject.prototype._createDragNode=function(d,f){this.editStop();if(window.dhtmlDragAndDrop.dragNode){return null}if(!this.dADTempOff){return null}d.parentObject=new Object();d.parentObject.treeNod=this;var l=this.callEvent("onBeforeDrag",[d.parentNode.idd,d._cellIndex,f]);if(!l){return null}var g=new Array();g=this.getSelectedId();g=(((g)&&(g!=""))?g.split(this.delim):[]);var h=false;for(var c=0;c<g.length;c++){if(g[c]==d.parentNode.idd){h=true}}if(!h){this.selectRow(this.rowsAr[d.parentNode.idd],false,f.ctrlKey,false);if(!f.ctrlKey){g=[]}g[this.selMultiRows?g.length:0]=d.parentNode.idd}if(this.isTreeGrid()){for(var c=g.length-1;c>=0;c--){if(this._checkParent(this.rowsAr[g[c]],g)){g.splice(c,1)}}}var m=this;if(g.length&&this._dndorder){g.sort(function(n,e){return(m.rowsAr[n].rowIndex>m.rowsAr[e].rowIndex?1:-1)})}var a=this.getFirstParentOfType(_isIE?f.srcElement:f.target,"TD");if(a){this._dndExtra=a._cellIndex}this._dragged=new Array();for(var c=0;c<g.length;c++){if(this.rowsAr[g[c]]){this._dragged[this._dragged.length]=this.rowsAr[g[c]];this.rowsAr[g[c]].treeNod=this}}d.parentObject.parentNode=d.parentNode;var k=document.createElement("div");k.innerHTML=(l!==true?l:this.rowToDragElement(d.parentNode.idd));k.style.position="absolute";k.className="dragSpanDiv";return k};dhtmlXGridObject.prototype._createSdrgc=function(){this._sdrgc=document.createElement("DIV");this._sdrgc.innerHTML="&nbsp;";this._sdrgc.className="gridDragLine";this.objBox.appendChild(this._sdrgc)};function dragContext(w,v,u,s,r,q,n,o,m,g){this.source=w||"grid";this.target=v||"grid";this.mode=u||"move";this.dropmode=s||"child";this.sid=r||0;this.tid=q;this.sobj=n||null;this.tobj=o||null;this.sExtra=m||null;this.tExtra=g||null;return this}dragContext.prototype.valid=function(){if(this.sobj!=this.tobj){return true}if(this.sid==this.tid){return false}if(this.target=="treeGrid"){var a=this.tid;while(a=this.tobj.getParentId(a)){if(this.sid==a){return false}}}return true};dragContext.prototype.close=function(){this.sobj=null;this.tobj=null};dragContext.prototype.copy=function(){return new dragContext(this.source,this.target,this.mode,this.dropmode,this.sid,this.tid,this.sobj,this.tobj,this.sExtra,this.tExtra)};dragContext.prototype.set=function(d,c){this[d]=c;return this};dragContext.prototype.uid=function(d,c){this.nid=this.sid;while(this.tobj.rowsAr[this.nid]){this.nid=this.nid+((new Date()).valueOf())}return this};dragContext.prototype.data=function(){if(this.sobj==this.tobj){return this.sobj._getRowArray(this.sobj.rowsAr[this.sid])}if(this.source=="tree"){return this.tobj.treeToGridElement(this.sobj,this.sid,this.tid)}else{return this.tobj.gridToGrid(this.sid,this.sobj,this.tobj)}};dragContext.prototype.attrs=function(){if(this.source=="tree"){return{}}else{return this.sobj.rowsAr[this.sid]._attrs}};dragContext.prototype.childs=function(){if(this.source=="treeGrid"){return this.sobj._h2.get[this.sid]._xml_await?this.sobj._h2.get[this.sid].has_kids:null}return null};dragContext.prototype.pid=function(){if(!this.tid){return 0}if(!this.tobj._h2){return 0}if(this.target=="treeGrid"){if(this.dropmode=="child"){return this.tid}else{var c=this.tobj.rowsAr[this.tid];var a=this.tobj._h2.get[c.idd].parent.id;if((this.alfa)&&(this.tobj._sbmod)&&(c.nextSibling)){var d=this.tobj._h2.get[c.nextSibling.idd].parent.id;if(d==this.tid){return this.tid}if(d!=a){return d}}return a}}};dragContext.prototype.ind=function(){if(this.tid==window.unknown){return this.tobj.rowsBuffer.length}if(this.target=="treeGrid"){if(this.dropmode=="child"){this.tobj.openItem(this.tid)}else{this.tobj.openItem(this.tobj.getParentId(this.tid))}}var a=this.tobj.rowsBuffer._dhx_find(this.tobj.rowsAr[this.tid]);if((this.alfa)&&(this.tobj._sbmod)&&(this.dropmode=="sibling")){var c=this.tobj.rowsAr[this.tid];if((c.nextSibling)&&(this._h2.get[c.nextSibling.idd].parent.id==this.tid)){return a+1}}return(a+1+((this.target=="treeGrid"&&a>=0&&this.tobj._h2.get[this.tobj.rowsBuffer[a].idd].state=="minus")?this.tobj._getOpenLenght(this.tobj.rowsBuffer[a].idd,0):0))};dragContext.prototype.img=function(){if((this.target!="grid")&&(this.sobj._h2)){return this.sobj.getItemImage(this.sid)}else{return null}};dragContext.prototype.slist=function(){var c=new Array();for(var a=0;a<this.sid.length;a++){c[c.length]=this.sid[a][(this.source=="tree")?"id":"idd"]}return c.join(",")};dhtmlXGridObject.prototype._drag=function(n,f,m,o){if(this._realfake){return this._fake._drag()}var l=(this.lastLanding);if(this._autoOpenTimer){window.clearTimeout(this._autoOpenTimer)}var e=m.parentNode;var d=n.parentObject;if(!e.idd){e.grid=this;this.dadmodefix=0}var k=new dragContext(0,0,0,((e.grid.dadmode==1||e.grid.dadmodec)?"sibling":"child"));if(d&&d.childNodes){k.set("source","tree").set("sobj",d.treeNod).set("sid",k.sobj._dragged)}else{if(!d){return true}if(d.treeNod.isTreeGrid&&d.treeNod.isTreeGrid()){k.set("source","treeGrid")}k.set("sobj",d.treeNod).set("sid",k.sobj._dragged)}if(e.grid.isTreeGrid()){k.set("target","treeGrid")}else{k.set("dropmode","sibling")}k.set("tobj",e.grid).set("tid",e.idd);if(((k.tobj.dadmode==2)&&(k.tobj.dadmodec==1))&&(k.tobj.dadmodefix<0)){if(k.tobj.obj.rows[1].idd!=k.tid){k.tid=e.previousSibling.idd}else{k.tid=0}}var a=this.getFirstParentOfType(o,"TD");if(a){k.set("tExtra",a._cellIndex)}if(a){k.set("sExtra",k.sobj._dndExtra)}if(k.sobj.dpcpy){k.set("mode","copy")}if(k.tobj._realfake){k.tobj=k.tobj._fake}if(k.sobj._realfake){k.sobj=k.sobj._fake}k.tobj._clearMove();if(d&&d.treeNod&&d.treeNod._nonTrivialRow){d.treeNod._nonTrivialRow(this,k.tid,k.dropmode,d)}else{k.tobj.dragContext=k;if(!k.tobj.callEvent("onDrag",[k.slist(),k.tid,k.sobj,k.tobj,k.sExtra,k.tExtra])){return k.tobj.dragContext=null}var q=new Array();if(typeof(k.sid)=="object"){var h=k.copy();for(var g=0;g<k.sid.length;g++){if(!h.set("alfa",(!g)).set("sid",k.sid[g][(k.source=="tree"?"id":"idd")]).valid()){continue}h.tobj._dragRoutine(h);if(h.target=="treeGrid"&&h.dropmode=="child"){h.tobj.openItem(h.tid)}q[q.length]=h.nid;h.set("dropmode","sibling").set("tid",h.nid)}h.close()}else{k.tobj._dragRoutine(k)}if(k.tobj.laterLink){k.tobj.laterLink()}k.tobj.callEvent("onDrop",[k.slist(),k.tid,q.join(","),k.sobj,k.tobj,k.sExtra,k.tExtra])}k.tobj.dragContext=null;k.close()};dhtmlXGridObject.prototype._dragRoutine=function(n){if((n.sobj==n.tobj)&&(n.source=="grid")&&(n.mode=="move")&&!this._fake){if(n.sobj._dndProblematic){return}var k=n.sobj.rowsAr[n.sid];var m=n.sobj.rowsCol._dhx_find(k);n.sobj.rowsCol._dhx_removeAt(n.sobj.rowsCol._dhx_find(k));n.sobj.rowsBuffer._dhx_removeAt(n.sobj.rowsBuffer._dhx_find(k));n.sobj.rowsBuffer._dhx_insertAt(n.ind(),k);if(n.tobj._fake){n.tobj._fake.rowsCol._dhx_removeAt(m);var o=n.tobj._fake.rowsAr[n.sid];o.parentNode.removeChild(o)}n.sobj._insertRowAt(k,n.ind());n.nid=n.sid;n.sobj.callEvent("onGridReconstructed",[]);return}var h;if(this._h2&&typeof n.tid!="undefined"&&n.dropmode=="sibling"&&(this._sbmod||n.tid)){if(n.alfa&&this._sbmod&&this._h2.get[n.tid].childs.length){this.openItem(n.tid);h=n.uid().tobj.addRowBefore(n.nid,n.data(),this._h2.get[n.tid].childs[0].id,n.img(),n.childs())}else{h=n.uid().tobj.addRowAfter(n.nid,n.data(),n.tid,n.img(),n.childs())}}else{h=n.uid().tobj.addRow(n.nid,n.data(),n.ind(),n.pid(),n.img(),n.childs())}h._attrs=n.attrs();if(n.source=="tree"){this.callEvent("onRowAdded",[n.nid]);var a=n.sobj._globalIdStorageFind(n.sid);if(a.childsCount){var g=n.copy().set("tid",n.nid).set("dropmode",n.target=="grid"?"sibling":"child");for(var e=0;e<a.childsCount;e++){n.tobj._dragRoutine(g.set("sid",a.childNodes[e].id));if(n.mode=="move"){e--}}g.close()}}else{n.tobj._copyUserData(n);this.callEvent("onRowAdded",[n.nid]);if((n.source=="treeGrid")){if(n.sobj==n.tobj){h._xml=n.sobj.rowsAr[n.sid]._xml}var f=n.sobj._h2.get[n.sid];if((f)&&(f.childs.length)){var g=n.copy().set("tid",n.nid);if(n.target=="grid"){g.set("dropmode","sibling")}else{g.tobj.openItem(n.tid);g.set("dropmode","child")}var d=f.childs.length;for(var e=0;e<d;e++){n.sobj.render_row_tree(null,f.childs[e].id);n.tobj._dragRoutine(g.set("sid",f.childs[e].id));if(d!=f.childs.length){e--;d=f.childs.length}}g.close()}}}if(n.mode=="move"){n.sobj[(n.source=="tree")?"deleteItem":"deleteRow"](n.sid);if((n.sobj==n.tobj)&&(!n.tobj.rowsAr[n.sid])){n.tobj.changeRowId(n.nid,n.sid);n.nid=n.sid}}};dhtmlXGridObject.prototype.gridToGrid=function(e,a,d){var f=new Array();for(var c=0;c<a.hdr.rows[0].cells.length;c++){f[c]=a.cells(e,c).getValue()}return f};dhtmlXGridObject.prototype.checkParentLine=function(a,c){if((!this._h2)||(!c)||(!a)){return false}if(a.id==c){return true}else{return this.checkParentLine(a.parent,c)}};dhtmlXGridObject.prototype._dragIn=function(f,d,c,g){if(!this.dADTempOff){return 0}var a=this.isTreeGrid();var e=d.parentNode.idd?d.parentNode:d.parentObject;if(this._drag_validate){if(f.parentNode==d.parentNode){return 0}if((a)&&(this==e.grid)&&((this.checkParentLine(this._h2.get[f.parentNode.idd],d.parentNode.idd)))){return 0}}if(!this.callEvent("onDragIn",[e.idd||e.id,f.parentNode.idd,e.grid||e.treeNod,(f.grid||f.parentNode.grid)])){return this._setMove(f,c,g,true)}this._setMove(f,c,g);if((a)&&(f.parentNode.expand!="")){this._autoOpenTimer=window.setTimeout(new callerFunction(this._autoOpenItem,this),1000);this._autoOpenId=f.parentNode.idd}else{if(this._autoOpenTimer){window.clearTimeout(this._autoOpenTimer)}}return f};dhtmlXGridObject.prototype._autoOpenItem=function(a,c){c.openItem(c._autoOpenId)};dhtmlXGridObject.prototype._dragOut=function(c){this._clearMove();var a=c.parentNode.parentObject?c.parentObject.id:c.parentNode.idd;this.callEvent("onDragOut",[a]);if(this._autoOpenTimer){window.clearTimeout(this._autoOpenTimer)}};dhtmlXGridObject.prototype._setMove=function(g,c,k,f){if(!g.parentNode.idd){return}var d=getAbsoluteTop(g);var a=getAbsoluteTop(this.objBox);if((d-a)>(parseInt(this.objBox.offsetHeight)-50)){this.objBox.scrollTop=parseInt(this.objBox.scrollTop)+20}if((d-a+parseInt(this.objBox.scrollTop))<(parseInt(this.objBox.scrollTop)+30)){this.objBox.scrollTop=parseInt(this.objBox.scrollTop)-20}if(f){return 0}if(this.dadmode==2){var h=k-d+(document.body.scrollTop||document.documentElement.scrollTop)-2-g.offsetHeight/2;if((Math.abs(h)-g.offsetHeight/6)>0){this.dadmodec=1;if(h<0){this.dadmodefix=-1}else{this.dadmodefix=1}}else{this.dadmodec=0}}else{this.dadmodec=this.dadmode}if(this.dadmodec){if(!this._sdrgc){this._createSdrgc()}this._sdrgc.style.display="block";this._sdrgc.style.top=d-a+parseInt(this.objBox.scrollTop)+((this.dadmodefix>=0)?g.offsetHeight:0)+"px"}else{this._llSelD=g;if(g.parentNode.tagName=="TR"){for(var e=0;e<g.parentNode.childNodes.length;e++){var h=g.parentNode.childNodes[e];h._bgCol=h.style.backgroundColor;h.style.backgroundColor="#FFCCCC"}}}};dhtmlXGridObject.prototype._clearMove=function(){if(this._sdrgc){this._sdrgc.style.display="none"}if((this._llSelD)&&(this._llSelD.parentNode.tagName=="TR")){var c=this._llSelD.parentNode.childNodes;for(var a=0;a<c.length;a++){c[a].style.backgroundColor=c[a]._bgCol}}this._llSelD=null};dhtmlXGridObject.prototype.rowToDragElement=function(a){var c=this.cells(a,0).getValue();return c};dhtmlXGridObject.prototype._copyUserData=function(e){if(!e.tobj.UserData[e.nid]||e.tobj!=e.sobj){e.tobj.UserData[e.nid]=new Hashtable()}else{return}var d=e.sobj.UserData[e.sid];var a=e.tobj.UserData[e.nid];if(d){a.keys=a.keys.concat(d.keys);a.values=a.values.concat(d.values)}};dhtmlXGridObject.prototype.moveRow=function(d,e,a,c){switch(e){case"row_sibling":this.moveRowTo(d,a,"move","sibling",this,c);break;case"up":this.moveRowUp(d);break;case"down":this.moveRowDown(d);break}};dhtmlXGridObject.prototype._nonTrivialNode=function(n,m,h,k,d){if((n.callEvent)&&(!d)){if(!n.callEvent("onDrag",[k.idd,m.id,(h?h.id:null),this,n])){return false}}var l=k.idd;var a=l;while(n._idpull[a]){a+=(new Date()).getMilliseconds().toString()}var f=(this.isTreeGrid()?this.getItemImage(l):"");if(h){for(e=0;e<m.childsCount;e++){if(m.childNodes[e]==h){break}}if(e!=0){h=m.childNodes[e-1]}else{st="TOP";h=""}}var c=n._attachChildNode(m,a,this.gridToTreeElement(n,a,l),"",f,f,f,"","",h);if(this._h2){var g=this._h2.get[l];if(g.childs.length){for(var e=0;e<g.childs.length;e++){this._nonTrivialNode(n,c,0,this.rowsAr[g.childs[e].id],1);if(!this.dpcpy){e--}}}}if(!this.dpcpy){this.deleteRow(l)}if((n.callEvent)&&(!d)){n.callEvent("onDrop",[a,m.id,(h?h.id:null),this,n])}};dhtmlXGridObject.prototype.gridToTreeElement=function(c,d,a){return this.cells(a,0).getValue()};dhtmlXGridObject.prototype.treeToGridElement=function(e,f,a){var c=new Array();var g=this.cellType._dhx_find("tree");if(g==-1){g=0}for(var d=0;d<this.getColumnCount();d++){c[c.length]=(d!=g)?(e.getUserData(f,this.getColumnId(d))||""):e.getItemText(f)}return c};dhtmlXGridObject.prototype.moveRowTo=function(e,d,h,g,a,f){var k=new dragContext((a||this).isTreeGrid()?"treeGrid":"grid",(f||this).isTreeGrid()?"treeGrid":"grid",h,g||"sibling",e,d,a||this,f||this);k.tobj._dragRoutine(k);k.close();return k.nid};dhtmlXGridObject.prototype.enableMercyDrag=function(a){this.dpcpy=convertStringToBoolean(a)};dhtmlXGridObject.prototype.toPDF=function(f,n,s,q,l,x){var g={row:this.getSelectedRowId(),col:this.getSelectedCellIndex()};if(g.row===null||g.col===-1){g=false}else{var c=this.cells(g.row,g.col).cell;c.parentNode.className=c.parentNode.className.replace(" rowselected","");c.className=c.className.replace(" cellselected","");g.el=c}n=n||"color";var u=n=="full_color";var a=this;a._asCDATA=true;if(typeof(x)==="undefined"){this.target=' target="_blank"'}else{this.target=x}eXcell_ch.prototype.getContent=function(){return this.getValue()};eXcell_ra.prototype.getContent=function(){return this.getValue()};function w(A){var I=[];for(var F=1;F<a.hdr.rows.length;F++){I[F]=[];for(var E=0;E<a._cCount;E++){var K=a.hdr.rows[F].childNodes[E];if(!I[F][E]){I[F][E]=[0,0]}if(K){I[F][K._cellIndexS]=[K.colSpan,K.rowSpan]}}}var H="<rows profile='"+A+"'";if(s){H+=" header='"+s+"'"}if(q){H+=" footer='"+q+"'"}H+="><head>"+a._serialiseExportConfig(I).replace(/^<head/,"<columns").replace(/head>$/,"columns>");for(var F=2;F<a.hdr.rows.length;F++){var d=0;var N=a.hdr.rows[F];var J="";for(var E=0;E<a._cCount;E++){if((a._srClmn&&!a._srClmn[E])||(a._hrrar[E]&&(!a._fake||E>=a._fake.hdrLabels.length))){d++;continue}var M=I[F][E];var L=((M[0]&&M[0]>1)?' colspan="'+M[0]+'" ':"");if(M[1]&&M[1]>1){L+=' rowspan="'+M[1]+'" ';d=-1}var y="";var D=N;if(a._fake&&E<a._fake._cCount){D=a._fake.hdr.rows[F]}for(var C=0;C<D.cells.length;C++){if(D.cells[C]._cellIndexS==E){if(D.cells[C].getElementsByTagName("SELECT").length){y=""}else{y=_isIE?D.cells[C].innerText:D.cells[C].textContent}y=y.replace(/[ \n\r\t\xA0]+/," ");break}}if(!y||y==" "){d++}J+="<column"+L+"><![CDATA["+y+"]]></column>"}if(d!=a._cCount){H+="\n<columns>"+J+"</columns>"}}H+="</head>\n";H+=m();return H}function e(){var d=[];if(l){for(var y=0;y<l.length;y++){d.push(r(a.getRowIndex(l[y])))}}else{for(var y=0;y<a.getRowsNum();y++){d.push(r(y))}}return d.join("\n")}function m(){var A=["<foot>"];if(!a.ftr){return""}for(var C=1;C<a.ftr.rows.length;C++){A.push("<columns>");var F=a.ftr.rows[C];for(var y=0;y<a._cCount;y++){if(a._srClmn&&!a._srClmn[y]){continue}if(a._hrrar[y]&&(!a._fake||y>=a._fake.hdrLabels.length)){continue}for(var d=0;d<F.cells.length;d++){var E="";var D="";if(F.cells[d]._cellIndexS==y){E=_isIE?F.cells[d].innerText:F.cells[d].textContent;E=E.replace(/[ \n\r\t\xA0]+/," ");if(F.cells[d].colSpan&&F.cells[d].colSpan!=1){D=" colspan='"+F.cells[d].colSpan+"' "}if(F.cells[d].rowSpan&&F.cells[d].rowSpan!=1){D=" rowspan='"+F.cells[d].rowSpan+"' "}break}}A.push("<column"+D+"><![CDATA["+E+"]]></column>")}A.push("</columns>")}A.push("</foot>");return A.join("\n")}function k(y,d){return(window.getComputedStyle?(window.getComputedStyle(y,null)[d]):(y.currentStyle?y.currentStyle[d]:null))||""}function r(C){if(!a.rowsBuffer[C]){return""}var d=a.render_row(C);if(d.style.display=="none"){return""}var y=a.isTreeGrid()?' level="'+a.getLevel(d.idd)+'"':"";var H="<row"+y+">";for(var E=0;E<a._cCount;E++){if(((!a._srClmn)||(a._srClmn[E]))&&(!a._hrrar[E]||(a._fake&&E<a._fake.hdrLabels.length))){var L=a.cells(d.idd,E);if(u){var D=k(L.cell,"color");var K=k(L.cell,"backgroundColor");var J=k(L.cell,"font-weight")||k(L.cell,"fontWeight");var F=k(L.cell,"font-style")||k(L.cell,"fontStyle");var I=k(L.cell,"text-align")||k(L.cell,"textAlign");var A=k(L.cell,"font-family")||k(L.cell,"fontFamily");if(K=="transparent"||K=="rgba(0, 0, 0, 0)"){K="rgb(255,255,255)"}H+="<cell bgColor='"+K+"' textColor='"+D+"' bold='"+J+"' italic='"+F+"' align='"+I+"' font='"+A+"'>"}else{H+="<cell>"}H+="<![CDATA["+(L.getContent?L.getContent():L.getTitle())+"]]></cell>"}}return H+"</row>"}function o(){var d="</rows>";return d}var v=document.createElement("div");v.style.display="none";document.body.appendChild(v);var h="form_"+a.uid();v.innerHTML='<form id="'+h+'" method="post" action="'+f+'" accept-charset="utf-8"  enctype="application/x-www-form-urlencoded"'+this.target+'><input type="hidden" name="grid_xml" id="grid_xml"/> </form>';document.getElementById(h).firstChild.value=encodeURIComponent(w(n).replace("\u2013","-")+e()+o());document.getElementById(h).submit();v.parentNode.removeChild(v);a=null;if(g){g.el.parentNode.className+=" rowselected";g.el.className+=" cellselected"}g=null};dhtmlXGridObject.prototype._serialiseExportConfig=function(g){function f(m){if(typeof(m)!=="string"){return m}m=m.replace(/&/g,"&amp;");m=m.replace(/"/g,"&quot;");m=m.replace(/'/g,"&apos;");m=m.replace(/</g,"&lt;");m=m.replace(/>/g,"&gt;");return m}var c="<head>";for(var d=0;d<this.hdr.rows[0].cells.length;d++){if(this._srClmn&&!this._srClmn[d]){continue}if(this._hrrar[d]&&(!this._fake||d>=this._fake.hdrLabels.length)){continue}var e=this.fldSort[d];if(e=="cus"){e=this._customSorts[d].toString();e=e.replace(/function[\ ]*/,"").replace(/\([^\f]*/,"")}var l=g[1][d];var h=((l[1]&&l[1]>1)?' rowspan="'+l[1]+'" ':"")+((l[0]&&l[0]>1)?' colspan="'+l[0]+'" ':"");c+="<column "+h+" width='"+this.getColWidth(d)+"' align='"+this.cellAlign[d]+"' type='"+this.cellType[d]+"' hidden='"+((this.isColumnHidden&&this.isColumnHidden(d))?"true":"false")+"' sort='"+(e||"na")+"' color='"+(this.columnColor[d]||"")+"'"+(this.columnIds[d]?(" id='"+this.columnIds[d]+"'"):"")+">";if(this._asCDATA){c+="<![CDATA["+this.getHeaderCol(d)+"]]>"}else{c+=this.getHeaderCol(d)}var k=this.combos[d]?this.getCombo(d):null;if(k){for(var a=0;a<k.keys.length;a++){c+="<option value='"+f(k.keys[a])+"'><![CDATA["+k.values[a]+"]]></option>"}}c+="</column>"}return c+="</head>"};if(window.eXcell_sub_row_grid){window.eXcell_sub_row_grid.prototype.getContent=function(){return""}}dhtmlXGridObject.prototype.toExcel=function(a,e,h,g,c){if(!document.getElementById("ifr")){var f=document.createElement("iframe");f.style.display="none";f.setAttribute("name","dhx_export_iframe");f.setAttribute("src","");f.setAttribute("id","dhx_export_iframe");document.body.appendChild(f)}var d=' target="dhx_export_iframe"';this.toPDF(a,e,h,g,c,d)};dhtmlXGridObject.prototype.filterBy=function(e,f,c){if(this.isTreeGrid()){return this.filterTreeBy(e,f,c)}if(this._f_rowsBuffer){if(!c){this.rowsBuffer=dhtmlxArray([].concat(this._f_rowsBuffer));if(this._fake){this._fake.rowsBuffer=this.rowsBuffer}}}else{this._f_rowsBuffer=[].concat(this.rowsBuffer)}if(!this.rowsBuffer.length){return}var g=true;this.dma(true);if(typeof(e)=="object"){for(var a=0;a<f.length;a++){this._filterA(e[a],f[a])}}else{this._filterA(e,f)}this.dma(false);if(this.pagingOn&&this.rowsBuffer.length/this.rowsBufferOutSize<(this.currentPage-1)){this.changePage(0)}this._reset_view();this.callEvent("onGridReconstructed",[])};dhtmlXGridObject.prototype._filterA=function(c,e){if(e==""){return}var f=true;if(typeof(e)=="function"){f=false}else{e=(e||"").toString().toLowerCase()}if(!this.rowsBuffer.length){return}for(var a=this.rowsBuffer.length-1;a>=0;a--){if(f?(this._get_cell_value(this.rowsBuffer[a],c).toString().toLowerCase().indexOf(e)==-1):(!e.call(this,this._get_cell_value(this.rowsBuffer[a],c),this.rowsBuffer[a].idd))){this.rowsBuffer.splice(a,1)}}};dhtmlXGridObject.prototype.getFilterElement=function(a){if(!this.filters){return}for(var c=0;c<this.filters.length;c++){if(this.filters[c][1]==a){return(this.filters[c][0].combo||this.filters[c][0])}}return null};dhtmlXGridObject.prototype.collectValues=function(g){var o=this.callEvent("onCollectValues",[g]);if(o!==true){return o}if(this.isTreeGrid()){return this.collectTreeValues(g)}this.dma(true);this._build_m_order();g=this._m_order?this._m_order[g]:g;var m={};var k=[];var e=this._f_rowsBuffer||this.rowsBuffer;for(var h=0;h<e.length;h++){var a=this._get_cell_value(e[h],g);if(a&&(!e[h]._childIndexes||e[h]._childIndexes[g]!=e[h]._childIndexes[g-1])){m[a]=true}}this.dma(false);var n=(this.combos[g]||(this._col_combos?this._col_combos[g]:false));for(var l in m){if(m[l]===true){if(n){if(n.get&&n.get(l)){l=n.get(l)}else{if(n.getOption&&n.getOption(l)){l=n.getOption(l).text}}}k.push(l)}}return k.sort()};dhtmlXGridObject.prototype._build_m_order=function(){if(this._c_order){this._m_order=[];for(var a=0;a<this._c_order.length;a++){this._m_order[this._c_order[a]]=a}}};dhtmlXGridObject.prototype.filterByAll=function(){var d=[];var c=[];this._build_m_order();for(var e=0;e<this.filters.length;e++){var g=this._m_order?this._m_order[this.filters[e][1]]:this.filters[e][1];if(g>=this._cCount){continue}c.push(g);var h=this.filters[e][0].old_value=this.filters[e][0].value;if(this.filters[e][0]._filter){h=this.filters[e][0]._filter()}var f;if(typeof h!="function"&&(f=(this.combos[g]||(this._col_combos?this._col_combos[g]:false)))){if(f.values){g=f.values._dhx_find(h);h=(g==-1)?h:f.keys[g]}else{if(f.getOptionByLabel){h=(f.getOptionByLabel(h)?f.getOptionByLabel(h).value:h)}}}d.push(h)}if(!this.callEvent("onFilterStart",[c,d])){return}this.filterBy(c,d);if(this._cssEven){this._fixAlterCss()}this.callEvent("onFilterEnd",[this.filters]);if(this._f_rowsBuffer&&this.rowsBuffer.length==this._f_rowsBuffer.length){this._f_rowsBuffer=null}};dhtmlXGridObject.prototype.makeFilter=function(f,d,c){if(!this.filters){this.filters=[]}if(typeof(f)!="object"){f=document.getElementById(f)}if(!f){return}var a=this;if(!f.style.width){f.style.width="90%"}if(f.tagName=="SELECT"){this.filters.push([f,d]);this._loadSelectOptins(f,d);f.onchange=function(){a.filterByAll()};if(_isIE){f.style.marginTop="1px"}this.attachEvent("onEditCell",function(h,g,k){this._build_m_order();if(h==2&&this.filters&&(this._m_order?(k==this._m_order[d]):(k==d))){this._loadSelectOptins(f,d)}return true})}else{if(f.tagName=="INPUT"){this.filters.push([f,d]);f.old_value=f.value="";f.onkeydown=function(){if(this._timer){window.clearTimeout(this._timer)}this._timer=window.setTimeout(function(){if(f.value!=f.old_value){a.filterByAll();f.old_value=f.value}},500)}}else{if(f.tagName=="DIV"&&f.className=="combo"){this.filters.push([f,d]);f.style.padding="0px";f.style.margin="0px";if(!window.dhx_globalImgPath){window.dhx_globalImgPath=this.imgURL}var e=new dhtmlXCombo(f,"_filter","90%");e.filterSelfA=e.filterSelf;e.filterSelf=function(){if(this.getSelectedIndex()==0){this.setComboText("")}this.filterSelfA.apply(this,arguments);this.optionsArr[0].hide(false)};e.enableFilteringMode(true);f.combo=e;f.value="";this._loadComboOptins(f,d);e.attachEvent("onChange",function(){f.value=e.getSelectedValue();if(f.value===null){f.value=""}a.filterByAll()})}}}if(f.parentNode){f.parentNode.className+=" filter"}this._filters_ready()};dhtmlXGridObject.prototype.findCell=function(g,h,e,f){var f=f||(function(l,k){return k.toString().toLowerCase().indexOf(l)!=-1});if(f===true){f=function(l,k){return k.toString().toLowerCase()==l}}var d=new Array();g=g.toString().toLowerCase();if(typeof e!="number"){e=e?1:0}if(!this.rowsBuffer.length){return d}for(var c=(h||0);c<this._cCount;c++){if(this._h2){this._h2.forEachChild(0,function(k){if(e&&d.length==e){return d}if(f(g,this._get_cell_value(k.buff,c))){d.push([k.id,c])}},this)}else{for(var a=0;a<this.rowsBuffer.length;a++){if(f(g,this._get_cell_value(this.rowsBuffer[a],c))){d.push([this.rowsBuffer[a].idd,c]);if(e&&d.length==e){return d}}}}if(typeof(h)!="undefined"){return d}}return d};dhtmlXGridObject.prototype.makeSearch=function(e,d,a){if(typeof(e)!="object"){e=document.getElementById(e)}if(!e){return}var c=this;if(e.tagName=="INPUT"){e.onkeypress=function(){if(this._timer){window.clearTimeout(this._timer)}this._timer=window.setTimeout(function(){if(e.value==""){return}var f=c.findCell(e.value,d,true,a);if(f.length){if(c._h2){c.openItem(f[0][0])}c.selectCell(c.getRowIndex(f[0][0]),(d||0))}},500)}}if(e.parentNode){e.parentNode.className+=" filter"}};dhtmlXGridObject.prototype._loadSelectOptins=function(g,k){var a=this.collectValues(k);var d=g.value;g.innerHTML="";g.options[0]=new Option("","");var h=this._filter_tr?this._filter_tr[k]:null;for(var e=0;e<a.length;e++){g.options[g.options.length]=new Option(h?h(a[e]):a[e],a[e])}g.value=d};dhtmlXGridObject.prototype.setSelectFilterLabel=function(c,a){if(!this._filter_tr){this._filter_tr=[]}this._filter_tr[c]=a};dhtmlXGridObject.prototype._loadComboOptins=function(e,g){if(!e.combo){return}var a=this.collectValues(g);e.combo.clearAll();var f=[["",""]];for(var d=0;d<a.length;d++){f.push([a[d],a[d]])}e.combo.addOption(f)};dhtmlXGridObject.prototype.refreshFilters=function(){if(!this.filters){return}for(var a=0;a<this.filters.length;a++){switch(this.filters[a][0].tagName.toLowerCase()){case"input":break;case"select":this._loadSelectOptins.apply(this,this.filters[a]);break;case"div":this._loadComboOptins.apply(this,this.filters[a]);break}}};dhtmlXGridObject.prototype._filters_ready=function(c,a){this.attachEvent("onXLE",this.refreshFilters);this.attachEvent("onRowCreated",function(f,e){if(this._f_rowsBuffer){for(var d=0;d<this._f_rowsBuffer.length;d++){if(this._f_rowsBuffer[d].idd==f){return this._f_rowsBuffer[d]=e}}}});this.attachEvent("onClearAll",function(){this._f_rowsBuffer=null;if(!this.hdr.rows.length){this.filters=[]}});this.attachEvent("onSetSizes",this._filters_resize_combo);this.attachEvent("onResize",this._filters_resize_combo);this._filters_ready=function(){}};dhtmlXGridObject.prototype._filters_resize_combo=function(){if(!this.filters){return}for(var a=0;a<this.filters.length;a++){if(this.filters[a][0].combo!=null){this.filters[a][0].combo.setSize(Math.round(this.filters[a][0].offsetWidth*90/100))}}return true};dhtmlXGridObject.prototype._in_header_text_filter=function(c,a){c.innerHTML="<input type='text'>";c.onclick=c.onmousedown=function(d){(d||event).cancelBubble=true;return true};c.onselectstart=function(){return(event.cancelBubble=true)};this.makeFilter(c.firstChild,a)};dhtmlXGridObject.prototype._in_header_text_filter_inc=function(c,a){c.innerHTML="<input type='text'>";c.onclick=c.onmousedown=function(d){(d||event).cancelBubble=true;return true};c.onselectstart=function(){return(event.cancelBubble=true)};this.makeFilter(c.firstChild,a);c.firstChild._filter=function(){if(c.firstChild.value==""){return""}return function(d){return(d.toString().toLowerCase().indexOf(c.firstChild.value.toLowerCase())==0)}};this._filters_ready()};dhtmlXGridObject.prototype._in_header_select_filter=function(c,a){c.innerHTML="<select></select>";c.onclick=function(d){(d||event).cancelBubble=true;return false};this.makeFilter(c.firstChild,a)};dhtmlXGridObject.prototype._in_header_select_filter_strict=function(d,c){d.innerHTML="<select style='width:90%; font-size:8pt; font-family:Tahoma;'></select>";d.onclick=function(f){(f||event).cancelBubble=true;return false};this.makeFilter(d.firstChild,c);var a=this.combos;d.firstChild._filter=function(){var e=d.firstChild.value;if(!e){return""}if(a[c]){e=a[c].keys[a[c].values._dhx_find(e)]}e=e.toLowerCase();return function(f){return(f.toString().toLowerCase()==e)}};this._filters_ready()};dhtmlXGridObject.prototype._in_header_combo_filter=function(c,a){c.innerHTML="<div style='width:100%; padding-left:2px; overflow:hidden; ' class='combo'></div>";c.onselectstart=function(){return(event.cancelBubble=true)};c.onclick=c.onmousedown=function(d){(d||event).cancelBubble=true;return true};this.makeFilter(c.firstChild,a)};dhtmlXGridObject.prototype._search_common=function(c,a){c.innerHTML="<input type='text' style='width:90%; '>";c.onclick=c.onmousedown=function(d){(d||event).cancelBubble=true;return true};c.onselectstart=function(){return(event.cancelBubble=true)}};dhtmlXGridObject.prototype._in_header_text_search=function(d,c,a){this._search_common(d,c);this.makeSearch(d.firstChild,c)};dhtmlXGridObject.prototype._in_header_text_search_strict=function(c,a){this._search_common(c,a);this.makeSearch(c.firstChild,a,true)};dhtmlXGridObject.prototype._in_header_numeric_filter=function(c,a){this._in_header_text_filter.call(this,c,a);c.firstChild._filter=function(){var d=this.value;var f;var h="==";var e=parseFloat(d.replace("=",""));var g=null;if(d){if(d.indexOf("..")!=-1){d=d.split("..");e=parseFloat(d[0]);g=parseFloat(d[1]);return function(k){if(k>=e&&k<=g){return true}return false}}f=d.match(/>=|<=|>|</);if(f){h=f[0];e=parseFloat(d.replace(h,""))}return Function("v"," if (v "+h+" "+e+" ) return true; return false;")}return""}};dhtmlXGridObject.prototype._in_header_master_checkbox=function(e,d,f){e.innerHTML=f[0]+"<input type='checkbox' />"+f[1];var a=this;e.getElementsByTagName("input")[0].onclick=function(g){a._build_m_order();var c=a._m_order?a._m_order[d]:d;var h=this.checked?1:0;a.forEachRowA(function(l){var k=this.cells(l,c);if(k.isCheckbox()){k.setValue(h);k.cell.wasChanged=true}this.callEvent("onEditCell",[1,l,c,h]);this.callEvent("onCheckbox",[l,c,h])});(g||event).cancelBubble=true}};dhtmlXGridObject.prototype._in_header_stat_total=function(d,a,f){var e=function(){var k=0;this._build_m_order();var h=this._m_order?this._m_order[a]:a;for(var g=0;g<this.rowsBuffer.length;g++){var c=parseFloat(this._get_cell_value(this.rowsBuffer[g],h));k+=isNaN(c)?0:c}return this._maskArr[h]?this._aplNF(k,h):(Math.round(k*100)/100)};this._stat_in_header(d,e,a,f,f)};dhtmlXGridObject.prototype._in_header_stat_multi_total=function(f,e,m){var l=m[1].split(":");m[1]="";for(var d=0;d<l.length;d++){l[d]=parseInt(l[d])}var g=function(){var q=0;for(var o=0;o<this.rowsBuffer.length;o++){var n=1;for(var c=0;c<l.length;c++){n*=parseFloat(this._get_cell_value(this.rowsBuffer[o],l[c]))}q+=isNaN(n)?0:n}return this._maskArr[e]?this._aplNF(q,e):(Math.round(q*100)/100)};var a=[];for(var h=0;h<l.length;h++){a[l[h]]=true}this._stat_in_header(f,g,a,m,m)};dhtmlXGridObject.prototype._in_header_stat_max=function(d,a,f){var e=function(){this._build_m_order();var g=this._m_order?this._m_order[a]:a;var h=-999999999;if(this.getRowsNum()==0){return"&nbsp;"}for(var c=0;c<this.rowsBuffer.length;c++){h=Math.max(h,parseFloat(this._get_cell_value(this.rowsBuffer[c],g)))}return this._maskArr[a]?this._aplNF(h,a):h};this._stat_in_header(d,e,a,f)};dhtmlXGridObject.prototype._in_header_stat_min=function(d,a,f){var e=function(){this._build_m_order();var g=this._m_order?this._m_order[a]:a;var h=999999999;if(this.getRowsNum()==0){return"&nbsp;"}for(var c=0;c<this.rowsBuffer.length;c++){h=Math.min(h,parseFloat(this._get_cell_value(this.rowsBuffer[c],g)))}return this._maskArr[a]?this._aplNF(h,a):h};this._stat_in_header(d,e,a,f)};dhtmlXGridObject.prototype._in_header_stat_average=function(d,a,f){var e=function(){this._build_m_order();var h=this._m_order?this._m_order[a]:a;var l=0;var k=0;if(this.getRowsNum()==0){return"&nbsp;"}for(var g=0;g<this.rowsBuffer.length;g++){var c=parseFloat(this._get_cell_value(this.rowsBuffer[g],h));l+=isNaN(c)?0:c;k++}return this._maskArr[a]?this._aplNF(l/k,a):(Math.round(l/k*100)/100)};this._stat_in_header(d,e,a,f)};dhtmlXGridObject.prototype._in_header_stat_count=function(d,a,f){var e=function(){return this.getRowsNum()};this._stat_in_header(d,e,a,f)};dhtmlXGridObject.prototype._stat_in_header=function(d,e,a,k){var g=this;var h=function(){this.dma(true);d.innerHTML=(k[0]?k[0]:"")+e.call(this)+(k[1]?k[1]:"");this.dma(false);this.callEvent("onStatReady",[])};if(!this._stat_events){this._stat_events=[];this.attachEvent("onClearAll",function(){if(!this.hdr.rows[1]){for(var f=0;f<this._stat_events.length;f++){for(var c=0;c<4;c++){this.detachEvent(this._stat_events[f][c])}}this._stat_events=[]}})}this._stat_events.push([this.attachEvent("onGridReconstructed",h),this.attachEvent("onXLE",h),this.attachEvent("onFilterEnd",h),this.attachEvent("onEditCell",function(c,l,f){if(c==2&&(f==a||(a&&a[f]))){h.call(this)}return true})]);d.innerHTML=""};dhtmlXGridObject.prototype.loadCSVFile=function(c,a){this.load(c,a,"csv")};dhtmlXGridObject.prototype.enableCSVAutoID=function(a){this._csvAID=convertStringToBoolean(a)};dhtmlXGridObject.prototype.enableCSVHeader=function(a){this._csvHdr=convertStringToBoolean(a)};dhtmlXGridObject.prototype.setCSVDelimiter=function(a){this.csv.cell=a};dhtmlXGridObject.prototype._csvAID=true;dhtmlXGridObject.prototype.loadCSVString=function(a){this.parse(a,"csv")};dhtmlXGridObject.prototype.serializeToCSV=function(k){this.editStop();if(this._mathSerialization){this._agetm="getMathValue"}else{if(this._strictText||k){this._agetm="getTitle"}else{this._agetm="getValue"}}var g=[];if(this._csvHdr){for(var f=1;f<this.hdr.rows.length;f++){var c=[];for(var h=0;h<this._cCount;h++){if((!this._srClmn)||(this._srClmn[h])){c.push(this.getColumnLabel(h,f-1))}}g.push(this.csvParser.str(c,this.csv.cell,this.csv.row))}}var h=0;var e=this.rowsBuffer.length;for(h;h<e;h++){var d=this._serializeRowToCVS(null,h);if(d!=""){g.push(d)}}return this.csvParser.block(g,this.csv.row)};dhtmlXGridObject.prototype._serializeRowToCVS=function(a,l,d,h){var k=new Array();if(!a){a=this.render_row(l);if(this._fake&&!this._fake.rowsAr[a.idd]){this._fake.render_row(l)}}if(!this._csvAID){k[k.length]=a.idd}d=d||0;h=h||this._cCount;var n=false;var e=d;while(a.childNodes[d]._cellIndex>e&&d){d--}for(var m=d;e<h;m++){if(!a.childNodes[m]){break}var c=a.childNodes[m]._cellIndex;if(((!this._srClmn)||(this._srClmn[c]))&&(!this._serialize_visible||!this._hrrar[c])){var f=a.childNodes[m];var g=this.cells(a.idd,c);while(e!=c){e++;k.push("");if(e>=h){break}}if(e>=h){break}e++;if(g.cell){zxVal=g[this._agetm]()}else{zxVal=""}if((this._chAttr)&&(g.wasChanged())){n=true}k[k.length]=((zxVal===null)?"":zxVal);if(this._ecspn&&f.colSpan&&f.colSpan>1){f=f.colSpan-1;for(var o=0;o<f;o++){k[k.length]="";e++}}}else{e++}}if((this._onlChAttr)&&(!n)){return""}return this.csvParser.str(k,this.csv.cell,this.csv.row)};dhtmlXGridObject.prototype.toClipBoard=function(a){if(window.clipboardData){window.clipboardData.setData("Text",a)}else{(new Clipboard()).copy(a)}};dhtmlXGridObject.prototype.fromClipBoard=function(){if(window.clipboardData){return window.clipboardData.getData("Text")}else{return(new Clipboard()).paste()}};dhtmlXGridObject.prototype.cellToClipboard=function(d,c){if((!d)||(!c)){if(!this.selectedRows[0]){return}d=this.selectedRows[0].idd;c=this.cell._cellIndex}var a=this.cells(d,c);this.toClipBoard(((a.getLabel?a.getLabel():a.getValue())||"").toString())};dhtmlXGridObject.prototype.updateCellFromClipboard=function(d,c){if((!d)||(!c)){if(!this.selectedRows[0]){return}d=this.selectedRows[0].idd;c=this.cell._cellIndex}var a=this.cells(d,c);a[a.setImage?"setLabel":"setValue"](this.fromClipBoard())};dhtmlXGridObject.prototype.rowToClipboard=function(e){var a="";if(this._mathSerialization){this._agetm="getMathValue"}else{if(this._strictText){this._agetm="getTitle"}else{this._agetm="getValue"}}this._serialize_visible=true;if(e){a=this._serializeRowToCVS(this.getRowById(e))}else{var d=[];for(var c=0;c<this.selectedRows.length;c++){d[d.length]=this._serializeRowToCVS(this.selectedRows[c]);a=this.csvParser.block(d,this.csv.row)}}this._serialize_visible=false;this.toClipBoard(a)};dhtmlXGridObject.prototype.updateRowFromClipboard=function(f){var a=this.fromClipBoard();if(!a){return}if(f){var e=this.getRowById(f)}else{var e=this.selectedRows[0]}if(!e){return}var g=this.csvParser;a=g.unblock(a,this.csv.cell,this.csv.row)[0];if(!this._csvAID){a.splice(0,1)}for(var d=0;d<a.length;d++){var c=this.cells3(e,d);c[c.setImage?"setLabel":"setValue"](a[d])}};dhtmlXGridObject.prototype.csvParser={block:function(a,c){return a.join(c)},unblock:function(g,a,f){var e=(g||"").split(f);for(var c=0;c<e.length;c++){e[c]=(e[c]||"").split(a)}var d=e.length-1;if(e[d].length==1&&e[d][0]==""){e.splice(d,1)}return e},str:function(c,a,d){return c.join(a)}};dhtmlXGridObject.prototype.csvExtParser={_quote:RegExp('"',"g"),_quote_esc:RegExp('\\\\"',"g"),block:function(a,c){return a.join(c)},unblock:function(k,n,q){var d=[[]];var c=0;if(!k){return d}var l=/^[ ]*"/;var h=/"[ ]*$/;var a=new RegExp(".*"+q+".*$");var f=k.split(n);for(var e=0;e<f.length;e++){if(f[e].match(l)){var o=f[e].replace(l,"");while(!f[e].match(h)){e++;o+=f[e]}d[c].push(o.replace(h,"").replace(this._quote_esc,'"'))}else{if(f[e].match(a)){var g=f[e].indexOf(q);d[c].push(f[e].substr(0,g));c++;d[c]=[];f[e]=f[e].substr(g+1);e--}else{if(f[e]||e!=f.length-1){d[c].push(f[e])}}}}var m=d.length-1;if(m>0&&!d[m].length){d.splice(m,1)}return d},str:function(d,a,e){for(var c=0;c<d.length;c++){d[c]='"'+d[c].replace(this._quote,'\\"')+'"'}return d.join(a)}};dhtmlXGridObject.prototype.addRowFromClipboard=function(){var a=this.fromClipBoard();if(!a){return}var d=this.csvParser.unblock(a,this.csv.cell,this.csv.row);for(var c=0;c<d.length;c++){if(d[c]){a=d[c];if(!a.length){continue}if(this._csvAID){this.addRow(this.getRowsNum()+2,a)}else{if(this.rowsAr[a[0]]){a[0]=this.uid()}this.addRow(a[0],a.slice(1))}}}};dhtmlXGridObject.prototype.gridToClipboard=function(){this.toClipBoard(this.serializeToCSV())};dhtmlXGridObject.prototype.gridFromClipboard=function(){var a=this.fromClipBoard();if(!a){return}this.loadCSVString(a)};dhtmlXGridObject.prototype.getXLS=function(g){if(!this.xslform){this.xslform=document.createElement("FORM");this.xslform.action=(g||"")+"xls.php";this.xslform.method="post";this.xslform.target=(_isIE?"_blank":"");document.body.appendChild(this.xslform);var f=document.createElement("INPUT");f.type="hidden";f.name="csv";this.xslform.appendChild(f);var e=document.createElement("INPUT");e.type="hidden";e.name="csv_header";this.xslform.appendChild(e)}var h=this.serializeToCSV();this.xslform.childNodes[0].value=h;var d=[];var a=this._cCount;for(var c=0;c<a;c++){d.push(this.getHeaderCol(c))}d=d.join(",");this.xslform.childNodes[1].value=d;this.xslform.submit()};dhtmlXGridObject.prototype.printView=function(o,e){var m="<style>TD { font-family:Arial; text-align:center; padding-left:2px;padding-right:2px; } \n td.filter input, td.filter select { display:none; }	\n  </style>";var x=null;if(this._fake){x=[].concat(this._hrrar);for(var w=0;w<this._fake._cCount;w++){this._hrrar[w]=null}}m+="<base  href='"+document.location.href+"'></base>";if(!this.parentGrid){m+=(o||"")}m+='<table width="100%" border="2px" cellpadding="0" cellspacing="0">';var n=Math.max(this.rowsBuffer.length,this.rowsCol.length);var l=this._cCount;var q=this._printWidth();m+='<tr class="header_row_1">';for(var w=0;w<l;w++){if(this._hrrar&&this._hrrar[w]){continue}var g=this.hdr.rows[1].cells[this.hdr.rows[1]._childIndexes?this.hdr.rows[1]._childIndexes[parseInt(w)]:w];var a=(g.colSpan||1);var D=(g.rowSpan||1);for(var v=1;v<a;v++){q[w]+=q[v]}m+='<td rowspan="'+D+'" width="'+q[w]+'%" style="background-color:lightgrey;" colspan="'+a+'">'+this.getHeaderCol(w)+"</td>";w+=a-1}m+="</tr>";for(var w=2;w<this.hdr.rows.length;w++){if(_isIE){m+="<tr style='background-color:lightgrey' class='header_row_"+w+"'>";var f=this.hdr.rows[w].childNodes;for(var v=0;v<f.length;v++){if(!this._hrrar||!this._hrrar[f[v]._cellIndex]){m+=f[v].outerHTML}}m+="</tr>"}else{m+="<tr class='header_row_"+w+"' style='background-color:lightgrey'>"+(this._fake?this._fake.hdr.rows[w].innerHTML:"")+this.hdr.rows[w].innerHTML+"</tr>"}}for(var w=0;w<n;w++){m+="<tr>";if(this.rowsCol[w]&&this.rowsCol[w]._cntr){m+=this.rowsCol[w].innerHTML.replace(/<img[^>]*>/gi,"")+"</tr>";continue}if(this.rowsCol[w]&&this.rowsCol[w].style.display=="none"){continue}var k;if(this.rowsCol[w]){k=this.rowsCol[w].idd}else{if(this.rowsBuffer[w]){k=this.rowsBuffer[w].idd}else{continue}}for(var v=0;v<l;v++){if(this._hrrar&&this._hrrar[v]){continue}if(this.rowsAr[k]&&this.rowsAr[k].tagName=="TR"){var C=this.cells(k,v);if(C._setState){var r=""}else{if(C.getContent){r=C.getContent()}else{if(C.getImage||C.combo){var r=C.cell.innerHTML}else{var r=C.getValue()}}}}else{var r=this._get_cell_value(this.rowsBuffer[w],v)}var s=this.columnColor[v]?"background-color:"+this.columnColor[v]+";":"";var u=this.cellAlign[v]?"text-align:"+this.cellAlign[v]+";":"";var y=C.getAttribute("colspan");m+='<td style="'+s+u+'" '+(y?'colSpan="'+y+'"':"")+">"+(r===""?"&nbsp;":r)+"</td>";if(y){v+=y-1}}m+="</tr>";if(this.rowsCol[w]&&this.rowsCol[w]._expanded){var h=this.cells4(this.rowsCol[w]._expanded.ctrl);if(h.getSubGrid){m+='<tr><td colspan="'+l+'">'+h.getSubGrid().printView()+"</td></tr>"}else{m+='<tr><td colspan="'+l+'">'+this.rowsCol[w]._expanded.innerHTML+"</td></tr>"}}}if(this.ftr){for(var w=1;w<this.ftr.childNodes[0].rows.length;w++){m+="<tr style='background-color:lightgrey'>"+((this._fake)?this._fake.ftr.childNodes[0].rows[w].innerHTML:"")+this.ftr.childNodes[0].rows[w].innerHTML+"</tr>"}}m+="</table>";if(this.parentGrid){return m}m+=(e||"");var A=window.open("","_blank");A.document.write(m);A.document.write("<script>window.onerror=function(){return true;}<\/script>");A.document.close();if(this._fake){this._hrrar=x}};dhtmlXGridObject.prototype._printWidth=function(){var f=[];var e=0;for(var d=0;d<this._cCount;d++){var a=this.getColWidth(d);f.push(a);e+=a}var h=[];var c=0;for(var d=0;d<f.length;d++){var g=Math.floor((f[d]/e)*100);c+=g;h.push(g)}h[h.length-1]+=100-c;return h};if(!window.clipboardData){window.clipboardData={_make:function(){var c=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!c){return null}var a=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!a){return null}a.addDataFlavor("text/unicode");var d=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);this._p=[c,a,d];return true},setData:function(a,f){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(d){dhtmlxError.throwError("Clipboard","Access to clipboard denied",[a,f]);return""}if(!this._make()){return false}this._p[2].data=f;this._p[1].setTransferData("text/unicode",this._p[2],f.length*2);var c=Components.interfaces.nsIClipboard;this._p[0].setData(this._p[1],null,c.kGlobalClipboard)},getData:function(a){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(d){dhtmlxError.throwError("Clipboard","Access to clipboard denied",[a]);return""}if(!this._make()){return false}this._p[0].getData(this._p[1],this._p[0].kGlobalClipboard);var c=new Object();var f=new Object();try{this._p[1].getTransferData("text/unicode",f,c)}catch(d){return""}if(f){f=f.value.QueryInterface(Components.interfaces.nsISupportsString)}if(f){return f.data.substring(0,c.value/2)}return""}}}dhtmlXGridObject.prototype.enableBlockSelection=function(d){if(typeof this._bs_mode=="undefined"){var a=this;this.obj.onmousedown=function(f){if(a._bs_mode){a._OnSelectionStart((f||event),this)}return true};this._CSVRowDelimiter=this.csv.row;this.attachEvent("onResize",function(){a._HideSelection();return true});this.attachEvent("onGridReconstructed",function(){a._HideSelection();return true});this.attachEvent("onFilterEnd",this._HideSelection)}if(d===false){this._bs_mode=false;return this._HideSelection()}else{this._bs_mode=true}var c=this._clip_area=document.createElement("textarea");c.style.cssText="position:absolute; width:1px; height:1px; overflow:hidden; color:transparent; background-color:transparent; bottom:1px; right:1px; border:none;";c.onkeydown=function(f){f=f||event;if(f.keyCode==86&&(f.ctrlKey||f.metaKey)){a.pasteBlockFromClipboard()}};document.body.insertBefore(this._clip_area,document.body.firstChild);dhtmlxEvent(this.entBox,"click",function(){if(!a.editor){a._clip_area.select()}})};dhtmlXGridObject.prototype.forceLabelSelection=function(a){this._strictText=convertStringToBoolean(a)};dhtmlXGridObject.prototype._OnSelectionStart=function(d,e){var c=this;if(d.button==2){return}var f=d.srcElement||d.target;if(this.editor){if(f.tagName&&(f.tagName=="INPUT"||f.tagName=="TEXTAREA")){return}this.editStop()}c.setActive(true);var h=this.getPosition(this.obj);var a=d.clientX-h[0]+(document.body.scrollLeft||(document.documentElement?document.documentElement.scrollLeft:0));var g=d.clientY-h[1]+(document.body.scrollTop||(document.documentElement?document.documentElement.scrollTop:0));this._CreateSelection(a-4,g-4);if(f==this._selectionObj){this._HideSelection();this._startSelectionCell=null}else{while(f&&(!f.tagName||f.tagName.toLowerCase()!="td")){f=f.parentNode}this._startSelectionCell=f}if(this._startSelectionCell){if(!this.callEvent("onBeforeBlockSelected",[this._startSelectionCell.parentNode.idd,this._startSelectionCell._cellIndex])){return this._startSelectionCell=null}}this.obj.onmousedown=null;this.obj[_isIE?"onmouseleave":"onmouseout"]=function(k){if(c._blsTimer){window.clearTimeout(c._blsTimer)}};this.obj.onmmold=this.obj.onmousemove;this._init_pos=[a,g];this._selectionObj.onmousemove=this.obj.onmousemove=function(k){k=k||d;if(k.preventDefault){k.preventDefault()}else{k.returnValue=false}c._OnSelectionMove(k)};this._oldDMP=document.body.onmouseup;document.body.onmouseup=function(k){k=k||d;c._OnSelectionStop(k,this);return true};this.callEvent("onBeforeBlockSelection",[]);document.body.onselectstart=function(){return false}};dhtmlXGridObject.prototype._getCellByPos=function(a,e){a=a;if(this._fake){a+=this._fake.objBox.scrollWidth}e=e;var c=0;for(var d=0;d<this.obj.rows.length;d++){e-=this.obj.rows[d].offsetHeight;if(e<=0){c=this.obj.rows[d];break}}if(!c||!c.idd){return null}for(var d=0;d<this._cCount;d++){a-=this.getColWidth(d);if(a<=0){while(true){if(c._childIndexes&&c._childIndexes[d+1]==c._childIndexes[d]){c=c.previousSibling}else{return this.cells(c.idd,d).cell}}}}return null};dhtmlXGridObject.prototype._OnSelectionMove=function(e){var s=this;this._ShowSelection();var n=this.getPosition(this.obj);var h=e.clientX-n[0]+(document.body.scrollLeft||(document.documentElement?document.documentElement.scrollLeft:0));var g=e.clientY-n[1]+(document.body.scrollTop||(document.documentElement?document.documentElement.scrollTop:0));if((Math.abs(this._init_pos[0]-h)<5)&&(Math.abs(this._init_pos[1]-g)<5)){return this._HideSelection()}var q=this._endSelectionCell;if(this._startSelectionCell==null){this._endSelectionCell=this._startSelectionCell=this.getFirstParentOfType(e.srcElement||e.target,"TD")}else{if(e.srcElement||e.target){if((e.srcElement||e.target).className=="dhtmlxGrid_selection"){this._endSelectionCell=(this._getCellByPos(h,g)||this._endSelectionCell)}else{var r=this.getFirstParentOfType(e.srcElement||e.target,"TD");if(r.parentNode.idd){this._endSelectionCell=r}}}}if(this._endSelectionCell){if(!this.callEvent("onBeforeBlockSelected",[this._endSelectionCell.parentNode.idd,this._endSelectionCell._cellIndex])){this._endSelectionCell=q}}var f=this.objBox.scrollLeft+this.objBox.clientWidth;var c=this.objBox.scrollTop+this.objBox.clientHeight;var l=this.objBox.scrollLeft;var k=this.objBox.scrollTop;var d=false;if(this._blsTimer){window.clearTimeout(this._blsTimer)}if(h+20>=f){this.objBox.scrollLeft=this.objBox.scrollLeft+20;d=true}else{if(h-20<l){this.objBox.scrollLeft=this.objBox.scrollLeft-20;d=true}}if(g+20>=c&&!this._realfake){this.objBox.scrollTop=this.objBox.scrollTop+20;d=true}else{if(g-20<k&&!this._realfake){this.objBox.scrollTop=this.objBox.scrollTop-20;d=true}}this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._endSelectionCell);if(d){var o=e.clientX;var m=e.clientY;this._blsTimer=window.setTimeout(function(){s._OnSelectionMove({clientX:o,clientY:m})},100)}};dhtmlXGridObject.prototype._OnSelectionStop=function(c){var a=this;if(this._blsTimer){window.clearTimeout(this._blsTimer)}this.obj.onmousedown=function(f){if(a._bs_mode){a._OnSelectionStart((f||c),this)}return true};this.obj.onmousemove=this.obj.onmmold||null;this._selectionObj.onmousemove=null;document.body.onmouseup=this._oldDMP||null;if(parseInt(this._selectionObj.style.width)<2&&parseInt(this._selectionObj.style.height)<2){this._HideSelection()}else{var d=this.getFirstParentOfType(c.srcElement||c.target,"TD");if((!d)||(!d.parentNode.idd)){d=this._endSelectionCell}while(d&&(!d.tagName||d.tagName.toLowerCase()!="td")){d=d.parentNode}if(!d){return this._HideSelection()}this._stopSelectionCell=d;this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._stopSelectionCell);this.callEvent("onBlockSelected",[])}document.body.onselectstart=function(){}};dhtmlXGridObject.prototype._RedrawSelectionPos=function(o,h){var m={};m.LeftTopCol=o._cellIndex;m.LeftTopRow=this.getRowIndex(o.parentNode.idd);m.RightBottomCol=h._cellIndex;m.RightBottomRow=this.getRowIndex(h.parentNode.idd);var e=o.offsetWidth;var d=o.offsetHeight;o=this.getPosition(o,this.obj);var q=h.offsetWidth;var k=h.offsetHeight;h=this.getPosition(h,this.obj);if(o[0]<h[0]){var f=o[0];var g=h[0]+q}else{var l=m.RightBottomCol;m.RightBottomCol=m.LeftTopCol;m.LeftTopCol=l;var f=h[0];var g=o[0]+e}if(o[1]<h[1]){var n=o[1];var a=h[1]+k}else{var l=m.RightBottomRow;m.RightBottomRow=m.LeftTopRow;m.LeftTopRow=l;var n=h[1];var a=o[1]+d}var r=g-f;var c=a-n;this._selectionObj.style.left=f+"px";this._selectionObj.style.top=n+"px";this._selectionObj.style.width=r+"px";this._selectionObj.style.height=c+"px";return m};dhtmlXGridObject.prototype._CreateSelection=function(a,d){if(this._selectionObj==null){var c=document.createElement("div");c.style.position="absolute";c.style.display="none";c.className="dhtmlxGrid_selection";this._selectionObj=c;this._selectionObj.onmousedown=function(f){f=f||event;if(f.button==2||(_isMacOS&&f.ctrlKey)){return this.parentNode.grid.callEvent("onBlockRightClick",["BLOCK",f])}};this._selectionObj.oncontextmenu=function(f){(f||event).cancelBubble=true;return false};this.objBox.appendChild(this._selectionObj)}this._selectionObj.style.width="0px";this._selectionObj.style.height="0px";this._selectionObj.style.left=a+"px";this._selectionObj.style.top=d+"px";this._selectionObj.startX=a;this._selectionObj.startY=d};dhtmlXGridObject.prototype._ShowSelection=function(){if(this._selectionObj){this._selectionObj.style.display=""}};dhtmlXGridObject.prototype._HideSelection=function(){if(this._selectionObj){this._selectionObj.style.display="none"}this._selectionArea=null;this._clip_area.value="";this._clip_area.blur()};dhtmlXGridObject.prototype.copyBlockToClipboard=function(){if(this._selectionArea!=null){var d=new Array();if(this._mathSerialization){this._agetm="getMathValue"}else{if(this._strictText){this._agetm="getTitle"}else{this._agetm="getValue"}}this._serialize_visible=true;for(var a=this._selectionArea.LeftTopRow;a<=this._selectionArea.RightBottomRow;a++){var c=this._serializeRowToCVS(this.rowsBuffer[a],null,this._selectionArea.LeftTopCol,this._selectionArea.RightBottomCol+1);if(!this._csvAID){d[d.length]=c.substr(c.indexOf(this.csv.cell)+1)}else{d[d.length]=c}}d=d.join(this._CSVRowDelimiter);this._clip_area.value=d;this._clip_area.select();this._serialize_visible=false}};dhtmlXGridObject.prototype.pasteBlockFromClipboard=function(){this._clip_area.select();var a=this;window.setTimeout(function(){a._pasteBlockFromClipboard();a=null},1)};dhtmlXGridObject.prototype._pasteBlockFromClipboard=function(){var g=this._clip_area.value;if(this._selectionArea!=null){var s=this._selectionArea.LeftTopRow;var a=this._selectionArea.LeftTopCol}else{if(this.cell!=null&&!this.editor){var s=this.getRowIndex(this.cell.parentNode.idd);var a=this.cell._cellIndex}else{return false}}g=this.csvParser.unblock(g,this.csv.cell,this.csv.row);var h=s+g.length;var q=a+g[0].length;if(q>this._cCount){q=this._cCount}var e=0;for(var m=s;m<h;m++){var u=this.render_row(m);if(u==-1){continue}var d=0;for(var f=a;f<q;f++){if(this._hrrar[f]){q=Math.max(q+1,this._cCount);continue}var o=this.cells3(u,f);if(o.isDisabled()){d++;continue}if(this._onEditUndoRedo){this._onEditUndoRedo(2,u.idd,f,g[e][d],o.getValue())}if(o.combo){var r=o.combo.values;for(var c=0;c<r.length;c++){if(g[e][d]==r[c]){o.setValue(o.combo.keys[c]);r=null;break}}if(r!=null&&o.editable){o.setValue(g[e][d++])}else{d++}}else{o[o.setImage?"setLabel":"setValue"](g[e][d++])}o.cell.wasChanged=true}this.callEvent("onRowPaste",[u.idd]);e++}};dhtmlXGridObject.prototype.getSelectedBlock=function(){if(this._selectionArea){return this._selectionArea}else{if(this.getSelectedRowId()!==null){return{LeftTopRow:this.getSelectedRowId(),LeftTopCol:this.getSelectedCellIndex(),RightBottomRow:this.getSelectedRowId(),RightBottomCol:this.getSelectedCellIndex()}}else{return null}}};dhtmlXGridObject.prototype.enableSmartRendering=function(d,c,a){if(arguments.length>2){if(c&&!this.rowsBuffer[c-1]){this.rowsBuffer[c-1]=0}c=a}this._srnd=convertStringToBoolean(d);this._srdh=this._srdh||20;this._dpref=c||0};dhtmlXGridObject.prototype.enablePreRendering=function(a){this._srnd_pr=parseInt(a||50)};dhtmlXGridObject.prototype.forceFullLoading=function(a,f){for(var d=0;d<this.rowsBuffer.length;d++){if(!this.rowsBuffer[d]){var e=a||(this.rowsBuffer.length-d);if(this.callEvent("onDynXLS",[d,e])){var c=this;this.load(this.xmlFileUrl+getUrlSymbol(this.xmlFileUrl)+"posStart="+d+"&count="+e,function(){window.setTimeout(function(){c.forceFullLoading(a,f)},100)},this._data_type)}return}}if(f){f.call(this)}};dhtmlXGridObject.prototype.setAwaitedRowHeight=function(a){this._srdh=parseInt(a)};dhtmlXGridObject.prototype._get_view_size=function(){return Math.floor(parseInt(this.entBox.offsetHeight)/this._srdh)+2};dhtmlXGridObject.prototype._add_filler=function(h,a,c,e){if(!a){return null}var g="__filler__";var f=this._prepareRow(g);f.firstChild.style.width="1px";for(var d=1;d<f.childNodes.length;d++){f.childNodes[d].style.display="none"}f.firstChild.style.height=a*this._srdh+"px";c=c||this.rowsCol[h];if(c&&c.nextSibling){c.parentNode.insertBefore(f,c.nextSibling)}else{if(_isKHTML){this.obj.appendChild(f)}else{this.obj.rows[0].parentNode.appendChild(f)}}this.callEvent("onAddFiller",[h,a,f,c,e]);return[h,a,f]};dhtmlXGridObject.prototype._update_srnd_view=function(){var g=Math.floor(this.objBox.scrollTop/this._srdh);var c=g+this._get_view_size();if(this.multiLine){var h=this.objBox.scrollTop;g=0;while(h>0){h-=this.rowsCol[g]?this.rowsCol[g].offsetHeight:this._srdh;g++}c=g+this._get_view_size();if(g>0){g--}}c+=(this._srnd_pr||0);if(c>this.rowsBuffer.length){c=this.rowsBuffer.length}for(var e=g;e<c;e++){if(!this.rowsCol[e]){var f=this._add_from_buffer(e);if(f==-1){if(this.xmlFileUrl){if(this._dpref&&this.rowsBuffer[c-1]){var d=this._dpref?this._dpref:(c-e);var a=Math.max(0,Math.min(e,c-this._dpref));this._current_load=[a,c-a]}else{this._current_load=[e,(this._dpref?this._dpref:(c-e))]}if(this.callEvent("onDynXLS",this._current_load)){this.load(this.xmlFileUrl+getUrlSymbol(this.xmlFileUrl)+"posStart="+this._current_load[0]+"&count="+this._current_load[1],this._data_type)}}return}else{if(this._tgle){this._updateLine(this._h2.get[this.rowsBuffer[e].idd],this.rowsBuffer[e]);this._updateParentLine(this._h2.get[this.rowsBuffer[e].idd],this.rowsBuffer[e])}if(e&&e==(this._realfake?this._fake:this)["_r_select"]){this.selectCell(e,this.cell?this.cell._cellIndex:0,true)}}}}if(this._fake&&!this._realfake&&this.multiLine){this._fake.objBox.scrollTop=this.objBox.scrollTop}};dhtmlXGridObject.prototype._add_from_buffer=function(e){var g=this.render_row(e);if(g==-1){return -1}if(g._attrs.selected||g._attrs.select){this.selectRow(g,false,true);g._attrs.selected=g._attrs.select=null}if(!this._cssSP){if(this._cssEven&&e%2==0){g.className=this._cssEven+((g.className.indexOf("rowselected")!=-1)?" rowselected ":" ")+(g._css||"")}else{if(this._cssUnEven&&e%2==1){g.className=this._cssUnEven+((g.className.indexOf("rowselected")!=-1)?" rowselected ":" ")+(g._css||"")}}}else{if(this._h2){var a=this._h2.get[g.idd];g.className+=" "+((a.level%2)?(this._cssUnEven+" "+this._cssUnEven):(this._cssEven+" "+this._cssEven))+"_"+a.level+(this.rowsAr[a.id]._css||"")}}for(var c=0;c<this._fillers.length;c++){var d=this._fillers[c];if(d&&d[0]<=e&&(d[0]+d[1])>e){var h=e-d[0];if(h==0){this._insert_before(e,g,d[2]);this._update_fillers(c,-1,1)}else{if(h==d[1]-1){this._insert_after(e,g,d[2]);this._update_fillers(c,-1,0)}else{this._fillers.push(this._add_filler(e+1,d[1]-h-1,d[2],1));this._insert_after(e,g,d[2]);this._update_fillers(c,-d[1]+h,0)}}return}}};dhtmlXGridObject.prototype._update_fillers=function(d,a,e){var c=this._fillers[d];c[1]=c[1]+a;c[0]=c[0]+e;if(!c[1]){this.callEvent("onRemoveFiller",[c[2]]);c[2].parentNode.removeChild(c[2]);this._fillers.splice(d,1)}else{c[2].firstChild.style.height=parseFloat(c[2].firstChild.style.height)+a*this._srdh+"px";this.callEvent("onUpdateFiller",[c[2]])}};dhtmlXGridObject.prototype._insert_before=function(c,d,a){a.parentNode.insertBefore(d,a);this.rowsCol[c]=d;this.callEvent("onRowInserted",[d,null,a,"before"])};dhtmlXGridObject.prototype._insert_after=function(c,d,a){if(a.nextSibling){a.parentNode.insertBefore(d,a.nextSibling)}else{a.parentNode.appendChild(d)}this.rowsCol[c]=d;this.callEvent("onRowInserted",[d,null,a,"after"])};dhtmlxValidation=function(){};dhtmlxValidation.prototype={trackInput:function(d,e,c,a){dhtmlxEvent(d,"keyup",function(f){if(dhtmlxValidation._timer){window.clearTimeout(dhtmlxValidation._timer);dhtmlxValidation._timer=null}dhtmlxValidation._timer=window.setTimeout(function(){if(!dhtmlxValidation.checkInput(d,e)){if(!c||c(d,d.value,e)){d.className+=" dhtmlx_live_validation_error"}}else{d.className=d.className.replace(/[ ]*dhtmlx_live_validation_error/g,"");if(a){a(d,d.value,e)}}},250)})},checkInput:function(a,c){return this.checkValue(a.value,c)},checkValue:function(d,e){if(typeof e=="string"){e=e.split(",")}var a=true;for(var c=0;c<e.length;c++){if(!this["is"+e[c]]){alert("Incorrect validation rule: "+e[c])}else{a=a&&this["is"+e[c]](d)}}return a},isEmpty:function(a){return a==""},isNotEmpty:function(a){return(a instanceof Array?a.length>0:!a=="")},isValidBoolean:function(a){return !!a.toString().match(/^(0|1|true|false)$/)},isValidEmail:function(a){return !!a.toString().match(/(^[a-z0-9]([0-9a-z\-_\.]*)@([0-9a-z_\-\.]*)([.][a-z]{3})$)|(^[a-z]([0-9a-z_\.\-]*)@([0-9a-z_\-\.]*)(\.[a-z]{2,4})$)/i)},isValidInteger:function(a){return !!a.toString().match(/(^-?\d+$)/)},isValidNumeric:function(a){return !!a.toString().match(/(^-?\d\d*[\.|,]\d*$)|(^-?\d\d*$)|(^-?[\.|,]\d\d*$)/)},isValidAplhaNumeric:function(a){return !!a.toString().match(/^[_\-a-z0-9]+$/gi)},isValidDatetime:function(c){var a=c.toString().match(/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})$/);return a&&!!(a[1]<=9999&&a[2]<=12&&a[3]<=31&&a[4]<=59&&a[5]<=59&&a[6]<=59)||false},isValidDate:function(a){var c=a.toString().match(/^(\d{4})-(\d{2})-(\d{2})$/);return c&&!!(c[1]<=9999&&c[2]<=12&&c[3]<=31)||false},isValidTime:function(c){var a=c.toString().match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/);return a&&!!(a[1]<=24&&a[2]<=59&&a[3]<=59)||false},isValidIPv4:function(a){var c=a.toString().match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);return c&&!!(c[1]<=255&&c[2]<=255&&c[3]<=255&&c[4]<=255)||false},isValidCurrency:function(a){return a.toString().match(/^\$?\s?\d+?([\.,\,]?\d+)?\s?\$?$/)&&true||false},isValidSSN:function(a){return a.toString().match(/^\d{3}\-?\d{2}\-?\d{4}$/)&&true||false},isValidSIN:function(a){return a.toString().match(/^\d{9}$/)&&true||false}};dhtmlxValidation=new dhtmlxValidation();dhtmlXGridObject.prototype.enableValidation=function(c,a){c=convertStringToBoolean(c);if(c){this._validators={data:[]}}else{this._validators=false}if(arguments.length>1){this._validators._live=a}if(!this._validators._event){this._validators._event=this.attachEvent("onEditCell",this.validationEvent)}};dhtmlXGridObject.prototype.setColValidators=function(a){if(!this._validators){this.enableValidation(true)}if(typeof a=="string"){a=a.split(this.delim)}this._validators.data=a};dhtmlXGridObject.prototype.validationEvent=function(g,c,e,d,k){var l=this._validators;if(!l){return true}var h=(l.data[e]||this.cells(c,e).getAttribute("validate"))||"";if(g==1&&h){var f=this.editor||(this._fake||{}).editor;if(!f){return true}f.cell.className=f.cell.className.replace(/[ ]*dhtmlx_validation_error/g,"");if(l._live){var a=this;dhtmlxValidation.trackInput(f.getInput(),h,function(m,n,o){return a.callEvent("onLiveValidationError",[c,e,n,m,o])},function(m,n,o){return a.callEvent("onLiveValidationCorrect",[c,e,n,m,o])})}}if(g==2){this.validateCell(c,e,h,d)}return true};dhtmlXGridObject.prototype.validateCell=function(h,f,g,e){g=g||(this._validators.data[f]||this.cells(h,f).getAttribute("validate"));e=e||this.cells(h,f).getValue();if(!g){return}var c=this.cells(h,f).cell;var a=true;if(typeof g=="string"){g=g.split(this.delim)}for(var d=0;d<g.length;d++){if(!dhtmlxValidation.checkValue(e,g[d])){if(this.callEvent("onValidationError",[h,f,e,g[d]])){c.className+=" dhtmlx_validation_error"}a=false}}if(a){this.callEvent("onValidationCorrect",[h,f,e,g]);c.className=c.className.replace(/[ ]*dhtmlx_validation_error/g,"")}return a};function eXcell_stree(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid;if(!this.grid._sub_trees){return}this._sub=this.grid._sub_trees[a._cellIndex];if(!this._sub){return}this._sub=this._sub[0]}this.getValue=function(){return this.cell._val};this.setValue=function(c){this.cell._val=c;c=this._sub.getItemText(this.cell._val);this.setCValue((c||"&nbsp;"),c)};this.edit=function(){this._sub.parentObject.style.display="block";var d=this.grid.getPosition(this.cell);this._sub.parentObject.style.top=d[1]+"px";this._sub.parentObject.style.left=d[0]+"px";this._sub.parentObject.style.position="absolute";var c=this.grid.editStop;this.grid.editStop=function(){};this.grid.editStop=c};this.detach=function(){this._sub.parentObject.style.display="none";if(this.grid._sub_id!=null){var c=this.cell._val;this.setValue(this._sub.getSelectedItemId());this.grid._sub_id=null;return this.cell._val!=c}}}eXcell_stree.prototype=new eXcell;dhtmlXGridObject.prototype.setSubTree=function(a,c){if(!this._sub_trees){this._sub_trees=[]}this._sub_trees[c]=[a];a.parentObject.style.display="none";var d=this;a.parentObject.onclick=function(e){(e||window.event).cancelBubble=true;return false};a.ev_onDblClick=null;a.attachEvent("onDblClick",function(e){d._sub_id=e;d.editStop();return true});a._chRRS=true};function eXcell_link(a){this.cell=a;this.grid=this.cell.parentNode.grid;this.isDisabled=function(){return true};this.edit=function(){};this.getValue=function(){if(this.cell.firstChild.getAttribute){var c=this.cell.firstChild.getAttribute("target");return this.cell.firstChild.innerHTML+"^"+this.cell.firstChild.getAttribute("href")+(c?("^"+c):"")}else{return""}};this.setValue=function(d){if((typeof(d)!="number")&&(!d||d.toString()._dhx_trim()=="")){this.setCValue("&nbsp;",c);return(this.cell._clearCell=true)}var c=d.split("^");if(c.length==1){c[1]=""}else{if(c.length>1){c[1]="href='"+c[1]+"'";if(c.length==3){c[1]+=" target='"+c[2]+"'"}else{c[1]+=" target='_blank'"}}}this.setCValue("<a "+c[1]+" onclick='(_isIE?event:arguments[0]).cancelBubble = true;'>"+c[0]+"</a>",c)}}eXcell_link.prototype=new eXcell;eXcell_link.prototype.getTitle=function(){var a=this.cell.firstChild;return((a&&a.tagName)?a.getAttribute("href"):"")};eXcell_link.prototype.getContent=function(){var a=this.cell.firstChild;return((a&&a.tagName)?a.innerHTML:"")};function eXcell_grid(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid;if(!this.grid._sub_grids){return}this._sub=this.grid._sub_grids[a._cellIndex];if(!this._sub){return}this._sindex=this._sub[1];this._sub=this._sub[0]}this.getValue=function(){return this.cell.val};this.setValue=function(c){this.cell.val=c;if(this._sub.getRowById(c)){c=this._sub.cells(c,this._sindex);if(c){c=c.getValue()}else{c=""}}this.setCValue((c||"&nbsp;"),c)};this.edit=function(){this.val=this.cell.val;this._sub.entBox.style.display="block";var d=this.grid.getPosition(this.cell);this._sub.entBox.style.top=d[1]+"px";this._sub.entBox.style.left=d[0]+"px";this._sub.entBox.style.position="absolute";this._sub.setSizes();var c=this.grid.editStop;this.grid.editStop=function(){};if(this._sub.getRowById(this.cell.val)){this._sub.setSelectedRow(this.cell.val)}this._sub.setActive(true);this.grid.editStop=c};this.detach=function(){var c=this.cell.val;this._sub.entBox.style.display="none";if(this._sub.getSelectedId()===null){return false}this.setValue(this._sub.getSelectedId());this.grid.setActive(true);return this.cell.val!=c}}eXcell_grid.prototype=new eXcell;dhtmlXGridObject.prototype.setSubGrid=function(c,a,e){if(!this._sub_grids){this._sub_grids=[]}this._sub_grids[a]=[c,e];c.entBox.style.display="none";var d=this;c.attachEvent("onRowSelect",function(f){d.editStop();return true});c._chRRS=false};function eXcell_dhxCalendar(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid;if(!this.grid._grid_calendarA){var d=this.grid._grid_calendarA=new dhtmlxCalendarObject();this.grid.callEvent("onDhxCalendarCreated",[d]);var c=this.grid;d.attachEvent("onClick",function(){this._last_operation_calendar=true;window.setTimeout(function(){c.editStop()},1);return true});var e=function(f){(f||event).cancelBubble=true};dhtmlxEvent(d.base,"click",e);d=null}}}eXcell_dhxCalendar.prototype=new eXcell;eXcell_dhxCalendar.prototype.edit=function(){var c=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(false,false);this.grid._grid_calendarA.setPosition(c[0],c[1]+this.cell.offsetHeight);this.grid._grid_calendarA._last_operation_calendar=false;this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]);this.cell._cediton=true;this.val=this.cell.val;this._val=this.cell.innerHTML;var a=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=function(){};this.grid._grid_calendarA.setDateFormat((this.grid._dtmask||"%d/%m/%Y"));this.grid._grid_calendarA.setDate(this.val||(new Date()));this.grid._grid_calendarA.draw=a};eXcell_dhxCalendar.prototype.getDate=function(){if(this.cell.val){return this.cell.val}return null};eXcell_dhxCalendar.prototype.getValue=function(){if(this.cell._clearCell){return""}if(this.grid._dtmask_inc&&this.cell.val){return this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString()}return this.cell.innerHTML.toString()._dhx_trim()};eXcell_dhxCalendar.prototype.detach=function(){if(!this.grid._grid_calendarA){return}this.grid._grid_calendarA.hide();if(this.cell._cediton){this.cell._cediton=false}else{return}if(this.grid._grid_calendarA._last_operation_calendar){var d=this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask||"%d/%m/%Y"));var c=this.grid._grid_calendarA.getDate();this.cell.val=new Date(c);this.setCValue(d,c);this.cell._clearCell=!d;var a=this.val;this.val=this._val;return(this.cell.val.valueOf()!=a)}return false};eXcell_dhxCalendar.prototype.setValue=function(a){if(a&&typeof a=="object"){this.cell.val=a;this.cell._clearCell=false;this.setCValue(this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask||"%d/%m/%Y"),a).toString(),this.cell.val);return}if(!a||a.toString()._dhx_trim()==""){a="&nbsp";this.cell._clearCell=true;this.cell.val=""}else{this.cell._clearCell=false;this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate((this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y"),a.toString(),null,true));if(this.grid._dtmask_inc){a=this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask||"%d/%m/%Y"),this.cell.val)}}if((this.cell.val=="NaN")||(this.cell.val=="Invalid Date")){this.cell._clearCell=true;this.cell.val=new Date();this.setCValue("&nbsp;",0)}else{this.setCValue((a||"").toString(),this.cell.val)}};function eXcell_dhxCalendarA(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid;if(!this.grid._grid_calendarA){var d=this.grid._grid_calendarA=new dhtmlxCalendarObject();this.grid.callEvent("onDhxCalendarCreated",[d]);var c=this.grid;d.attachEvent("onClick",function(){this._last_operation_calendar=true;window.setTimeout(function(){c.editStop()},1);return true});var e=function(f){(f||event).cancelBubble=true};dhtmlxEvent(d.base,"click",e)}}}eXcell_dhxCalendarA.prototype=new eXcell;eXcell_dhxCalendarA.prototype.edit=function(){var c=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(false,false);this.grid._grid_calendarA.setPosition(c[0]*1+this.cell.offsetWidth,c[1]*1);this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid._grid_calendarA._last_operation_calendar=false;this.cell._cediton=true;this.val=this.cell.val;this._val=this.cell.innerHTML;var a=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=function(){};this.grid._grid_calendarA.setDateFormat((this.grid._dtmask||"%d/%m/%Y"));this.grid._grid_calendarA.setDate(this.val);this.grid._grid_calendarA.draw=a;this.cell.atag=((!this.grid.multiLine)&&(_isKHTML||_isMacOS||_isFF))?"INPUT":"TEXTAREA";this.obj=document.createElement(this.cell.atag);this.obj.style.height=(this.cell.offsetHeight-(_isIE?4:2))+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.align;this.obj.onclick=function(d){(d||event).cancelBubble=true};this.obj.onmousedown=function(d){(d||event).cancelBubble=true};this.obj.value=this.getValue();this.cell.innerHTML="";this.cell.appendChild(this.obj);if(window.dhx4.isIE){this.obj.style.overflow="visible";if((this.grid.multiLine)&&(this.obj.offsetHeight>=18)&&(this.obj.offsetHeight<40)){this.obj.style.height="36px";this.obj.style.overflow="scroll"}}this.obj.onselectstart=function(d){if(!d){d=event}d.cancelBubble=true;return true};this.obj.focus();this.obj.focus()};eXcell_dhxCalendarA.prototype.getDate=function(){if(this.cell.val){return this.cell.val}return null};eXcell_dhxCalendarA.prototype.getValue=function(){if(this.cell._clearCell){return""}if(this.grid._dtmask_inc&&this.cell.val){return this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString()}return this.cell.innerHTML.toString()._dhx_trim()};eXcell_dhxCalendarA.prototype.detach=function(){if(!this.grid._grid_calendarA){return}this.grid._grid_calendarA.hide();if(this.cell._cediton){this.cell._cediton=false}else{return}if(this.grid._grid_calendarA._last_operation_calendar){this.grid._grid_calendarA._last_operation_calendar=false;var d=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y");var c=this.grid._grid_calendarA.getDate();this.cell.val=new Date(c);this.setCValue(d,c);this.cell._clearCell=!d;var a=this.val;this.val=this._val;return(this.cell.val.valueOf()!=(a|"").valueOf())}this.setValue(this.obj.value);var a=this.val;this.val=this._val;return(this.cell.val.valueOf()!=(a||"").valueOf())};eXcell_dhxCalendarA.prototype.setValue=function(a){if(a&&typeof a=="object"){this.cell.val=a;this.cell._clearCell=false;this.setCValue(this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask||"%d/%m/%Y"),a).toString(),this.cell.val);return}if(!a||a.toString()._dhx_trim()==""){a="&nbsp";this.cell._clearCell=true;this.cell.val=""}else{this.cell._clearCell=false;this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate((this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y"),a.toString(),null,true));if(this.grid._dtmask_inc){a=this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask||"%d/%m/%Y"),this.cell.val)}}if((this.cell.val=="NaN")||(this.cell.val=="Invalid Date")){this.cell.val=new Date();this.cell._clearCell=true;this.setCValue("&nbsp;",0)}else{this.setCValue((a||"").toString(),this.cell.val)}};function eXcell_cntr(a){this.cell=a;this.grid=this.cell.parentNode.grid;if(!this.grid._ex_cntr_ready&&!this._realfake){this.grid._ex_cntr_ready=true;if(this.grid._h2){this.grid.attachEvent("onOpenEn",function(d){this.resetCounter(a._cellIndex)})}var c=function(){var d=this;window.setTimeout(function(){if(!d.resetCounter){return}if(d._fake&&!d._realfake&&a._cellIndex<d._fake._cCount){d._fake.resetCounter(a._cellIndex)}else{d.resetCounter(a._cellIndex)}},1);return true};this.grid.attachEvent("onBeforeSorting",c);this.grid.attachEvent("onFilterEnd",c)}this.edit=function(){};this.getValue=function(){return this.cell.innerHTML};this.setValue=function(e){this.cell.style.paddingRight="2px";var d=this.cell;window.setTimeout(function(){if(!d.parentNode){return}var f=d.parentNode.rowIndex;if(d.parentNode.grid.currentPage||f<0||d.parentNode.grid._srnd){f=d.parentNode.grid.rowsBuffer._dhx_find(d.parentNode)+1}if(f<=0){return}d.innerHTML=f;if(d.parentNode.grid._fake&&d._cellIndex<d.parentNode.grid._fake._cCount&&d.parentNode.grid._fake.rowsAr[d.parentNode.idd]){d.parentNode.grid._fake.cells(d.parentNode.idd,d._cellIndex).setCValue(f)}d=null},100)}}dhtmlXGridObject.prototype.resetCounter=function(c){if(this._fake&&!this._realfake&&c<this._fake._cCount){this._fake.resetCounter(c,this.currentPage)}var a=arguments[0]||0;if(this.currentPage){a=(this.currentPage-1)*this.rowsBufferOutSize}for(a=0;a<this.rowsBuffer.length;a++){if(this.rowsBuffer[a]&&this.rowsBuffer[a].tagName=="TR"&&this.rowsAr[this.rowsBuffer[a].idd]){this.rowsAr[this.rowsBuffer[a].idd].childNodes[c].innerHTML=a+1}}};eXcell_cntr.prototype=new eXcell;function eXcell_acheck(a){try{this.cell=a;this.grid=this.cell.parentNode.grid;this.cell.obj=this}catch(c){}this.changeState=function(){if((!this.grid.isEditable)||(this.cell.parentNode._locked)||(this.isDisabled())){return}if(this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])!=false){this.val=this.getValue();if(this.val=="1"){this.setValue("<checkbox state='false'>")}else{this.setValue("<checkbox state='true'>")}this.cell.wasChanged=true;this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")]);this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")])}else{this.editor=null}};this.getValue=function(){try{return this.cell.chstate.toString()}catch(d){return null}};this.isCheckbox=function(){return true};this.isChecked=function(){if(this.getValue()=="1"){return true}else{return false}};this.setChecked=function(d){this.setValue(d.toString())};this.detach=function(){return this.val!=this.getValue()};this.drawCurrentState=function(){if(this.cell.chstate==1){return"<div  onclick='(new eXcell_acheck(this.parentNode)).changeState(); (arguments[0]||event).cancelBubble=true;'  style='cursor:pointer; font-weight:bold; text-align:center; '><span style='height:8px; width:8px; background:green; display:inline-block;'></span>&nbsp;Yes</div>"}else{return"<div  onclick='(new eXcell_acheck(this.parentNode)).changeState(); (arguments[0]||event).cancelBubble=true;' style='cursor:pointer;  text-align:center; '><span style='height:8px; width:8px; background:red; display:inline-block;'></span>&nbsp;No</div>"}}}eXcell_acheck.prototype=new eXcell;eXcell_acheck.prototype.setValue=function(c){c=(c||"").toString();if(c.indexOf("1")!=-1||c.indexOf("true")!=-1){c="1";this.cell.chstate="1"}else{c="0";this.cell.chstate="0"}var a=this;this.setCValue(this.drawCurrentState(),this.cell.chstate)};function eXcell_context(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid;if(!this.grid._sub_context){return}this._sub=this.grid._sub_context[a._cellIndex];if(!this._sub){return}this._sindex=this._sub[1];this._sub=this._sub[0]}this.getValue=function(){return _isIE?this.cell.innerText:this.cell.textContent};this.setValue=function(d){this.cell._val=d;var c=this._sub.itemPull[this._sub.idPrefix+this.cell._val];d=c?c.title:d;this.setCValue((d||"&nbsp;"),d)};this.edit=function(){var d=this.grid.getPosition(this.cell);this._sub.showContextMenu(d[0]+this.cell.offsetWidth,d[1]);var c=this.grid.editStop;this.grid.editStop=function(){};this.grid.editStop=c};this.detach=function(){if(this.grid._sub_id!=null){var c=this.cell._val;this.setValue(this.grid._sub_id);this.grid._sub_id=null;return this.cell._val!=c}this._sub.hideContextMenu()}}eXcell_context.prototype=new eXcell;dhtmlXGridObject.prototype.setSubContext=function(a,c,e){var d=this;a.attachEvent("onClick",function(g,f){d._sub_id=g;d.editStop();a.hideContextMenu();return true});if(!this._sub_context){this._sub_context=[]}this._sub_context[c]=[a,e];a.hideContextMenu()};function dhtmlXGridFromTable(obj,init){if(typeof(obj)!="object"){obj=document.getElementById(obj)}var w=document.createElement("DIV");w.setAttribute("width",obj.getAttribute("gridWidth")||(obj.offsetWidth?(obj.offsetWidth+"px"):0)||(window.getComputedStyle?window.getComputedStyle(obj,null)["width"]:(obj.currentStyle?obj.currentStyle.width:0)));w.setAttribute("height",obj.getAttribute("gridHeight")||(obj.offsetHeight?(obj.offsetHeight+"px"):0)||(window.getComputedStyle?window.getComputedStyle(obj,null)["height"]:(obj.currentStyle?obj.currentStyle.height:0)));w.className=obj.className;obj.className="";if(obj.id){w.id=obj.id}var mr=obj;var drag=obj.getAttribute("dragAndDrop");mr.parentNode.insertBefore(w,mr);var f=mr.getAttribute("name")||("name_"+(new Date()).valueOf());var windowf=new dhtmlXGridObject(w);window[f]=windowf;var acs=mr.getAttribute("onbeforeinit");var acs2=mr.getAttribute("oninit");if(acs){eval(acs)}windowf.setImagePath(windowf.imgURL||(mr.getAttribute("imgpath")||mr.getAttribute("image_path")||""));var skin=mr.getAttribute("skin");if(skin){windowf.setSkin(skin)}if(init){init(windowf)}var hrow=mr.rows[0];var za="";var zb="";var zc="";var zd="";var ze="";for(var i=0;i<hrow.cells.length;i++){za+=(za?",":"")+hrow.cells[i].innerHTML;var width=hrow.cells[i].getAttribute("width")||hrow.cells[i].offsetWidth||(window.getComputedStyle?window.getComputedStyle(hrow.cells[i],null)["width"]:(hrow.cells[i].currentStyle?hrow.cells[i].currentStyle.width:0));zb+=(zb?",":"")+(width=="*"?width:parseInt(width));zc+=(zc?",":"")+(hrow.cells[i].getAttribute("align")||"left");zd+=(zd?",":"")+(hrow.cells[i].getAttribute("type")||"ed");ze+=(ze?",":"")+(hrow.cells[i].getAttribute("sort")||"str");var f_a=hrow.cells[i].getAttribute("format");if(f_a){if(hrow.cells[i].getAttribute("type").toLowerCase().indexOf("calendar")!=-1){windowf._dtmask=f_a}else{windowf.setNumberFormat(f_a,i)}}}windowf.setHeader(za);windowf.setInitWidths(zb);windowf.setColAlign(zc);windowf.setColTypes(zd);windowf.setColSorting(ze);if(obj.getAttribute("gridHeight")=="auto"){windowf.enableAutoHeigth(true)}if(obj.getAttribute("multiline")){windowf.enableMultiline(true)}var lmn=mr.getAttribute("lightnavigation");if(lmn){windowf.enableLightMouseNavigation(lmn)}var evr=mr.getAttribute("evenrow");var uevr=mr.getAttribute("unevenrow");if(evr||uevr){windowf.enableAlterCss(evr,uevr)}if(drag){windowf.enableDragAndDrop(true)}windowf.init();if(obj.getAttribute("split")){windowf.splitAt(obj.getAttribute("split"))}windowf._process_inner_html(mr,1);if(acs2){eval(acs2)}if(obj.parentNode&&obj.parentNode.removeChild){obj.parentNode.removeChild(obj)}return windowf}dhtmlXGridObject.prototype._process_html=function(c){if(c.tagName&&c.tagName=="TABLE"){return this._process_inner_html(c,0)}var a=document.createElement("DIV");a.innerHTML=c.xmlDoc.responseText;var d=a.getElementsByTagName("TABLE")[0];this._process_inner_html(d,0)};dhtmlXGridObject.prototype._process_inner_html=function(d,f){var c=d.rows.length;for(var a=f;a<c;a++){var e=d.rows[a].getAttribute("id")||a;this.rowsBuffer.push({idd:e,data:d.rows[a],_parser:this._process_html_row,_locator:this._get_html_data})}this.render_dataset();this.setSizes()};dhtmlXGridObject.prototype._process_html_row=function(l,f){var h=f.getElementsByTagName("TD");var c=[];l._attrs=this._xml_attrs(f);for(var e=0;e<h.length;e++){var g=h[e];var a=g.getAttribute("type");if(l.childNodes[e]){if(a){l.childNodes[e]._cellType=a}l.childNodes[e]._attrs=this._xml_attrs(h[e])}if(g.firstChild){c.push(g.innerHTML)}else{c.push("")}if(g.colSpan>1){l.childNodes[e]._attrs.colspan=g.colSpan;for(var d=1;d<g.colSpan;d++){c.push("")}}}for(e<h.length;e<l.childNodes.length;e++){l.childNodes[e]._attrs={}}this._fillRow(l,(this._c_order?this._swapColumns(c):c));return l};dhtmlXGridObject.prototype._get_html_data=function(c,a){c=c.firstChild;while(true){if(!c){return""}if(c.tagName=="TD"){a--}if(a<0){break}c=c.nextSibling}return(c.firstChild?c.firstChild.data:"")};dhtmlxEvent(window,"load",function(){var d=document.getElementsByTagName("table");for(var c=0;c<d.length;c++){if(d[c].className=="dhtmlxGrid"){dhtmlXGridFromTable(d[c])}}});dhtmlXGridObject.prototype._process_xmlA=function(a){if(!a.doXPath){var d=new dtmlXMLLoaderObject(function(){});if(typeof a=="string"){d.loadXMLString(a)}else{if(a.responseXML){d.xmlDoc=a}else{d.xmlDoc={}}d.xmlDoc.responseXML=a}a=d}this._parsing=true;var h=a.getXMLTopNode(this.xml.top);this._parseHead(h);var g=a.doXPath(this.xml.row,h);var f=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0);var e=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0);if(e&&!this.rowsBuffer[e-1]){this.rowsBuffer[e-1]=null}if(this.isTreeGrid()){this._get_xml_data=this._get_xml_dataA;this._process_xml_row=this._process_xml_rowA;return this._process_tree_xml(a)}for(var c=0;c<g.length;c++){if(this.rowsBuffer[c+f]){continue}var k=g[c].getAttribute("id")||this.uid();this.rowsBuffer[c+f]={idd:k,data:g[c],_parser:this._process_xml_rowA,_locator:this._get_xml_dataA};this.rowsAr[k]=g[c]}this.render_dataset();this._parsing=false;return a.xmlDoc.responseXML?a.xmlDoc.responseXML:a.xmlDoc};dhtmlXGridObject.prototype._process_xmlB=function(a){if(!a.doXPath){var d=new dtmlXMLLoaderObject(function(){});if(typeof a=="string"){d.loadXMLString(a)}else{if(a.responseXML){d.xmlDoc=a}else{d.xmlDoc={}}d.xmlDoc.responseXML=a}a=d}this._parsing=true;var h=a.getXMLTopNode(this.xml.top);this._parseHead(h);var g=a.doXPath(this.xml.row,h);var f=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0);var e=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0);if(e&&!this.rowsBuffer[e-1]){this.rowsBuffer[e-1]=null}if(this.isTreeGrid()){this._get_xml_data=this._get_xml_dataB;this._process_xml_row=this._process_xml_rowB;return this._process_tree_xml(a)}for(var c=0;c<g.length;c++){if(this.rowsBuffer[c+f]){continue}var k=g[c].getAttribute("id")||this.uid();this.rowsBuffer[c+f]={idd:k,data:g[c],_parser:this._process_xml_rowB,_locator:this._get_xml_dataB};this.rowsAr[k]=g[c]}this.render_dataset();this._parsing=false;return a.xmlDoc.responseXML?a.xmlDoc.responseXML:a.xmlDoc};dhtmlXGridObject.prototype._process_xml_rowA=function(f,d){var a=[];f._attrs=this._xml_attrs(d);for(var c=0;c<this.columnIds.length;c++){var g=this.columnIds[c];var e=f._attrs[g]||"";if(f.childNodes[c]){f.childNodes[c]._attrs={}}a.push(e)}this._fillRow(f,(this._c_order?this._swapColumns(a):a));return f};dhtmlXGridObject.prototype._get_xml_dataA=function(c,a){return c.getAttribute(this.getColumnId(a))};dhtmlXGridObject.prototype._process_xml_rowB=function(a,f){var k=[];a._attrs=this._xml_attrs(f);if(this._ud_enabled){var l=this.xmlLoader.doXPath("./userdata",f);for(var d=l.length-1;d>=0;d--){this.setUserData(l[d].getAttribute("name"),l[d].firstChild?l[d].firstChild.data:"")}}for(var h=0;h<f.childNodes.length;h++){var e=f.childNodes[h];if(!e.tagName){continue}var c=this.getColIndexById(e.tagName);if(isNaN(c)){continue}var g=e.getAttribute("type");if(g){a.childNodes[c]._cellType=g}a.childNodes[c]._attrs=this._xml_attrs(e);if(e.getAttribute("xmlcontent")){}else{if(e.firstChild){e=e.firstChild.data}else{e=""}}k[c]=e}for(var d=0;d<a.childNodes.length;d++){if(!a.childNodes[d]._attrs){a.childNodes[d]._attrs={}}}this._fillRow(a,(this._c_order?this._swapColumns(k):k));return a};dhtmlXGridObject.prototype._get_xml_dataB=function(c,a){var d=this.getColumnId(a);c=c.firstChild;while(true){if(!c){return""}if(c.tagName==d){return(c.firstChild?c.firstChild.data:"")}c=c.nextSibling}return""};dhtmlXGridObject.prototype.startFastOperations=function(){this._disF=["setSizes","callEvent","_fixAlterCss","cells4","forEachRow","_correctMonolite"];this._disA=[];for(var a=this._disF.length-1;a>=0;a--){this._disA[a]=this[this._disF[a]];this[this._disF[a]]=function(){return true}}this._cellCache=[];this.cells4=function(d){var e=this._cellCache[d._cellIndex];if(!e){e=this._cellCache[d._cellIndex]=this._disA[3].apply(this,[d]);e.destructor=function(){return true};e.setCValue=function(c){e.cell.innerHTML=c}}e.cell=d;e.combo=d._combo||this.combos[d._cellIndex];return e}};dhtmlXGridObject.prototype.stopFastOperations=function(){if(!this._disF){return}for(var a=this._disF.length-1;a>=0;a--){this[this._disF[a]]=this._disA[a]}if(this._correctMonolite){this._correctMonolite()}this.setSizes();this.callEvent("onGridReconstructed",[])};dhtmlXGridObject.prototype._in_header_number_filter=function(d,c){this._in_header_text_filter.call(this,d,c);var a=this;d.firstChild._filter=function(){var e=a._get_filters(this.value,"num");return function(h){var f=e.length>0?false:true;for(var g=0;g<e.length;g++){f=f||e[g](h)}return f}}};dhtmlXGridObject.prototype._in_header_string_filter=function(d,c){this._in_header_text_filter.call(this,d,c);var a=this;d.firstChild._filter=function(){var e=a._get_filters(this.value,"str");return function(h){var f=e.length>0?false:true;for(var g=0;g<e.length;g++){f=f||e[g](h)}return f}}};dhtmlXGridObject.prototype._get_filters=function(h,d){var a=h.split(",");var e=[];for(var c=0;c<a.length;c++){if(a[c]==""){continue}var g=this["_get_"+d+"_filter"](a[c]);e.push(g)}return e};dhtmlXGridObject.prototype._get_str_filter=function(c){if(c=="null"||c=="empty"){return new Function("value",'if (value == null || value == "") return true; return false;')}if(c=="!null"||c=="!empty"){return new Function("value",'if (value == null || value == "") return false; return true;')}if(c.substr(0,1)==="!"){var a=c.substr(1);return new Function("value",'if (value !== "'+a+'") return true; return false;')}if(c.substr(0,1)==="~"){var a=c.substr(1);return new Function("value",'if (value.indexOf("'+a+'") !== -1) return true; return false;')}if(c.substr(0,1)==="^"&&c.substr(c.length-1,1)==="&"){c="="+c.substr(1,c.length-2)}if(c.substr(0,1)==="^"){var a=c.substr(1);return new Function("value","if (value.substr(0, "+a.length+') === "'+a+'") return true; return false;')}if(c.substr(c.length-1,1)==="&"){var a=c.substr(0,c.length-1);return new Function("value","if (value.substr(value.length - "+a.length+') === "'+a+'") return true; return false;')}if(c.substr(0,1)==="="){var a=c.substr(1)}else{var a=c}return new Function("value",'if (value === "'+a+'") return true; return false;')};dhtmlXGridObject.prototype._get_num_filter=function(f){if(f=="null"||f=="empty"){return new Function("value",'if (value == null || value == "") return true; return false;')}if(f=="!null"||f=="!empty"){return new Function("value",'if (value == null || value == "") return false; return true;')}var a=f.split("..");if(a.length==2){var g=parseFloat(a[0]);var e=parseFloat(a[1]);return new Function("value","if (value >= "+g+" && value <= "+e+") return true; return false;")}var d=f.match(/<>|>=|<=|>|<|=/);if(d){var h=d[0];var c=parseFloat(f.replace(h,""))}else{var h="==";c=parseFloat(f)}if(h=="<>"){h="!="}if(h=="="){h="=="}return new Function("value"," if (value "+h+" "+c+" ) return true; return false;")};dhtmlXGridObject.prototype.attachHeaderA=dhtmlXGridObject.prototype.attachHeader;dhtmlXGridObject.prototype.attachHeader=function(){this.attachHeaderA.apply(this,arguments);if(this._realfake){return true}this.formAutoSubmit();if(typeof(this.FormSubmitOnlyChanged)=="undefined"){this.submitOnlyChanged(true)}if(typeof(this._submitAR)=="undefined"){this.submitAddedRows(true)}var a=this;this._added_rows=[];this._deleted_rows=[];this.attachEvent("onRowAdded",function(c){a._added_rows.push(c);a.forEachCell(c,function(d){d.cell.wasChanged=true});return true});this.attachEvent("onBeforeRowDeleted",function(c){a._deleted_rows.push(c);return true});this.attachHeader=this.attachHeaderA};dhtmlXGridObject.prototype.formAutoSubmit=function(){this.parentForm=this.detectParentFormPresent();if(this.parentForm===false){return false}if(this.formEventAttached){return}this.formInputs=new Array();var a=this;dhtmlxEvent(this.parentForm,"submit",function(){if(a.entBox){a.parentFormOnSubmit()}});this.formEventAttached=true};dhtmlXGridObject.prototype.parentFormOnSubmit=function(){this.formCreateInputCollection();if(!this.callEvent("onBeforeFormSubmit",[])){return false}};dhtmlXGridObject.prototype.submitOnlyChanged=function(a){this.FormSubmitOnlyChanged=convertStringToBoolean(a)};dhtmlXGridObject.prototype.submitColumns=function(a){if(typeof a=="string"){a=a.split(this.delim)}this._submit_cols=a};dhtmlXGridObject.prototype.setFieldName=function(a){a=a.replace(/\{GRID_ID\}/g,"'+a1+'");a=a.replace(/\{ROW_ID\}/g,"'+a2+'");a=a.replace(/\{ROW_INDEX\}/g,"'+this.getRowIndex(a2)+'");a=a.replace(/\{COLUMN_INDEX\}/g,"'+a3+'");a=a.replace(/\{COLUMN_ID\}/g,"'+this.getColumnId(a3)+'");this._input_mask=Function("a1","a2","a3","return '"+a+"';")};dhtmlXGridObject.prototype.submitSerialization=function(a){this.FormSubmitSerialization=convertStringToBoolean(a)};dhtmlXGridObject.prototype.submitAddedRows=function(a){this._submitAR=convertStringToBoolean(a)};dhtmlXGridObject.prototype.submitOnlySelected=function(a){this.FormSubmitOnlySelected=convertStringToBoolean(a)};dhtmlXGridObject.prototype.submitOnlyRowID=function(a){this.FormSubmitOnlyRowID=convertStringToBoolean(a)};dhtmlXGridObject.prototype.createFormInput=function(c,d){var a=document.createElement("input");a.type="hidden";if(this._input_mask&&(typeof c!="string")){a.name=this._input_mask.apply(this,c)}else{a.name=((this.globalBox||this.entBox).id||"dhtmlXGrid")+"_"+c}a.value=d;this.parentForm.appendChild(a);this.formInputs.push(a)};dhtmlXGridObject.prototype.createFormInputRow=function(d){var e=(this.globalBox||this.entBox).id;for(var c=0;c<this._cCount;c++){var a=this.cells3(d,c);if(((!this.FormSubmitOnlyChanged)||a.wasChanged())&&(!this._submit_cols||this._submit_cols[c])){this.createFormInput(this._input_mask?[e,d.idd,c]:(d.idd+"_"+c),a.getValue())}}};dhtmlXGridObject.prototype.formCreateInputCollection=function(){if(this.parentForm==false){return false}for(var a=0;a<this.formInputs.length;a++){this.parentForm.removeChild(this.formInputs[a])}this.formInputs=new Array();if(this.FormSubmitSerialization){this.createFormInput("serialized",this.serialize())}else{if(this.FormSubmitOnlySelected){if(this.FormSubmitOnlyRowID){this.createFormInput("selected",this.getSelectedId())}else{for(var a=0;a<this.selectedRows.length;a++){this.createFormInputRow(this.selectedRows[a])}}}else{if(this._submitAR){if(this._added_rows.length){this.createFormInput("rowsadded",this._added_rows.join(","))}if(this._deleted_rows.length){this.createFormInput("rowsdeleted",this._deleted_rows.join(","))}}this.forEachRow(function(c){this.getRowById(c);this.createFormInputRow(this.rowsAr[c])})}}};dhtmlXGridObject.prototype.detectParentFormPresent=function(){var a=false;var c=this.entBox;while(c&&c.tagName&&c!=document.body){if(c.tagName.toLowerCase()=="form"){a=c;break}else{c=c.parentNode}}return a};dhtmlXGridObject.prototype.unGroup=function(){if(!this._groups){return}this._dndProblematic=false;delete this._groups;delete this._gIndex;if(this._fake){this._mirror_rowsCol()}this.forEachRow(function(a){this.rowsAr[a].style.display=""});this._reset_view();this.callEvent("onGridReconstructed",[]);this.callEvent("onUnGroup",[])};dhtmlXGridObject.prototype._mirror_rowsCol=function(){this._fake._groups=this._groups;this._fake._gIndex=this._gIndex;this.rowsBuffer=dhtmlxArray();for(var a=0;a<this.rowsCol.length;a++){if(!this.rowsCol[a]._cntr){this.rowsBuffer.push(this.rowsCol[a])}}this._fake.rowsBuffer=dhtmlxArray();for(var a=0;a<this._fake.rowsCol.length;a++){if(!this._fake.rowsCol[a]._cntr){this._fake.rowsBuffer.push(this._fake.rowsCol[a])}}};dhtmlXGridObject.prototype.groupBy=function(h,e){if(this._groups){this.unGroup()}this._dndProblematic=true;this._groups={};if(!e){e=["#title"];for(var f=1;f<this._cCount;f++){e.push("#cspan")}}this._gmask=document.createElement("TR");this._gmask.origin=e;var g,d=0;for(var f=0;f<e.length;f++){if(e[f]=="#cspan"){g.colSpan=(parseInt(g.colSpan)||1)+1}else{g=document.createElement("TD");g._cellIndex=f;if(this._hrrar[f]){g.style.display="none"}g.className="group_row";g.innerHTML="&nbsp;";if(e[f]=="#title"){this._gmask._title=d}else{g.align=this.cellAlign[f]||"left"}this._gmask.appendChild(g);if(e[f].indexOf("#stat")==0){this._gmask._math=true;g._counter=[this["_g_"+e[f].replace("#","")],f,d]}d++}}for(var c in this._groups){this._groups[c]=this.undefined}this._gIndex=h;if(this._fake&&!this._realfake){this._fake._groups=[];this._fake._gIndex=this._gIndex}this._nextRow=function(l,a){var k=this.rowsCol[l+a];if(k&&(k.style.display=="none"||k._cntr)){return this._nextRow(l+a,a)}return k};if(!this.__sortRowsBG){this._key_events=dhtmlXHeir({},this._key_events);this._key_events.k38_0_0=function(){if(this.editor&&this.editor.combo){this.editor.shiftPrev()}else{var a=this.row.rowIndex;if(!a){return}var k=this._nextRow(a-1,-1);if(k){this.selectCell(k,this.cell._cellIndex,true)}}};this._key_events.k13_1_0=this._key_events.k13_0_1=function(){};this._key_events.k40_0_0=function(){if(this.editor&&this.editor.combo){this.editor.shiftNext()}else{var a=this.row.rowIndex;if(!a){return}var k=this._nextRow(a-1,1);if(k){this.selectCell(k,this.cell._cellIndex,true)}}};this.attachEvent("onFilterStart",function(){if(this._groups){this._groups=this.undefined}return true});this.attachEvent("onFilterEnd",function(){if(typeof this._gIndex!="undefined"){this.groupBy(this._gIndex,this._gmask.origin)}});this.sortRows_bg=this.sortRows;this.sortRows=function(l,k,a){if(typeof(this._groups)=="undefined"){return this.sortRows_bg.apply(this,arguments)}this.callEvent("onBeforeSorting",[l,(k||"str"),(a||"asc")])};this.attachEvent("onBeforeSorting",function(l,k,a){if(typeof(this._groups)=="undefined"){return true}if(l==this._gIndex){this._sortByGroup(l,k,a)}else{this._sortInGroup(l,k,a)}this.setSortImgState(true,l,a);if(this._fake){this._mirror_rowsCol();this._fake._groups=[];this._fake._reset_view()}this.setSortImgState(true,l,a);this.callEvent("onAfterSorting",[l,k,a]);return false});this.attachEvent("onClearAll",function(){this.unGroup()});this.attachEvent("onBeforeRowDeleted",function(l){if(!this._groups){return true}if(!this.rowsAr[l]){return true}var k=this.cells(l,this._gIndex).getValue();if(k===""){k=" "}var a=this._groups[k];this._dec_group(a);return true});this.attachEvent("onAfterRowDeleted",function(a){this.updateGroups()});this.attachEvent("onCheckbox",function(l,a,k){this.callEvent("onEditCell",[2,l,a,(k?1:0),(k?0:1)])});this.attachEvent("onXLE",this.updateGroups);this.attachEvent("onColumnHidden",this.hideGroupColumn);this.attachEvent("onEditCell",function(x,l,v,u,y){if(!this._groups){return true}if(x==2&&u!=y&&v==this._gIndex){if(y===""){y=" "}this._dec_group(this._groups[y]);var a=this.rowsAr[l];var w=this.rowsCol._dhx_find(a);var q=this._inc_group(u);var s=this.rowsCol[q];if(a==s){s=s.nextSibling}var k=a.parentNode;var m=a.rowIndex;k.removeChild(a);if(s){k.insertBefore(a,s)}else{k.appendChild(a)}this.rowsCol._dhx_insertAt(q,a);if(q<w){w++}this.rowsCol._dhx_removeAt(w,a);this._fixAlterCss()}else{if(x==2&&u!=y){this.updateGroups();this._updateGroupView(this._groups[this.cells(l,this._gIndex).getValue()||" "])}}return true});this.__sortRowsBG=true}this._groupExisting();if(this._hrrar){for(var f=0;f<this._hrrar.length;f++){if(this._hrrar[f]){this.hideGroupColumn(f,true)}}}this.callEvent("onGroup",[]);if(this._ahgr||this._awdth){this.setSizes()}};dhtmlXGridObject.prototype._sortInGroup=function(d,k,e){var l=this._groups_get();l.reverse();for(var g=0;g<l.length;g++){var h=l[g]._cntr._childs;var m={};for(var f=0;f<h.length;f++){var n=this.cells3(h[f],d);m[h[f].idd]=n.getDate?n.getDate():n.getValue()}this._sortCore(d,k,e,m,h)}this._groups_put(l);this.setSizes();this.callEvent("onGridReconstructed",[])};dhtmlXGridObject.prototype._sortByGroup=function(f,h,d){var c=this._groups_get();var e=[];for(var g=0;g<c.length;g++){c[g].idd="_sort_"+g;e["_sort_"+g]=c[g]._cntr.text}this._sortCore(f,h,d,e,c);this._groups_put(c);this.callEvent("onGridReconstructed",[]);this.setSizes()};dhtmlXGridObject.prototype._inc_group=function(f,d,a){if(f===""){f=" "}if(!this._groups[f]){this._groups[f]={text:f,row:this._addPseudoRow(),count:0,state:d?"plus":"minus"}}var e=this._groups[f];e.row._cntr=e;var c=this.rowsCol._dhx_find(e.row)+e.count+1;e.count++;if(!a){this._updateGroupView(e);this.updateGroups()}return c};dhtmlXGridObject.prototype._dec_group=function(a){if(!a){return}a.count--;if(a.count==0){a.row.parentNode.removeChild(a.row);this.rowsCol._dhx_removeAt(this.rowsCol._dhx_find(a.row));delete this._groups[a.text]}else{this._updateGroupView(a)}if(this._fake&&!this._realfake){this._fake._dec_group(this._fake._groups[a.text])}this.updateGroups();return true};dhtmlXGridObject.prototype._insertRowAt_gA=dhtmlXGridObject.prototype._insertRowAt;dhtmlXGridObject.prototype._insertRowAt=function(d,e,c){if(typeof(this._groups)!="undefined"){if(this._realfake){var f=this._fake._bfs_cells(d.idd,this._gIndex).getValue()}else{if(this._bfs_cells3){var f=this._bfs_cells3(d,this._gIndex).getValue()}else{var f=this.cells3(d,this._gIndex).getValue()}}if(!f){f=" "}e=this._inc_group(f,d.style.display=="none")}var a=this._insertRowAt_gA(d,e,c);if(typeof(this._groups)!="undefined"){this.expandGroup(f);this._updateGroupView(this._groups[f]);this.updateGroups()}return a};dhtmlXGridObject.prototype._updateGroupView=function(d){if(this._fake&&!this._realfake){return d.row.firstChild.innerHTML="&nbsp;"}var a=this._gmask||this._fake._gmask;var c="<img style='margin-bottom:-4px' src='"+this.imgURL+d.state+".gif'> ";if(this.customGroupFormat){c+=this.customGroupFormat(d.text,d.count)}else{c+=d.text+" ( "+d.count+" ) "}d.row.childNodes[a._title].innerHTML=c};dhtmlXGridObject.prototype._addPseudoRow=function(f){var a=this._gmask||this._fake._gmask;var e=a.cloneNode(true);for(var c=0;c<e.childNodes.length;c++){e.childNodes[c]._cellIndex=a.childNodes[c]._cellIndex;if(this._realfake){e.childNodes[c].style.display=""}}var d=this;e.onclick=function(g){if(!d.callEvent("onGroupClick",[this._cntr.text])){return}if(d._fake&&d._realfake){d._fake._switchGroupState(d._fake._groups[this._cntr.text].row)}else{d._switchGroupState(this)}(g||event).cancelBubble="true"};e.ondblclick=function(g){(g||event).cancelBubble="true"};if(!f){if(_isKHTML){this.obj.appendChild(e)}else{this.obj.firstChild.appendChild(e)}this.rowsCol.push(e)}return e};dhtmlXGridObject.prototype._groups_get=function(){var c=[];this._temp_par=this.obj.parentNode;this._temp_par.removeChild(this.obj);var d=[];for(var e=this.rowsCol.length-1;e>=0;e--){if(this.rowsCol[e]._cntr){this.rowsCol[e]._cntr._childs=d;d=[];c.push(this.rowsCol[e])}else{d.push(this.rowsCol[e])}this.rowsCol[e].parentNode.removeChild(this.rowsCol[e])}return c};dhtmlXGridObject.prototype._groups_put=function(a){var f=this.rowsCol.stablesort;this.rowsCol=new dhtmlxArray(0);this.rowsCol.stablesort=f;for(var e=0;e<a.length;e++){var d=a[e]._cntr;this.obj.firstChild.appendChild(d.row);this.rowsCol.push(d.row);d.row.idd=null;for(var c=0;c<d._childs.length;c++){this.obj.firstChild.appendChild(d._childs[c]);this.rowsCol.push(d._childs[c])}delete d._childs}this._temp_par.appendChild(this.obj)};dhtmlXGridObject.prototype._groupExisting=function(c){if(!this.getRowsNum()){return}var c=[];this._temp_par=this.obj.parentNode;this._temp_par.removeChild(this.obj);var d=[];var e=this.rowsCol.length;for(var f=0;f<e;f++){var h=this.cells4(this.rowsCol[f].childNodes[this._gIndex]).getValue();this.rowsCol[f].style.display="";if(!h){h=" "}if(!this._groups[h]){this._groups[h]={text:h,row:this._addPseudoRow(true),count:0,state:"minus"};var g=this._groups[h];g.row._cntr=g;this._groups[h]._childs=[];c.push(g.row)}this._groups[h].count++;this._groups[h]._childs.push(this.rowsCol[f]);this.rowsCol[f].parentNode.removeChild(this.rowsCol[f])}for(var f=0;f<c.length;f++){this._updateGroupView(c[f]._cntr)}this._groups_put(c);if(this._fake&&!this._realfake){this._mirror_rowsCol();this._fake._groups=[];this._fake._reset_view()}this.callEvent("onGridReconstructed",[]);this.updateGroups()};dhtmlXGridObject.prototype._switchGroupState=function(e){var d=e._cntr;if(this._fake&&!this._realfake){d.state=this._fake._groups[e._cntr.text].row._cntr.state;this._fake._switchGroupState(this._fake._groups[e._cntr.text].row)}var c=this.rowsCol._dhx_find(d.row)+1;d.state=d.state=="minus"?"plus":"minus";var a=d.state=="plus"?"none":"";while(this.rowsCol[c]&&!this.rowsCol[c]._cntr){this.rowsCol[c].style.display=a;c++}this._updateGroupView(d);this.callEvent("onGroupStateChanged",[d.text,(d.state=="minus")]);this.setSizes()};dhtmlXGridObject.prototype.expandGroup=function(a){if(this._groups[a].state=="plus"){this._switchGroupState(this._groups[a].row)}};dhtmlXGridObject.prototype.collapseGroup=function(a){if(this._groups[a].state=="minus"){this._switchGroupState(this._groups[a].row)}};dhtmlXGridObject.prototype.expandAllGroups=function(){for(var a in this._groups){if(this._groups[a]&&this._groups[a].state=="plus"){this._switchGroupState(this._groups[a].row)}}};dhtmlXGridObject.prototype.collapseAllGroups=function(){for(var a in this._groups){if(this._groups[a]&&this._groups[a].state=="minus"){this._switchGroupState(this._groups[a].row)}}};dhtmlXGridObject.prototype.hideGroupColumn=function(g,f){if(this._fake){return}var e=-1;var h=this._gmask.childNodes;for(var d=0;d<h.length;d++){if(h[d]._cellIndex==g){e=d;break}}if(e==-1){return}for(var c in this._groups){this._groups[c].row.childNodes[e].style.display=f?"none":""}};dhtmlXGridObject.prototype.groupStat=function(c,e,d){d=this["_g_"+(d||"stat_total")];var f=0;var a=0;this.forEachRowInGroup(c,function(g){f=d(f,this.cells(g,e).getValue()*1,a);a++});return f};dhtmlXGridObject.prototype.forEachRowInGroup=function(a,e){var f=this._groups[a].row.nextSibling;if(f){while(f&&!f._cntr){e.call(this,f.idd);f=f.nextSibling}}else{var d=this._groups[a]._childs;if(d){for(var c=0;c<d.length;c++){e.call(this,d[c].idd)}}}};dhtmlXGridObject.prototype.updateGroups=function(){if(!this._gmask||!this._gmask._math||this._parsing){return}var c=this._gmask.childNodes;for(var a=0;a<c.length;a++){if(c[a]._counter){this._b_processing.apply(this,c[a]._counter)}}};dhtmlXGridObject.prototype._b_processing=function(d,h,g){var k=0,e=0;if(!this._ecache[this.cellType[h]]){this.cells5({parentNode:{grid:this}},this.cellType[h])}for(var f=this.rowsCol.length-1;f>=0;f--){if(!this.rowsCol[f]._cntr){k=d(k,this.cells3(this.rowsCol[f],h).getValue()*1,e);e++}else{this.cells5(this.rowsCol[f].childNodes[g],this.cellType[h]).setValue(k);e=k=0}}};dhtmlXGridObject.prototype._g_stat_total=function(e,d,a){return e+d};dhtmlXGridObject.prototype._g_stat_min=function(e,d,a){if(!a){e=Infinity}return Math.min(e,d)};dhtmlXGridObject.prototype._g_stat_max=function(e,d,a){if(!a){e=-Infinity}return Math.max(e,d)};dhtmlXGridObject.prototype._g_stat_average=function(e,d,a){return(e*a+d)/(a+1)};dhtmlXGridObject.prototype._g_stat_count=function(e,d,a){return e++};dhtmlXGridObject.prototype._in_header_collapse=function(f,e,k){var a=f.tagName=="TD"?f:f.parentNode;e=a._cellIndexS;if(!this._column_groups){this._column_groups=[]}var h=k[1].split(":");var h=k[1].split(":");h=[h.shift(),h.join(":")];var g=parseInt(h[0]);f.innerHTML=k[0]+"<img src='"+this.imgURL+"minus.gif' style='padding-right:10px;height:16px'/><span style='position:relative; top:-6px;'>"+(h[1]||"")+"<span>";f.style.paddingBottom="0px";var d=this;this._column_groups[e]=f.getElementsByTagName("IMG")[0];this._column_groups[e].onclick=function(l){(l||event).cancelBubble=true;this._cstate=!this._cstate;for(var c=e+1;c<(e+g);c++){d.setColumnHidden(c,this._cstate)}if(this._cstate){if(a.colSpan&&a.colSpan>0){a._exp_colspan=a.colSpan;var o=Math.max(1,a.colSpan-g);if(!_isFF){for(var m=0;m<a.colSpan-o;m++){var n=document.createElement("TD");if(a.nextSibling){a.parentNode.insertBefore(n,a.nextSibling)}else{a.parentNode.appendChild(n)}}}a.colSpan=o}d.callEvent("onColumnCollapse",[e,this._cstate])}else{if(a._exp_colspan){a.colSpan=a._exp_colspan;if(!_isFF){for(var m=1;m<a._exp_colspan;m++){a.parentNode.removeChild(a.nextSibling)}}d.callEvent("onColumnCollapse",[e,this._cstate])}}this.src=d.imgURL+(this._cstate?"plus.gif":"minus.gif");if(d.sortImg.style.display!="none"){d.setSortImgPos()}}};dhtmlXGridObject.prototype.collapseColumns=function(a){if(!this._column_groups[a]||this._column_groups[a]._cstate){return}this._column_groups[a].onclick({})};dhtmlXGridObject.prototype.expandColumns=function(a){if(!this._column_groups[a]||!this._column_groups[a]._cstate){return}this._column_groups[a].onclick({})};dhtmlXGridObject.prototype.enableHeaderMenu=function(a){if(typeof a=="string"){a=a.split(",")}this._hm_config=a;var c=this;this.attachEvent("onInit",function(){this.hdr.oncontextmenu=function(d){return c._doHContClick(d||window.event)};this.startColResizeA=this.startColResize;this.startColResize=function(d){if(d.button==2||(_isMacOS&&d.ctrlKey)){return this._doHContClick(d)}return this.startColResizeA(d)};this._chm_ooc=this.obj.onclick;this._chm_hoc=this.hdr.onclick;this.hdr.onclick=function(d){if(d&&(d.button==2||(_isMacOS&&d.ctrlKey))){return false}c._showHContext(false);return c._chm_hoc.apply(this,arguments)};this.obj.onclick=function(){c._showHContext(false);return c._chm_ooc.apply(this,arguments)}});dhtmlxEvent(document.body,"click",function(){if(c._hContext){c._showHContext(false)}});if(this.hdr.rows.length){this.callEvent("onInit",[])}this.enableHeaderMenu=function(){}};dhtmlXGridObject.prototype._doHContClick=function(c){function a(e){if(e.pageX||e.pageY){return{x:e.pageX,y:e.pageY}}var f=((_isIE)&&(document.compatMode!="BackCompat"))?document.documentElement:document.body;return{x:e.clientX+f.scrollLeft-f.clientLeft,y:e.clientY+f.scrollTop-f.clientTop}}this._createHContext();var d=a(c);this._showHContext(true,d.x,d.y);c[_isIE?"srcElement":"target"].oncontextmenu=function(f){(f||event).cancelBubble=true;return false};c.cancelBubble=true;if(c.preventDefault){c.preventDefault()}return false};dhtmlXGridObject.prototype._createHContext=function(){if(this._hContext){return this._hContext}var n=document.createElement("DIV");n.oncontextmenu=function(a){(a||event).cancelBubble=true;return false};n.onclick=function(a){(a||event).cancelBubble=true;return true};n.className="dhx_header_cmenu";n.style.width=n.style.height="5px";n.style.display="none";var e=[];var g=0;if(this._fake){g=this._fake._cCount}var l=g;for(var g;g<this.hdr.rows[1].cells.length;g++){var o=this.hdr.rows[1].cells[g];if(!this._hm_config||(this._hm_config[g]&&this._hm_config[g]!="false")){if(o.firstChild&&o.firstChild.tagName=="DIV"){var m=o.firstChild.innerHTML}else{var m=o.innerHTML}m=m.replace(/<[^>]*>/gi,"");e.push("<div class='dhx_header_cmenu_item'><input type='checkbox' column='"+l+"' len='"+(o.colSpan||1)+"' checked='true' />"+m+"</div>")}l+=(o.colSpan||1)}n.innerHTML=e.join("");var h=this;var k=function(){var d=this.getAttribute("column");if(!this.checked&&!h._checkLast(d)){return this.checked=true}if(h._realfake){h=h._fake}for(var a=0;a<this.getAttribute("len");a++){h.setColumnHidden((d*1+a*1),!this.checked)}if(this.checked&&h.getColWidth(d)==0){h.adjustColumnSize(d)}};for(var g=0;g<n.childNodes.length;g++){n.childNodes[g].firstChild.onclick=k}document.body.insertBefore(n,document.body.firstChild);this._hContext=n;n.style.position="absolute";n.style.zIndex=999;n.style.width="auto";n.style.height="auto";n.style.display="block"};dhtmlXGridObject.prototype._checkLast=function(c){for(var a=0;a<this._cCount;a++){if((!this._hrrar||!this._hrrar[a])&&(a!=c)){return true}}return false};dhtmlXGridObject.prototype._updateHContext=function(){for(var d=0;d<this._hContext.childNodes.length;d++){var e=this._hContext.childNodes[d].firstChild;var a=e.getAttribute("column");if(this.isColumnHidden(a)||(this.getColWidth(a)==0)){e.checked=false}}};dhtmlXGridObject.prototype._showHContext=function(c,a,d){if(c&&this.enableColumnMove){this._hContext.parentNode.removeChild(this._hContext);this._hContext=null}this._createHContext();this._hContext.style.display=(c?"block":"none");if(c){this._updateHContext(true);this._hContext.style.left=a+"px";this._hContext.style.top=d+"px"}};dhtmlXGridObject.prototype._process_json_row=function(f,g){f._attrs=g;for(var d=0;d<f.childNodes.length;d++){f.childNodes[d]._attrs={}}if(g.userdata){for(var c in g.userdata){this.setUserData(f.idd,c,g.userdata[c])}}g=this._c_order?this._swapColumns(g.data):g.data;for(var e=0;e<g.length;e++){if(typeof g[e]=="object"&&g[e]!=null){f.childNodes[e]._attrs=g[e];if(g[e].type){f.childNodes[e]._cellType=g[e].type}g[e]=g[e].value}}this._fillRow(f,g);return f};dhtmlXGridObject.prototype._process_js_row=function(g,h){g._attrs=h;for(var e=0;e<g.childNodes.length;e++){g.childNodes[e]._attrs={}}if(h.userdata){for(var d in h.userdata){this.setUserData(g.idd,d,h.userdata[d])}}var c=[];for(var f=0;f<this.columnIds.length;f++){c[f]=h[this.columnIds[f]];if(typeof c[f]=="object"&&c[f]!=null){g.childNodes[f]._attrs=c[f];if(c[f].type){g.childNodes[f]._cellType=c[f].type}c[f]=c[f].value}if(!c[f]&&c[f]!==0){c[f]=""}}this._fillRow(g,c);return g};dhtmlXGridObject.prototype.updateFromJSON=function(a,e,c,d){if(typeof e=="undefined"){e=true}this._refresh_mode=[true,e,c];this.load(a,d,"json")},dhtmlXGridObject.prototype._refreshFromJSON=function(d){if(this._f_rowsBuffer){this.filterBy(0,"")}reset=false;if(window.eXcell_tree){eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue;eXcell_tree.prototype.setValue=function(o){var n=this.grid._h2.get[this.cell.parentNode.idd];if(n&&this.cell.parentNode.valTag){this.setLabel(o)}else{this.setValueX(o)}}}var m=this.cellType._dhx_find("tree");var f=d.parent||0;var h={};if(this._refresh_mode[2]){if(m!=-1){this._h2.forEachChild(f,function(n){h[n.id]=true},this)}else{this.forEachRow(function(n){h[n]=true})}}var l=d.rows;for(var e=0;e<l.length;e++){var k=l[e];var a=k.id;h[a]=false;if(this.rowsAr[a]&&this.rowsAr[a].tagName!="TR"){if(this._h2){this._h2.get[a].buff.data=k}else{this.rowsBuffer[this.getRowIndex(a)].data=k}this.rowsAr[a]=k}else{if(this.rowsAr[a]){this._process_json_row(this.rowsAr[a],k,-1);this._postRowProcessing(this.rowsAr[a],true)}else{if(this._refresh_mode[1]){var g={idd:a,data:k,_parser:this._process_json_row,_locator:this._get_json_data};var c=this.rowsBuffer.length;if(this._refresh_mode[1]=="top"){this.rowsBuffer.unshift(g);c=0}else{this.rowsBuffer.push(g)}if(this._h2){reset=true;(this._h2.add(a,f)).buff=this.rowsBuffer[this.rowsBuffer.length-1]}this.rowsAr[a]=k;k=this.render_row(c);this._insertRowAt(k,c?-1:0)}}}}if(this._refresh_mode[2]){for(a in h){if(h[a]&&this.rowsAr[a]){this.deleteRow(a)}}}this._refresh_mode=null;if(window.eXcell_tree){eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX}if(reset){this._renderSort()}if(this._f_rowsBuffer){this._f_rowsBuffer=null;this.filterByAll()}},dhtmlXGridObject.prototype._process_js=function(a){return this._process_json(a,"js")},dhtmlXGridObject.prototype._process_json=function(data,mode){this._parsing=true;try{if(data&&data.xmlDoc){eval("dhtmlx.temp="+data.xmlDoc.responseText+";");data=dhtmlx.temp}else{if(typeof data=="string"){eval("dhtmlx.temp="+data+";");data=dhtmlx.temp}}}catch(e){dhtmlxError.throwError("LoadXML","Incorrect JSON",[(data.xmlDoc||data),this]);data={rows:[]}}if(this._refresh_mode){return this._refreshFromJSON(data)}var cr=parseInt(data.pos||0);var total=parseInt(data.total_count||0);var reset=false;if(total){if(!this.rowsBuffer[total-1]){if(this.rowsBuffer.length){reset=true}this.rowsBuffer[total-1]=null}if(total<this.rowsBuffer.length){this.rowsBuffer.splice(total,this.rowsBuffer.length-total);reset=true}}for(var key in data){if(key!="rows"){this.setUserData("",key,data[key])}}if(mode=="js"&&data.collections){for(var colkey in data.collections){var index=this.getColIndexById(colkey);var colrecs=data.collections[colkey];if(index!==window.undefined){if(this.cellType[index]=="clist"){colplaindata=[];for(var j=0;j<colrecs.length;j++){colplaindata.push(colrecs[j].label)}this.registerCList(index,colplaindata)}else{var combo=this.getCombo(index);for(var j=0;j<colrecs.length;j++){combo.put(colrecs[j].value,colrecs[j].label)}}}}}if(this.isTreeGrid()){return this._process_tree_json(data,null,null,mode)}if(mode=="js"){if(data.data){data=data.data}for(var i=0;i<data.length;i++){if(this.rowsBuffer[i+cr]){continue}var row=data[i];var id=row.id||(i+1);this.rowsBuffer[i+cr]={idd:id,data:row,_parser:this._process_js_row,_locator:this._get_js_data};this.rowsAr[id]=data[i]}}else{for(var i=0;i<data.rows.length;i++){if(this.rowsBuffer[i+cr]){continue}var id=data.rows[i].id;this.rowsBuffer[i+cr]={idd:id,data:data.rows[i],_parser:this._process_json_row,_locator:this._get_json_data};this.rowsAr[id]=data.rows[i]}}if(reset&&this._srnd){var h=this.objBox.scrollTop;this._reset_view();this.objBox.scrollTop=h}else{this.render_dataset()}this._parsing=false};dhtmlXGridObject.prototype._get_json_data=function(c,a){if(typeof c.data[a]=="object"){return c.data[a].value}else{return c.data[a]}};dhtmlXGridObject.prototype._process_tree_json=function(e,f,c,h){this._parsing=true;var a=false;if(!f){this.render_row=this.render_row_tree;a=true;f=e;c=f.parent||0;if(c=="0"){c=0}if(!this._h2){this._h2=new dhtmlxHierarchy()}if(this._fake){this._fake._h2=this._h2}}if(h=="js"){if(f.data&&!c){e=f.data}if(f.rows){f=f.rows}for(var d=0;d<f.length;d++){var k=f[d].id;var g=this._h2.add(k,c);g.buff={idd:k,data:f[d],_parser:this._process_js_row,_locator:this._get_js_data};if(f[d].open){g.state="minus"}this.rowsAr[k]=g.buff;this._process_tree_json(f[d],f[d],k,h)}}else{if(f.rows){for(var d=0;d<f.rows.length;d++){var k=f.rows[d].id;var g=this._h2.add(k,c);g.buff={idd:k,data:f.rows[d],_parser:this._process_json_row,_locator:this._get_json_data};if(f.rows[d].open){g.state="minus"}this.rowsAr[k]=g.buff;this._process_tree_json(f.rows[d],f.rows[d],k,h)}}}if(a){if(c!=0){this._h2.change(c,"state","minus")}this._updateTGRState(this._h2.get[c]);this._h2_to_buff();if(c!=0&&(this._srnd||this.pagingOn)){this._renderSort()}else{this.render_dataset()}if(this._slowParse===false){this.forEachRow(function(l){this.render_row_tree(0,l)})}this._parsing=false;if(c!=0&&!this._srnd){this.callEvent("onOpenEnd",[c,1])}}};dhtmlXGridObject.prototype.enableMarkedCells=function(a){this.markedRowsArr=new dhtmlxArray(0);this.markedCellsArr=new Array(0);this.lastMarkedRow=null;this.lastMarkedColumn=null;this.markedCells=true;this.lastMarkMethod=0;if(arguments.length>0){if(!convertStringToBoolean(a)){this.markedCells=false}}};dhtmlXGridObject.prototype.doMark=function(d,h){var g=d.parentNode.idd;this.setActive(true);if(!g){return}this.editStop();this.cell=d;this.row=d.parentNode;var l=d._cellIndex;if(!h){h=0}if(h==0){this.unmarkAll()}else{if(h==1){if(this.lastMarkedRow){var c=Math.min(this.getRowIndex(g),this.getRowIndex(this.lastMarkedRow));var k=Math.max(this.getRowIndex(g),this.getRowIndex(this.lastMarkedRow));var a=Math.min(l,this.lastMarkedColumn);var m=Math.max(l,this.lastMarkedColumn);for(var f=c;f<k+1;f++){for(var e=a;e<m+1;e++){this.mark(this.getRowId(f),e,true)}}}}else{if(h==2){if(this.markedRowsArr._dhx_find(g)!=-1){for(var n=0;n<this.markedCellsArr[g].length;n++){if(this.markedCellsArr[g][n]==l){this.mark(g,l,false);return true}}}}}}if(!this.markedCellsArr[g]){this.markedCellsArr[g]=new dhtmlxArray(0)}if(h!=1){this.mark(g,l)}this.moveToVisible(this.cells(g,l).cell);this.lastMarkedRow=g;this.lastMarkedColumn=l;this.lastMarkMethod=h};dhtmlXGridObject.prototype.mark=function(d,c,e){if(arguments.length>2){if(!convertStringToBoolean(e)){this.cells(d,c).cell.className=this.cells(d,c).cell.className.replace(/cellselected/g,"");if(this.markedRowsArr._dhx_find(d)!=-1){var a=this.markedCellsArr[d]._dhx_find(c);if(a!=-1){this.markedCellsArr[d]._dhx_removeAt(a);if(this.markedCellsArr[d].length==0){this.markedRowsArr._dhx_removeAt(this.markedRowsArr._dhx_find(d))}this.callEvent("onCellUnMarked",[d,c])}}return true}}this.cells(d,c).cell.className+=" cellselected";if(this.markedRowsArr._dhx_find(d)==-1){this.markedRowsArr[this.markedRowsArr.length]=d}if(!this.markedCellsArr[d]){this.markedCellsArr[d]=new dhtmlxArray(0)}if(this.markedCellsArr[d]._dhx_find(c)==-1){this.markedCellsArr[d][this.markedCellsArr[d].length]=c;this.callEvent("onCellMarked",[d,c])}};dhtmlXGridObject.prototype.unmarkAll=function(){if(this.markedRowsArr){for(var a=0;a<this.markedRowsArr.length;a++){var d=this.markedRowsArr[a];if(this.rowsAr[d]){for(var c=0;c<this.markedCellsArr[d].length;c++){this.callEvent("onCellUnMarked",[d,this.markedCellsArr[d][c]]);this.cells(d,this.markedCellsArr[d][c]).cell.className=this.cells(d,this.markedCellsArr[d][c]).cell.className.replace(/cellselected/g,"")}}}this.markedRowsArr=new dhtmlxArray(0);this.markedCellsArr=new Array(0)}return true};dhtmlXGridObject.prototype.getMarked=function(){var d=new Array();if(this.markedRowsArr){for(var a=0;a<this.markedRowsArr.length;a++){var e=this.markedRowsArr[a];for(var c=0;c<this.markedCellsArr[e].length;c++){d[d.length]=[e,this.markedCellsArr[e][c]]}}}return d};function eXcell_math(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid}this.edit=function(){this.grid.editor=new eXcell_ed(this.cell);this.grid.editor.fix_self=true;this.grid.editor.getValue=this.cell.original?(function(){return this.cell.original}):this.getValue;this.grid.editor.setValue=this.setValue;this.grid.editor.edit()};this.isDisabled=function(){return !this.grid._mathEdit};this.setValue=function(c){c=this.grid._compileSCL(c,this.cell,this.fix_self);if(this.grid._strangeParams[this.cell._cellIndex]){this.grid.cells5(this.cell,this.grid._strangeParams[this.cell._cellIndex]).setValue(c)}else{this.setCValue(c);this.cell._clearCell=false}};this.getValue=function(){if(this.grid._strangeParams[this.cell._cellIndex]){return this.grid.cells5(this.cell,this.grid._strangeParams[this.cell._cellIndex]).getValue()}return this.cell.innerHTML}}eXcell_math.prototype=new eXcell;dhtmlXGridObject.prototype._init_point_bm=dhtmlXGridObject.prototype._init_point;dhtmlXGridObject.prototype._init_point=function(){this._mat_links={};this._aggregators=[];this.attachEvent("onClearAll",function(){this._mat_links={};this._aggregators=[]});this.attachEvent("onCellChanged",function(g,f){if(this._mat_links[g]){var a=this._mat_links[g][f];if(a){for(var e=0;e<a.length;e++){if(a[e].parentNode){this.cells5(a[e]).setValue(this._calcSCL(a[e]))}}}}if(!this._parsing&&this._aggregators[f]){var d=this._h2.get[g].parent.id;if(d!=0){var c=this.cells(d,f);c.setValue(this._calcSCL(c.cell))}}});this.attachEvent("onAfterRowDeleted",function(e,c){if(c!=0){if(!this._parsing&&this._aggregators.length){for(var d=0;d<this._aggregators.length;d++){if(this._aggregators[d]){var a=this.cells(c,d);a.setValue(this._calcSCL(a.cell))}}}}return true});this.attachEvent("onXLE",function(){for(var a=0;a<this._aggregators.length;a++){if(this._aggregators[a]){this._h2.forEachChild(0,function(d){if(d.childs.length!=0){var c=this.cells(d.id,a);c.setValue(this._calcSCL(c.cell))}},this)}}});this._init_point=this._init_point_bm;if(this._init_point){this._init_point()}};dhtmlXGridObject.prototype.enableMathSerialization=function(a){this._mathSerialization=convertStringToBoolean(a)};dhtmlXGridObject.prototype.setMathRound=function(a){this._roundDl=a;this._roundD=Math.pow(10,a)};dhtmlXGridObject.prototype.enableMathEditing=function(a){this._mathEdit=convertStringToBoolean(a)};dhtmlXGridObject.prototype._calcSCL=function(cell){if(!cell._code){return this.cells5(cell).getValue()}try{dhtmlx.agrid=this;var z=eval(cell._code)}catch(e){return("#SCL")}if(this._roundD){var pre=Math.abs(z)<1?"0":"";if(z<0){pre="-"+pre}z=Math.round(Math.abs(z)*this._roundD).toString();if(z==0){return 0}if(this._roundDl>0){var n=z.length-this._roundDl;if(n<0){z=("000000000"+z).substring(9+n);n=0}return(pre+z.substring(0,n)+"."+z.substring(n,z.length))}return pre+z}return z};dhtmlXGridObject.prototype._countTotal=function(g,c){var a=0;var f=this._h2.get[g];for(var d=0;d<f.childs.length;d++){if(!f.childs[d].buff){return a}if(f.childs[d].buff._parser){this._h2.forEachChild(g,function(h){if(h.childs.length==0){var k=parseFloat(this._get_cell_value(h.buff,c),10);if(k){a+=k}}},this);return a}var e=parseFloat(this._get_cell_value(f.childs[d].buff,c),10);if(e){a+=e}}return a};dhtmlXGridObject.prototype._compileSCL=function(d,c,a){if(d===null||d===window.undefined){return d}d=d.toString();if(d.indexOf("=")!=0||!c.parentNode){this._reLink([],c);if(a){c._code=c.original=null}return d}c.original=d;var g=null;d=d.replace("=","");if(d.indexOf("sum")!=-1){d=d.replace("sum","(dhtmlx.agrid._countTotal('"+c.parentNode.idd+"',"+c._cellIndex+"))");if(!this._aggregators){this._aggregators=[]}this._aggregators[c._cellIndex]="sum";c._code=d;return this._parsing?"":this._calcSCL(c)}if(d.indexOf("[[")!=-1){var f=/(\[\[([^\,]*)\,([^\]]*)]\])/g;dhtmlx.agrid=this;g=g||(new Array());d=d.replace(f,function(k,h,m,l){if(m=="-"){m=c.parentNode.idd}if(m.indexOf("#")==0){m=dhtmlx.agrid.getRowId(m.replace("#",""))}g[g.length]=[m,l];return'(parseFloat(dhtmlx.agrid.cells("'+m+'",'+l+").getValue(),10))"})}if(d.indexOf(":")!=-1){var f=/:(\w+)/g;dhtmlx.agrid=this;var e=c.parentNode.idd;g=g||(new Array());d=d.replace(f,function(k,h,m,l){g[g.length]=[e,dhtmlx.agrid.getColIndexById(h)];return'(parseFloat(dhtmlx.agrid.cells("'+e+'",dhtmlx.agrid.getColIndexById("'+h+'")).getValue(),10))'})}else{var f=/c([0-9]+)/g;dhtmlx.agrid=this;var e=c.parentNode.idd;g=g||(new Array());d=d.replace(f,function(k,h,m,l){g[g.length]=[e,h];return'(parseFloat(dhtmlx.agrid.cells("'+e+'",'+h+").getValue(),10))"})}this._reLink(g,c);c._code=d;return this._calcSCL(c)};dhtmlXGridObject.prototype._reLink=function(c,a){if(!c.length){return}for(var e=0;e<c.length;e++){if(!this._mat_links[c[e][0]]){this._mat_links[c[e][0]]={}}var d=this._mat_links[c[e][0]];if(!d[c[e][1]]){d[c[e][1]]=[]}d[c[e][1]].push(a)}};if(_isKHTML){(function(){var a=String.prototype.replace;String.prototype.replace=function(m,d){if(typeof d!="function"){return a.apply(this,arguments)}var f=""+this;var k=d;if(!(m instanceof RegExp)){var h=f.indexOf(m);return(h==-1?f:a.apply(f,[m,k(m,h,f)]))}var c=m;var n=[];var g=c.lastIndex;var l;while((l=c.exec(f))!=null){var h=l.index;var e=l.concat(h,f);n.push(f.slice(g,h),k.apply(null,e).toString());if(!c.global){g+=RegExp.lastMatch.length;break}else{g=c.lastIndex}}n.push(f.slice(g));return n.join("")}})()}dhtmlXGridObject.prototype.insertColumn=function(d,k,m,a,h,l,o,c,f){d=parseInt(d);if(d>this._cCount){d=this._cCount}if(!this._cMod){this._cMod=this._cCount}this._processAllArrays(this._cCount,d-1,[(k||"&nbsp;"),(a||100),(m||"ed"),(l||"left"),(o||""),(h||"na"),(f||""),"",this._cMod,(a||100)]);this._processAllRows("_addColInRow",d);if(typeof(k)=="object"){for(var g=1;g<this.hdr.rows.length;g++){if(k[g-1]=="#rspan"){var r=g-1;var q=false;var n=null;while(!q){var n=this.hdr.rows[r];for(var e=0;e<n.cells.length;e++){if(n.cells[e]._cellIndex==d){q=e;break}}r--}this.hdr.rows[r+1].cells[e].rowSpan=(this.hdr.rows[r].cells[e].rowSpan||1)+1}else{this.setHeaderCol(d,(k[g-1]||"&nbsp;"),g)}}}else{this.setHeaderCol(d,(k||"&nbsp;"))}this.hdr.rows[0].cells[d];this._cCount++;this._cMod++;this._master_row=null;this.setSizes()};dhtmlXGridObject.prototype.deleteColumn=function(a){a=parseInt(a);if(this._cCount==0){return}if(!this._cMod){this._cMod=this._cCount}if(a>=this._cCount){return}this._processAllArrays(a,this._cCount-1,[null,null,null,null,null,null,null,null,null,null,null]);this._processAllRows("_deleteColInRow",a);this._cCount--;this._master_row=null;this.setSizes()};dhtmlXGridObject.prototype._processAllRows=function(f,a,c){this[f](this.obj.rows[0],a,c,0);var e=this.hdr.rows.length;for(var d=0;d<e;d++){this[f](this.hdr.rows[d],a,c,d)}if(this.ftr){var e=this.ftr.firstChild.rows.length;for(var d=0;d<e;d++){this[f](this.ftr.firstChild.rows[d],a,c,d)}}this.forEachRow(function(g){if(this.rowsAr[g]&&this.rowsAr[g].tagName=="TR"){this[f](this.rowsAr[g],a,c,-1)}})};dhtmlXGridObject.prototype._processAllArrays=function(m,a,k){var f=["hdrLabels","initCellWidth","cellType","cellAlign","cellVAlign","fldSort","columnColor","_hrrar","_c_order"];if(this.cellWidthPX.length){f.push("cellWidthPX")}if(this.cellWidthPC.length){f.push("cellWidthPC")}if(this._col_combos){f.push("_col_combos")}if(this._mCols){f[f.length]="_mCols"}if(this.columnIds){f[f.length]="columnIds"}if(this._maskArr){f.push("_maskArr")}if(this._drsclmW){f.push("_drsclmW")}if(this._RaSeCol){f.push("_RaSeCol")}if(this._hm_config){f.push("_hm_config")}if(this._drsclmn){f.push("_drsclmn")}if(this.clists){f.push("clists")}if(this._validators&&this._validators.data){f.push(this._validators.data)}f.push("combos");if(this._customSorts){f.push("_customSorts")}if(this._aggregators){f.push("_aggregators")}var h=(m<=a);if(!this._c_order){this._c_order=new Array();var d=this._cCount;for(var g=0;g<d;g++){this._c_order[g]=g}}for(var g=0;g<f.length;g++){var n=this[f[g]]||f[g];if(n){if(h){var c=n[m];for(var e=m;e<a;e++){n[e]=n[e+1]}n[a]=c}else{var c=n[m];for(var e=m;e>(a+1);e--){n[e]=n[e-1]}n[a+1]=c}if(k){n[a+(h?0:1)]=k[g]}}}};dhtmlXGridObject.prototype.moveColumn=function(a,c){c--;a=parseInt(a);c=parseInt(c);if(c<a){var d=c+1}else{var d=c}if(!this.callEvent("onBeforeCMove",[a,d])){return false}if(a==d){return}this.editStop();this._processAllRows("_moveColInRow",a,c);this._processAllArrays(a,c);if(this.fldSorted){this.setSortImgPos(this.fldSorted._cellIndex)}this.callEvent("onAfterCMove",[a,d])};dhtmlXGridObject.prototype._swapColumns=function(c){var d=new Array();for(var a=0;a<this._cCount;a++){var e=c[this._c_order[a]];if(typeof(e)=="undefined"){e=""}d[a]=e}return d};dhtmlXGridObject.prototype._moveColInRow=function(g,a,d){var h=g.childNodes[a];var f=g.childNodes[d+1];if(!h){return}if(f){g.insertBefore(h,f)}else{g.appendChild(h)}for(var e=0;e<g.childNodes.length;e++){g.childNodes[e]._cellIndex=g.childNodes[e]._cellIndexS=e}};dhtmlXGridObject.prototype._addColInRow=function(k,g,a,e){var f=g;if(k._childIndexes){if(k._childIndexes[g-1]==k._childIndexes[g]||!k.childNodes[k._childIndexes[g-1]]){for(var d=k._childIndexes.length;d>=g;d--){k._childIndexes[d]=d?(k._childIndexes[d-1]+1):0}k._childIndexes[g]--}else{for(var d=k._childIndexes.length;d>=g;d--){k._childIndexes[d]=d?(k._childIndexes[d-1]+1):0}}var f=k._childIndexes[g]}var l=k.childNodes[f];var h=document.createElement((e)?"TD":"TH");if(e){h._attrs={}}else{h.style.width=(parseInt(this.cellWidthPX[g])||"100")+"px"}if(l){k.insertBefore(h,l)}else{k.appendChild(h)}if(this.dragAndDropOff&&k.idd){this.dragger.addDraggableItem(k.childNodes[f],this)}for(var d=f+1;d<k.childNodes.length;d++){k.childNodes[d]._cellIndex=k.childNodes[d]._cellIndexS=k.childNodes[d]._cellIndex+1}if(k.childNodes[f]){k.childNodes[f]._cellIndex=k.childNodes[f]._cellIndexS=g}if(k.idd||typeof(k.idd)!="undefined"){this.cells3(k,g).setValue("");h.align=this.cellAlign[g];h.style.verticalAlign=this.cellVAlign[g];h.bgColor=this.columnColor[g]}else{if(h.tagName=="TD"){if(!k.idd&&this.forceDivInHeader){h.innerHTML="<div class='hdrcell'>&nbsp;</div>"}else{h.innerHTML="&nbsp;"}}}};dhtmlXGridObject.prototype._deleteColInRow=function(k,h){var d=h;if(k._childIndexes){h=k._childIndexes[h]}var l=k.childNodes[h];if(!l){return}if(l.colSpan&&l.colSpan>1&&l.parentNode.idd){var f=l.colSpan-1;var a=this.cells4(l).getValue();this.setColspan(l.parentNode.idd,l._cellIndex,1);if(f>1){var g=l._cellIndex*1;this.setColspan(l.parentNode.idd,g+1,f);this.cells(l.parentNode.idd,l._cellIndex*1+1).setValue(a);k._childIndexes.splice(g,1);for(var e=g;e<k._childIndexes.length;e++){k._childIndexes[e]-=1}}}else{if(k._childIndexes){k._childIndexes.splice(d,1);for(var e=d;e<k._childIndexes.length;e++){k._childIndexes[e]--}}}if(l){k.removeChild(l)}for(var e=h;e<k.childNodes.length;e++){k.childNodes[e]._cellIndex=k.childNodes[e]._cellIndexS=k.childNodes[e]._cellIndex-1}};dhtmlXGridObject.prototype.enableColumnMove=function(c,a){this._mCol=convertStringToBoolean(c);if(typeof(a)!="undefined"){this._mCols=a.split(",")}if(!this._mmevTrue){dhtmlxEvent(this.hdr,"mousedown",this._startColumnMove);dhtmlxEvent(document.body,"mousemove",this._onColumnMove);dhtmlxEvent(document.body,"mouseup",this._stopColumnMove);this._mmevTrue=true}};dhtmlXGridObject.prototype._startColumnMove=function(f){f=f||event;var d=f.target||f.srcElement;var a=d;while(a.tagName!="TABLE"){a=a.parentNode}var c=a.grid;if(!c){return}c.setActive();if(!c._mCol||f.button==2){return}d=c.getFirstParentOfType(d,"TD");if(d.style.cursor!="default"){return true}if((c)&&(!c._colInMove)){c.resized=null;if((!c._mCols)||(c._mCols[d._cellIndex]=="true")){c._colInMove=d._cellIndex+1}}return true};dhtmlXGridObject.prototype._onColumnMove=function(g){g=g||event;var a=window.globalActiveDHTMLGridObject;if((a)&&(a._colInMove)){if(a._showHContext){a._showHContext(false)}if(typeof(a._colInMove)!="object"){var h=document.createElement("DIV");h._aIndex=(a._colInMove-1);h._bIndex=null;h.innerHTML=a.getHeaderCol(h._aIndex);h.className="dhx_dragColDiv";h.style.position="absolute";document.body.appendChild(h);a._colInMove=h}var f=[];f[0]=(document.body.scrollLeft||document.documentElement.scrollLeft);f[1]=(document.body.scrollTop||document.documentElement.scrollTop);a._colInMove.style.left=g.clientX+f[0]+8+"px";a._colInMove.style.top=g.clientY+f[1]+8+"px";var c=g.target||g.srcElement;while((c)&&(typeof(c._cellIndexS)=="undefined")){c=c.parentNode}if(a._colInMove._oldHe){a._colInMove._oldHe.className=a._colInMove._oldHe.className.replace(/columnTarget(L|R)/g,"");a._colInMove._oldHe=null;a._colInMove._bIndex=null}if(c){if(a.hdr.rows[1]._childIndexes){var d=a.hdr.rows[1].cells[a.hdr.rows[1]._childIndexes[c._cellIndexS]]}else{var d=a.hdr.rows[1].cells[c._cellIndexS]}var h=g.clientX-(getAbsoluteLeft(d)-a.hdrBox.scrollLeft);if(h/d.offsetWidth>0.5){d.className+=" columnTargetR";a._colInMove._bIndex=c._cellIndexS}else{d.className+=" columnTargetL";a._colInMove._bIndex=c._cellIndexS-1}if(d.offsetLeft<(a.objBox.scrollLeft+20)){a.objBox.scrollLeft=Math.max(0,d.offsetLeft-20)}if((d.offsetLeft+d.offsetWidth-a.objBox.scrollLeft)>(a.objBox.offsetWidth-20)){a.objBox.scrollLeft=Math.min(a.objBox.scrollLeft+d.offsetWidth+20,a.objBox.scrollWidth-a.objBox.offsetWidth)}a._colInMove._oldHe=d}g.cancelBubble=true;return false}return true};dhtmlXGridObject.prototype._stopColumnMove=function(c){c=c||event;var a=window.globalActiveDHTMLGridObject;if((a)&&(a._colInMove)){if(typeof(a._colInMove)=="object"){a._colInMove.parentNode.removeChild(a._colInMove);if(a._colInMove._bIndex!=null){a.moveColumn(a._colInMove._aIndex,a._colInMove._bIndex+1)}if(a._colInMove._oldHe){a._colInMove._oldHe.className=a._colInMove._oldHe.className.replace(/columnTarget(L|R)/g,"")}a._colInMove._oldHe=null;a._colInMove.grid=null;a.resized=true}a._colInMove=0}return true};dhtmlXGridObject.prototype.mouseOverHeader=function(c){var a=this;dhtmlxEvent(this.hdr,"mousemove",function(f){f=f||window.event;var d=f.target||f.srcElement;if(d.tagName!="TD"){d=a.getFirstParentOfType(d,"TD")}if(d&&(typeof(d._cellIndex)!="undefined")){c(d.parentNode.rowIndex,d._cellIndex)}})};dhtmlXGridObject.prototype.mouseOver=function(c){var a=this;dhtmlxEvent(this.obj,"mousemove",function(f){f=f||window.event;var d=f.target||f.srcElement;if(d.tagName!="TD"){d=a.getFirstParentOfType(d,"TD")}if(d&&(typeof(d._cellIndex)!="undefined")){c(d.parentNode.rowIndex,d._cellIndex)}})};dhtmlXGridObject.prototype.enablePaging=function(g,e,c,f,a,d){this._pgn_parentObj=typeof(f)=="string"?document.getElementById(f):f;this._pgn_recInfoParentObj=typeof(d)=="string"?document.getElementById(d):d;this.pagingOn=g;this.showRecInfo=a;this.rowsBufferOutSize=parseInt(e);this.currentPage=1;this.pagesInGroup=parseInt(c);this._init_pgn_events();this.setPagingSkin("default")};dhtmlXGridObject.prototype.setXMLAutoLoading=function(a,c){this.xmlFileUrl=a;this._dpref=c};dhtmlXGridObject.prototype.changePageRelative=function(a){this.changePage(this.currentPage+a)};dhtmlXGridObject.prototype.changePage=function(a){if(arguments.length==0){a=this.currentPage||0}a=parseInt(a);a=Math.max(1,Math.min(a,Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize)));if(!this.callEvent("onBeforePageChanged",[this.currentPage,a])){return}this.currentPage=parseInt(a);this._reset_view();this._fixAlterCss();this.callEvent("onPageChanged",this.getStateOfView())};dhtmlXGridObject.prototype.setPagingSkin=function(a){this._pgn_skin=this["_pgn_"+a];if(a=="toolbar"){this._pgn_skin_tlb=arguments[1]}};dhtmlXGridObject.prototype.setPagingTemplates=function(d,c){this._pgn_templateA=this._pgn_template_compile(d);this._pgn_templateB=this._pgn_template_compile(c);this._page_skin_update()};dhtmlXGridObject.prototype._page_skin_update=function(a){if(!this.pagesInGroup){this.pagesInGroup=Math.ceil(Math.min(5,this.rowsBuffer.length/this.rowsBufferOutSize))}var c=Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize);if(c&&c<this.currentPage){return this.changePage(c)}if(this.pagingOn&&this._pgn_skin){this._pgn_skin.apply(this,this.getStateOfView())}};dhtmlXGridObject.prototype._init_pgn_events=function(a){this.attachEvent("onXLE",this._page_skin_update);this.attachEvent("onClearAll",this._page_skin_update);this.attachEvent("onPageChanged",this._page_skin_update);this.attachEvent("onGridReconstructed",this._page_skin_update);this._init_pgn_events=function(){}};dhtmlXGridObject.prototype._pgn_default=function(d,e,a){if(!this.pagingBlock){this.pagingBlock=document.createElement("DIV");this.pagingBlock.className="pagingBlock";this.recordInfoBlock=document.createElement("SPAN");this.recordInfoBlock.className="recordsInfoBlock";if(!this._pgn_parentObj){return}this._pgn_parentObj.appendChild(this.pagingBlock);if(this._pgn_recInfoParentObj&&this.showRecInfo){this._pgn_recInfoParentObj.appendChild(this.recordInfoBlock)}if(!this._pgn_templateA){this._pgn_templateA=this._pgn_template_compile("[prevpages:&lt;:&nbsp;] [currentpages:,&nbsp;] [nextpages:&gt;:&nbsp;]");this._pgn_templateB=this._pgn_template_compile("Results <b>[from]-[to]</b> of <b>[total]</b>")}}var c=this.getStateOfView();this.pagingBlock.innerHTML=this._pgn_templateA.apply(this,c);this.recordInfoBlock.innerHTML=this._pgn_templateB.apply(this,c);this._pgn_template_active(this.pagingBlock);this._pgn_template_active(this.recordInfoBlock);this.callEvent("onPaging",[])};dhtmlXGridObject.prototype._pgn_block=function(c){var f=Math.floor((this.currentPage-1)/this.pagesInGroup)*this.pagesInGroup;var a=Math.min(Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize),f+this.pagesInGroup);var e=[];for(var d=f+1;d<=a;d++){if(d==this.currentPage){e.push("<a class='dhx_not_active'><b>"+d+"</b></a>")}else{e.push("<a onclick='this.grid.changePage("+d+"); return false;'>"+d+"</a>")}}return e.join(c)};dhtmlXGridObject.prototype._pgn_link=function(e,c,d){if(e=="prevpages"||e=="prev"){if(this.currentPage==1){return d}return"<a onclick='this.grid.changePageRelative(-1*"+(e=="prev"?"1":"this.grid.pagesInGroup")+"); return false;'>"+c+"</a>"}if(e=="nextpages"||e=="next"){if(this.rowsBuffer.length/this.rowsBufferOutSize<=this.currentPage){return d}if(this.rowsBuffer.length/(this.rowsBufferOutSize*(e=="next"?"1":this.pagesInGroup))<=1){return d}return"<a onclick='this.grid.changePageRelative("+(e=="next"?"1":"this.grid.pagesInGroup")+"); return false;'>"+c+"</a>"}if(e=="current"){var a=this.currentPage+(c?parseInt(c):0);if(a<1||Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize)<a){return d}return"<a "+(a==this.currentPage?"class='dhx_active_page_link' ":"")+"onclick='this.grid.changePage("+a+"); return false;'>"+a+"</a>"}return c};dhtmlXGridObject.prototype._pgn_template_active=function(d){var a=d.getElementsByTagName("A");if(a){for(var c=0;c<a.length;c++){a[c].grid=this}}};dhtmlXGridObject.prototype._pgn_template_compile=function(a){a=a.replace(/\[([^\]]*)\]/g,function(d,c){c=c.split(":");switch(c[0]){case"from":return'"+(arguments[1]*1+(arguments[2]*1?1:0))+"';case"total":return'"+arguments[3]+"';case"to":return'"+arguments[2]+"';case"current":case"prev":case"next":case"prevpages":case"nextpages":return"\"+this._pgn_link('"+c[0]+"','"+c[1]+"','"+c[2]+"')+\"";case"currentpages":return"\"+this._pgn_block('"+c[1]+"')+\""}});return new Function('return "'+a+'";')};dhtmlXGridObject.prototype.i18n.paging={results:"Results",records:"Records from ",to:" to ",page:"Page ",perpage:"rows per page",first:"To first Page",previous:"Previous Page",found:"Found records",next:"Next Page",last:"To last Page",of:" of ",notfound:"No Records Found"};dhtmlXGridObject.prototype.setPagingWTMode=function(a,c,d,e){this._WTDef=[a,c,d,e]};dhtmlXGridObject.prototype._pgn_bricks=function(k,a,d){var f=(this.skin_name||"").split("_")[1];var c="";if(f=="light"||f=="modern"||f=="skyblue"){c="_"+f}this.pagerElAr=new Array();this.pagerElAr.pagerCont=document.createElement("DIV");this.pagerElAr.pagerBord=document.createElement("DIV");this.pagerElAr.pagerLine=document.createElement("DIV");this.pagerElAr.pagerBox=document.createElement("DIV");this.pagerElAr.pagerInfo=document.createElement("DIV");this.pagerElAr.pagerInfoBox=document.createElement("DIV");var h=(this.globalBox||this.objBox);this.pagerElAr.pagerCont.style.width=h.clientWidth+"px";this.pagerElAr.pagerCont.style.overflow="hidden";this.pagerElAr.pagerCont.style.clear="both";this.pagerElAr.pagerBord.className="dhx_pbox"+c;this.pagerElAr.pagerLine.className="dhx_pline"+c;this.pagerElAr.pagerBox.style.clear="both";this.pagerElAr.pagerInfo.className="dhx_pager_info"+c;this.pagerElAr.pagerCont.appendChild(this.pagerElAr.pagerBord);this.pagerElAr.pagerCont.appendChild(this.pagerElAr.pagerLine);this.pagerElAr.pagerCont.appendChild(this.pagerElAr.pagerInfo);this.pagerElAr.pagerLine.appendChild(this.pagerElAr.pagerBox);this.pagerElAr.pagerInfo.appendChild(this.pagerElAr.pagerInfoBox);this._pgn_parentObj.innerHTML="";this._pgn_parentObj.appendChild(this.pagerElAr.pagerCont);if(this.rowsBuffer.length>0){var g=20;var o=22;if(k>this.pagesInGroup){var m=document.createElement("DIV");var l=document.createElement("DIV");m.className="dhx_page"+c;l.innerHTML="&larr;";m.appendChild(l);this.pagerElAr.pagerBox.appendChild(m);var n=this;m.pgnum=(Math.ceil(k/this.pagesInGroup)-1)*this.pagesInGroup;m.onclick=function(){n.changePage(this.pgnum)};g+=o}for(var e=1;e<=this.pagesInGroup;e++){var m=document.createElement("DIV");var l=document.createElement("DIV");m.className="dhx_page"+c;pageNumber=((Math.ceil(k/this.pagesInGroup)-1)*this.pagesInGroup)+e;if(pageNumber>Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize)){break}l.innerHTML=pageNumber;m.appendChild(l);if(k==pageNumber){m.className+=" dhx_page_active"+c;l.className="dhx_page_active"+c}else{var n=this;m.pgnum=pageNumber;m.onclick=function(){n.changePage(this.pgnum)}}g+=(parseInt(o/3)*pageNumber.toString().length)+15;l.style.width=(parseInt(o/3)*pageNumber.toString().length)+8+"px";this.pagerElAr.pagerBox.appendChild(m)}if(Math.ceil(k/this.pagesInGroup)*this.pagesInGroup<Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize)){var m=document.createElement("DIV");var l=document.createElement("DIV");m.className="dhx_page"+c;l.innerHTML="&rarr;";m.appendChild(l);this.pagerElAr.pagerBox.appendChild(m);var n=this;m.pgnum=(Math.ceil(k/this.pagesInGroup)*this.pagesInGroup)+1;m.onclick=function(){n.changePage(this.pgnum)};g+=o}this.pagerElAr.pagerLine.style.width=g+"px"}if(this.rowsBuffer.length>0&&this.showRecInfo){this.pagerElAr.pagerInfoBox.innerHTML=this.i18n.paging.records+(a+1)+this.i18n.paging.to+d+this.i18n.paging.of+this.rowsBuffer.length}else{if(this.rowsBuffer.length==0){this.pagerElAr.pagerLine.parentNode.removeChild(this.pagerElAr.pagerLine);this.pagerElAr.pagerInfoBox.innerHTML=this.i18n.paging.notfound}}this.pagerElAr.pagerBox.appendChild(document.createElement("SPAN")).innerHTML="&nbsp;";this.pagerElAr.pagerBord.appendChild(document.createElement("SPAN")).innerHTML="&nbsp;";this.pagerElAr.pagerCont.appendChild(document.createElement("SPAN")).innerHTML="&nbsp;";this.callEvent("onPaging",[])};dhtmlXGridObject.prototype._pgn_toolbar=function(g,h,c){if(!this.aToolBar){this.aToolBar=this._pgn_createToolBar()}var f=Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize);if(this._WTDef[0]){this.aToolBar.enableItem("right");this.aToolBar.enableItem("rightabs");this.aToolBar.enableItem("left");this.aToolBar.enableItem("leftabs");if(this.currentPage>=f){this.aToolBar.disableItem("right");this.aToolBar.disableItem("rightabs")}if(this.currentPage==1){this.aToolBar.disableItem("left");this.aToolBar.disableItem("leftabs")}}if(this._WTDef[2]){var e=this;this.aToolBar.forEachListOption("pages",function(k){e.aToolBar.removeListOption("pages",k)});var a={dhx_skyblue:4,dhx_web:0,dhx_terrace:14}[this.aToolBar.conf.skin];for(var d=0;d<f;d++){this.aToolBar.addListOption("pages","pages_"+(d+1),NaN,"button","<span style='padding: 0px "+a+"px 0px 0px;'>"+this.i18n.paging.page+(d+1)+"</span>","paging_page.gif")}this.aToolBar.setItemText("pages",this.i18n.paging.page+g)}if(this._WTDef[1]){if(!this.getRowsNum()){this.aToolBar.setItemText("results",this.i18n.paging.notfound)}else{this.aToolBar.setItemText("results","<div style='width:100%; text-align:center'>"+this.i18n.paging.records+(h+1)+this.i18n.paging.to+c+"</div>")}}if(this._WTDef[3]){this.aToolBar.setItemText("perpagenum",this.rowsBufferOutSize.toString()+" "+this.i18n.paging.perpage)}this.callEvent("onPaging",[])};dhtmlXGridObject.prototype._pgn_createToolBar=function(){this.aToolBar=new dhtmlXToolbarObject({parent:this._pgn_parentObj,skin:(this._pgn_skin_tlb||this.skin_name),icons_path:this.imgURL});if(!this._WTDef){this.setPagingWTMode(true,true,true,true)}var e=this;this.aToolBar.attachEvent("onClick",function(f){f=f.split("_");switch(f[0]){case"leftabs":e.changePage(1);break;case"left":e.changePage(e.currentPage-1);break;case"rightabs":e.changePage(99999);break;case"right":e.changePage(e.currentPage+1);break;case"perpagenum":if(f[1]===this.undefined){return}e.rowsBufferOutSize=parseInt(f[1]);e.changePage();e.aToolBar.setItemText("perpagenum",f[1]+" "+e.i18n.paging.perpage);break;case"pages":if(f[1]===this.undefined){return}e.changePage(f[1]);e.aToolBar.setItemText("pages",e.i18n.paging.page+f[1]);break}});if(this._WTDef[0]){this.aToolBar.addButton("leftabs",NaN,null,"ar_left_abs.gif","ar_left_abs_dis.gif");this.aToolBar.addButton("left",NaN,null,"ar_left.gif","ar_left_dis.gif")}if(this._WTDef[1]){this.aToolBar.addText("results",NaN,this.i18n.paging.results);this.aToolBar.setWidth("results","150");this.aToolBar.disableItem("results")}if(this._WTDef[0]){this.aToolBar.addButton("right",NaN,null,"ar_right.gif","ar_right_dis.gif");this.aToolBar.addButton("rightabs",NaN,null,"ar_right_abs.gif","ar_right_abs_dis.gif")}if(this._WTDef[2]){if(this.aToolBar.conf.skin=="dhx_terrace"){this.aToolBar.addSeparator()}this.aToolBar.addButtonSelect("pages",NaN,"select page",[],"paging_pages.gif",null,false,true)}var a;if(a=this._WTDef[3]){if(this.aToolBar.conf.skin=="dhx_terrace"){this.aToolBar.addSeparator()}this.aToolBar.addButtonSelect("perpagenum",NaN,"select size",[],"paging_rows.gif",null,false,true);if(typeof a!="object"){a=[5,10,15,20,25,30]}var c={dhx_skyblue:4,dhx_web:0,dhx_terrace:18}[this.aToolBar.conf.skin];for(var d=0;d<a.length;d++){this.aToolBar.addListOption("perpagenum","perpagenum_"+a[d],NaN,"button","<span style='padding: 0px "+c+"px 0px 0px;'>"+a[d]+" "+this.i18n.paging.perpage+"</span>","paging_page.gif")}}return this.aToolBar};dhtmlXGridObject.prototype.post=function(a,c,e,d){this.callEvent("onXLS",[this]);if(arguments.length==3&&typeof e!="function"){d=e;e=null}d=d||"xml";c=c||"";if(!this.xmlFileUrl){this.xmlFileUrl=a}this._data_type=d;this.xmlLoader.onloadAction=function(h,f,l,k,g){g=h["_process_"+d](g);if(!h._contextCallTimer){h.callEvent("onXLE",[h,0,0,g])}if(e){e();e=null}};this.xmlLoader.loadXML(a,true,c)};dhtmlXGridObject.prototype.setRowspan=function(m,o,f){var n=this[this._bfs_cells?"_bfs_cells":"cells"](m,o).cell;var a=this.rowsAr[m];if(n.rowSpan&&n.rowSpan!=1){var g=a.nextSibling;for(var k=1;k<n.rowSpan;k++){var h=g.childNodes[g._childIndexes[n._cellIndex+1]];var d=document.createElement("TD");d.innerHTML="&nbsp;";d._cellIndex=n._cellIndex;d._clearCell=true;if(h){h.parentNode.insertBefore(d,h)}else{g.parentNode.appendChild(d)}this._shiftIndexes(g,n._cellIndex,-1);g=g.nextSibling}}n.rowSpan=f;if(!this._h2){a=a.nextSibling||this.rowsCol[this.rowsCol._dhx_find(a)+1]}else{a=this.rowsAr[this._h2.get[a.idd].parent.childs[this._h2.get[a.idd].index+1].id]}var e=[];for(var k=1;k<f;k++){var l=null;if(this._fake&&!this._realfake){l=this._bfs_cells3(a,o).cell}else{l=this.cells3(a,o).cell}this._shiftIndexes(a,n._cellIndex,1);if(l){l.parentNode.removeChild(l)}e.push(a);if(!this._h2){a=a.nextSibling||this.rowsCol[this.rowsCol._dhx_find(a)+1]}else{var a=this._h2.get[a.idd].parent.childs[this._h2.get[a.idd].index+1];if(a){a=this.rowsAr[a.id]}}}this.rowsAr[m]._rowSpan=this.rowsAr[m]._rowSpan||{};this.rowsAr[m]._rowSpan[o]=e;if(this._fake&&!this._realfake&&o<this._fake._cCount){this._fake.setRowspan(m,o,f)}};dhtmlXGridObject.prototype._shiftIndexes=function(a,e,c){if(!a._childIndexes){a._childIndexes=new Array();for(var d=0;d<a.childNodes.length;d++){a._childIndexes[d]=d}}for(var d=0;d<a._childIndexes.length;d++){if(d>e){a._childIndexes[d]=a._childIndexes[d]-c}}};dhtmlXGridObject.prototype.enableRowspan=function(){this._erspan=true;this.enableRowspan=function(){};this.attachEvent("onAfterSorting",function(){if(this._dload){return}for(var f=1;f<this.obj.rows.length;f++){if(this.obj.rows[f]._rowSpan){var a=this.obj.rows[f];for(var g in a._rowSpan){var l=a;var c=l._rowSpan[g];for(var d=0;d<c.length;d++){if(l.nextSibling){l.parentNode.insertBefore(c[d],l.nextSibling)}else{l.parentNode.appendChild(c[d])}if(this._fake){var e=this._fake.rowsAr[l.idd];var h=this._fake.rowsAr[c[d].idd];if(e.nextSibling){e.parentNode.insertBefore(h,e.nextSibling)}else{e.parentNode.appendChild(h)}this._correctRowHeight(l.idd)}l=l.nextSibling}}}}var k=this.rowsCol.stablesort;this.rowsCol=new dhtmlxArray();this.rowsCol.stablesort=k;for(var f=1;f<this.obj.rows.length;f++){this.rowsCol.push(this.obj.rows[f])}});this.attachEvent("onXLE",function(e,d,m,g){for(var h=0;h<this.rowsBuffer.length;h++){var l=this.render_row(h);var k=l.childNodes;for(var f=0;f<k.length;f++){if(k[f]._attrs.rowspan){this.setRowspan(l.idd,f,k[f]._attrs.rowspan)}}}})};dhtmlXGridObject.prototype._init_point_bspl=dhtmlXGridObject.prototype._init_point;dhtmlXGridObject.prototype._init_point=function(){if(this._split_later){this.splitAt(this._split_later)}this._init_point=this._init_point_bspl;if(this._init_point){this._init_point()}};dhtmlXGridObject.prototype.splitAt=function(f){if(!this.obj.rows[0]){return this._split_later=f}f=parseInt(f);var a=document.createElement("DIV");this.entBox.appendChild(a);var g=document.createElement("DIV");this.entBox.appendChild(g);for(var l=this.entBox.childNodes.length-3;l>=0;l--){g.insertBefore(this.entBox.childNodes[l],g.firstChild)}this.entBox.style.position="relative";this.globalBox=this.entBox;this.entBox=g;g.grid=this;a.style.cssText+="border:0px solid red !important;";g.style.cssText+="border:0px solid red !important;";g.style.top="0px";g.style.position="absolute";a.style.position="absolute";a.style.top="0px";a.style.left="0px";a.style.zIndex=11;g.style.height=a.style.height=this.globalBox.clientHeight;this._fake=new dhtmlXGridObject(a);this.globalBox=this._fake.globalBox=this.globalBox;this._fake._fake=this;this._fake._realfake=true;this._treeC=this.cellType._dhx_find("tree");this._fake.delim=this.delim;this._fake.customGroupFormat=this.customGroupFormat;this._fake.setImagesPath(this._imgURL);this._fake.iconURL=this.iconURL;this._fake._customSorts=this._customSorts;this._fake.noHeader=this.noHeader;this._fake._enbTts=this._enbTts;this._fake._htkebl=this._htkebl;this._fake.clists=this.clists;this._fake.fldSort=new Array();this._fake.selMultiRows=this.selMultiRows;this._fake.multiLine=this.multiLine;if(this.multiLine||this._erspan){this.attachEvent("onCellChanged",this._correctRowHeight);this.attachEvent("onRowAdded",this._correctRowHeight);var u=function(){this.forEachRow(function(w){this._correctRowHeight(w)})};this.attachEvent("onPageChanged",u);this.attachEvent("onXLE",u);this.attachEvent("onResizeEnd",u);if(!this._ads_count){this.attachEvent("onAfterSorting",u)}if(this._srnd){this.attachEvent("onFilterEnd",u)}this.attachEvent("onDistributedEnd",u)}this.attachEvent("onGridReconstructed",function(){this._fake.objBox.scrollTop=this.objBox.scrollTop});this._fake.loadedKidsHash=this.loadedKidsHash;if(this._h2){this._fake._h2=this._h2}this._fake._dInc=this._dInc;var s=[[],[],[],[],[],[],[]];var k=["hdrLabels","initCellWidth","cellType","cellAlign","cellVAlign","fldSort","columnColor"];var q=["setHeader","setInitWidths","setColTypes","setColAlign","setColVAlign","setColSorting","setColumnColor"];this._fake.callEvent=function(){var w=true;this._fake._split_event=true;var x=(arguments[0]=="onScroll");if(arguments[0]=="onGridReconstructed"||x){this._fake.callEvent.apply(this,arguments)}if(!x){w=this._fake.callEvent.apply(this._fake,arguments)}this._fake._split_event=false;return w};if(this._elmn){this._fake.enableLightMouseNavigation(true)}if(this.__cssEven||this._cssUnEven){this._fake.attachEvent("onGridReconstructed",function(){this._fixAlterCss()})}this._fake._cssEven=this._cssEven;this._fake._cssUnEven=this._cssUnEven;this._fake._cssSP=this._cssSP;this._fake.isEditable=this.isEditable;this._fake._edtc=this._edtc;if(this._sst){this._fake.enableStableSorting(true)}this._fake._sclE=this._sclE;this._fake._dclE=this._dclE;this._fake._f2kE=this._f2kE;this._fake._maskArr=this._maskArr;this._fake._dtmask=this._dtmask;this._fake.combos=this.combos;var d=0;var n=this.globalBox.offsetWidth;for(var l=0;l<f;l++){for(var h=0;h<k.length;h++){if(this[k[h]]){s[h][l]=this[k[h]][l]}if(typeof s[h][l]=="string"){s[h][l]=s[h][l].replace(new RegExp("\\"+this.delim,"g"),"\\"+this.delim)}}if(_isFF){s[1][l]=s[1][l]*1}if(this.cellWidthType=="%"){s[1][l]=Math.round(parseInt(this[k[1]][l])*n/100);d+=s[1][l]}else{d+=parseInt(this[k[1]][l])}this.setColumnHidden(l,true)}for(var h=0;h<k.length;h++){var r=s[h].join(this.delim);if(q[h]!="setHeader"){if(r!=""){this._fake[q[h]](r)}}else{this._fake[q[h]](r,null,this._hstyles)}}this._fake._strangeParams=this._strangeParams;this._fake._drsclmn=this._drsclmn;d=Math.min(this.globalBox.offsetWidth,d);g.style.left=d+"px";a.style.width=d+"px";g.style.width=Math.max(this.globalBox.offsetWidth-d,0);if(this._ecspn){this._fake._ecspn=true}this._fake.init();if(this.dragAndDropOff){this.dragger.addDragLanding(this._fake.entBox,this)}this._fake.objBox.style.overflow="hidden";if(!dhtmlx.$customScroll){this._fake.objBox.style.overflowX="scroll"}else{this._fake.objBox._custom_scroll_mode=""}this._fake._srdh=this._srdh||20;this._fake._srnd=this._srnd;var v=this;function o(y){var x=y.wheelDelta/-40;if(y.wheelDelta===window.undefined){x=y.detail}var w=v.objBox;w.scrollTop+=x*40;if(y.preventDefault){y.preventDefault()}}dhtmlxEvent(this._fake.objBox,"mousewheel",o);dhtmlxEvent(this._fake.objBox,"DOMMouseScroll",o);function c(x,w){w.style.whiteSpace="";var C=w.nextSibling;var y=w.parentNode;x.parentNode.insertBefore(w,x);if(!C){y.appendChild(x)}else{y.insertBefore(x,C)}var A=x.style.display;x.style.display=w.style.display;w.style.display=A}function e(F,N,H,x){var y=(new Array(f)).join(this.delim);var I=[];if(F==2){for(var D=0;D<f;D++){var w=N[F-1].cells[N[F-1]._childIndexes?N[F-1]._childIndexes[D]:D];if(w.rowSpan&&w.rowSpan>1){I[w._cellIndex]=w.rowSpan-1;x[F-1].cells[x[F-1]._childIndexes?x[F-1]._childIndexes[D]:D].rowSpan=w.rowSpan;w.rowSpan=1}}}for(F;F<N.length;F++){this._fake.attachHeader(y,null,H);x=x||this._fake.ftr.childNodes[0].rows;var L=f;var A=0;for(var E=0;E<L;E++){if(I[E]){I[E]=I[E]-1;if(_isIE||(_isFF&&_FFrv>=1.9)||_isOpera){var C=document.createElement("TD");if(_isFF){C.style.display="none"}N[F].insertBefore(C,N[F].cells[0])}A++;continue}var K=x[F].cells[E-A];var J=N[F].cells[E-(_isIE?0:A)];var M=J.rowSpan;c(K,J);if(M>1){I[E]=M-1;J.rowSpan=M}if(x[F].cells[E].colSpan>1){N[F].cells[E].colSpan=x[F].cells[E].colSpan;L-=x[F].cells[E].colSpan-1;for(var D=1;D<x[F].cells[E].colSpan;D++){x[F].removeChild(x[F].cells[E+1])}}}}}if(this.hdr.rows.length>2){e.call(this,2,this.hdr.rows,"_aHead",this._fake.hdr.rows)}if(this.ftr){e.call(this,1,this.ftr.childNodes[0].rows,"_aFoot");this._fake.ftr.parentNode.style.bottom=(_isFF?2:1)+"px"}if(this.saveSizeToCookie){this.saveSizeToCookie=function(x,w){if(this._realfake){return this._fake.saveSizeToCookie.apply(this._fake,arguments)}if(!x){x=this.entBox.id}var A=new Array();var C="cellWidthPX";for(var y=0;y<this[C].length;y++){if(y<f){A[y]=this._fake[C][y]}else{A[y]=this[C][y]}}A=A.join(",");this.setCookie(x,w,0,A);var A=(this.initCellWidth||(new Array)).join(",");this.setCookie(x,w,1,A);return true};this.loadSizeFromCookie=function(w){if(!w){w=this.entBox.id}var C=this._getCookie(w,1);if(!C){return}this.initCellWidth=C.split(",");var C=this._getCookie(w,0);var D="cellWidthPX";this.cellWidthType="px";var y=0;if((C)&&(C.length)){C=C.split(",");for(var x=0;x<C.length;x++){if(x<f){this._fake[D][x]=C[x];y+=C[x]*1}else{this[D][x]=C[x]}}}this._fake.entBox.style.width=y+"px";this._fake.objBox.style.width=y+"px";var A=this.globalBox.childNodes[1];A.style.left=y-(_isFF?0:0)+"px";if(this.ftr){this.ftr.style.left=y-(_isFF?0:0)+"px"}A.style.width=this.globalBox.offsetWidth-y+"px";this.setSizes();return true};this._fake.onRSE=this.onRSE}this.setCellTextStyleA=this.setCellTextStyle;this.setCellTextStyle=function(x,y,w){if(y<f){this._fake.setCellTextStyle(x,y,w)}this.setCellTextStyleA(x,y,w)};this.setRowTextBoldA=this.setRowTextBold;this.setRowTextBold=function(w){this.setRowTextBoldA(w);this._fake.setRowTextBold(w)};this.setRowColorA=this.setRowColor;this.setRowColor=function(x,w){this.setRowColorA(x,w);this._fake.setRowColor(x,w)};this.setRowHiddenA=this.setRowHidden;this.setRowHidden=function(x,w){this.setRowHiddenA(x,w);this._fake.setRowHidden(x,w)};this.setRowTextNormalA=this.setRowTextNormal;this.setRowTextNormal=function(w){this.setRowTextNormalA(w);this._fake.setRowTextNormal(w)};this.getChangedRows=function(y){var w=new Array();function x(C){for(var A=0;A<C.childNodes.length;A++){if(C.childNodes[A].wasChanged){return w[w.length]=C.idd}}}this.forEachRow(function(D){var C=this.rowsAr[D];var A=this._fake.rowsAr[D];if(C.tagName!="TR"||!A||A.tagName!="TR"){return}if(y&&C._added){w[w.length]=C.idd}else{if(!x(C)){x(A)}}});return w.join(this.delim)};this.setRowTextStyleA=this.setRowTextStyle;this.setRowTextStyle=function(x,w){this.setRowTextStyleA(x,w);if(this._fake.rowsAr[x]){this._fake.setRowTextStyle(x,w)}};this.lockRowA=this.lockRow;this.lockRow=function(x,w){this.lockRowA(x,w);this._fake.lockRow(x,w)};this.getColWidth=function(w){if(w<f){return parseInt(this._fake.cellWidthPX[w])}else{return parseInt(this.cellWidthPX[w])}};this.getColumnLabel=function(w){return this._fake.getColumnLabel.apply(((w<f)?this._fake:this),arguments)};this.setColWidthA=this._fake.setColWidthA=this.setColWidth;this.setColWidth=function(w,x){w=w*1;if(w<f){this._fake.setColWidthA(w,x)}else{this.setColWidthA(w,x)}if((w+1)<=f){this._fake._correctSplit(Math.min(this._fake.objBox.offsetWidth,this._fake.obj.offsetWidth))}};this.adjustColumnSizeA=this.adjustColumnSize;this.setColumnLabelA=this.setColumnLabel;this.setColumnLabel=function(x,w,C,A){var y=this;if(x<f){y=this._fake}return this.setColumnLabelA.apply(y,[x,w,C,A])};this.adjustColumnSize=function(w,x){if(w<f){if(_isIE){this._fake.obj.style.tableLayout=""}this._fake.adjustColumnSize(w,x);if(_isIE){this._fake.obj.style.tableLayout="fixed"}this._fake._correctSplit()}else{return this.adjustColumnSizeA(w,x)}};var m="cells";this._bfs_cells=this[m];this[m]=function(){if(arguments[1]<f){return this._fake.cells.apply(this._fake,arguments)}else{return this._bfs_cells.apply(this,arguments)}};this._bfs_isColumnHidden=this.isColumnHidden;this.isColumnHidden=function(){if(parseInt(arguments[0])<f){return this._fake.isColumnHidden.apply(this._fake,arguments)}else{return this._bfs_isColumnHidden.apply(this,arguments)}};this._bfs_setColumnHidden=this.setColumnHidden;this.setColumnHidden=function(){if(parseInt(arguments[0])<f){this._fake.setColumnHidden.apply(this._fake,arguments);return this._fake._correctSplit()}else{return this._bfs_setColumnHidden.apply(this,arguments)}};var m="cells2";this._bfs_cells2=this[m];this[m]=function(){if(arguments[1]<f){return this._fake.cells2.apply(this._fake,arguments)}else{return this._bfs_cells2.apply(this,arguments)}};var m="cells3";this._bfs_cells3=this[m];this[m]=function(x,w){if(arguments[1]<f&&this._fake.rowsAr[arguments[0].idd]){if(this._fake.rowsAr[x.idd]&&this._fake.rowsAr[x.idd].childNodes.length==0){return this._bfs_cells3.apply(this,arguments)}arguments[0]=arguments[0].idd;return this._fake.cells.apply(this._fake,arguments)}else{return this._bfs_cells3.apply(this,arguments)}};var m="changeRowId";this._bfs_changeRowId=this[m];this[m]=function(){this._bfs_changeRowId.apply(this,arguments);if(this._fake.rowsAr[arguments[0]]){this._fake.changeRowId.apply(this._fake,arguments)}};this._fake.getRowById=function(y){var x=this.rowsAr[y];if(!x&&this._fake.rowsAr[y]){x=this._fake.getRowById(y)}if(x){if(x.tagName!="TR"){for(var w=0;w<this.rowsBuffer.length;w++){if(this.rowsBuffer[w]&&this.rowsBuffer[w].idd==y){return this.render_row(w)}}if(this._h2){return this.render_row(null,x.idd)}}return x}return null};if(this.collapseKids){this._fake._bfs_collapseKids=this.collapseKids;this._fake.collapseKids=function(){return this._fake.collapseKids.apply(this._fake,[this._fake.rowsAr[arguments[0].idd]])};this["_bfs_collapseKids"]=this.collapseKids;this["collapseKids"]=function(){var w=this["_bfs_collapseKids"].apply(this,arguments);this._fake._h2syncModel();if(!this._cssSP){this._fake._fixAlterCss()}};this._fake._bfs_expandKids=this.expandKids;this._fake.expandKids=function(){this._fake.expandKids.apply(this._fake,[this._fake.rowsAr[arguments[0].idd]]);if(!this._cssSP){this._fake._fixAlterCss()}};this["_bfs_expandAll"]=this.expandAll;this["expandAll"]=function(){this._bfs_expandAll();this._fake._h2syncModel();if(!this._cssSP){this._fake._fixAlterCss()}};this["_bfs_collapseAll"]=this.collapseAll;this["collapseAll"]=function(){this._bfs_collapseAll();this._fake._h2syncModel();if(!this._cssSP){this._fake._fixAlterCss()}};this["_bfs_expandKids"]=this.expandKids;this["expandKids"]=function(){var w=this["_bfs_expandKids"].apply(this,arguments);this._fake._h2syncModel();if(!this._cssSP){this._fake._fixAlterCss()}};this._fake._h2syncModel=function(){if(this._fake.pagingOn){this._fake._renderSort()}else{this._renderSort()}};this._updateTGRState=function(w){return this._fake._updateTGRState(w)}}if(this._elmnh){this._setRowHoverA=this._fake._setRowHoverA=this._setRowHover;this._unsetRowHoverA=this._fake._unsetRowHoverA=this._unsetRowHover;this._setRowHover=this._fake._setRowHover=function(){var w=this.grid;w._setRowHoverA.apply(this,arguments);var x=(_isIE?event.srcElement:arguments[0].target);x=w._fake.rowsAr[w.getFirstParentOfType(x,"TD").parentNode.idd];if(x){w._fake._setRowHoverA.apply(w._fake.obj,[{target:x.childNodes[0]},arguments[1]])}};this._unsetRowHover=this._fake._unsetRowHover=function(){if(arguments[1]){var w=this}else{var w=this.grid}w._unsetRowHoverA.apply(this,arguments);w._fake._unsetRowHoverA.apply(w._fake.obj,arguments)};this._fake.enableRowsHover(true,this._hvrCss);this.enableRowsHover(false);this.enableRowsHover(true,this._fake._hvrCss)}this._updateTGRState=function(w){if(!w.update||w.id==0){return}if(this.rowsAr[w.id].imgTag){this.rowsAr[w.id].imgTag.src=this.iconTree+w.state+".gif"}if(this._fake.rowsAr[w.id]&&this._fake.rowsAr[w.id].imgTag){this._fake.rowsAr[w.id].imgTag.src=this.iconTree+w.state+".gif"}w.update=false};this.copy_row=function(D){var w=D.cloneNode(true);w._skipInsert=D._skipInsert;var E=f;w._attrs={};w._css=D._css;if(this._ecspn){E=0;for(var C=0;(E<w.childNodes.length&&C<f);C+=(w.childNodes[E].colSpan||1)){E++}}while(w.childNodes.length>E){w.removeChild(w.childNodes[w.childNodes.length-1])}var A=E;for(var C=0;C<A;C++){if(this.dragAndDropOff){this.dragger.addDraggableItem(w.childNodes[C],this)}w.childNodes[C].style.display=(this._fake._hrrar?(this._fake._hrrar[C]?"none":""):"");w.childNodes[C]._cellIndex=C;w.childNodes[C].combo_value=arguments[0].childNodes[C].combo_value;w.childNodes[C]._clearCell=arguments[0].childNodes[C]._clearCell;w.childNodes[C]._cellType=arguments[0].childNodes[C]._cellType;w.childNodes[C]._brval=arguments[0].childNodes[C]._brval;w.childNodes[C].val=arguments[0].childNodes[C].val;w.childNodes[C]._attrs=arguments[0].childNodes[C]._attrs;w.childNodes[C].chstate=arguments[0].childNodes[C].chstate;if(D._attrs.style){w.childNodes[C].style.cssText+=";"+D._attrs.style}if(w.childNodes[C].colSpan>1){this._childIndexes=this._fake._childIndexes}}if(this._h2&&this._treeC<f){var y=this._h2.get[arguments[0].idd];w.imgTag=w.childNodes[this._treeC].childNodes[0].childNodes[y.level];w.valTag=w.childNodes[this._treeC].childNodes[0].childNodes[y.level+2]}w.idd=D.idd;w.grid=this._fake;return w};var m="_insertRowAt";this._bfs_insertRowAt=this[m];this[m]=function(){var x=this["_bfs_insertRowAt"].apply(this,arguments);arguments[0]=this.copy_row(arguments[0]);var w=this._fake._insertRowAt.apply(this._fake,arguments);if(x._fhd){w.parentNode.removeChild(w);this._fake.rowsCol._dhx_removeAt(this._fake.rowsCol._dhx_find(w));x._fhd=false}return x};this._bfs_setSizes=this.setSizes;this.setSizes=function(){if(this._notresize){return}this._bfs_setSizes(this,arguments);this.sync_headers();if(this.sync_scroll()&&this._ahgr){this.setSizes()}var w=this.dontSetSizes?(this.entBox.offsetHeight+"px"):this.entBox.style.height;this._fake.entBox.style.height=w;this._fake.objBox.style.height=this.objBox.style.height;this._fake.hdrBox.style.height=this.hdrBox.style.height;this._fake.objBox.scrollTop=this.objBox.scrollTop;this._fake.setColumnSizes(this._fake.entBox.clientWidth);this.globalBox.style.width=parseInt(this.entBox.style.width)+parseInt(this._fake.entBox.style.width);if(!this.dontSetSizes){this.globalBox.style.height=w}};this.sync_scroll=this._fake.sync_scroll=function(x){var w=this.objBox.style.overflowX;if(this.obj.offsetWidth<=this.objBox.offsetWidth){if(!x){return this._fake.sync_scroll(true)}this.objBox.style.overflowX="hidden";this._fake.objBox.style.overflowX="hidden"}else{if(!dhtmlx.$customScroll){this.objBox.style.overflowX="scroll";this._fake.objBox.style.overflowX="scroll"}}return w!=this.objBox.style.overflowX};this.sync_headers=this._fake.sync_headers=function(){if(this.noHeader||(this._fake.hdr.scrollHeight==this.hdr.offsetHeight)){return}for(var x=1;x<this.hdr.rows.length;x++){var A=f;while(!this.hdr.rows[x].childNodes[A]){A--}var w=Math.min(this.hdr.rows[x].childNodes[A].scrollHeight+2,this.hdr.rows[x].scrollHeight);var y=this._fake.hdr.rows[x].scrollHeight;if(w!=y){this._fake.hdr.rows[x].style.height=this.hdr.rows[x].style.height=Math.max(w,y)+"px"}if(window._KHTMLrv){this._fake.hdr.rows[x].childNodes[0].style.height=this.hdr.rows[x].childNodes[A].style.height=Math.max(w,y)+"px"}}this._fake.sync_headers};this._fake._bfs_setSizes=this._fake.setSizes;this._fake.setSizes=function(){if(this._fake._notresize){return}this._fake.setSizes()};var m="_doOnScroll";this._bfs__doOnScroll=this[m];this[m]=function(){this._bfs__doOnScroll.apply(this,arguments);this._fake.objBox.scrollTop=this.objBox.scrollTop;this._fake._doOnScroll.apply(this._fake,arguments)};var m="selectAll";this._bfs__selectAll=this[m];this[m]=function(){this._bfs__selectAll.apply(this,arguments);this._bfs__selectAll.apply(this._fake,arguments)};var m="doClick";this._bfs_doClick=this[m];this[m]=function(){this["_bfs_doClick"].apply(this,arguments);if(arguments[0].tagName=="TD"){var w=(arguments[0]._cellIndex>=f);if(!arguments[0].parentNode.idd){return}if(!w){arguments[0].className=arguments[0].className.replace(/cellselected/g,"")}if(!this._fake.rowsAr[arguments[0].parentNode.idd]){this._fake.render_row(this.getRowIndex(arguments[0].parentNode.idd))}arguments[0]=this._fake.cells(arguments[0].parentNode.idd,(w?0:arguments[0]._cellIndex)).cell;if(w){this._fake.cell=null}this._fake._bfs_doClick.apply(this._fake,arguments);if(w){this._fake.cell=this.cell}else{this.cell=this._fake.cell}if(this._fake.onRowSelectTime){clearTimeout(this._fake.onRowSelectTime)}if(w){arguments[0].className=arguments[0].className.replace(/cellselected/g,"");globalActiveDHTMLGridObject=this;this._fake.cell=this.cell}else{this.objBox.scrollTop=this._fake.objBox.scrollTop}}};this._fake._bfs_doClick=this._fake[m];this._fake[m]=function(){this["_bfs_doClick"].apply(this,arguments);if(arguments[0].tagName=="TD"){var w=(arguments[0]._cellIndex<f);if(!arguments[0].parentNode.idd){return}arguments[0]=this._fake._bfs_cells(arguments[0].parentNode.idd,(w?f:arguments[0]._cellIndex)).cell;this._fake.cell=null;this._fake._bfs_doClick.apply(this._fake,arguments);this._fake.cell=this.cell;if(this._fake.onRowSelectTime){clearTimeout(this._fake.onRowSelectTime)}if(w){arguments[0].className=arguments[0].className.replace(/cellselected/g,"");globalActiveDHTMLGridObject=this;this._fake.cell=this.cell;this._fake.objBox.scrollTop=this.objBox.scrollTop}}};this.clearSelectionA=this.clearSelection;this.clearSelection=function(w){if(w){this._fake.clearSelection()}this.clearSelectionA()};this.moveRowUpA=this.moveRowUp;this.moveRowUp=function(w){if(!this._h2){this._fake.moveRowUp(w)}this.moveRowUpA(w);if(this._h2){this._fake._h2syncModel()}};this.moveRowDownA=this.moveRowDown;this.moveRowDown=function(w){if(!this._h2){this._fake.moveRowDown(w)}this.moveRowDownA(w);if(this._h2){this._fake._h2syncModel()}};this._fake.getUserData=function(){return this._fake.getUserData.apply(this._fake,arguments)};this._fake.setUserData=function(){return this._fake.setUserData.apply(this._fake,arguments)};this.getSortingStateA=this.getSortingState;this.getSortingState=function(){var w=this.getSortingStateA();if(w.length!=0){return w}return this._fake.getSortingState()};this.setSortImgStateA=this._fake.setSortImgStateA=this.setSortImgState;this.setSortImgState=function(x,w,A,y){this.setSortImgStateA(x,w,A,y);if(w*1<f){this._fake.setSortImgStateA(x,w,A,y);this.setSortImgStateA(false)}else{this._fake.setSortImgStateA(false)}};this._fake.doColResizeA=this._fake.doColResize;this._fake.doColResize=function(D,C,A,w,F){var y=-1;var E=0;if(arguments[1]._cellIndex==(f-1)){y=this._initalSplR+(D.clientX-w);if(!this._initalSplF){this._initalSplF=arguments[3]+this.objBox.scrollWidth-this.objBox.offsetWidth}if(this.objBox.scrollWidth==this.objBox.offsetWidth&&(this._fake.alter_split_resize||(D.clientX-w)>0)){arguments[3]=(this._initalSplF||arguments[3]);E=this.doColResizeA.apply(this,arguments)}else{E=this.doColResizeA.apply(this,arguments)}}else{if(this.obj.offsetWidth<this.entBox.offsetWidth){y=this.obj.offsetWidth}E=this.doColResizeA.apply(this,arguments)}this._correctSplit(y);this.resized=this._fake.resized=1;return E};this._fake.changeCursorState=function(y){var x=y.target||y.srcElement;if(x.tagName!="TD"){x=this.getFirstParentOfType(x,"TD")}if((x.tagName=="TD")&&(this._drsclmn)&&(!this._drsclmn[x._cellIndex])){return}var w=(y.layerX||0)+(((!_isIE)&&(y.target.tagName=="DIV"))?x.offsetLeft:0);var A=parseInt(this.getPosition(x,this.hdrBox));if(((x.offsetWidth-(y.offsetX||(A-w)*-1))<(_isOpera?20:10))||((this.entBox.offsetWidth-(y.offsetX?(y.offsetX+x.offsetLeft):w)+this.objBox.scrollLeft-0)<(_isOpera?20:10))){x.style.cursor="E-resize"}else{x.style.cursor="default"}if(_isOpera){this.hdrBox.scrollLeft=this.objBox.scrollLeft}};this._fake.startColResizeA=this._fake.startColResize;this._fake.startColResize=function(x){var y=this.startColResizeA(x);this._initalSplR=this.entBox.offsetWidth;this._initalSplF=null;if(this.entBox.onmousemove){var w=this.entBox.parentNode;if(w._aggrid){return y}w._aggrid=w.grid;w.grid=this;this.entBox.parentNode.onmousemove=this.entBox.onmousemove;this.entBox.onmousemove=null}return y};this._fake.stopColResizeA=this._fake.stopColResize;this._fake.stopColResize=function(x){if(this.entBox.parentNode.onmousemove){var w=this.entBox.parentNode;w.grid=w._aggrid;w._aggrid=null;this.entBox.onmousemove=this.entBox.parentNode.onmousemove;this.entBox.parentNode.onmousemove=null;if(this.obj.offsetWidth<this.entBox.offsetWidth){this._correctSplit(this.obj.offsetWidth)}}return this.stopColResizeA(x)};this.doKeyA=this.doKey;this._fake.doKeyA=this._fake.doKey;this._fake.doKey=this.doKey=function(y){if(!y){return true}if(this._htkebl){return true}if((y.target||y.srcElement).value!==window.undefined){var w=(y.target||y.srcElement);if((!w.parentNode)||(w.parentNode.className.indexOf("editable")==-1)){return true}}switch(y.keyCode){case 9:if(!y.shiftKey){if(this._realfake){if((this.cell)&&(this.cell._cellIndex==(f-1))){if(y.preventDefault){y.preventDefault()}var x=f;while(this._fake._hrrar&&this._fake._hrrar[x]){x++}this._fake.selectCell(this._fake.getRowIndex(this.cell.parentNode.idd),x,false,false,true);return false}else{var A=this.doKeyA(y)}globalActiveDHTMLGridObject=this;return A}else{if(this.cell){var x=this.cell._cellIndex+1;while(this.rowsCol[0].childNodes[x]&&this.rowsCol[0].childNodes[x].style.display=="none"){x++}if(x==this.rowsCol[0].childNodes.length){if(y.preventDefault){y.preventDefault()}var A=this.rowsBuffer[this.getRowIndex(this.cell.parentNode.idd)+1];if(A){this.showRow(A.idd);this._fake.selectCell(this._fake.getRowIndex(A.idd),0,false,false,true);return false}}}return this.doKeyA(y)}}else{if(this._realfake){if((this.cell)&&(this.cell._cellIndex==0)){if(y.preventDefault){y.preventDefault()}var A=this._fake.rowsBuffer[this._fake.getRowIndex(this.cell.parentNode.idd)-1];if(A){this._fake.showRow(A.idd);var x=this._fake._cCount-1;while(A.childNodes[x].style.display=="none"){x--}this._fake.selectCell(this._fake.getRowIndex(A.idd),x,false,false,true)}return false}else{return this.doKeyA(y)}}else{if((this.cell)&&(this.cell._cellIndex==f)){if(y.preventDefault){y.preventDefault()}this._fake.selectCell(this.getRowIndex(this.cell.parentNode.idd),f-1,false,false,true);return false}else{return this.doKeyA(y)}}}break}return this.doKeyA(y)};this.editCellA=this.editCell;this.editCell=function(){if(this.cell&&this.cell.parentNode.grid!=this){return this._fake.editCell()}return this.editCellA()};this.deleteRowA=this.deleteRow;this.deleteRow=function(w,x){if(this.deleteRowA(w,x)===false){return false}if(this._fake.rowsAr[w]){this._fake.deleteRow(w)}};this.clearAllA=this.clearAll;this.clearAll=function(){this.clearAllA();this._fake.clearAll()};this.editStopA=this.editStop;this.editStop=function(w){if(this._fake.editor){this._fake.editStop(w)}else{this.editStopA(w)}};this.attachEvent("onAfterSorting",function(x,w,y){if(x>=f){this._fake.setSortImgState(false)}});this._fake.sortField=function(x,w,A){this._fake.sortField.call(this._fake,x,w,this._fake.hdr.rows[0].cells[x]);if(this.fldSort[x]!="na"&&this._fake.fldSorted){var y=this._fake.getSortingState()[1];this._fake.setSortImgState(false);this.setSortImgState(true,arguments[0],y)}};this.sortTreeRowsA=this.sortTreeRows;this._fake.sortTreeRowsA=this._fake.sortTreeRows;this.sortTreeRows=this._fake.sortTreeRows=function(y,A,w,x){if(this._realfake){return this._fake.sortTreeRows(y,A,w,x)}this.sortTreeRowsA(y,A,w,x);this._fake._h2syncModel();this._fake.setSortImgStateA(false);this._fake.fldSorted=null};this._fake._fillers=[];this._fake.rowsBuffer=this.rowsBuffer;this.attachEvent("onClearAll",function(){this._fake.rowsBuffer=this.rowsBuffer});this._add_filler_s=this._add_filler;this._add_filler=function(x,w,C,y){if(!this._fake._fillers){this._fake._fillers=[]}if(this._realfake||!y){var A;if(C||!this._fake._fillers.length){if(C&&C.idd){A=this._fake.rowsAr[C.idd]}else{if(C&&C.nextSibling){A={};A.nextSibling=this._fake.rowsAr[C.nextSibling.idd];A.parentNode=A.nextSibling.parentNode}}this._fake._fillers.push(this._fake._add_filler(x,w,A))}}return this._add_filler_s.apply(this,arguments)};this._add_from_buffer_s=this._add_from_buffer;this._add_from_buffer=function(){var w=this._add_from_buffer_s.apply(this,arguments);if(w!=-1){this._fake._add_from_buffer.apply(this._fake,arguments);if(this.multiLine){this._correctRowHeight(this.rowsBuffer[arguments[0]].idd)}}return w};this._fake.render_row=function(w){var x=this._fake.render_row(w);if(x==-1){return -1}if(x){return this.rowsAr[x.idd]=this.rowsAr[x.idd]||this._fake.copy_row(x)}return null};this._reset_view_s=this._reset_view;this._reset_view=function(){this._fake._reset_view(true);this._fake._fillers=[];this._reset_view_s()};this.moveColumn_s=this.moveColumn;this.moveColumn=function(x,w){if(w>=f){return this.moveColumn_s(x,w)}};this.attachEvent("onCellChanged",function(C,y,A){if(this._split_event&&y<f&&this.rowsAr[C]){var w=this._fake.rowsAr[C];if(!w){return}if(w._childIndexes){w=w.childNodes[w._childIndexes[y]]}else{w=w.childNodes[y]}var x=this.rowsAr[C].childNodes[y];if(x._treeCell&&x.firstChild.lastChild){x.firstChild.lastChild.innerHTML=A}else{x.innerHTML=w.innerHTML}x._clearCell=false;x.combo_value=w.combo_value;x.chstate=w.chstate}});this._fake.combos=this.combos;this.setSizes();if(this.rowsBuffer[0]){this._reset_view()}this.attachEvent("onXLE",function(){this._fake._correctSplit()});this._fake._correctSplit()};dhtmlXGridObject.prototype._correctSplit=function(c){c=c||(this.obj.scrollWidth-this.objBox.scrollLeft);c=Math.min(this.globalBox.offsetWidth,c);if(c>-1){this.entBox.style.width=c+"px";this.objBox.style.width=c+"px";var e=(this.globalBox.offsetWidth-this.globalBox.clientWidth)/2;this._fake.entBox.style.left=c+"px";this._fake.entBox.style.width=Math.max(0,this.globalBox.offsetWidth-c-(this.quirks?0:2)*e)+"px";if(this._fake.ftr){this._fake.ftr.parentNode.style.width=this._fake.entBox.style.width}if(_isIE){var d=_isIE&&!window.xmlHttpRequest;var e=(this.globalBox.offsetWidth-this.globalBox.clientWidth);this._fake.hdrBox.style.width=this._fake.objBox.style.width=Math.max(0,this.globalBox.offsetWidth-(d?e:0)-c)+"px"}}};dhtmlXGridObject.prototype._correctRowHeight=function(l,g){if(!this.rowsAr[l]||!this._fake.rowsAr[l]){return}var f=this.rowsAr[l].offsetHeight;var d=this._fake.rowsAr[l].offsetHeight;var a=Math.max(f,d);if(!a){return}this.rowsAr[l].style.height=this._fake.rowsAr[l].style.height=a+"px";if(window._KHTMLrv){var c=this._fake._cCount;var k;while(!k&&c>=0){k=this.rowsAr[l].childNodes[c];c-=1}var e=this._fake.rowsAr[l].firstChild;if(k&&e){k.style.height=e.style.height=a+"px"}}};dhtmlXGridObject.prototype.enableAutoSizeSaving=function(c,a){this.attachEvent("onResizeEnd",function(){this.saveSizeToCookie(c,a)})};dhtmlXGridObject.prototype.saveOpenStates=function(c,a){if(!c){c=this.entBox.id}var d=[];this._h2.forEachChild(0,function(f){if(f.state=="minus"){d.push(f.id)}});var e="gridOpen"+(c||"")+"="+d.join("|")+(a?("; "+a):"");document.cookie=e};dhtmlXGridObject.prototype.loadOpenStates=function(d,a){var f=this.getCookie(d,"gridOpen");if(!f){return}f=f.split("|");for(var e=0;e<f.length;e++){var c=this.getParentId(f[e]);if(!this.getOpenState(c)){continue}this.openItem(f[e])}};dhtmlXGridObject.prototype.enableAutoHiddenColumnsSaving=function(c,a){this.attachEvent("onColumnHidden",function(){this.saveHiddenColumnsToCookie(c,a)})};dhtmlXGridObject.prototype.enableSortingSaving=function(c,a){this.attachEvent("onBeforeSorting",function(){var d=this;window.setTimeout(function(){d.saveSortingToCookie(c,a)},1);return true})};dhtmlXGridObject.prototype.enableOrderSaving=function(c,a){this.attachEvent("onAfterCMove",function(){this.saveOrderToCookie(c,a);this.saveSizeToCookie(c,a)})};dhtmlXGridObject.prototype.enableAutoSaving=function(c,a){this.enableOrderSaving(c,a);this.enableAutoSizeSaving(c,a);this.enableSortingSaving(c,a)};dhtmlXGridObject.prototype.saveSizeToCookie=function(c,a){if(this.cellWidthType=="px"){var e=this.cellWidthPX.join(",")}else{var e=this.cellWidthPC.join(",")}var d=(this.initCellWidth||(new Array)).join(",");this.setCookie(c,a,0,e);this.setCookie(c,a,1,d)};dhtmlXGridObject.prototype.saveHiddenColumnsToCookie=function(c,a){var e=[].concat(this._hrrar||[]);if(this._fake&&this._fake._hrrar){for(var d=0;d<this._fake._cCount;d++){e[d]=this._fake._hrrar[d]?"1":""}}this.setCookie(c,a,4,e.join(",").replace(/display:none;/g,"1"))};dhtmlXGridObject.prototype.loadHiddenColumnsFromCookie=function(c){var e=this._getCookie(c,4);var a=(e||"").split(",");for(var d=0;d<this._cCount;d++){this.setColumnHidden(d,(a[d]?true:false))}};dhtmlXGridObject.prototype.saveSortingToCookie=function(c,a){this.setCookie(c,a,2,(this.getSortingState()||[]).join(","))};dhtmlXGridObject.prototype.loadSortingFromCookie=function(a){var c=this._getCookie(a,2);c=(c||"").split(",");if(c.length>1&&c[0]<this._cCount){this.sortRows(c[0],null,c[1]);this.setSortImgState(true,c[0],c[1])}};dhtmlXGridObject.prototype.saveOrderToCookie=function(d,a){if(!this._c_order){this._c_order=[];var c=this._cCount;for(var e=0;e<c;e++){this._c_order[e]=e}}this.setCookie(d,a,3,((this._c_order||[]).slice(0,this._cCount)).join(","));this.saveSortingToCookie()};dhtmlXGridObject.prototype.loadOrderFromCookie=function(c){var f=this._getCookie(c,3);f=(f||"").split(",");if(f.length>1&&f.length<=this._cCount){for(var e=0;e<f.length;e++){if((!this._c_order&&f[e]!=e)||(this._c_order&&f[e]!=this._c_order[e])){var d=f[e];if(this._c_order){for(var a=0;a<this._c_order.length;a++){if(this._c_order[a]==f[e]){d=a;break}}}this.moveColumn(d*1,e)}}}};dhtmlXGridObject.prototype.loadSizeFromCookie=function(a){var d=this._getCookie(a,1);if(d){this.initCellWidth=d.split(",")}var d=this._getCookie(a,0);if((d)&&(d.length)){if(!this._fake&&this._hrrar){for(var c=0;c<d.length;c++){if(this._hrrar[c]){d[c]=0}}}if(this.cellWidthType=="px"){this.cellWidthPX=d.split(",")}else{this.cellWidthPC=d.split(",")}}this.setSizes();return true};dhtmlXGridObject.prototype.clearConfigCookie=function(a){if(!a){a=this.entBox.id}var c="gridSettings"+a+"=||||";document.cookie=c};dhtmlXGridObject.prototype.clearSizeCookie=dhtmlXGridObject.prototype.clearConfigCookie;dhtmlXGridObject.prototype.setCookie=function(c,a,g,e){if(!c){c=this.entBox.id}var d=this.getCookie(c);d=(d||"||||").split("|");d[g]=e;var f="gridSettings"+c+"="+d.join("|").replace(/,/g,"-")+(a?("; "+a):"");document.cookie=f};dhtmlXGridObject.prototype.getCookie=function(c,e){if(!c){c=this.entBox.id}c=(e||"gridSettings")+c;var d=c+"=";if(document.cookie.length>0){var f=document.cookie.indexOf(d);if(f!=-1){f+=d.length;var a=document.cookie.indexOf(";",f);if(a==-1){a=document.cookie.length}return document.cookie.substring(f,a)}}};dhtmlXGridObject.prototype._getCookie=function(a,c){return((this.getCookie(a)||"||||").replace(/-/g,",").split("|"))[c]};dhtmlXGridObject.prototype.enableUndoRedo=function(){var c=this;var d=function(){return c._onEditUndoRedo.apply(c,arguments)};this.attachEvent("onEditCell",d);var a=function(f,e,g){return c._onEditUndoRedo.apply(c,[2,f,e,(g?1:0),(g?0:1)])};this.attachEvent("onCheckbox",a);this._IsUndoRedoEnabled=true;this._UndoRedoData=[];this._UndoRedoPos=-1};dhtmlXGridObject.prototype.disableUndoRedo=function(){this._IsUndoRedoEnabled=false;this._UndoRedoData=[];this._UndoRedoPos=-1};dhtmlXGridObject.prototype._onEditUndoRedo=function(d,c,g,e,a){if(this._IsUndoRedoEnabled&&d==2&&a!=e){if(this._UndoRedoPos!==-1&&this._UndoRedoPos!=(this._UndoRedoData.length-1)){this._UndoRedoData=this._UndoRedoData.slice(0,this._UndoRedoPos+1)}else{if(this._UndoRedoPos===-1&&this._UndoRedoData.length>0){this._UndoRedoData=[]}}var f={old_value:a,new_value:e,row_id:c,cell_index:g};this._UndoRedoData.push(f);this._UndoRedoPos++}return true};dhtmlXGridObject.prototype.doUndo=function(){if(this._UndoRedoPos===-1){return false}var a=this._UndoRedoData[this._UndoRedoPos--];var d=this.cells(a.row_id,a.cell_index);if(this.getColType(a.cell_index)=="tree"){d.setLabel(a.old_value)}else{d.setValue(a.old_value)}this.callEvent("onUndo",[a.row_id])};dhtmlXGridObject.prototype.doRedo=function(){if(this._UndoRedoPos==this._UndoRedoData.length-1){return false}var a=this._UndoRedoData[++this._UndoRedoPos];this.cells(a.row_id,a.cell_index).setValue(a.new_value);this.callEvent("onUndo",[a.row_id])};dhtmlXGridObject.prototype.getRedo=function(){if(this._UndoRedoPos==this._UndoRedoData.length-1){return[]}return this._UndoRedoData.slice(this._UndoRedoPos+1)};dhtmlXGridObject.prototype.getUndo=function(){if(this._UndoRedoPos==-1){return[]}return this._UndoRedoData.slice(0,this._UndoRedoPos+1)};function eXcell_time(a){this.base=eXcell_ed;this.base(a);this.getValue=function(){return this.cell.innerHTML.toString()};this.setValue=function(g){var f=new RegExp(" ","i");g=g.replace(f,":");if((g=="")){g="00:00"}else{var f=new RegExp("[a-zA-Z]","i");var e=g.match(f);if(e){g="00:00"}else{var f=new RegExp("[0-9]+[\\.\\/;\\-,_\\]\\[\\?\\: ][0-9]+","i");var e=g.search(f);if(e!=-1){var f=new RegExp("[\\./\\;\\-\\,\\_\\]\\[ \\?]","i");g=g.replace(f,":")}else{var f=new RegExp("[^0-9]","i");res1=g.search(f);if(e=g.match(f)){g="00:00"}else{if(g.length==1){g="00:0"+g}else{if(parseInt(g)<60){g="00:"+g}else{if(g.length<5){var d=parseInt(g);var c=Math.floor(d/60);d=d-60*c;var c=c.toString();var d=d.toString();while(c.length<2){c="0"+c}while(d.length<2){d="0"+d}g=c+":"+d}}}}}}}this.cell.innerHTML=g}}eXcell_time.prototype=new eXcell_ed;function eXcell_sub_row(a){if(a){this.cell=a;this.grid=this.cell.parentNode.grid}this.getValue=function(){return this.grid.getUserData(this.cell.parentNode.idd,"__sub_row")};this._setState=function(c,d){(d||this.cell).innerHTML="<img src='"+this.grid.imgURL+c+"' width='18' height='18' />";(d||this.cell).firstChild.onclick=this.grid._expandMonolite};this.open=function(){this.cell.firstChild.onclick(null,true)};this.close=function(){this.cell.firstChild.onclick(null,false,true)};this.isOpen=function(){return !!this.cell.parentNode._expanded};this.setValue=function(c){if(c){this.grid.setUserData(this.cell.parentNode.idd,"__sub_row",c)}this._setState(c?"plus.gif":"blank.gif")};this.setContent=function(c){if(this.cell.parentNode._expanded){this.cell.parentNode._expanded.innerHTML=c;this.resize()}else{this.cell._previous_content=null;this.setValue(c);this.cell._sub_row_type=null}};this.resize=function(){this.grid._detectHeight(this.cell.parentNode._expanded,this.cell,this.cell.parentNode._expanded.scrollHeight)},this.isDisabled=function(){return true};this.getTitle=function(){return this.grid.getUserData(this.cell.parentNode.idd,"__sub_row")?"click to expand|collapse":""}}eXcell_sub_row.prototype=new eXcell;function eXcell_sub_row_ajax(a){this.base=eXcell_sub_row;this.base(a);this.setValue=function(c){if(c){this.grid.setUserData(this.cell.parentNode.idd,"__sub_row",c)}this.cell._sub_row_type="ajax";this.cell._previous_content=null;this._setState(c?"plus.gif":"blank.gif")}}eXcell_sub_row_ajax.prototype=new eXcell_sub_row;function eXcell_sub_row_grid(a){this.base=eXcell_sub_row;this.base(a);this.setValue=function(c){if(c){this.grid.setUserData(this.cell.parentNode.idd,"__sub_row",c)}this.cell._sub_row_type="grid";this._setState(c?"plus.gif":"blank.gif")};this.getSubGrid=function(){if(!a._sub_grid){return null}return a._sub_grid}}eXcell_sub_row_grid.prototype=new eXcell_sub_row;dhtmlXGridObject.prototype._expandMonolite=function(a,q,h){var e=this.parentNode;var r=e.parentNode;var l=r.grid;if(a||window.event){if(!h&&!r._expanded){l.editStop()}(a||event).cancelBubble=true}var o=l.getUserData(r.idd,"__sub_row");if(!l._sub_row_editor){l._sub_row_editor=new eXcell_sub_row(e)}if(!o){return}if(r._expanded&&!q){l._sub_row_editor._setState("plus.gif",e);e._previous_content=r._expanded;l.objBox.removeChild(r._expanded);r._expanded=false;r.style.height=(r.oldHeight||20)+"px";e.style.height=(r.oldHeight||20)+"px";if(l._fake){l._fake.rowsAr[r.idd].style.height=(r.oldHeight||20)+"px"}for(var g=0;g<r.cells.length;g++){r.cells[g].style.verticalAlign="middle";r.cells[g].style.paddingTop="0px"}delete l._flow[r.idd];l._correctMonolite();r._expanded.ctrl=null}else{if(!r._expanded&&!h){l._sub_row_editor._setState("minus.gif",e);r.oldHeight=e.offsetHeight;if(e._previous_content){var m=e._previous_content;m.ctrl=e;l.objBox.appendChild(m);l._detectHeight(m,e,parseInt(m.style.height))}else{var m=document.createElement("DIV");m.ctrl=e;if(e._sub_row_type){l._sub_row_render[e._sub_row_type](l,m,e,o)}else{m.innerHTML=o}m.style.cssText="position:absolute; left:0px; top:0px; overflow:auto; font-family:Tahoma; font-size:8pt; margin-top:2px; margin-left:4px;";m.className="dhx_sub_row";l.objBox.appendChild(m);l._detectHeight(m,e)}if(!l._flow){l.attachEvent("onGridReconstructed",function(){if((this.pagingOn&&!this.parentGrid)||this._srnd){this._collapsMonolite()}else{this._correctMonolite()}});l.attachEvent("onResizeEnd",function(){this._correctMonolite(true)});l.attachEvent("onAfterCMove",function(){this._correctMonolite(true)});l.attachEvent("onDrop",function(){this._correctMonolite(true)});l.attachEvent("onBeforePageChanged",function(){this._collapsMonolite();return true});l.attachEvent("onGroupStateChanged",function(){this._correctMonolite();return true});l.attachEvent("onFilterEnd",function(){this._collapsMonolite()});l.attachEvent("onUnGroup",function(){this._collapsMonolite()});l.attachEvent("onPageChanged",function(){this._collapsMonolite()});l.attachEvent("onXLE",function(){this._collapsMonolite()});l.attachEvent("onClearAll",function(){for(var c in this._flow){if(this._flow[c]&&this._flow[c].parentNode){this._flow[c].parentNode.removeChild(this._flow[c])}}this._flow=[]});l.attachEvent("onEditCell",function(n,d,s){if((n!==2)&&this._flow[d]&&this.cellType[s]!="ch"&&this.cellType[s]!="ra"){this._expandMonolite.apply(this._flow[d].ctrl.firstChild,[0,false,true])}return true});l.attachEvent("onCellChanged",function(s,d){if(!this._flow[s]){return}var n=this.cells(s,d).cell;n.style.verticalAlign="top";n.style.paddingTop="3px"});l._flow=[]}l._flow[r.idd]=m;l._correctMonolite();var k=l._srdh>30?11:3;if(l.multiLine){k=0}for(var g=0;g<r.cells.length;g++){r.cells[g].style.verticalAlign="top";r.cells[g].style.paddingTop=k+"px"}if(l._fake){var f=l._fake.rowsAr[r.idd];for(var g=0;g<f.cells.length;g++){f.cells[g].style.verticalAlign="top";f.cells[g].style.paddingTop=k+"px"}}e.style.paddingTop=(k-1)+"px";r._expanded=m}}if(l._ahgr){l.setSizes()}if(l.parentGrid){l.callEvent("onGridReconstructed",[])}l.callEvent("onSubRowOpen",[r.idd,(!!r._expanded)])};dhtmlXGridObject.prototype._sub_row_render={ajax:function(that,d,td,c){d.innerHTML="Loading...";var xml=new dtmlXMLLoaderObject(function(){d.innerHTML=xml.xmlDoc.responseText;var z=xml.xmlDoc.responseText.match(/<script[^>]*>([^\f]+?)<\/script>/g);if(z){for(var i=0;i<z.length;i++){eval(z[i].replace(/<([\/]{0,1})s[^>]*>/g,""))}}that._detectHeight(d,td);that._correctMonolite();that.setUserData(td.parentNode.idd,"__sub_row",xml.xmlDoc.responseText);td._sub_row_type=null;if(that._ahgr){that.setSizes()}that.callEvent("onSubAjaxLoad",[td.parentNode.idd,xml.xmlDoc.responseText])},this,true,true);xml.loadXML(c)},grid:function(a,e,g,f){g._sub_grid=new dhtmlXGridObject(e);if(a.skin_name){g._sub_grid.setSkin(a.skin_name)}g._sub_grid.parentGrid=a;g._sub_grid.imgURL=a.imgURL;g._sub_grid.iconURL=a.iconURL;g._sub_grid.enableAutoHeight(true);g._sub_grid._delta_x=g._sub_grid._delta_y=null;g._sub_grid.attachEvent("onGridReconstructed",function(){a._detectHeight(e,g,g._sub_grid.objBox.scrollHeight+g._sub_grid.hdr.offsetHeight+(this.ftr?this.ftr.offsetHeight:0));a._correctMonolite();this.setSizes();if(a.parentGrid){a.callEvent("onGridReconstructed",[])}});if(!a.callEvent("onSubGridCreated",[g._sub_grid,g.parentNode.idd,g._cellIndex,f])){g._sub_grid.objBox.style.overflow="hidden";g._sub_row_type=null}else{g._sub_grid.loadXML(f,function(){a._detectHeight(e,g,g._sub_grid.objBox.scrollHeight+g._sub_grid.hdr.offsetHeight+(g._sub_grid.ftr?g._sub_grid.ftr.offsetHeight:0));g._sub_grid.objBox.style.overflow="hidden";a._correctMonolite();g._sub_row_type=null;if(!a.callEvent("onSubGridLoaded",[g._sub_grid,g.parentNode.idd,g._cellIndex,f])){return}if(a._ahgr){a.setSizes()}})}}};dhtmlXGridObject.prototype._detectHeight=function(g,k,c){var a=k.offsetLeft+k.offsetWidth;g.style.left=a+"px";g.style.width=Math.max(0,k.parentNode.offsetWidth-a-4)+"px";var c=c||g.scrollHeight;g.style.overflow="hidden";g.style.height=c+"px";var f=k.parentNode;k.parentNode.style.height=(f.oldHeight||20)+3+c*1+"px";k.style.height=(f.oldHeight||20)+3+c*1+"px";if(this._fake){var e=this._fake.rowsAr[k.parentNode.idd];e.style.height=(f.oldHeight||20)+3+c*1+"px"}};dhtmlXGridObject.prototype._correctMonolite=function(e){if(this._in_correction){return}this._in_correction=true;for(var d in this._flow){if(this._flow[d]&&this._flow[d].tagName=="DIV"){if(this.rowsAr[d]){if(this.rowsAr[d].style.display=="none"){this.cells4(this._flow[d].ctrl).close();continue}this._flow[d].style.top=this.rowsAr[d].offsetTop+(this.rowsAr[d].oldHeight||20)+"px";if(e){var c=this._flow[d].ctrl.offsetLeft+this._flow[d].ctrl.offsetWidth;this._flow[d].style.left=c+"px";this._flow[d].style.width=this.rowsAr[d].offsetWidth-c-4+"px"}}else{this._flow[d].ctrl=null;this.objBox.removeChild(this._flow[d]);delete this._flow[d]}}}this._in_correction=false};dhtmlXGridObject.prototype._collapsMonolite=function(){for(var c in this._flow){if(this._flow[c]&&this._flow[c].tagName=="DIV"){if(this.rowsAr[c]){this.cells4(this._flow[c].ctrl).close()}}}};function eXcell_ra_str(a){if(a){this.base=eXcell_ra;this.base(a);this.grid=a.parentNode.grid}}eXcell_ra_str.prototype=new eXcell_ch;eXcell_ra_str.prototype.setValue=function(d){this.cell.style.verticalAlign="middle";if(d){d=d.toString()._dhx_trim();if((d=="false")||(d=="0")){d=""}}if(d){if(this.grid.rowsAr[this.cell.parentNode.idd]){for(var c=0;c<this.grid._cCount;c++){if(c!==this.cell._cellIndex){var a=this.grid.cells(this.cell.parentNode.idd,c);if((a.cell._cellType||this.grid.cellType[a.cell._cellIndex])!="ra_str"){continue}if(a.getValue()){a.setValue("0")}}}}d="1";this.cell.chstate="1"}else{d="0";this.cell.chstate="0"}this.setCValue("<img src='"+this.grid.imgURL+"radio_chk"+d+".gif' onclick='new eXcell_ra_str(this.parentNode).changeState()'>",this.cell.chstate)};dhtmlXGridObject.prototype._init_point_bcg=dhtmlXGridObject.prototype._init_point;dhtmlXGridObject.prototype._init_point=function(){if(!window.dhx_globalImgPath){window.dhx_globalImgPath=this.imgURL}this._col_combos=[];for(var a=0;a<this._cCount;a++){if(this.cellType[a].indexOf("combo")==0){this._col_combos[a]=eXcell_combo.prototype.initCombo.call({grid:this},a)}}if(!this._loading_handler_set){this._loading_handler_set=this.attachEvent("onXLE",function(e,d,g,f){eXcell_combo.prototype.fillColumnCombos(this,f);this.detachEvent(this._loading_handler_set);this._loading_handler_set=null})}if(this._init_point_bcg){this._init_point_bcg()}};function eXcell_combo(a){if(!a){return}this.cell=a;this.grid=a.parentNode.grid;this._combo_pre="";this.edit=function(){if(!window.dhx_globalImgPath){window.dhx_globalImgPath=this.grid.imgURL}this.val=this.getValue();var c=this.getText();if(this.cell._clearCell){c=""}this.cell.innerHTML="";if(!this.cell._brval){this.combo=(this.grid._realfake?this.grid._fake:this.grid)._col_combos[this.cell._cellIndex]}else{this.combo=this.cell._brval}this.cell.appendChild(this.combo.DOMParent);this.combo.DOMParent.style.margin="0";this.combo.DOMelem_input.focus();this.combo.setSize(this.cell.offsetWidth-2);if(!this.combo._xml){if(this.combo.getIndexByValue(this.cell.combo_value)!=-1){this.combo.selectOption(this.combo.getIndexByValue(this.cell.combo_value))}else{if(this.combo.getOptionByLabel(c)){this.combo.selectOption(this.combo.getIndexByValue(this.combo.getOptionByLabel(c).value))}else{this.combo.setComboText(c)}}}else{this.combo.setComboText(c)}this.combo.openSelect()};this.selectComboOption=function(d,c){c.selectOption(c.getIndexByValue(c.getOptionByLabel(d).value))};this.getValue=function(c){return this.cell.combo_value||""};this.getText=function(d){var e=this.cell;if(this._combo_pre==""&&e.childNodes[1]){e=e.childNodes[1]}else{e.childNodes[0].childNodes[1]}return(_isIE?e.innerText:e.textContent)};this.setValue=function(f){if(typeof(f)=="object"){this.cell._brval=this.initCombo();var d=this.cell._cellIndex;var e=this.cell.parentNode.idd;if(!f.firstChild){this.cell.combo_value="&nbsp;";this.cell._clearCell=true}else{this.cell.combo_value=f.firstChild.data}this.setComboOptions(this.cell._brval,f,this.grid,d,e)}else{this.cell.combo_value=f;var c=null;if((c=this.cell._brval)&&(typeof(this.cell._brval)=="object")){f=(c.getOption(f)||{}).text||f}else{if(c=this.grid._col_combos[this.cell._cellIndex]||((this.grid._fake)&&(c=this.grid._fake._col_combos[this.cell._cellIndex]))){f=(c.getOption(f)||{}).text||f}}if((f||"").toString()._dhx_trim()==""){f=null}if(f!==null){this.setComboCValue(f)}else{this.setComboCValue("&nbsp;","");this.cell._clearCell=true}}};this.detach=function(){this.cell.removeChild(this.combo.DOMParent);var c=this.cell.combo_value;if(!this.combo.getComboText()||this.combo.getComboText().toString()._dhx_trim()==""){this.setComboCValue("&nbsp;");this.cell._clearCell=true}else{this.setComboCValue(this.combo.getComboText().replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.combo.getActualValue());this.cell._clearCell=false}this.combo._confirmSelect();this.cell.combo_value=this.combo.getActualValue();this.combo.closeAll();this.grid._still_active=true;this.grid.setActive(1);return c!=this.cell.combo_value}}eXcell_combo.prototype=new eXcell;eXcell_combo_v=function(a){var c=new eXcell_combo(a);c._combo_pre="<img src='"+(window.dhx_globalImgPath?window.dhx_globalImgPath:this.grid.imgURL)+"combo_select"+(dhtmlx.skin?"_"+dhtmlx.skin:"")+".gif' class='dhxgrid_combo_icon'/>";return c};eXcell_combo.prototype.initCombo=function(c){var a=document.createElement("DIV");var e=this.grid.defVal[arguments.length?c:this.cell._cellIndex];var f=new dhtmlXCombo(a,"combo",0,e);this.grid.defVal[arguments.length?c:this.cell._cellIndex]="";f.DOMelem.className+=" dhxcombo_in_grid";var d=this.grid;f.DOMelem.onselectstart=function(){event.cancelBubble=true;return true};f.attachEvent("onKeyPressed",function(g){if(g==13||g==27){d.editStop();if(d._fake){d._fake.editStop()}}});dhtmlxEvent(f.DOMlist,"click",function(){d.editStop();if(d._fake){d._fake.editStop()}});return f};eXcell_combo.prototype.fillColumnCombos=function(d,a){if(!a){return}d.combo_columns=d.combo_columns||[];columns=d.xmlLoader.doXPath("//column",a);for(var c=0;c<columns.length;c++){if((columns[c].getAttribute("type")||"").indexOf("combo")==0){d.combo_columns[d.combo_columns.length]=c;this.setComboOptions(d._col_combos[c],columns[c],d,c)}}};eXcell_combo.prototype.setComboCValue=function(d,c){if(this._combo_pre!=""){var a=(this.cell.offsetHeight?this.cell.offsetHeight+"px":0);d="<div style='width:100%;position:relative;height:100%;overflow:hidden;'>"+this._combo_pre+"<span>"+d+"</span></div>"}if(arguments.length>1){this.setCValue(d,c)}else{this.setCValue(d)}};eXcell_combo.prototype.setComboOptions=function(g,h,d,m,o){if(window.dhx4.s2b(h.getAttribute("xmlcontent"))){if(!h.getAttribute("source")){options=h.childNodes;var a=[];for(var k=0;k<options.length;k++){if(options[k].tagName=="option"){var e=options[k].firstChild?options[k].firstChild.data:"";a[a.length]=[options[k].getAttribute("value"),e]}}g.addOption(a);if(arguments.length==4){d.forEachRowA(function(r){var q=d.cells(r,m);if(!q.cell._brval&&!q.cell._cellType&&(q.cell._cellIndex==m)){if(q.cell.combo_value==""){q.setComboCValue("&nbsp;","")}else{if(!g.getOption(q.cell.combo_value)){q.setComboCValue(q.cell.combo_value)}else{q.setComboCValue(g.getOption(q.cell.combo_value).text)}}}})}else{var n=(this.cell)?this:d.cells(o,m);if(h.getAttribute("text")){if(h.getAttribute("text")._dhx_trim()==""){n.setComboCValue("&nbsp;","")}else{n.setComboCValue(h.getAttribute("text"))}}else{if((!n.cell.combo_value)||(n.cell.combo_value._dhx_trim()=="")){n.setComboCValue("&nbsp;","")}else{if(!g.getOption(n.cell.combo_value)){n.setComboCValue(n.cell.combo_value)}else{n.setComboCValue(g.getOption(n.cell.combo_value).text)}}}}}}if(h.getAttribute("source")){if(h.getAttribute("auto")&&window.dhx4.s2b(h.getAttribute("auto"))){if(h.getAttribute("xmlcontent")){var n=(this.cell)?this:d.cells(o,m);if(h.getAttribute("text")){n.setComboCValue(h.getAttribute("text"))}}else{d.forEachRowA(function(u){var s=d.cells(u,m);if(!s.cell._brval&&!s.cell._cellType){var r=s.cell.combo_value.toString();if(r.indexOf("^")!=-1){var q=r.split("^");s.cell.combo_value=q[0];s.setComboCValue(q[1])}}})}g.enableFilteringMode(true,h.getAttribute("source"),window.dhx4.s2b(h.getAttribute("cache")||true),window.dhx4.s2b(h.getAttribute("sub")||false))}else{var l=this;var f=arguments.length;g.load(h.getAttribute("source"),function(){if(f==4){d.forEachRow(function(s){var r=d.cells(s,m);if(!r.cell._brval&&!r.cell._cellType){if(g.getOption(r.cell.combo_value)){r.setComboCValue(g.getOption(r.cell.combo_value).text)}else{if((r.cell.combo_value||"").toString()._dhx_trim()==""){r.setComboCValue("&nbsp;","");r.cell._clearCell=true}else{r.setComboCValue(r.cell.combo_value)}}}})}else{var q=d.cells(o,m);if(g.getOption(q.cell.combo_value)){q.setComboCValue(g.getOption(q.cell.combo_value).text)}else{q.setComboCValue(q.cell.combo_value)}}})}}if(!h.getAttribute("auto")||!window.dhx4.s2b(h.getAttribute("auto"))){if(h.getAttribute("editable")&&!window.dhx4.s2b(h.getAttribute("editable"))){g.readonly(true)}if(h.getAttribute("filter")&&window.dhx4.s2b(h.getAttribute("filter"))){g.enableFilteringMode(true)}}};eXcell_combo.prototype.getCellCombo=function(){if(this.cell._brval){return this.cell._brval}this.cell._brval=this.initCombo();return this.cell._brval};eXcell_combo.prototype.refreshCell=function(){this.setValue(this.getValue())};dhtmlXGridObject.prototype.getColumnCombo=function(a){if(this._col_combos&&this._col_combos[a]){return this._col_combos[a]}if(!this._col_combos){this._col_combos=[]}this._col_combos[a]=eXcell_combo.prototype.initCombo.call({grid:this},a);return this._col_combos[a]};dhtmlXGridObject.prototype.refreshComboColumn=function(a){this.forEachRow(function(c){if(this.cells(c,a).refreshCell){this.cells(c,a).refreshCell()}})};function eXcell_clist(a){try{this.cell=a;this.grid=this.cell.parentNode.grid}catch(c){}this.edit=function(){this.val=this.getValue();var e=(this.cell._combo||this.grid.clists[this.cell._cellIndex]);if(!e){return}this.obj=document.createElement("DIV");var d=this.val.split(",");var l="";for(var h=0;h<e.length;h++){var k=false;for(var f=0;f<d.length;f++){if(e[h]==d[f]){k=true}}if(k){l+="<div><input type='checkbox' id='dhx_clist_"+h+"' checked='true' /><label for='dhx_clist_"+h+"'>"+e[h]+"</label></div>"}else{l+="<div><input type='checkbox' id='dhx_clist_"+h+"'/><label for='dhx_clist_"+h+"'>"+e[h]+"</label></div>"}}l+="<div><input type='button' value='"+(this.grid.applyButtonText||"Apply")+"' style='width:100px; font-size:8pt;' onclick='this.parentNode.parentNode.editor.grid.editStop();'/></div>";this.obj.editor=this;this.obj.innerHTML=l;document.body.appendChild(this.obj);this.obj.style.position="absolute";this.obj.className="dhx_clist";this.obj.onclick=function(m){(m||event).cancelBubble=true;return true};var g=this.grid.getPosition(this.cell);this.obj.style.left=g[0]+"px";this.obj.style.top=g[1]+this.cell.offsetHeight+"px";this.obj.getValue=function(){var n="";for(var m=0;m<this.childNodes.length-1;m++){if(this.childNodes[m].childNodes[0].checked){if(n){n+=","}n+=this.childNodes[m].childNodes[1].innerHTML}}return n.replace(/&amp;/g,"&")}};this.getValue=function(){if(this.cell._clearCell){return""}return this.cell.innerHTML.toString()._dhx_trim().replace(/&amp;/g,"&")};this.detach=function(d){if(this.obj){this.setValue(this.obj.getValue());this.obj.editor=null;this.obj.parentNode.removeChild(this.obj);this.obj=null}return this.val!=this.getValue()}}eXcell_clist.prototype=new eXcell;eXcell_clist.prototype.setValue=function(d){if(typeof(d)=="object"){var c=this.grid.xmlLoader.doXPath("./option",d);if(c.length){this.cell._combo=[]}for(var a=0;a<c.length;a++){this.cell._combo.push(c[a].firstChild?c[a].firstChild.data:"")}d=d.firstChild.data}if(d===""||d===this.undefined){this.setCTxtValue(" ",d);this.cell._clearCell=true}else{this.setCTxtValue(d);this.cell._clearCell=false}};dhtmlXGridObject.prototype.registerCList=function(a,c){if(!this.clists){this.clists=new Array()}if(typeof(c)!="object"){c=c.split(",")}this.clists[a]=c};function eXcell_calck(a){try{this.cell=a;this.grid=this.cell.parentNode.grid}catch(c){}this.edit=function(){this.val=this.getValue();var d=this.grid.getPosition(this.cell);this.obj=new calcX(d[0],d[1]+this.cell.offsetHeight,this,this.val)};this.getValue=function(){return this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)};this.detach=function(){if(this.obj){this.setValue(this.obj.inputZone.value);this.obj.removeSelf()}this.obj=null;return this.val!=this.getValue()}}eXcell_calck.prototype=new eXcell;eXcell_calck.prototype.setValue=function(a){if(!a||a.toString()._dhx_trim()==""){a="0"}this.setCValue(this.grid._aplNF(a,this.cell._cellIndex),a)};function calcX(left,top,onReturnSub,val){this.top=top||0;this.left=left||0;this.onReturnSub=onReturnSub||null;this.operandA=0;this.operandB=0;this.operatorA="";this.state=0;this.dotState=0;this.calckGo=function(){return(eval(this.operandA+"*1"+this.operatorA+this.operandB+"*1"))};this.isNumeric=function(str){return((str.search(/[^1234567890]/gi)==-1)?(true):(false))};this.isOperation=function(str){return((str.search(/[^\+\*\-\/]/gi)==-1)?(true):(false))};this.onCalcKey=function(e){that=this.calk;var z=this.innerHTML;var rZone=that.inputZone;if(((that.state==0)||(that.state==2))&&(that.isNumeric(z))){if(rZone.value!="0"){rZone.value+=z}else{rZone.value=z}}if((((that.state==0)||(that.state==2))&&(z=="."))&&(that.dotState==0)){that.dotState=1;rZone.value+=z}if((z=="C")){rZone.value=0;that.dotState=0;that.state=0}if((that.state==0)&&(that.isOperation(z))){that.operatorA=z;that.operandA=rZone.value;that.state=1}if((that.state==2)&&(that.isOperation(z))){that.operandB=rZone.value;rZone.value=that.calckGo();that.operatorA=z;that.operandA=rZone.value;that.state=1}if((that.state==2)&&(z=="=")){that.operandB=rZone.value;rZone.value=that.calckGo();that.operatorA=z;that.operandA=rZone.value;that.state=3}if((that.state==1)&&(that.isNumeric(z))){rZone.value=z;that.state=2;that.dotState=0}if((that.state==3)&&(that.isNumeric(z))){rZone.value=z;that.state=0}if((that.state==3)&&(that.isOperation(z))){that.operatorA=z;that.operandA=rZone.value;that.state=1}if(z=="e"){rZone.value=Math.E;if(that.state==1){that.state=2}that.dotState=0}if(z=="p"){rZone.value=Math.PI;if(that.state==1){that.state=2}that.dotState=0}if(z=="Off"){that.topNod.parentNode.removeChild(that.topNod)}if(e||event){(e||event).cancelBubble=true}};this.sendResult=function(){that=this.calk;if(that.state==2){var rZone=that.inputZone;that.operandB=rZone.value;rZone.value=that.calckGo();that.operatorA=z;that.operandA=rZone.value;that.state=3}var z=that.inputZone.value;that.topNod.parentNode.removeChild(that.topNod);that.onReturnSub.grid.editStop(false)};this.removeSelf=function(){if(this.topNod.parentNode){this.topNod.parentNode.removeChild(this.topNod)}};this.keyDown=function(){this.className="calcPressed"};this.keyUp=function(){this.className="calcButton"};this.init_table=function(){var table=this.topNod.childNodes[0];if((!table)||(table.tagName!="TABLE")){return}for(i=1;i<table.childNodes[0].childNodes.length;i++){for(j=0;j<table.childNodes[0].childNodes[i].childNodes.length;j++){table.childNodes[0].childNodes[i].childNodes[j].onclick=this.onCalcKey;table.childNodes[0].childNodes[i].childNodes[j].onmousedown=this.keyDown;table.childNodes[0].childNodes[i].childNodes[j].onmouseout=this.keyUp;table.childNodes[0].childNodes[i].childNodes[j].onmouseup=this.keyUp;table.childNodes[0].childNodes[i].childNodes[j].calk=this}}this.inputZone=this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0];if(this.onReturnSub){this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[1].onclick=this.sendResult;this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[1].calk=this}else{this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[1].innerHTML=""}};this.drawSelf=function(){var div=document.createElement("div");div.className="calcTable";div.style.position="absolute";div.style.top=this.top+"px";div.style.left=this.left+"px";div.innerHTML="<table cellspacing='0' id='calc_01' class='calcTable'><tr><td colspan='4'><table cellpadding='1' cellspacing='0' width='100%'><tr><td width='100%' style='overflow:hidden;'><input style='width:100%' class='calcInput' value='0' align='right' readonly='true' style='text-align:right'></td><td class='calkSubmit'>=</td></tr></table></td></tr><tr><td class='calcButton' width='25%'>Off</td><td class='calcButton' width='25%'>p</td><td class='calcButton' width='25%'>e</td><td class='calcButton' width='25%'>/</td></tr><tr><td class='calcButton'>7</td><td class='calcButton'>8</td><td class='calcButton'>9</td><td class='calcButton'>*</td></tr><tr><td class='calcButton'>4</td><td class='calcButton'>5</td><td class='calcButton'>6</td><td class='calcButton'>+</td></tr><tr><td class='calcButton'>1</td><td class='calcButton'>2</td><td class='calcButton'>3</td><td class='calcButton'>-</td></tr><tr><td class='calcButton'>0</td><td class='calcButton'>.</td><td class='calcButton'>C</td><td class='calcButton'>=</td></tr></table>";div.onclick=function(e){(e||event).cancelBubble=true};document.body.appendChild(div);this.topNod=div};this.drawSelf();this.init_table();if(val){var rZone=this.inputZone;rZone.value=val*1;this.operandA=val*1;this.state=3}return this}if(!window.dhtmlx){window.dhtmlx={}}(function(){var m=null;function o(v,s){var u=v.callback;n(false);v.box.parentNode.removeChild(v.box);m=v.box=null;if(u){u(s)}}function a(u){if(m){u=u||event;var s=u.which||event.keyCode;if(dhtmlx.message.keyboard){if(s==13||s==32){o(m,true)}if(s==27){o(m,false)}}if(u.preventDefault){u.preventDefault()}return !(u.cancelBubble=true)}}if(document.attachEvent){document.attachEvent("onkeydown",a)}else{document.addEventListener("keydown",a,true)}function n(u){if(!n.cover){n.cover=document.createElement("DIV");n.cover.onkeydown=a;n.cover.className="dhx_modal_cover";document.body.appendChild(n.cover)}var s=document.body.scrollHeight;n.cover.style.display=u?"inline-block":"none"}function g(u,s){return"<div class='dhtmlx_popup_button' result='"+s+"' ><div>"+u+"</div></div>"}function d(u){if(!q.area){q.area=document.createElement("DIV");q.area.className="dhtmlx_message_area";q.area.style[q.position]="5px";document.body.appendChild(q.area)}q.hide(u.id);var s=document.createElement("DIV");s.innerHTML="<div>"+u.text+"</div>";s.className="dhtmlx-info dhtmlx-"+u.type;s.onclick=function(){q.hide(u.id);u=null};if(q.position=="bottom"&&q.area.firstChild){q.area.insertBefore(s,q.area.firstChild)}else{q.area.appendChild(s)}if(u.expire>0){q.timers[u.id]=window.setTimeout(function(){q.hide(u.id)},u.expire)}q.pull[u.id]=s;s=null;return u.id}function h(u,w,A){var y=document.createElement("DIV");y.className=" dhtmlx_modal_box dhtmlx-"+u.type;y.setAttribute("dhxbox",1);var s="";if(u.width){y.style.width=u.width}if(u.height){y.style.height=u.height}if(u.title){s+='<div class="dhtmlx_popup_title">'+u.title+"</div>"}s+='<div class="dhtmlx_popup_text"><span>'+(u.content?"":u.text)+'</span></div><div  class="dhtmlx_popup_controls">';if(w){s+=g(u.ok||"OK",true)}if(A){s+=g(u.cancel||"Cancel",false)}if(u.buttons){for(var v=0;v<u.buttons.length;v++){s+=g(u.buttons[v],v)}}s+="</div>";y.innerHTML=s;if(u.content){var x=u.content;if(typeof x=="string"){x=document.getElementById(x)}if(x.style.display=="none"){x.style.display=""}y.childNodes[u.title?1:0].appendChild(x)}y.onclick=function(E){E=E||event;var D=E.target||E.srcElement;if(!D.className){D=D.parentNode}if(D.className=="dhtmlx_popup_button"){var C=D.getAttribute("result");C=(C=="true")||(C=="false"?false:C);o(u,C)}};u.box=y;if(w||A){m=u}return y}function r(u,v,A){var w=u.tagName?u:h(u,v,A);if(!u.hidden){n(true)}document.body.appendChild(w);var s=u.left||Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-w.offsetWidth)/2));var C=u.top||Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-w.offsetHeight)/2));if(u.position=="top"){w.style.top="-3px"}else{w.style.top=C+"px"}w.style.left=s+"px";w.onkeydown=a;w.focus();if(u.hidden){dhtmlx.modalbox.hide(w)}return w}function l(s){return r(s,true,false)}function c(s){return r(s,true,true)}function f(s){return r(s)}function k(u,s,v){if(typeof u!="object"){if(typeof s=="function"){v=s;s=""}u={text:u,type:s,callback:v}}return u}function e(v,u,s,w){if(typeof v!="object"){v={text:v,type:u,expire:s,id:w}}v.id=v.id||q.uid();v.expire=v.expire||q.expire;return v}dhtmlx.alert=function(){var s=k.apply(this,arguments);s.type=s.type||"confirm";return l(s)};dhtmlx.confirm=function(){var s=k.apply(this,arguments);s.type=s.type||"alert";return c(s)};dhtmlx.modalbox=function(){var s=k.apply(this,arguments);s.type=s.type||"alert";return f(s)};dhtmlx.modalbox.hide=function(s){while(s&&s.getAttribute&&!s.getAttribute("dhxbox")){s=s.parentNode}if(s){s.parentNode.removeChild(s);n(false)}};var q=dhtmlx.message=function(w,v,u,x){w=e.apply(this,arguments);w.type=w.type||"info";var s=w.type.split("-")[0];switch(s){case"alert":return l(w);case"confirm":return c(w);case"modalbox":return f(w);default:return d(w);break}};q.seed=(new Date()).valueOf();q.uid=function(){return q.seed++};q.expire=4000;q.keyboard=true;q.position="top";q.pull={};q.timers={};q.hideAll=function(){for(var s in q.pull){q.hide(s)}};q.hide=function(u){var s=q.pull[u];if(s&&s.parentNode){window.setTimeout(function(){s.parentNode.removeChild(s);s=null},2000);s.className+=" hidden";if(q.timers[u]){window.clearTimeout(q.timers[u])}delete q.pull[u]}}})();
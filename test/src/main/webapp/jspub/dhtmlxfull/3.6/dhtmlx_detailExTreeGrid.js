/*
Copyright DHTMLX LTD. http://www.dhtmlx.com
To use this library please contact sales@dhtmlx.com to obtain license
*/
dhtmlx=function(a){for(var c in a)dhtmlx[c]=a[c];return dhtmlx};dhtmlx.extend_api=function(a,c,b){var d=window[a];if(d)window[a]=function(a){if(a&&typeof a=="object"&&!a.tagName){var b=d.apply(this,c._init?c._init(a):arguments),g;for(g in dhtmlx)if(c[g])this[c[g]](dhtmlx[g]);for(g in a)if(c[g])this[c[g]](a[g]);else g.indexOf("on")==0&&this.attachEvent(g,a[g])}else b=d.apply(this,arguments);c._patch&&c._patch(this);return b||this},window[a].prototype=d.prototype,b&&dhtmlXHeir(window[a].prototype,b)};
dhtmlxAjax={get:function(a,c){var b=new dtmlXMLLoaderObject(!0);b.async=arguments.length<3;b.waitCall=c;b.loadXML(a);return b},post:function(a,c,b){var d=new dtmlXMLLoaderObject(!0);d.async=arguments.length<4;d.waitCall=b;d.loadXML(a,!0,c);return d},getSync:function(a){return this.get(a,null,!0)},postSync:function(a,c){return this.post(a,c,null,!0)}};
function dtmlXMLLoaderObject(a,c,b,d){this.xmlDoc="";this.async=typeof b!="undefined"?b:!0;this.onloadAction=a||null;this.mainObject=c||null;this.waitCall=null;this.rSeed=d||!1;return this}dtmlXMLLoaderObject.count=0;
dtmlXMLLoaderObject.prototype.waitLoadFunction=function(a){var c=!0;return this.check=function(){if(a&&a.onloadAction!=null&&(!a.xmlDoc.readyState||a.xmlDoc.readyState==4)&&c){c=!1;dtmlXMLLoaderObject.count++;if(typeof a.onloadAction=="function")a.onloadAction(a.mainObject,null,null,null,a);if(a.waitCall)a.waitCall.call(this,a),a.waitCall=null}}};
dtmlXMLLoaderObject.prototype.getXMLTopNode=function(a,c){if(this.xmlDoc.responseXML){var b=this.xmlDoc.responseXML.getElementsByTagName(a);b.length==0&&a.indexOf(":")!=-1&&(b=this.xmlDoc.responseXML.getElementsByTagName(a.split(":")[1]));var d=b[0]}else d=this.xmlDoc.documentElement;if(d)return this._retry=!1,d;if(!this._retry&&_isIE)return this._retry=!0,c=this.xmlDoc,this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),!0),this.getXMLTopNode(a,c);dhtmlxError.throwError("LoadXML","Incorrect XML",
[c||this.xmlDoc,this.mainObject]);return document.createElement("DIV")};dtmlXMLLoaderObject.prototype.loadXMLString=function(a,c){if(_isIE)this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async=this.async,this.xmlDoc.onreadystatechange=function(){},this.xmlDoc.loadXML(a);else{var b=new DOMParser;this.xmlDoc=b.parseFromString(a,"text/xml")}if(!c){if(this.onloadAction)this.onloadAction(this.mainObject,null,null,null,this);if(this.waitCall)this.waitCall(),this.waitCall=null}};
dtmlXMLLoaderObject.prototype.loadXML=function(a,c,b,d){this.rSeed&&(a+=(a.indexOf("?")!=-1?"&":"?")+"a_dhx_rSeed="+(new Date).valueOf());this.filePath=a;this.xmlDoc=!_isIE&&window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");if(this.async)this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this);this.xmlDoc.open(c?"POST":"GET",a,this.async);d?(this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")"),this.xmlDoc.setRequestHeader("Content-type",
"text/xml")):c&&this.xmlDoc.setRequestHeader("Content-type",this.contenttype||"application/x-www-form-urlencoded");this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest");this.xmlDoc.send(b);this.async||(new this.waitLoadFunction(this))()};
dtmlXMLLoaderObject.prototype.destructor=function(){return this.setXSLParamValue=this.getXMLTopNode=this.xmlNodeToJSON=this.doSerialization=this.loadXMLString=this.loadXML=this.doXSLTransToString=this.doXSLTransToObject=this.doXPathOpera=this.doXPath=this.xmlDoc=this.mainObject=this.onloadAction=this.filePath=this.rSeed=this.async=this._retry=this._getAllNamedChilds=this._filterXPath=null};
dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(a){for(var c={},b=0;b<a.attributes.length;b++)c[a.attributes[b].name]=a.attributes[b].value;c._tagvalue=a.firstChild?a.firstChild.nodeValue:"";for(b=0;b<a.childNodes.length;b++){var d=a.childNodes[b].tagName;d&&(c[d]||(c[d]=[]),c[d].push(this.xmlNodeToJSON(a.childNodes[b])))}return c};function callerFunction(a,c){return this.handler=function(b){if(!b)b=window.event;a(b,c);return!0}}function getAbsoluteLeft(a){return getOffset(a).left}
function getAbsoluteTop(a){return getOffset(a).top}function getOffsetSum(a){for(var c=0,b=0;a;)c+=parseInt(a.offsetTop),b+=parseInt(a.offsetLeft),a=a.offsetParent;return{top:c,left:b}}
function getOffsetRect(a){var c=a.getBoundingClientRect(),b=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||b.scrollTop,f=window.pageXOffset||d.scrollLeft||b.scrollLeft,g=d.clientTop||b.clientTop||0,i=d.clientLeft||b.clientLeft||0,h=c.top+e-g,j=c.left+f-i;return{top:Math.round(h),left:Math.round(j)}}function getOffset(a){return a.getBoundingClientRect?getOffsetRect(a):getOffsetSum(a)}
function convertStringToBoolean(a){typeof a=="string"&&(a=a.toLowerCase());switch(a){case "1":case "true":case "yes":case "y":case 1:case !0:return!0;default:return!1}}function getUrlSymbol(a){return a.indexOf("?")!=-1?"&":"?"}function dhtmlDragAndDropObject(){if(window.dhtmlDragAndDrop)return window.dhtmlDragAndDrop;this.dragStartObject=this.dragStartNode=this.dragNode=this.lastLanding=0;this.tempDOMM=this.tempDOMU=null;this.waitDrag=0;window.dhtmlDragAndDrop=this;return this}
dhtmlDragAndDropObject.prototype.removeDraggableItem=function(a){a.onmousedown=null;a.dragStarter=null;a.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(a,c){a.onmousedown=this.preCreateDragCopy;a.dragStarter=c;this.addDragLanding(a,c)};dhtmlDragAndDropObject.prototype.addDragLanding=function(a,c){a.dragLanding=c};
dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(a){if(!((a||window.event)&&(a||event).button==2)){if(window.dhtmlDragAndDrop.waitDrag)return window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1;window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(a);window.dhtmlDragAndDrop.waitDrag=1;window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup;window.dhtmlDragAndDrop.tempDOMM=
document.body.onmousemove;window.dhtmlDragAndDrop.dragStartNode=this;window.dhtmlDragAndDrop.dragStartObject=this.dragStarter;document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy;document.body.onmousemove=window.dhtmlDragAndDrop.callDrag;window.dhtmlDragAndDrop.downtime=(new Date).valueOf();a&&a.preventDefault&&a.preventDefault();return!1}};
dhtmlDragAndDropObject.prototype.callDrag=function(a){if(!a)a=window.event;dragger=window.dhtmlDragAndDrop;if(!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode)if(dragger.waitDrag){dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,a);if(!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1};dragger.gldragNode=dragger.dragNode;document.body.appendChild(dragger.dragNode);document.body.onmouseup=dragger.stopDrag;dragger.waitDrag=
0;dragger.dragNode.pWindow=window;dragger.initFrameRoute()}else return dragger.stopDrag(a,!0);if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var c=dragger.gldragNode;if(dragger.gldragNode.old)c=dragger.gldragNode.old;c.parentNode.removeChild(c);var b=dragger.dragNode.pWindow;c.pWindow&&c.pWindow.dhtmlDragAndDrop.lastLanding&&c.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(c.pWindow.dhtmlDragAndDrop.lastLanding);if(_isIE){var d=document.createElement("Div");d.innerHTML=
dragger.dragNode.outerHTML;dragger.dragNode=d.childNodes[0]}else dragger.dragNode=dragger.dragNode.cloneNode(!0);dragger.dragNode.pWindow=window;dragger.gldragNode.old=dragger.dragNode;document.body.appendChild(dragger.dragNode);b.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=a.clientX+15+(dragger.fx?dragger.fx*-1:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";dragger.dragNode.style.top=a.clientY+3+(dragger.fy?dragger.fy*-1:0)+(document.body.scrollTop||
document.documentElement.scrollTop)+"px";var e=a.srcElement?a.srcElement:a.target;dragger.checkLanding(e,a)}};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(a){if(window.name){for(var c=parent.frames[window.name].frameElement.offsetParent,b=0,d=0;c;)b+=c.offsetLeft,d+=c.offsetTop,c=c.offsetParent;if(parent.dhtmlDragAndDrop){var e=parent.dhtmlDragAndDrop.calculateFramePosition(1);b+=e.split("_")[0]*1;d+=e.split("_")[1]*1}if(a)return b+"_"+d;else this.fx=b;this.fy=d}return"0_0"};
dhtmlDragAndDropObject.prototype.checkLanding=function(a,c){a&&a.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=a,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,c.clientX,c.clientY,c),this.lastLanding_scr=_isIE?c.srcElement:c.target):a&&a.tagName!="BODY"?this.checkLanding(a.parentNode,c):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,c.clientX,c.clientY,c),this.lastLanding=
0,this._onNotFound&&this._onNotFound())};
dhtmlDragAndDropObject.prototype.stopDrag=function(a,c){dragger=window.dhtmlDragAndDrop;if(!c){dragger.stopFrameRoute();var b=dragger.lastLanding;dragger.lastLanding=null;b&&b.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,b,_isIE?event.srcElement:a.target)}dragger.lastLanding=null;dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode);dragger.dragNode=0;dragger.gldragNode=0;dragger.fx=0;dragger.fy=0;dragger.dragStartNode=
0;dragger.dragStartObject=0;document.body.onmouseup=dragger.tempDOMU;document.body.onmousemove=dragger.tempDOMM;dragger.tempDOMU=null;dragger.tempDOMM=null;dragger.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(a){a&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var c=0;c<window.frames.length;c++)try{window.frames[c]!=a&&window.frames[c].dhtmlDragAndDrop&&window.frames[c].dhtmlDragAndDrop.stopFrameRoute(window)}catch(b){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=a&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(d){}};
dhtmlDragAndDropObject.prototype.initFrameRoute=function(a,c){if(a)window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=a.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=a.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=a.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=a.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&c&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition();
try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=a&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(b){}for(var d=0;d<window.frames.length;d++)try{window.frames[d]!=a&&window.frames[d].dhtmlDragAndDrop&&window.frames[d].dhtmlDragAndDrop.initFrameRoute(window,!a||c?1:0)}catch(e){}};_OperaRv=_KHTMLrv=_FFrv=_isChrome=_isMacOS=_isKHTML=_isOpera=_isIE=_isFF=!1;navigator.userAgent.indexOf("Macintosh")!=-1&&(_isMacOS=!0);navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0);
if(navigator.userAgent.indexOf("Safari")!=-1||navigator.userAgent.indexOf("Konqueror")!=-1)_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0;else if(navigator.userAgent.indexOf("Opera")!=-1)_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3));else if(navigator.appName.indexOf("Microsoft")!=-1){if(_isIE=!0,(navigator.appVersion.indexOf("MSIE 8.0")!=-1||navigator.appVersion.indexOf("MSIE 9.0")!=
-1||navigator.appVersion.indexOf("MSIE 10.0")!=-1)&&document.compatMode!="BackCompat")_isIE=8}else _isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1]);
dtmlXMLLoaderObject.prototype.doXPath=function(a,c,b,d){if(_isKHTML||!_isIE&&!window.XPathResult)return this.doXPathOpera(a,c);if(_isIE)return c||(c=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),c||dhtmlxError.throwError("LoadXML","Incorrect XML",[c||this.xmlDoc,this.mainObject]),b!=null&&c.setProperty("SelectionNamespaces","xmlns:xsl='"+b+"'"),d=="single"?c.selectSingleNode(a):c.selectNodes(a)||[];else{var e=c;c||(c=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML);c||dhtmlxError.throwError("LoadXML",
"Incorrect XML",[c||this.xmlDoc,this.mainObject]);c.nodeName.indexOf("document")!=-1?e=c:(e=c,c=c.ownerDocument);var f=XPathResult.ANY_TYPE;if(d=="single")f=XPathResult.FIRST_ORDERED_NODE_TYPE;var g=[],i=c.evaluate(a,e,function(){return b},f,null);if(f==XPathResult.FIRST_ORDERED_NODE_TYPE)return i.singleNodeValue;for(var h=i.iterateNext();h;)g[g.length]=h,h=i.iterateNext();return g}};function w(){if(!this.catches)this.catches=[];return this}w.prototype.catchError=function(a,c){this.catches[a]=c};
w.prototype.throwError=function(a,c,b){if(this.catches[a])return this.catches[a](a,c,b);if(this.catches.ALL)return this.catches.ALL(a,c,b);alert("Error type: "+a+"\nDescription: "+c);return null};window.dhtmlxError=new w;
dtmlXMLLoaderObject.prototype.doXPathOpera=function(a,c){var b=a.replace(/[\/]+/gi,"/").split("/"),d=null,e=1;if(!b.length)return[];if(b[0]==".")d=[c];else if(b[0]=="")d=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(b[e].replace(/\[[^\]]*\]/g,"")),e++;else return[];for(;e<b.length;e++)d=this._getAllNamedChilds(d,b[e]);b[e-1].indexOf("[")!=-1&&(d=this._filterXPath(d,b[e-1]));return d};
dtmlXMLLoaderObject.prototype._filterXPath=function(a,c){for(var b=[],c=c.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,""),d=0;d<a.length;d++)a[d].getAttribute(c)&&(b[b.length]=a[d]);return b};
dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(a,c){var b=[];_isKHTML&&(c=c.toUpperCase());for(var d=0;d<a.length;d++)for(var e=0;e<a[d].childNodes.length;e++)_isKHTML?a[d].childNodes[e].tagName&&a[d].childNodes[e].tagName.toUpperCase()==c&&(b[b.length]=a[d].childNodes[e]):a[d].childNodes[e].tagName==c&&(b[b.length]=a[d].childNodes[e]);return b};function dhtmlXHeir(a,c){for(var b in c)typeof c[b]=="function"&&(a[b]=c[b]);return a}
function dhtmlxEvent(a,c,b){a.addEventListener?a.addEventListener(c,b,!1):a.attachEvent&&a.attachEvent("on"+c,b)}dtmlXMLLoaderObject.prototype.xslDoc=null;dtmlXMLLoaderObject.prototype.setXSLParamValue=function(a,c,b){if(!b)b=this.xslDoc;if(b.responseXML)b=b.responseXML;var d=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+a+"']",b,"http://www.w3.org/1999/XSL/Transform","single");if(d!=null)d.firstChild.nodeValue=c};
dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(a,c){if(!a)a=this.xslDoc;if(a.responseXML)a=a.responseXML;if(!c)c=this.xmlDoc;if(c.responseXML)c=c.responseXML;if(_isIE){d=new ActiveXObject("Msxml2.DOMDocument.3.0");try{c.transformNodeToObject(a,d)}catch(b){d=c.transformNode(a)}}else{if(!this.XSLProcessor)this.XSLProcessor=new XSLTProcessor,this.XSLProcessor.importStylesheet(a);var d=this.XSLProcessor.transformToDocument(c)}return d};
dtmlXMLLoaderObject.prototype.doXSLTransToString=function(a,c){var b=this.doXSLTransToObject(a,c);return typeof b=="string"?b:this.doSerialization(b)};dtmlXMLLoaderObject.prototype.doSerialization=function(a){if(!a)a=this.xmlDoc;if(a.responseXML)a=a.responseXML;if(_isIE)return a.xml;else{var c=new XMLSerializer;return c.serializeToString(a)}};
dhtmlxEventable=function(a){a.attachEvent=function(a,b,d){a="ev_"+a.toLowerCase();this[a]||(this[a]=new this.eventCatcher(d||this));return a+":"+this[a].addEvent(b)};a.callEvent=function(a,b){a="ev_"+a.toLowerCase();return this[a]?this[a].apply(this,b):!0};a.checkEvent=function(a){return!!this["ev_"+a.toLowerCase()]};a.eventCatcher=function(a){var b=[],d=function(){for(var e=!0,d=0;d<b.length;d++)if(b[d]!=null)var g=b[d].apply(a,arguments),e=e&&g;return e};d.addEvent=function(a){typeof a!="function"&&
(a=eval(a));return a?b.push(a)-1:!1};d.removeEvent=function(a){b[a]=null};return d};a.detachEvent=function(a){if(a!=!1){var b=a.split(":");this[b[0]].removeEvent(b[1])}};a.detachAllEvents=function(){for(var a in this)a.indexOf("ev_")==0&&(this[a]=null)};a=null};if(!window.dhtmlx)window.dhtmlx={};
(function(){function a(a,c){var e=a.callback;b(!1);a.box.parentNode.removeChild(a.box);k=a.box=null;e&&e(c)}function c(b){if(k){var b=b||event,c=b.which||event.keyCode;dhtmlx.message.keyboard&&((c==13||c==32)&&a(k,!0),c==27&&a(k,!1));b.preventDefault&&b.preventDefault();return!(b.cancelBubble=!0)}}function b(a){if(!b.cover)b.cover=document.createElement("DIV"),b.cover.onkeydown=c,b.cover.className="dhx_modal_cover",document.body.appendChild(b.cover);var e=document.body.scrollHeight;b.cover.style.display=
a?"inline-block":"none"}function d(a,b){return"<div class='dhtmlx_popup_button' result='"+b+"' ><div>"+a+"</div></div>"}function e(a){if(!n.area)n.area=document.createElement("DIV"),n.area.className="dhtmlx_message_area",n.area.style[n.position]="5px",document.body.appendChild(n.area);n.hide(a.id);var b=document.createElement("DIV");b.innerHTML="<div>"+a.text+"</div>";b.className="dhtmlx-info dhtmlx-"+a.type;b.onclick=function(){n.hide(a.id);a=null};n.position=="bottom"&&n.area.firstChild?n.area.insertBefore(b,
n.area.firstChild):n.area.appendChild(b);a.expire>0&&(n.timers[a.id]=window.setTimeout(function(){n.hide(a.id)},a.expire));n.pull[a.id]=b;b=null;return a.id}function f(b,c,e){var g=document.createElement("DIV");g.className=" dhtmlx_modal_box dhtmlx-"+b.type;g.setAttribute("dhxbox",1);var f="";if(b.width)g.style.width=b.width;if(b.height)g.style.height=b.height;b.title&&(f+='<div class="dhtmlx_popup_title">'+b.title+"</div>");f+='<div class="dhtmlx_popup_text"><span>'+(b.content?"":b.text)+'</span></div><div  class="dhtmlx_popup_controls">';
c&&(f+=d(b.ok||"OK",!0));e&&(f+=d(b.cancel||"Cancel",!1));if(b.buttons)for(var i=0;i<b.buttons.length;i++)f+=d(b.buttons[i],i);f+="</div>";g.innerHTML=f;if(b.content){var h=b.content;typeof h=="string"&&(h=document.getElementById(h));if(h.style.display=="none")h.style.display="";g.childNodes[b.title?1:0].appendChild(h)}g.onclick=function(c){var c=c||event,e=c.target||c.srcElement;if(!e.className)e=e.parentNode;if(e.className=="dhtmlx_popup_button"){var d=e.getAttribute("result"),d=d=="true"||(d==
"false"?!1:d);a(b,d)}};b.box=g;if(c||e)k=b;return g}function g(a,e,d){var g=a.tagName?a:f(a,e,d);a.hidden||b(!0);document.body.appendChild(g);var i=a.left||Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-g.offsetWidth)/2)),h=a.top||Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-g.offsetHeight)/2));g.style.top=a.position=="top"?"-3px":h+"px";g.style.left=i+"px";g.onkeydown=c;g.focus();a.hidden&&dhtmlx.modalbox.hide(g);return g}function i(a){return g(a,
!0,!1)}function h(a){return g(a,!0,!0)}function j(a){return g(a)}function l(a,b,c){typeof a!="object"&&(typeof b=="function"&&(c=b,b=""),a={text:a,type:b,callback:c});return a}function m(a,b,c,e){typeof a!="object"&&(a={text:a,type:b,expire:c,id:e});a.id=a.id||n.uid();a.expire=a.expire||n.expire;return a}var k=null;document.attachEvent?document.attachEvent("onkeydown",c):document.addEventListener("keydown",c,!0);dhtmlx.alert=function(){var a=l.apply(this,arguments);a.type=a.type||"confirm";return i(a)};
dhtmlx.confirm=function(){var a=l.apply(this,arguments);a.type=a.type||"alert";return h(a)};dhtmlx.modalbox=function(){var a=l.apply(this,arguments);a.type=a.type||"alert";return j(a)};dhtmlx.modalbox.hide=function(a){for(;a&&a.getAttribute&&!a.getAttribute("dhxbox");)a=a.parentNode;a&&(a.parentNode.removeChild(a),b(!1))};var n=dhtmlx.message=function(a,b,c,d){a=m.apply(this,arguments);a.type=a.type||"info";var g=a.type.split("-")[0];switch(g){case "alert":return i(a);case "confirm":return h(a);case "modalbox":return j(a);
default:return e(a)}};n.seed=(new Date).valueOf();n.uid=function(){return n.seed++};n.expire=4E3;n.keyboard=!0;n.position="top";n.pull={};n.timers={};n.hideAll=function(){for(var a in n.pull)n.hide(a)};n.hide=function(a){var b=n.pull[a];b&&b.parentNode&&(window.setTimeout(function(){b.parentNode.removeChild(b);b=null},2E3),b.className+=" hidden",n.timers[a]&&window.clearTimeout(n.timers[a]),delete n.pull[a])}})();var globalActiveDHTMLGridObject;
String.prototype._dhx_trim=function(){return this.replace(/&nbsp;/g," ").replace(/(^[ \t]*)|([ \t]*$)/g,"")};function dhtmlxArray(a){return dhtmlXHeir(a||[],dhtmlxArray._master)}
dhtmlxArray._master={_dhx_find:function(a){for(var c=0;c<this.length;c++)if(a==this[c])return c;return-1},_dhx_insertAt:function(a,c){this[this.length]=null;for(var b=this.length-1;b>=a;b--)this[b]=this[b-1];this[a]=c},_dhx_removeAt:function(a){this.splice(a,1)},_dhx_swapItems:function(a,c){var b=this[a];this[a]=this[c];this[c]=b}};
function dhtmlXGridObject(a){if(_isIE)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(c){}if(a)if(typeof a=="object"){if(this.entBox=a,!this.entBox.id)this.entBox.id="cgrid2_"+this.uid()}else this.entBox=document.getElementById(a);else this.entBox=document.createElement("DIV"),this.entBox.id="cgrid2_"+this.uid();this.entBox.innerHTML="";dhtmlxEventable(this);var b=this;this._wcorr=0;this.fontWidth=7;this.row=this.cell=null;this.iconURL="";this.editor=null;this._dclE=this._f2kE=!0;this.combos=
[];this.defVal=[];this.rowsAr={};this.rowsBuffer=dhtmlxArray();this.rowsCol=dhtmlxArray();this._data_cache={};this._ecache={};this._ud_enabled=!0;this.xmlLoader=new dtmlXMLLoaderObject(this.doLoadDetails,this,!0,this.no_cashe);this._maskArr=[];this.selectedRows=dhtmlxArray();this.UserData={};this._sizeFix=this._borderFix=0;this.entBox.className+=" gridbox";this.entBox.style.width=this.entBox.getAttribute("width")||(window.getComputedStyle?this.entBox.style.width||window.getComputedStyle(this.entBox,
null).width:this.entBox.currentStyle?this.entBox.currentStyle.width:this.entBox.style.width||0)||"100%";this.entBox.style.height=this.entBox.getAttribute("height")||(window.getComputedStyle?this.entBox.style.height||window.getComputedStyle(this.entBox,null).height:this.entBox.currentStyle?this.entBox.currentStyle.height:this.entBox.style.height||0)||"100%";this.entBox.style.cursor="default";this.entBox.onselectstart=function(){return!1};var d=function(a){var b=document.createElement("TABLE");b.cellSpacing=
b.cellPadding=0;b.style.cssText="width:100%;table-layout:fixed;";b.className=a.substr(2);return b};this.obj=d("c_obj");this.hdr=d("c_hdr");this.hdr.style.marginRight="20px";this.hdr.style.paddingRight="20px";this.objBox=document.createElement("DIV");this.objBox.style.width="100%";this.objBox.style.overflow="auto";this.objBox.appendChild(this.obj);this.objBox.className="objbox";dhtmlx.$customScroll&&dhtmlx.CustomScroll.enable(this);this.hdrBox=document.createElement("DIV");this.hdrBox.style.width=
"100%";this.hdrBox.style.height="25px";this.hdrBox.style.overflow="hidden";this.hdrBox.className="xhdr";this.preloadImagesAr=[];this.sortImg=document.createElement("IMG");this.sortImg.style.display="none";this.hdrBox.appendChild(this.sortImg);this.hdrBox.appendChild(this.hdr);this.hdrBox.style.position="relative";this.entBox.appendChild(this.hdrBox);this.entBox.appendChild(this.objBox);this.entBox.grid=this;this.objBox.grid=this;this.hdrBox.grid=this;this.obj.grid=this;this.hdr.grid=this;this.cellWidthPX=
[];this.cellWidthPC=[];this.cellWidthType=this.entBox.cellwidthtype||"px";this.delim=this.entBox.delimiter||",";this._csvDelim=",";this.hdrLabels=[];this.columnIds=[];this.columnColor=[];this._hrrar=[];this.cellType=dhtmlxArray();this.cellAlign=[];this.initCellWidth=[];this.fldSort=[];this._srdh=_isIE&&document.compatMode!="BackCompat"?22:20;this.imgURL=window.dhx_globalImgPath||"";this.isActive=!1;this.isEditable=!0;this.pagingOn=this.useImagesInHeader=!1;this.rowsBufferOutSize=0;dhtmlxEvent(window,
"unload",function(){try{b.destructor&&b.destructor()}catch(a){}});this.setSkin=function(a){this.skin_name=a;var b=this.entBox.className.split(" gridbox")[0];this.entBox.className=b+" gridbox gridbox_"+a;this.skin_h_correction=0;this.enableAlterCss("ev_"+a,"odd_"+a,this.isTreeGrid());this._fixAlterCss();switch(a){case "clear":this._topMb=document.createElement("DIV");this._topMb.className="topMumba";this._topMb.innerHTML="<img style='left:0px'   src='"+this.imgURL+"skinC_top_left.gif'><img style='right:20px' src='"+
this.imgURL+"skinC_top_right.gif'>";this.entBox.appendChild(this._topMb);this._botMb=document.createElement("DIV");this._botMb.className="bottomMumba";this._botMb.innerHTML="<img style='left:0px'   src='"+this.imgURL+"skinD_bottom_left.gif'><img style='right:20px' src='"+this.imgURL+"skinD_bottom_right.gif'>";this.entBox.appendChild(this._botMb);if(this.entBox.style.position!="absolute")this.entBox.style.position="relative";this.skin_h_correction=20;break;case "dhx_terrace":this._srdh=40;this.forceDivInHeader=
!0;break;case "dhx_skyblue":case "dhx_web":case "glassy_blue":case "dhx_black":case "dhx_blue":case "modern":case "light":this._srdh=20;this.forceDivInHeader=!0;break;case "xp":this.forceDivInHeader=!0;this._srdh=_isIE&&document.compatMode!="BackCompat"?26:22;break;case "mt":this._srdh=_isIE&&document.compatMode!="BackCompat"?26:22;break;case "gray":if(_isIE&&document.compatMode!="BackCompat")this._srdh=22}if(_isIE&&this.hdr){var c=this.hdr.parentNode;c.removeChild(this.hdr);c.appendChild(this.hdr)}this.setSizes()};
_isIE&&this.preventIECaching(!0);if(window.dhtmlDragAndDropObject)this.dragger=new dhtmlDragAndDropObject;this._doOnScroll=function(a,b){this.callEvent("onScroll",[this.objBox.scrollLeft,this.objBox.scrollTop]);this.doOnScroll(a,b)};this.doOnScroll=function(a,c){this.hdrBox.scrollLeft=this.objBox.scrollLeft;if(this.ftr)this.ftr.parentNode.scrollLeft=this.objBox.scrollLeft;if(!c&&this._srnd)this._dLoadTimer&&window.clearTimeout(this._dLoadTimer),this._dLoadTimer=window.setTimeout(function(){b._update_srnd_view&&
b._update_srnd_view()},100)};this.attachToObject=function(a){a.appendChild(this.globalBox?this.globalBox:this.entBox);this.setSizes()};this.init=function(a){if(this.isTreeGrid()&&!this._h2){this._h2=new dhtmlxHierarchy;if(this._fake&&!this._realfake)this._fake._h2=this._h2;this._tgc={imgURL:null}}if(this._hstyles){this.editStop();this.fldSorted=this.r_fldSorted=this.resized=this.lastClicked=null;this.cellWidthPX=[];this.cellWidthPC=[];if(this.hdr.rows.length>0){var c=this.xmlFileUrl;this.clearAll(!0);
this.xmlFileUrl=c}for(var d=this.hdr.insertRow(0),i=0;i<this.hdrLabels.length;i++)d.appendChild(document.createElement("TH")),d.childNodes[i]._cellIndex=i,d.childNodes[i].style.height="0px";_isIE&&_isIE<8&&document.body.style.msTouchAction==this.undefined?d.style.position="absolute":d.style.height="auto";d=this.hdr.insertRow(_isKHTML?2:1);d._childIndexes=[];for(var h=0,i=0;i<this.hdrLabels.length;i++)d._childIndexes[i]=i-h,this.hdrLabels[i]==this.splitSign&&i!=0?(_isKHTML&&d.insertCell(i-h),d.cells[i-
h-1].colSpan=(d.cells[i-h-1].colSpan||1)+1,d.childNodes[i-h-1]._cellIndex++,h++,d._childIndexes[i]=i-h):(d.insertCell(i-h),d.childNodes[i-h]._cellIndex=i,d.childNodes[i-h]._cellIndexS=i,this.setColumnLabel(i,this.hdrLabels[i]));if(h==0)d._childIndexes=null;this._cCount=this.hdrLabels.length;_isIE&&window.setTimeout(function(){b.setSizes&&b.setSizes()},1);this.obj.firstChild||this.obj.appendChild(document.createElement("TBODY"));var j=this.obj.firstChild;if(!j.firstChild){j.appendChild(document.createElement("TR"));
j=j.firstChild;_isIE&&_isIE<8&&document.body.style.msTouchAction==this.undefined?j.style.position="absolute":j.style.height="auto";for(i=0;i<this.hdrLabels.length;i++)j.appendChild(document.createElement("TH")),j.childNodes[i].style.height="0px"}this._c_order=null;this.multiLine!=!0&&(this.obj.className+=" row20px");this.sortImg.style.position="absolute";this.sortImg.style.display="none";this.sortImg.src=this.imgURL+"sort_desc.gif";this.sortImg.defLeft=0;this.noHeader?this.hdrBox.style.display="none":
this.noHeader=!1;this._ivizcol&&this.setColHidden();this.attachHeader();this.attachHeader(0,0,"_aFoot");this.setSizes();a&&this.parseXML();this.obj.scrollTop=0;this.dragAndDropOff&&this.dragger.addDragLanding(this.entBox,this);this._initDrF&&this._initD();this._init_point&&this._init_point()}};this.setColumnSizes=function(a){for(var b=0,c=[],d=0,h=0;h<this._cCount;h++)if(this.initCellWidth[h]=="*"&&!this._hrrar[h])this._awdth=!1,c.push(h);else{if(this.cellWidthType=="%"){typeof this.cellWidthPC[h]==
"undefined"&&(this.cellWidthPC[h]=this.initCellWidth[h]);var j=a*this.cellWidthPC[h]/100||0;d>0.5&&(j++,d--);var l=this.cellWidthPX[h]=Math.floor(j),d=d+j-l}else typeof this.cellWidthPX[h]=="undefined"&&(this.cellWidthPX[h]=this.initCellWidth[h]);this._hrrar[h]||(b+=this.cellWidthPX[h]*1)}if(c.length){var m=Math.floor((a-b)/c.length);m<0&&(m=1);for(h=0;h<c.length;h++){var k=Math.max(this._drsclmW?this._drsclmW[c[h]]||0:0,m);this.cellWidthPX[c[h]]=k;b+=k}if(a>b){var n=c[c.length-1];this.cellWidthPX[n]+=
a-b;b=a}this._setAutoResize()}this.obj.style.width=b+"px";this.hdr.style.width=b+"px";if(this.ftr)this.ftr.style.width=b+"px";this.chngCellWidth();return b};this.setSizes=function(){if(this.hdr.rows[0]){var a=this.quirks=_isIE&&document.compatMode=="BackCompat",c=(this.entBox.offsetWidth-this.entBox.clientWidth)/2;if(!this.dontSetSizes)if(this.globalBox){var d=(this.globalBox.offsetWidth-this.globalBox.clientWidth)/2;if(this._delta_x&&!this._realfake){var i=this.globalBox.clientWidth;this.globalBox.style.width=
this._delta_x;this.entBox.style.width=Math.max(0,this.globalBox.clientWidth+(a?d*2:0)-this._fake.entBox.clientWidth)+"px";i!=this.globalBox.clientWidth&&this._fake._correctSplit(this._fake.entBox.clientWidth)}if(this._delta_y&&!this._realfake)this.globalBox.style.height=this._delta_y,this.entBox.style.overflow=this._fake.entBox.style.overflow="hidden",this.entBox.style.height=this._fake.entBox.style.height=this.globalBox.clientHeight+(a?d*2:0)+"px"}else{if(this._delta_x)this.entBox.parentNode&&this.entBox.parentNode.tagName==
"TD"?(this.entBox.style.width="1px",this.entBox.style.width=parseInt(this._delta_x)*this.entBox.parentNode.clientWidth/100-c*2+"px"):this.entBox.style.width=this._delta_x;if(this._delta_y)this.entBox.style.height=this._delta_y}window.clearTimeout(this._sizeTime);if(!this.entBox.offsetWidth&&(!this.globalBox||!this.globalBox.offsetWidth))this._sizeTime=window.setTimeout(function(){b.setSizes&&b.setSizes()},250);else{var h=!this._wthB&&(this.entBox.cmp||this._delta_x)&&(this.skin_name||"").indexOf("dhx")==
0&&!a?2:0,j=!this._wthB&&(this.entBox.cmp||this._delta_y)&&(this.skin_name||"").indexOf("dhx")==0&&!a?2:0;this._sizeFix&&(h-=this._sizeFix,j-=this._sizeFix);var l=this.parentGrid?!1:this.objBox.scrollHeight>this.objBox.offsetHeight,m=dhtmlx.$customScroll?0:18,k=this.entBox.clientWidth-(this.skin_h_correction||0)*(a?0:1)-h,n=this.entBox.clientWidth-(this.skin_h_correction||0)-h,o=this.entBox.clientHeight-j,p=this.setColumnSizes(n-(l?m:0)-(this._correction_x||0)),q=this.parentGrid?!1:this.objBox.scrollWidth>
this.objBox.offsetWidth||this.objBox.style.overflowX=="scroll",r=this.hdr.clientHeight,t=this.ftr?this.ftr.clientHeight:0,u=k,s=o-r-t;this._awdth&&this._awdth[0]&&this._awdth[1]==99999&&(q=0);if(this._ahgr&&(s=this._ahgrMA?this.entBox.parentNode.clientHeight-r-t:this.obj.offsetHeight+(q?m:0)+(this._correction_y||0),this._ahgrM&&(s=this._ahgrF?Math.min(this._ahgrM,s+r+t)-r-t:Math.min(this._ahgrM,s)),l&&s>=this.obj.scrollHeight+(q?m:0)))l=!1,this.setColumnSizes(n-(this._correction_x||0));if(this._awdth&&
this._awdth[0]){if(this.cellWidthType=="%")this.cellWidthType="px";this._fake&&(p+=this._fake.entBox.clientWidth);u=Math.min(Math.max(p+(l?m:0),this._awdth[2]),this._awdth[1])+(this._correction_x||0);this._fake&&(u-=this._fake.entBox.clientWidth)}s=Math.max(0,s);this._ff_size_delta=this._ff_size_delta==0.1?0.2:0.1;if(!_isFF)this._ff_size_delta=0;if(!this.dontSetSizes)this.entBox.style.width=Math.max(0,u+(a?2:0)*c+this._ff_size_delta)+"px",this.entBox.style.height=s+(a?2:0)*c+r+t+"px";this.objBox.style.height=
s+(a&&!l?2:0)*c+"px";this.hdrBox.style.height=r+"px";s!=o&&this.doOnScroll(0,!this._srnd);var v=this["setSizes_"+this.skin_name];v&&v.call(this);this.setSortImgPos();r!=this.hdr.clientHeight&&this._ahgr&&this.setSizes();this.callEvent("onSetSizes",[])}}};this.setSizes_clear=function(){var a=this.hdr.offsetHeight,b=this.entBox.offsetWidth,c=a+this.objBox.offsetHeight;this._topMb.style.top=(a||0)+"px";this._topMb.style.width=b+20+"px";this._botMb.style.top=c-3+"px";this._botMb.style.width=b+20+"px"};
this.chngCellWidth=function(){if(_isOpera&&this.ftr)this.ftr.width=this.objBox.scrollWidth+"px";for(var a=this._cCount,b=0;b<a;b++)if(this.hdr.rows[0].cells[b].style.width=this.cellWidthPX[b]+"px",this.obj.rows[0].childNodes[b].style.width=this.cellWidthPX[b]+"px",this.ftr)this.ftr.rows[0].cells[b].style.width=this.cellWidthPX[b]+"px"};this.setDelimiter=function(a){this.delim=a};this.setInitWidthsP=function(a,b){this.cellWidthType="%";this.initCellWidth=a.split(this.delim.replace(/px/gi,""));b||this._setAutoResize()};
this._setAutoResize=function(){if(!this._realfake){var a=window,b=this;dhtmlxEvent(window,"resize",function(){window.clearTimeout(b._resize_timer);if(b._setAutoResize)b._resize_timer=window.setTimeout(function(){b.setSizes&&b.setSizes();b._fake&&b._fake._correctSplit()},100)})}};this.setInitWidths=function(a){this.cellWidthType="px";this.initCellWidth=a.split(this.delim);if(_isFF)for(var b=0;b<this.initCellWidth.length;b++)this.initCellWidth[b]!="*"&&(this.initCellWidth[b]=parseInt(this.initCellWidth[b]))};
this.enableMultiline=function(a){this.multiLine=convertStringToBoolean(a)};this.enableMultiselect=function(a){this.selMultiRows=convertStringToBoolean(a)};this.setImagesPath=this.setImagePath=function(a){this.imgURL=a};this.setIconsPath=this.setIconPath=function(a){this.iconURL=a};this.changeCursorState=function(a){var b=a.target||a.srcElement;b.tagName!="TD"&&(b=this.getFirstParentOfType(b,"TD"));if(b){if(b.tagName=="TD"&&this._drsclmn&&!this._drsclmn[b._cellIndex])return b.style.cursor="default";
var c=(a.layerX||0)+(!_isIE&&a.target.tagName=="DIV"?b.offsetLeft:0);b.style.cursor=b.offsetWidth-(a.offsetX||(parseInt(this.getPosition(b,this.hdrBox))-c)*-1)<(_isOpera?20:10)?"E-resize":"default";if(_isOpera)this.hdrBox.scrollLeft=this.objBox.scrollLeft}};this.startColResize=function(a){this.resized&&this.stopColResize();this.resized=null;var c=a.target||a.srcElement;c.tagName!="TD"&&(c=this.getFirstParentOfType(c,"TD"));var d=a.clientX,i=this.hdr.offsetWidth,h=parseInt(c.offsetWidth);if(c.tagName==
"TD"&&c.style.cursor!="default"&&(!this._drsclmn||this._drsclmn[c._cellIndex]))b._old_d_mm=document.body.onmousemove,b._old_d_mu=document.body.onmouseup,document.body.onmousemove=function(a){b&&b.doColResize(a||window.event,c,h,d,i)},document.body.onmouseup=function(){b&&b.stopColResize()}};this.stopColResize=function(){document.body.onmousemove=b._old_d_mm||"";document.body.onmouseup=b._old_d_mu||"";this.setSizes();this.doOnScroll(0,1);this.callEvent("onResizeEnd",[this])};this.doColResize=function(a,
b,c,d,h){b.style.cursor="E-resize";this.resized=b;var j=c+(a.clientX-d),l=h+(a.clientX-d);if(this.callEvent("onResize",[b._cellIndex,j,this])){if(_isIE)this.objBox.scrollLeft=this.hdrBox.scrollLeft;if(b.colSpan>1){for(var m=[],k=0;k<b.colSpan;k++)m[k]=Math.round(j*this.hdr.rows[0].childNodes[b._cellIndexS+k].offsetWidth/b.offsetWidth);for(k=0;k<b.colSpan;k++)this._setColumnSizeR(b._cellIndexS+k*1,m[k])}else this._setColumnSizeR(b._cellIndex,j);this.doOnScroll(0,1);this.setSizes();this._fake&&this._awdth&&
this._fake._correctSplit()}};this._setColumnSizeR=function(a,b){if(b>(this._drsclmW&&!this._notresize?this._drsclmW[a]||10:10)){this.obj.rows[0].childNodes[a].style.width=b+"px";this.hdr.rows[0].childNodes[a].style.width=b+"px";if(this.ftr)this.ftr.rows[0].childNodes[a].style.width=b+"px";if(this.cellWidthType=="px")this.cellWidthPX[a]=b;else{var c=parseInt(this.entBox.offsetWidth);this.objBox.scrollHeight>this.objBox.offsetHeight&&(c-=17);var d=Math.round(b/c*100);this.cellWidthPC[a]=d}this.sortImg.style.display!=
"none"&&this.setSortImgPos()}};this.setSortImgState=function(a,b,c,d){c=(c||"asc").toLowerCase();if(convertStringToBoolean(a)){this.sortImg.src=c=="asc"?this.imgURL+"sort_asc.gif":this.imgURL+"sort_desc.gif";this.sortImg.style.display="";this.fldSorted=this.hdr.rows[0].childNodes[b];var h=this.hdr.rows[d||1];if(h){for(var j=0;j<h.childNodes.length;j++)if(h.childNodes[j]._cellIndexS==b)return this.r_fldSorted=h.childNodes[j],this.setSortImgPos();return this.setSortImgState(a,b,c,(d||1)+1)}}else this.sortImg.style.display=
"none",this.fldSorted=this.r_fldSorted=null};this.setSortImgPos=function(a,b,c,d){if(!this._hrrar||!this._hrrar[this.r_fldSorted?this.r_fldSorted._cellIndex:a])if(d||(d=a?this.hdr.rows[c||0].cells[a]:this.r_fldSorted),d!=null){var h=this.getPosition(d,this.hdrBox),j=d.offsetWidth;this.sortImg.style.left=Number(h[0]+j-13)+"px";this.sortImg.defLeft=parseInt(this.sortImg.style.left);this.sortImg.style.top=Number(h[1]+5)+"px";if(!this.useImagesInHeader&&!b)this.sortImg.style.display="inline";this.sortImg.style.left=
this.sortImg.defLeft+"px"}};this.setActive=function(a){arguments.length==0&&(a=!0);a==!0?(globalActiveDHTMLGridObject&&globalActiveDHTMLGridObject!=this&&(globalActiveDHTMLGridObject.editStop(),globalActiveDHTMLGridObject.callEvent("onBlur",[globalActiveDHTMLGridObject])),globalActiveDHTMLGridObject=this,this.isActive=!0):(this.isActive=!1,this.callEvent("onBlur",[this]))};this._doClick=function(a){var b=0,c=this.getFirstParentOfType(_isIE?a.srcElement:a.target,"TD");if(c){var d=!0;if(this.markedCells){var h=
0;if(a.shiftKey||a.metaKey)h=1;a.ctrlKey&&(h=2);this.doMark(c,h);return!0}if(this.selMultiRows!=!1&&(a.shiftKey&&this.row!=null&&this.selectedRows.length&&(b=1),a.ctrlKey||a.metaKey))b=2;this.doClick(c,d,b)}};this.doClick=function(a,c,d,i){this.selMultiRows||(d=0);var h=this.row?this.row.idd:0;this.setActive(!0);d||(d=0);if(this.cell!=null)this.cell.className=this.cell.className.replace(/cellselected/g,"");if(a.tagName=="TD"){if(this.checkEvent("onSelectStateChanged"))var j=this.getSelectedId();var l=
this.row;if(d==1){var m=this.rowsCol._dhx_find(a.parentNode),k=this.rowsCol._dhx_find(this.lastClicked);if(m>k)var n=k,o=m;else n=m,o=k;for(var p=0;p<this.rowsCol.length;p++)if(p>=n&&p<=o)if(this.rowsCol[p]&&!this.rowsCol[p]._sRow)this.rowsCol[p].className.indexOf("rowselected")==-1&&this.callEvent("onBeforeSelect",[this.rowsCol[p].idd,h])&&(this.rowsCol[p].className+=" rowselected",this.selectedRows[this.selectedRows.length]=this.rowsCol[p]);else return this.clearSelection(),this.doClick(a,c,0,i)}else if(d==
2&&a.parentNode.className.indexOf("rowselected")!=-1){a.parentNode.className=a.parentNode.className.replace(/rowselected/g,"");this.selectedRows._dhx_removeAt(this.selectedRows._dhx_find(a.parentNode));var q=!0,i=!1}this.editStop();if(typeof a.parentNode.idd=="undefined")return!0;if(!q&&!a.parentNode._sRow)if(this.callEvent("onBeforeSelect",[a.parentNode.idd,h]))if(this.getSelectedRowId()!=a.parentNode.idd){d==0&&this.clearSelection();this.cell=a;l==a.parentNode&&this._chRRS&&(c=!1);this.row=a.parentNode;
this.row.className+=" rowselected";if(this.cell&&_isIE&&_isIE==8){var r=this.cell.nextSibling,t=this.cell.parentNode;t.removeChild(this.cell);t.insertBefore(this.cell,r);this.cell.setActive()}if(this.selectedRows._dhx_find(this.row)==-1)this.selectedRows[this.selectedRows.length]=this.row}else this.cell=a,this.row=a.parentNode;else c=!1;if(this.cell&&this.cell.parentNode.className.indexOf("rowselected")!=-1)this.cell.className=this.cell.className.replace(/cellselected/g,"")+" cellselected";if(d!=
1&&!this.row)return;this.lastClicked=a.parentNode;var u=this.row.idd,s=this.cell;c&&typeof u!="undefined"&&s&&!q?b.onRowSelectTime=setTimeout(function(){b.callEvent&&b.callEvent("onRowSelect",[u,s._cellIndex])},100):this.callEvent("onRowSelectRSOnly",[u]);if(this.checkEvent("onSelectStateChanged")){var v=this.getSelectedId();j!=v&&this.callEvent("onSelectStateChanged",[v,j])}}this.isActive=!0;i!==!1&&this.cell&&this.cell.parentNode.idd&&this.moveToVisible(this.cell)};this.selectAll=function(){this.clearSelection();
var a=this.rowsBuffer;if(this.pagingOn)a=this.rowsCol;for(var b=0;b<a.length;b++)this.render_row(b).className+=" rowselected";this.selectedRows=dhtmlxArray([].concat(a));if(this.selectedRows.length)this.row=this.selectedRows[0],this.cell=this.row.cells[0];this._fake&&!this._realfake&&this._fake.selectAll()};this.selectCell=function(a,b,c,d,h,j){c||(c=!1);typeof a!="object"&&(a=this.render_row(a));if(!a||a==-1)return null;var l=a._childIndexes?a.childNodes[a._childIndexes[b]]:a.childNodes[b];l||(l=
a.childNodes[0]);this.markedCells?this.doMark(l,d?2:0):d?this.doClick(l,c,3,j):this.doClick(l,c,0,j);h&&this.editCell()};this.moveToVisible=function(a,b){if(this.pagingOn){var c=Math.floor(this.getRowIndex(a.parentNode.idd)/this.rowsBufferOutSize)+1;c!=this.currentPage&&this.changePage(c)}try{if(a.offsetHeight){var d=a.offsetLeft+a.offsetWidth+20,h=0;d>this.objBox.offsetWidth+this.objBox.scrollLeft?a.offsetLeft>this.objBox.scrollLeft&&(h=a.offsetLeft-5):a.offsetLeft<this.objBox.scrollLeft&&(d-=a.offsetWidth*
2/3,d<this.objBox.scrollLeft&&(h=a.offsetLeft-5));if(h&&!b)this.objBox.scrollLeft=h}if(a.offsetHeight)d=a.offsetTop;else var j=this._realfake?this._fake.rowsAr[a.parentNode.idd]:a.parentNode,d=this.rowsBuffer._dhx_find(j)*this._srdh;var l=d+a.offsetHeight+38;if(l>this.objBox.offsetHeight+this.objBox.scrollTop)var m=d;else d<this.objBox.scrollTop&&(m=d-5);if(m)this.objBox.scrollTop=m}catch(k){}};this.editCell=function(){if(!(this.editor&&this.cell==this.editor.cell)){this.editStop();if(this.isEditable!=
!0||!this.cell)return!1;var a=this.cell;if(a.parentNode._locked)return!1;this.editor=this.cells4(a);if(this.editor!=null){if(this.editor.isDisabled())return this.editor=null,!1;this.callEvent("onEditCell",[0,this.row.idd,this.cell._cellIndex])!=!1&&this.editor.edit?(this._Opera_stop=(new Date).valueOf(),a.className+=" editable",this.editor.edit(),this.callEvent("onEditCell",[1,this.row.idd,this.cell._cellIndex])):this.editor=null}}};this.editStop=function(a){if(_isOpera&&this._Opera_stop){if(this._Opera_stop*
1+50>(new Date).valueOf())return;this._Opera_stop=null}if(this.editor&&this.editor!=null)if(this.editor.cell.className=this.editor.cell.className.replace("editable",""),a){var b=this.editor.val;this.editor.detach();this.editor.setValue(b);this.editor=null;this.callEvent("onEditCancel",[this.row.idd,this.cell._cellIndex,b])}else{if(this.editor.detach())this.cell.wasChanged=!0;var c=this.editor;this.editor=null;var d=this.callEvent("onEditCell",[2,this.row.idd,this.cell._cellIndex,c.getValue(),c.val]);
if(typeof d=="string"||typeof d=="number")c[c.setImage?"setLabel":"setValue"](d);else if(!d)c[c.setImage?"setLabel":"setValue"](c.val);this._ahgr&&this.multiLine&&this.setSizes()}};this._nextRowCell=function(a,b,c){a=this._nextRow((this._groups?this.rowsCol:this.rowsBuffer)._dhx_find(a),b);return!a?null:a.childNodes[a._childIndexes?a._childIndexes[c]:c]};this._getNextCell=function(a,b,c){var a=a||this.cell,d=a.parentNode;this._tabOrder?(c=this._tabOrder[a._cellIndex],typeof c!="undefined"&&(a=c<0?
this._nextRowCell(d,b,Math.abs(c)-1):d.childNodes[c])):(c=a._cellIndex+b,c>=0&&c<this._cCount?(d._childIndexes&&(c=d._childIndexes[a._cellIndex]+b),a=d.childNodes[c]):a=this._nextRowCell(d,b,b==1?0:this._cCount-1));return!a?(b==1&&this.tabEnd&&(this.tabEnd.focus(),this.tabEnd.focus(),this.setActive(!1)),b==-1&&this.tabStart&&(this.tabStart.focus(),this.tabStart.focus(),this.setActive(!1)),null):a.style.display!="none"&&(!this.smartTabOrder||!this.cells(a.parentNode.idd,a._cellIndex).isDisabled())?
a:this._getNextCell(a,b)};this._nextRow=function(a,b){var c=this.render_row(a+b);return!c||c==-1?null:c&&c.style.display=="none"?this._nextRow(a+b,b):c};this.scrollPage=function(a){if(this.rowsBuffer.length){var b=this._realfake?this._fake:this,c=Math.floor((b._r_select||this.getRowIndex(this.row.idd)||0)+a*this.objBox.offsetHeight/(this._srdh||20));c<0&&(c=0);c>=this.rowsBuffer.length&&(c=this.rowsBuffer.length-1);if(this._srnd&&!this.rowsBuffer[c]){this.objBox.scrollTop+=Math.floor(a*this.objBox.offsetHeight/
(this._srdh||20))*(this._srdh||20);if(this._fake)this._fake.objBox.scrollTop=this.objBox.scrollTop;b._r_select=c}else{this.selectCell(c,this.cell._cellIndex,!0,!1,!1,this.multiLine||this._srnd);if(!this.multiLine&&!this._srnd&&!this._realfake&&(this.objBox.scrollTop=this.getRowById(this.getRowId(c)).offsetTop,this._fake))this._fake.objBox.scrollTop=this.objBox.scrollTop;b._r_select=null}}};this.doKey=function(a){if(!a)return!0;if((a.target||a.srcElement).value!==window.undefined){var b=a.target||
a.srcElement;if(!b.parentNode||b.parentNode.className.indexOf("editable")==-1)return!0}if(globalActiveDHTMLGridObject&&this!=globalActiveDHTMLGridObject)return globalActiveDHTMLGridObject.doKey(a);if(this.isActive==!1)return!0;if(this._htkebl)return!0;if(!this.callEvent("onKeyPress",[a.keyCode,a.ctrlKey,a.shiftKey,a]))return!1;var c="k"+a.keyCode+"_"+(a.ctrlKey?1:0)+"_"+(a.shiftKey?1:0);if(this.cell){if(this._key_events[c]){if(!1===this._key_events[c].call(this))return!0;a.preventDefault&&a.preventDefault();
a.cancelBubble=!0;return!1}this._key_events.k_other&&this._key_events.k_other.call(this,a)}return!0};this.selectRow=function(a,b,c,d){typeof a!="object"&&(a=this.render_row(a));this.selectCell(a,0,b,c,!1,d)};this.wasDblClicked=function(a){var b=this.getFirstParentOfType(_isIE?a.srcElement:a.target,"TD");if(b){var c=b.parentNode.idd;return this.callEvent("onRowDblClicked",[c,b._cellIndex,a])}};this._onHeaderClick=function(a,b){var c=this.grid,b=b||c.getFirstParentOfType(_isIE?event.srcElement:a.target,
"TD");if(this.grid.resized==null){if(!this.grid.callEvent("onHeaderClick",[b._cellIndexS,a||window.event]))return!1;c.sortField(b._cellIndexS,!1,b)}this.grid.resized=null};this.deleteSelectedRows=function(){var a=this.selectedRows.length;if(a!=0){var b=this.selectedRows;this.selectedRows=dhtmlxArray();for(var c=a-1;c>=0;c--){var d=b[c];if(this.deleteRow(d.idd,d)){if(d==this.row)var h=c}else this.selectedRows[this.selectedRows.length]=d}if(h)try{h+1>this.rowsCol.length&&h--,this.selectCell(h,0,!0)}catch(j){this.cell=
this.row=null}}};this.getSelectedRowId=function(){for(var a=[],b={},c=0;c<this.selectedRows.length;c++){var d=this.selectedRows[c].idd;b[d]||(a[a.length]=d,b[d]=!0)}return a.length==0?null:a.join(this.delim)};this.getSelectedCellIndex=function(){return this.cell!=null?this.cell._cellIndex:-1};this.getColWidth=function(a){return parseInt(this.cellWidthPX[a])};this.setColWidth=function(a,b){if(b=="*")this.initCellWidth[a]="*";else{if(this._hrrar[a])return;this.cellWidthType=="px"?this.cellWidthPX[a]=
parseInt(b):this.cellWidthPC[a]=parseInt(b)}this.setSizes()};this.getRowIndex=function(a){for(var b=0;b<this.rowsBuffer.length;b++)if(this.rowsBuffer[b]&&this.rowsBuffer[b].idd==a)return b;return-1};this.getRowId=function(a){return this.rowsBuffer[a]?this.rowsBuffer[a].idd:this.undefined};this.setRowId=function(a,b){this.changeRowId(this.getRowId(a),b)};this.changeRowId=function(a,b){if(a!=b){var c=this.rowsAr[a];c.idd=b;this.UserData[a]&&(this.UserData[b]=this.UserData[a],this.UserData[a]=null);
if(this._h2&&this._h2.get[a])this._h2.get[b]=this._h2.get[a],this._h2.get[b].id=b,delete this._h2.get[a];this.rowsAr[a]=null;this.rowsAr[b]=c;for(var d=0;d<c.childNodes.length;d++)if(c.childNodes[d]._code)c.childNodes[d]._code=this._compileSCL(c.childNodes[d]._val,c.childNodes[d]);if(this._mat_links&&this._mat_links[a]){var h=this._mat_links[a];delete this._mat_links[a];for(var j in h)for(d=0;d<h[j].length;d++)this._compileSCL(h[j][d].original,h[j][d])}this.callEvent("onRowIdChange",[a,b])}};this.setColumnIds=
function(a){this.columnIds=a.split(this.delim)};this.setColumnId=function(a,b){this.columnIds[a]=b};this.getColIndexById=function(a){for(var b=0;b<this.columnIds.length;b++)if(this.columnIds[b]==a)return b};this.getColumnId=function(a){return this.columnIds[a]};this.getColLabel=this.getColumnLabel=function(a,b,c){for(var d=(c||this.hdr).rows[(b||0)+1],h=0;h<d.cells.length;h++)if(d.cells[h]._cellIndexS==a)return _isIE?d.cells[h].innerText:d.cells[h].textContent;return""};this.getFooterLabel=function(a,
b){return this.getColumnLabel(a,b,this.ftr)};this.setRowTextBold=function(a){var b=this.getRowById(a);if(b)b.style.fontWeight="bold"};this.setRowTextStyle=function(a,b){var c=this.getRowById(a);if(c)for(var d=0;d<c.childNodes.length;d++){var h=c.childNodes[d]._attrs.style||"";this._hrrar&&this._hrrar[d]&&(h="display:none;");c.childNodes[d].style.cssText=h+"width:"+c.childNodes[d].style.width+";"+b}};this.setRowColor=function(a,b){for(var c=this.getRowById(a),d=0;d<c.childNodes.length;d++)c.childNodes[d].bgColor=
b};this.setCellTextStyle=function(a,b,c){var d=this.getRowById(a);if(d){var h=d.childNodes[d._childIndexes?d._childIndexes[b]:b];if(h){var j="";this._hrrar&&this._hrrar[b]&&(j="display:none;");h.style.cssText=j+"width:"+h.style.width+";"+c}}};this.setRowTextNormal=function(a){var b=this.getRowById(a);if(b)b.style.fontWeight="normal"};this.doesRowExist=function(a){return this.getRowById(a)!=null?!0:!1};this.getColumnsNum=function(){return this._cCount};this.moveRowUp=function(a){var b=this.getRowById(a);
if(this.isTreeGrid())return this.moveRowUDTG(a,-1);var c=this.rowsCol._dhx_find(b);if(b.previousSibling&&c!=0){b.parentNode.insertBefore(b,b.previousSibling);this.rowsCol._dhx_swapItems(c,c-1);this.setSizes();var d=this.rowsBuffer._dhx_find(b);this.rowsBuffer._dhx_swapItems(d,d-1);this._cssEven&&this._fixAlterCss(c-1)}};this.moveRowDown=function(a){var b=this.getRowById(a);if(this.isTreeGrid())return this.moveRowUDTG(a,1);var c=this.rowsCol._dhx_find(b);if(b.nextSibling){this.rowsCol._dhx_swapItems(c,
c+1);b.nextSibling.nextSibling?b.parentNode.insertBefore(b,b.nextSibling.nextSibling):b.parentNode.appendChild(b);this.setSizes();var d=this.rowsBuffer._dhx_find(b);this.rowsBuffer._dhx_swapItems(d,d+1);this._cssEven&&this._fixAlterCss(c)}};this.setUserData=function(a,b,c){a||(a="gridglobaluserdata");this.UserData[a]||(this.UserData[a]=new Hashtable);this.UserData[a].put(b,c)};this.getUserData=function(a,b){a||(a="gridglobaluserdata");this.getRowById(a);var c=this.UserData[a];return c?c.get(b):""};
this.setEditable=function(a){this.isEditable=convertStringToBoolean(a)};this.selectRowById=function(a,b,c,d){d||(d=!1);this.selectCell(this.getRowById(a),0,d,b,!1,c)};this.clearSelection=function(){this.editStop();for(var a=0;a<this.selectedRows.length;a++){var b=this.rowsAr[this.selectedRows[a].idd];if(b)b.className=b.className.replace(/rowselected/g,"")}this.selectedRows=dhtmlxArray();this.row=null;if(this.cell!=null)this.cell.className=this.cell.className.replace(/cellselected/g,""),this.cell=
null;this.callEvent("onSelectionCleared",[])};this.copyRowContent=function(a,b){var c=this.getRowById(a);if(this.isTreeGrid())this._copyTreeGridRowContent(c,a,b);else for(var d=0;d<c.cells.length;d++)this.cells(b,d).setValue(this.cells(a,d).getValue());if(!_isIE)this.getRowById(a).cells[0].height=c.cells[0].offsetHeight};this.setFooterLabel=function(a,b,c){return this.setColumnLabel(a,b,c,this.ftr)};this.setColumnLabel=function(a,b,c,d){var h=(d||this.hdr).rows[c||1],j=h._childIndexes?h._childIndexes[a]:
a;if(h.cells[j]){if(this.useImagesInHeader){h.cells[j].style.textAlign="left";h.cells[j].innerHTML="<img src='"+this.imgURL+""+b+"' onerror='this.src = \""+this.imgURL+"imageloaderror.gif\"'>";var l=new Image;l.src=this.imgURL+""+b.replace(/(\.[a-z]+)/,".des$1");this.preloadImagesAr[this.preloadImagesAr.length]=l;var m=new Image;m.src=this.imgURL+""+b.replace(/(\.[a-z]+)/,".asc$1");this.preloadImagesAr[this.preloadImagesAr.length]=m}else{var k="<div class='hdrcell'>";if(b.indexOf("img:[")!=-1){var n=
b.replace(/.*\[([^>]+)\].*/,"$1"),b=b.substr(b.indexOf("]")+1,b.length);k+="<img width='18px' height='18px' align='absmiddle' src='"+n+"' hspace='2'>"}k+=b;k+="</div>";h.cells[j].innerHTML=k;if(this._hstyles[j])h.cells[j].style.cssText=this._hstyles[j]}if((b||"").indexOf("#")!=-1){var o=b.match(/(^|{)#([^}]+)(}|$)/);if(o){var p="_in_header_"+o[2];if(this[p])this[p](this.forceDivInHeader?h.cells[j].firstChild:h.cells[j],j,b.split(o[0]))}}}};this.setColLabel=function(a,b,c,d){return this.setColumnLabel(a,
b,(c||0)+1,d)};this.clearAll=function(a){if(this.obj.rows[0]){if(this._h2&&(this._h2=new dhtmlxHierarchy,this._fake))this._realfake?this._h2=this._fake._h2:this._fake._h2=this._h2;this.limit=this._limitC=0;this.editStop(!0);this._dLoadTimer&&window.clearTimeout(this._dLoadTimer);if(this._dload)this.objBox.scrollTop=0,this.limit=this._limitC||0,this._initDrF=!0;for(var b=this.rowsCol.length,b=this.obj.rows.length,c=b-1;c>0;c--){var d=this.obj.rows[c];d.parentNode.removeChild(d)}if(a){this._master_row=
null;this.obj.rows[0].parentNode.removeChild(this.obj.rows[0]);for(c=this.hdr.rows.length-1;c>=0;c--)d=this.hdr.rows[c],d.parentNode.removeChild(d);if(this.ftr)this.ftr.parentNode.removeChild(this.ftr),this.ftr=null;this._aHead=this.ftr=this.cellWidth=this._aFoot=null;this.cellType=dhtmlxArray();this._hrrar=[];this.columnIds=[];this.combos=[];this._strangeParams=[];this.defVal=[];this._ivizcol=null}this.cell=this.row=null;this.rowsCol=dhtmlxArray();this.rowsAr={};this._RaSeCol=[];this.rowsBuffer=
dhtmlxArray();this.UserData=[];this.selectedRows=dhtmlxArray();if(this.pagingOn||this._srnd)this.xmlFileUrl="";this.pagingOn&&this.changePage(1);this._contextCallTimer&&window.clearTimeout(this._contextCallTimer);this._sst&&this.enableStableSorting(!0);this._fillers=this.undefined;this.setSortImgState(!1);this.setSizes();this.callEvent("onClearAll",[])}};this.sortField=function(a,b,c){if(this.getRowsNum()==0)return!1;var d=this.hdr.rows[0].cells[a];if(d&&d.tagName=="TH"&&this.fldSort.length-1>=d._cellIndex&&
this.fldSort[d._cellIndex]!="na"){var h=this.getSortingState(),j=h[0]==a&&h[1]=="asc"?"des":"asc";if(this.callEvent("onBeforeSorting",[a,this.fldSort[a],j])){this.sortImg.src=this.imgURL+"sort_"+(j=="asc"?"asc":"desc")+".gif";if(this.useImagesInHeader){var l=this.hdr.rows[1].cells[d._cellIndex].firstChild;if(this.fldSorted!=null){var m=this.hdr.rows[1].cells[this.fldSorted._cellIndex].firstChild;m.src=m.src.replace(/(\.asc\.)|(\.des\.)/,".")}l.src=l.src.replace(/(\.[a-z]+)$/,"."+j+"$1")}this.sortRows(d._cellIndex,
this.fldSort[d._cellIndex],j);this.fldSorted=d;this.r_fldSorted=c;var k=this.hdr.rows[1],k=c.parentNode,n=k._childIndexes?k._childIndexes[d._cellIndex]:d._cellIndex;this.setSortImgPos(!1,!1,!1,c)}}};this.setCustomSorting=function(a,b){if(!this._customSorts)this._customSorts=[];this._customSorts[b]=typeof a=="string"?eval(a):a;this.fldSort[b]="cus"};this.enableHeaderImages=function(a){this.useImagesInHeader=a};this.setHeader=function(a,b,c){for(var d=typeof a!="object"?this._eSplit(a):[].concat(a),
h=[],j=new dhtmlxArray(0),l=[],m=[],k=[],n=0;n<d.length;n++)h[h.length]=Math.round(100/d.length),j[j.length]="ed",l[l.length]="left",m[m.length]="middle",k[k.length]="na";this.splitSign=b||"#cspan";this.hdrLabels=d;this.cellWidth=h;this.initCellWidth.length||this.setInitWidthsP(h.join(this.delim),!0);this.cellType=j;this.cellAlign=l;this.cellVAlign=m;this.fldSort=k;this._hstyles=c||[]};this._eSplit=function(a){if(![].push)return a.split(this.delim);var b="r"+(new Date).valueOf(),c=this.delim.replace(/([\|\+\*\^])/g,
"\\$1");return(a||"").replace(RegExp(c,"g"),b).replace(RegExp("\\\\"+b,"g"),this.delim).split(b)};this.getColType=function(a){return this.cellType[a]};this.getColTypeById=function(a){return this.cellType[this.getColIndexById(a)]};this.setColTypes=function(a){this.cellType=dhtmlxArray(a.split(this.delim));this._strangeParams=[];for(var b=0;b<this.cellType.length;b++){if(this.cellType[b].indexOf("[")!=-1){var c=this.cellType[b].split(/[\[\]]+/g);this.cellType[b]=c[0];this.defVal[b]=c[1];c[1].indexOf("=")==
0&&(this.cellType[b]="math",this._strangeParams[b]=c[0])}window["eXcell_"+this.cellType[b]]||dhtmlxError.throwError("Configuration","Incorrect cell type: "+this.cellType[b],[this,this.cellType[b]])}};this.setColSorting=function(a){this.fldSort=a.split(this.delim);for(var b=0;b<this.fldSort.length;b++)if(this.fldSort[b].length>4&&typeof window[this.fldSort[b]]=="function"){if(!this._customSorts)this._customSorts=[];this._customSorts[b]=window[this.fldSort[b]];this.fldSort[b]="cus"}};this.setColAlign=
function(a){this.cellAlign=a.split(this.delim);for(var b=0;b<this.cellAlign.length;b++)this.cellAlign[b]=this.cellAlign[b]._dhx_trim()};this.setColVAlign=function(a){this.cellVAlign=a.split(this.delim)};this.setNoHeader=function(a){this.noHeader=convertStringToBoolean(a)};this.showRow=function(a){this.getRowById(a);this._h2&&this.openItem(this._h2.get[a].parent.id);for(var b=this.getRowById(a).childNodes[0];b&&b.style.display=="none";)b=b.nextSibling;b&&this.moveToVisible(b,!0)};this.setStyle=function(a,
b,c,d){this.ssModifier=[a,b,c,c,d];for(var h=["#"+this.entBox.id+" table.hdr td","#"+this.entBox.id+" table.obj td","#"+this.entBox.id+" table.obj tr.rowselected td.cellselected","#"+this.entBox.id+" table.obj td.cellselected","#"+this.entBox.id+" table.obj tr.rowselected td"],j=0;!_isIE;){try{var l=document.styleSheets[j].cssRules.length}catch(m){j++;continue}break}for(var k=0;k<h.length;k++)this.ssModifier[k]&&(_isIE?document.styleSheets[0].addRule(h[k],this.ssModifier[k]):document.styleSheets[j].insertRule(h[k]+
(" { "+this.ssModifier[k]+" }"),document.styleSheets[j].cssRules.length))};this.setColumnColor=function(a){this.columnColor=a.split(this.delim)};this.enableAlterCss=function(a,b,c,d){(a||b)&&this.attachEvent("onGridReconstructed",function(){this._fixAlterCss();this._fake&&this._fake._fixAlterCss()});this._cssSP=c;this._cssSU=d;this._cssEven=a;this._cssUnEven=b};this._fixAlterCss=function(a){if(this._h2&&(this._cssSP||this._cssSU))return this._fixAlterCssTGR(a);if(this._cssEven||this._cssUnEven)for(var b=
a=a||0,c=a;c<this.rowsCol.length;c++)if(this.rowsCol[c]&&this.rowsCol[c].style.display!="none")this.rowsCol[c]._cntr?b=1:(this.rowsCol[c].className=this.rowsCol[c].className.indexOf("rowselected")!=-1?b%2==1?this._cssUnEven+" rowselected "+(this.rowsCol[c]._css||""):this._cssEven+" rowselected "+(this.rowsCol[c]._css||""):b%2==1?this._cssUnEven+" "+(this.rowsCol[c]._css||""):this._cssEven+" "+(this.rowsCol[c]._css||""),b++)};this.clearChangedState=function(){for(var a=0;a<this.rowsCol.length;a++){var b=
this.rowsCol[a];if(b&&b.childNodes)for(var c=b.childNodes.length,d=0;d<c;d++)b.childNodes[d].wasChanged=!1}};this.getChangedRows=function(a){var b=[];this.forEachRow(function(c){var d=this.rowsAr[c];if(d.tagName=="TR"){var h=d.childNodes.length;if(a&&d._added)b[b.length]=d.idd;else for(var j=0;j<h;j++)if(d.childNodes[j].wasChanged){b[b.length]=d.idd;break}}});return b.join(this.delim)};this._sAll=this._sUDa=!1;this.setSerializationLevel=function(a,b,c,d,h,j){this._sUDa=a;this._sAll=b;this._sConfig=
c;this._chAttr=d;this._onlChAttr=h;this._asCDATA=j};this.setSerializableColumns=function(a){if(a){this._srClmn=(a||"").split(",");for(var b=0;b<this._srClmn.length;b++)this._srClmn[b]=convertStringToBoolean(this._srClmn[b])}else this._srClmn=null};this._serialise=function(){this.editStop();var a=[],b="</"+this.xml.s_row+">";if(this.isTreeGrid())this._h2.forEachChildF(0,function(b){var c=this._serializeRow(this.render_row_tree(-1,b.id));a.push(c);return c?!0:!1},this,function(){a.push(b)});else for(var c=
0;c<this.rowsBuffer.length;c++)if(this.rowsBuffer[c]&&(!this._chAttr||!this.rowsBuffer[c]._locator)){var d=this._serializeRow(this.render_row(c));a.push(d);d&&a.push(b)}return[a.join("")]};this._serializeRow=function(a,b){var c=[],d=this.xml.row_attrs,h=this.xml.cell_attrs;c.push("<"+this.xml.s_row);c.push(" id='"+a.idd+"'");this._sAll&&this.selectedRows._dhx_find(a)!=-1&&c.push(" selected='1'");this._h2&&this._h2.get[a.idd].state=="minus"&&c.push(" open='1'");if(d.length)for(b=0;b<d.length;b++)c.push(" "+
d[b]+"='"+a._attrs[d[b]]+"'");c.push(">");if(this._sUDa&&this.UserData[a.idd]){keysAr=this.UserData[a.idd].getKeys();for(var j=0;j<keysAr.length;j++)c.push("<userdata name='"+keysAr[j]+"'>"+(this._asCDATA?"<![CDATA[":"")+this.UserData[a.idd].get(keysAr[j])+(this._asCDATA?"]]\>":"")+"</userdata>")}for(var l=!1,m=0;m<this._cCount;m++)if(!this._srClmn||this._srClmn[m]){var k=this.cells3(a,m);c.push("<cell");if(h.length)for(b=0;b<h.length;b++)c.push(" "+h[b]+"='"+k.cell._attrs[h[b]]+"'");zxVal=k[this._agetm]();
this._asCDATA&&(zxVal="<![CDATA["+zxVal+"]]\>");this._ecspn&&k.cell.colSpan&&k.cell.colSpan>1&&c.push(' colspan="'+k.cell.colSpan+'" ');this._chAttr?k.wasChanged()&&(c.push(' changed="1"'),l=!0):this._onlChAttr&&k.wasChanged()&&(l=!0);this._sAll&&this.cellType[m]=="tree"?c.push((this._h2?" image='"+this._h2.get[a.idd].image+"'":"")+">"+zxVal+"</cell>"):c.push(">"+zxVal+"</cell>");if(this._ecspn&&k.cell.colSpan)for(var n=0;n<k.cell.colSpan-1;n++)c.push("<cell/>"),m++}return this._onlChAttr&&!l&&!a._added?
"":c.join("")};this._serialiseConfig=function(){for(var a="<head>",b=0;b<this.hdr.rows[0].cells.length;b++)if(!this._srClmn||this._srClmn[b]){var c=this.fldSort[b];c=="cus"&&(c=this._customSorts[b].toString(),c=c.replace(/function[\ ]*/,"").replace(/\([^\f]*/,""));a+="<column width='"+this.getColWidth(b)+"' align='"+this.cellAlign[b]+"' type='"+this.cellType[b]+"' sort='"+(c||"na")+"' color='"+this.columnColor[b]+"'"+(this.columnIds[b]?" id='"+this.columnIds[b]+"'":"")+">";a+=this._asCDATA?"<![CDATA["+
this.getHeaderCol(b)+"]]\>":this.getHeaderCol(b);var d=this.getCombo(b);if(d)for(var h=0;h<d.keys.length;h++)a+="<option value='"+d.keys[h]+"'>"+d.values[h]+"</option>";a+="</column>"}return a+="</head>"};this.serialize=function(){var a='<?xml version="1.0"?><rows>';this._agetm=this._mathSerialization?"getMathValue":"getValue";if(this._sUDa&&this.UserData.gridglobaluserdata)for(var b=this.UserData.gridglobaluserdata.getKeys(),c=0;c<b.length;c++)a+="<userdata name='"+b[c]+"'>"+this.UserData.gridglobaluserdata.get(b[c])+
"</userdata>";this._sConfig&&(a+=this._serialiseConfig());a+=this._serialise();a+="</rows>";return a};this.getPosition=function(a,b){if(!b){var c=getOffset(a);return[c.left,c.top]}for(var b=b||document.body,d=a,h=0,j=0;d&&d!=b;)h+=d.offsetLeft-d.scrollLeft,j+=d.offsetTop-d.scrollTop,d=d.offsetParent;b==document.body&&(_isIE?(j+=document.body.offsetTop||document.documentElement.offsetTop,h+=document.body.offsetLeft||document.documentElement.offsetLeft):_isFF||(h+=document.body.offsetLeft,j+=document.body.offsetTop));
return[h,j]};this.getFirstParentOfType=function(a,b){for(;a&&a.tagName!=b&&a.tagName!="BODY";)a=a.parentNode;return a};this.objBox.onscroll=function(){this.grid._doOnScroll()};this.objBox.ontouchend=function(){this.hdrBox.scrollLeft=this.objBox.scrollLeft};this.hdrBox.onscroll=function(){if(!this._try_header_sync){this._try_header_sync=!0;if(this.grid.objBox.scrollLeft!=this.scrollLeft)this.grid.objBox.scrollLeft=this.scrollLeft;this._try_header_sync=!1}};if(!_isOpera||_OperaRv>8.5)this.hdr.onmousemove=
function(a){this.grid.changeCursorState(a||window.event)},this.hdr.onmousedown=function(a){return this.grid.startColResize(a||window.event)};this.obj.onmousemove=this._drawTooltip;this.objBox.onclick=function(a){(a||event).cancelBubble=!0};this.obj.onclick=function(a){this.grid._doClick(a||window.event);this.grid._sclE?this.grid.editCell(a||window.event):this.grid.editStop();(a||event).cancelBubble=!0};this.obj.ondblclick=function(a){if(!this.grid.wasDblClicked(a||window.event))return!1;if(this.grid._dclE){var b=
this.grid.getFirstParentOfType(_isIE?event.srcElement:a.target,"TR");b==this.grid.row&&this.grid.editCell(a||window.event)}(a||event).cancelBubble=!0;if(_isOpera)return!1};this.hdr.onclick=this._onHeaderClick;this.sortImg.onclick=function(){b._onHeaderClick.apply({grid:b},[null,b.r_fldSorted])};this.hdr.ondblclick=this._onHeaderDblClick;if(!document.body._dhtmlxgrid_onkeydown)dhtmlxEvent(document,"keydown",function(a){if(globalActiveDHTMLGridObject)return globalActiveDHTMLGridObject.doKey(a||window.event)}),
document.body._dhtmlxgrid_onkeydown=!0;dhtmlxEvent(document.body,"click",function(){b.editStop&&b.editStop();b.isActive&&b.setActive(!1)});this.entBox.onbeforeactivate=function(){this._still_active=null;this.grid.setActive();event.cancelBubble=!0};this.entBox.onbeforedeactivate=function(){this.grid._still_active?this.grid._still_active=null:this.grid.isActive=!1;event.cancelBubble=!0};if(this.entBox.style.height.toString().indexOf("%")!=-1)this._delta_y=this.entBox.style.height;if(this.entBox.style.width.toString().indexOf("%")!=
-1)this._delta_x=this.entBox.style.width;(this._delta_x||this._delta_y)&&this._setAutoResize();this.setColHidden=this.setColumnsVisibility;this.enableCollSpan=this.enableColSpan;this.setMultiselect=this.enableMultiselect;this.setMultiLine=this.enableMultiline;this.deleteSelectedItem=this.deleteSelectedRows;this.getSelectedId=this.getSelectedRowId;this.getHeaderCol=this.getColumnLabel;this.isItemExists=this.doesRowExist;this.getColumnCount=this.getColumnsNum;this.setSelectedRow=this.selectRowById;
this.setHeaderCol=this.setColumnLabel;this.preventIECashing=this.preventIECaching;this.enableAutoHeigth=this.enableAutoHeight;this.getUID=this.uid;dhtmlx.image_path&&this.setImagePath(dhtmlx.image_path);dhtmlx.skin&&this.setSkin(dhtmlx.skin);return this}
dhtmlXGridObject.prototype={getRowAttribute:function(a,c){return this.getRowById(a)._attrs[c]},setRowAttribute:function(a,c,b){this.getRowById(a)._attrs[c]=b},isTreeGrid:function(){return this.cellType._dhx_find("tree")!=-1},setRowHidden:function(a,c){var b=convertStringToBoolean(c),d=this.getRowById(a);if(d){d.expand===""&&this.collapseKids(d);if(c&&d.style.display!="none"){d.style.display="none";var e=this.selectedRows._dhx_find(d);if(e!=-1){d.className=d.className.replace("rowselected","");for(var f=
0;f<d.childNodes.length;f++)d.childNodes[f].className=d.childNodes[f].className.replace(/cellselected/g,"");this.selectedRows._dhx_removeAt(e)}this.callEvent("onGridReconstructed",[])}if(!c&&d.style.display=="none")d.style.display="",this.callEvent("onGridReconstructed",[]);this.callEvent("onRowHide",[a,c]);this.setSizes()}},setColumnHidden:function(a,c){if(!this.hdr.rows.length){if(!this._ivizcol)this._ivizcol=[];return this._ivizcol[a]=c}if(this.fldSorted&&this.fldSorted.cellIndex==a&&c)this.sortImg.style.display=
"none";var b=convertStringToBoolean(c);if(b){if(this._hrrar){if(this._hrrar[a])return}else this._hrrar=[];this._hrrar[a]="display:none;";this._hideShowColumn(a,"none")}else{if(!this._hrrar||!this._hrrar[a])return;this._hrrar[a]="";this._hideShowColumn(a,"")}if(this.fldSorted&&this.fldSorted.cellIndex==a&&!c)this.sortImg.style.display="inline";this.setSortImgPos();this.callEvent("onColumnHidden",[a,c])},isColumnHidden:function(a){return this._hrrar&&this._hrrar[a]?!0:!1},setColumnsVisibility:function(a){if(a)this._ivizcol=
a.split(this.delim);if(this.hdr.rows.length&&this._ivizcol)for(var c=0;c<this._ivizcol.length;c++)this.setColumnHidden(c,this._ivizcol[c])},_fixHiddenRowsAll:function(a,c,b,d,e){for(var e=e||"_cellIndex",f=a.rows.length,g=0;g<f;g++){var i=a.rows[g].childNodes;if(i.length!=this._cCount)for(var h=0;h<i.length;h++){if(i[h][e]==c){i[h].style[b]=d;break}}else i[c].style[b]=d}},_hideShowColumn:function(a,c){var b=a;this.hdr.rows[1]&&this.hdr.rows[1]._childIndexes&&this.hdr.rows[1]._childIndexes[a]!=a&&
(b=this.hdr.rows[1]._childIndexes[a]);if(c=="none"){this.hdr.rows[0].cells[a]._oldWidth=this.hdr.rows[0].cells[a].style.width||this.initCellWidth[a]+"px";this.hdr.rows[0].cells[a]._oldWidthP=this.cellWidthPC[a];this.obj.rows[0].cells[a].style.width="0px";var d={rows:[this.obj.rows[0]]};this.forEachRow(function(a){this.rowsAr[a].tagName=="TR"&&d.rows.push(this.rowsAr[a])});this._fixHiddenRowsAll(d,a,"display","none");this.isTreeGrid()&&this._fixHiddenRowsAllTG(a,"none");(_isOpera&&_OperaRv<9||_isKHTML||
_isFF)&&this._fixHiddenRowsAll(this.hdr,a,"display","none","_cellIndexS");this.ftr&&this._fixHiddenRowsAll(this.ftr.childNodes[0],a,"display","none");this._fixHiddenRowsAll(this.hdr,a,"whiteSpace","nowrap","_cellIndexS");if(!this.cellWidthPX.length&&!this.cellWidthPC.length)this.cellWidthPX=[].concat(this.initCellWidth);this.cellWidthPX[a]&&(this.cellWidthPX[a]=0);this.cellWidthPC[a]&&(this.cellWidthPC[a]=0)}else if(this.hdr.rows[0].cells[a]._oldWidth){var e=this.hdr.rows[0].cells[a];(_isOpera||_isKHTML||
_isFF)&&this._fixHiddenRowsAll(this.hdr,a,"display","","_cellIndexS");this.ftr&&this._fixHiddenRowsAll(this.ftr.childNodes[0],a,"display","");d={rows:[this.obj.rows[0]]};this.forEachRow(function(a){this.rowsAr[a].tagName=="TR"&&d.rows.push(this.rowsAr[a])});this._fixHiddenRowsAll(d,a,"display","");this.isTreeGrid()&&this._fixHiddenRowsAllTG(a,"");this._fixHiddenRowsAll(this.hdr,a,"whiteSpace","normal","_cellIndexS");if(e._oldWidthP)this.cellWidthPC[a]=e._oldWidthP;e._oldWidth&&(this.cellWidthPX[a]=
parseInt(e._oldWidth))}this.setSizes();if(!_isIE&&!_isFF)this.obj.border=1,this.obj.border=0},enableColSpan:function(a){this._ecspn=convertStringToBoolean(a)},enableRowsHover:function(a,c){this._unsetRowHover(!1,!0);this._hvrCss=c;if(convertStringToBoolean(a)){if(!this._elmnh)this.obj._honmousemove=this.obj.onmousemove,this.obj.onmousemove=this._setRowHover,_isIE?this.obj.onmouseleave=this._unsetRowHover:this.obj.onmouseout=this._unsetRowHover,this._elmnh=!0}else if(this._elmnh)this.obj.onmousemove=
this.obj._honmousemove,_isIE?this.obj.onmouseleave=null:this.obj.onmouseout=null,this._elmnh=!1},enableEditEvents:function(a,c,b){this._sclE=convertStringToBoolean(a);this._dclE=convertStringToBoolean(c);this._f2kE=convertStringToBoolean(b)},enableLightMouseNavigation:function(a){if(convertStringToBoolean(a)){if(!this._elmn)this.entBox._onclick=this.entBox.onclick,this.entBox.onclick=function(){return!0},this.obj._onclick=this.obj.onclick,this.obj.onclick=function(a){var b=this.grid.getFirstParentOfType(a?
a.target:event.srcElement,"TD");if(b)this.grid.editStop(),this.grid.doClick(b),this.grid.editCell(),(a||event).cancelBubble=!0},this.obj._onmousemove=this.obj.onmousemove,this.obj.onmousemove=this._autoMoveSelect,this._elmn=!0}else if(this._elmn)this.entBox.onclick=this.entBox._onclick,this.obj.onclick=this.obj._onclick,this.obj.onmousemove=this.obj._onmousemove,this._elmn=!1},_unsetRowHover:function(a,c){that=c?this:this.grid;if(that._lahRw&&that._lahRw!=c){for(var b=0;b<that._lahRw.childNodes.length;b++)that._lahRw.childNodes[b].className=
that._lahRw.childNodes[b].className.replace(that._hvrCss,"");that._lahRw=null}},_setRowHover:function(a){var c=this.grid.getFirstParentOfType(a?a.target:event.srcElement,"TD");if(c&&c.parentNode!=this.grid._lahRw){this.grid._unsetRowHover(0,c);c=c.parentNode;if(!c.idd||c.idd=="__filler__")return;for(var b=0;b<c.childNodes.length;b++)c.childNodes[b].className+=" "+this.grid._hvrCss;this.grid._lahRw=c}this._honmousemove(a)},_autoMoveSelect:function(a){if(!this.grid.editor){var c=this.grid.getFirstParentOfType(a?
a.target:event.srcElement,"TD");c.parentNode.idd&&this.grid.doClick(c,!0,0)}this._onmousemove(a)},enableDistributedParsing:function(a,c,b){convertStringToBoolean(a)?(this._ads_count=c||10,this._ads_time=b||250):this._ads_count=0},destructor:function(){this.editStop(!0);if(this._sizeTime)this._sizeTime=window.clearTimeout(this._sizeTime);this.entBox.className=(this.entBox.className||"").replace(/gridbox.*/,"");if(this.formInputs)for(var a=0;a<this.formInputs.length;a++)this.parentForm.removeChild(this.formInputs[a]);
var c;this.xmlLoader=this.xmlLoader.destructor();for(a=0;a<this.rowsCol.length;a++)if(this.rowsCol[a])this.rowsCol[a].grid=null;for(a in this.rowsAr)this.rowsAr[a]&&(this.rowsAr[a]=null);this.rowsCol=new dhtmlxArray;this.rowsAr={};this.entBox.innerHTML="";var b=function(){};this.setSizes=this._update_srnd_view=this.callEvent=this.entBox.onclick=this.entBox.onmousedown=this.entBox.onbeforeactivate=this.entBox.onbeforedeactivate=this.entBox.onbeforedeactivate=this.entBox.onselectstart=b;this.entBox.grid=
this.objBox.grid=this.hdrBox.grid=this.obj.grid=this.hdr.grid=null;if(this._fake)this.globalBox.innerHTML="",this._fake.setSizes=this._fake._update_srnd_view=this._fake.callEvent=b,this.globalBox.onclick=this.globalBox.onmousedown=this.globalBox.onbeforeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onselectstart=b;for(c in this){if(this[c]&&this[c].m_obj)this[c].m_obj=null;this[c]=null}this==globalActiveDHTMLGridObject&&(globalActiveDHTMLGridObject=null);
return null},getSortingState:function(){var a=[];if(this.fldSorted)a[0]=this.fldSorted._cellIndex,a[1]=this.sortImg.src.indexOf("sort_desc.gif")!=-1?"des":"asc";return a},enableAutoHeight:function(a,c,b){this._ahgr=convertStringToBoolean(a);this._ahgrF=convertStringToBoolean(b);this._ahgrM=c||null;if(arguments.length==1)this.objBox.style.overflowY=a?"hidden":"auto";if(c=="auto")this._ahgrM=null,this._ahgrMA=!0,this._setAutoResize()},enableStableSorting:function(a){this._sst=convertStringToBoolean(a);
this.rowsCol.stablesort=function(a){for(var b=this.length-1,d=0;d<this.length-1;d++){for(var e=0;e<b;e++)if(a(this[e],this[e+1])>0){var f=this[e];this[e]=this[e+1];this[e+1]=f}b--}}},enableKeyboardSupport:function(a){this._htkebl=!convertStringToBoolean(a)},setScrollbarWidthCorrection:function(){},enableTooltips:function(a){this._enbTts=a.split(",");for(var c=0;c<this._enbTts.length;c++)this._enbTts[c]=convertStringToBoolean(this._enbTts[c])},enableResizing:function(a){this._drsclmn=a.split(",");
for(var c=0;c<this._drsclmn.length;c++)this._drsclmn[c]=convertStringToBoolean(this._drsclmn[c])},setColumnMinWidth:function(a,c){if(arguments.length==2){if(!this._drsclmW)this._drsclmW=[];this._drsclmW[c]=a}else this._drsclmW=a.split(",")},enableCellIds:function(a){this._enbCid=convertStringToBoolean(a)},lockRow:function(a,c){var b=this.getRowById(a);if(b)b._locked=convertStringToBoolean(c),this.cell&&this.cell.parentNode.idd==a&&this.editStop()},_getRowArray:function(a){for(var c=[],b=0;b<a.childNodes.length;b++){var d=
this.cells3(a,b);c[b]=d.getValue()}return c},setDateFormat:function(a,c){this._dtmask=a;this._dtmask_inc=c},setNumberFormat:function(a,c,b,d){var e=a.replace(/[^0\,\.]*/g,""),f=e.indexOf(".");f>-1&&(f=e.length-f-1);var g=e.indexOf(",");g>-1&&(g=e.length-f-2-g);if(typeof b!="string")b=this.i18n.decimal_separator;if(typeof d!="string")d=this.i18n.group_separator;var i=a.split(e)[0],h=a.split(e)[1];this._maskArr[c]=[f,g,i,h,b,d]},_aplNFb:function(a,c){var b=this._maskArr[c];if(!b)return a;var d=parseFloat(a.toString().replace(/[^0-9]*/g,
""));a.toString().substr(0,1)=="-"&&(d*=-1);b[0]>0&&(d/=Math.pow(10,b[0]));return d},_aplNF:function(a,c){var b=this._maskArr[c];if(!b)return a;var d=(parseFloat(a)<0?"-":"")+b[2],a=Math.abs(Math.round(parseFloat(a)*Math.pow(10,b[0]>0?b[0]:0))).toString(),a=(a.length<b[0]?Math.pow(10,b[0]+1-a.length).toString().substr(1,b[0]+1)+a.toString():a).split("").reverse();a[b[0]]=(a[b[0]]||"0")+b[4];if(b[1]>0)for(var e=(b[0]>0?0:1)+b[0]+b[1];e<a.length;e+=b[1])a[e]+=b[5];return d+a.reverse().join("")+b[3]},
_launchCommands:function(a){for(var c=0;c<a.length;c++){for(var b=[],d=0;d<a[c].childNodes.length;d++)if(a[c].childNodes[d].nodeType==1)b[b.length]=a[c].childNodes[d].firstChild.data;this[a[c].getAttribute("command")].apply(this,b)}},_parseHead:function(a){var c=this.xmlLoader.doXPath("./head",a);if(c.length){var b=this.xmlLoader.doXPath("./column",c[0]),d=this.xmlLoader.doXPath("./settings",c[0]),e="setInitWidths",f=!1;if(d[0])for(var g=0;g<d[0].childNodes.length;g++)switch(d[0].childNodes[g].tagName){case "colwidth":d[0].childNodes[g].firstChild&&
d[0].childNodes[g].firstChild.data=="%"&&(e="setInitWidthsP");break;case "splitat":f=d[0].childNodes[g].firstChild?d[0].childNodes[g].firstChild.data:!1}this._launchCommands(this.xmlLoader.doXPath("./beforeInit/call",c[0]));if(b.length>0){this.hdr.rows.length>0&&this.clearAll(!0);for(var i=[[],[],[],[],[],[],[],[],[]],h=",width,type,align,sort,color,format,hidden,id".split(","),j=["",e,"setColTypes","setColAlign","setColSorting","setColumnColor","","","setColumnIds"],l=0;l<b.length;l++){for(var m=
1;m<h.length;m++)i[m].push(b[l].getAttribute(h[m]));i[0].push((b[l].firstChild?b[l].firstChild.data:"").replace(/^\s*((\s\S)*.+)\s*$/gi,"$1"))}this.setHeader(i[0]);for(l=0;l<j.length;l++)if(j[l])this[j[l]](i[l].join(this.delim));for(l=0;l<b.length;l++)if(this.cellType[l].indexOf("co")==0||this.cellType[l]=="clist"){var k=this.xmlLoader.doXPath("./option",b[l]);if(k.length){var n=[];if(this.cellType[l]=="clist"){for(m=0;m<k.length;m++)n[n.length]=k[m].firstChild?k[m].firstChild.data:"";this.registerCList(l,
n)}else for(var o=this.getCombo(l),m=0;m<k.length;m++)o.put(k[m].getAttribute("value"),k[m].firstChild?k[m].firstChild.data:"")}}else i[6][l]&&(this.cellType[l].toLowerCase().indexOf("calendar")!=-1||this.fldSort[l]=="date"?this.setDateFormat(i[6][l]):this.setNumberFormat(i[6][l],l));this.init();var p=i[7].join(this.delim);this.setColHidden&&p.replace(/,/g,"")!=""&&this.setColHidden(p);f&&this.splitAt&&this.splitAt(f)}this._launchCommands(this.xmlLoader.doXPath("./afterInit/call",c[0]))}var q=this.xmlLoader.doXPath("//rows/userdata",
a);if(q.length>0){this.UserData.gridglobaluserdata||(this.UserData.gridglobaluserdata=new Hashtable);for(m=0;m<q.length;m++){for(var r="",t=0;t<q[m].childNodes.length;t++)r+=q[m].childNodes[t].nodeValue;this.UserData.gridglobaluserdata.put(q[m].getAttribute("name"),r)}}},getCheckedRows:function(a){var c=[];this.forEachRowA(function(b){this.cells(b,a).getValue()!=0&&c.push(b)},!0);return c.join(",")},checkAll:function(){for(var a=arguments.length?arguments[0]:1,c=0;c<this.getColumnsNum();c++)this.getColType(c)==
"ch"&&this.setCheckedRows(c,a)},uncheckAll:function(){this.checkAll(0)},setCheckedRows:function(a,c){this.forEachRowA(function(b){this.cells(b,a).isCheckbox()&&this.cells(b,a).setValue(c)})},_drawTooltip:function(a){var c=this.grid.getFirstParentOfType(a?a.target:event.srcElement,"TD");if(!c||this.grid.editor&&this.grid.editor.cell==c)return!0;var b=c.parentNode;if(b.idd&&b.idd!="__filler__"){var d=a?a.target:event.srcElement;if(b.idd==window.unknown)return!0;if(!this.grid.callEvent("onMouseOver",
[b.idd,c._cellIndex,a||window.event]))return!0;if(this.grid._enbTts&&!this.grid._enbTts[c._cellIndex]){if(d.title)d.title="";return!0}if(!(c._cellIndex>=this.grid._cCount)){var e=this.grid.cells3(b,c._cellIndex);if(e&&e.cell&&e.cell._attrs){if(d._title)e.cell.title="";if(!e.cell._attrs.title)d._title=!0;if(e)d.title=e.cell._attrs.title||(e.getTitle?e.getTitle():(e.getValue()||"").toString().replace(/<[^>]*>/gi,""));return!0}}}},enableCellWidthCorrection:function(a){if(_isFF)this._wcorr=parseInt(a)},
getAllRowIds:function(a){for(var c=[],b=0;b<this.rowsBuffer.length;b++)this.rowsBuffer[b]&&c.push(this.rowsBuffer[b].idd);return c.join(a||this.delim)},getAllItemIds:function(){return this.getAllRowIds()},setColspan:function(a,c,b){if(this._ecspn){var d=this.getRowById(a);if(d._childIndexes&&d.childNodes[d._childIndexes[c]]){var e=d._childIndexes[c],f=d.childNodes[e],g=f.colSpan;f.colSpan=1;if(g&&g!=1)for(var i=1;i<g;i++){var h=document.createElement("TD");f.nextSibling?d.insertBefore(h,f.nextSibling):
d.appendChild(h);d._childIndexes[c+i]=e+i;h._cellIndex=c+i;h.style.textAlign=this.cellAlign[i];h.style.verticalAlign=this.cellVAlign[i];f=h;this.cells3(d,c+i).setValue("")}for(var j=c*1+1*g;j<d._childIndexes.length;j++)d._childIndexes[j]+=(g-1)*1}if(b&&b>1){if(d._childIndexes)e=d._childIndexes[c];else{e=c;d._childIndexes=[];for(j=0;j<d.childNodes.length;j++)d._childIndexes[j]=j}d.childNodes[e].colSpan=b;for(j=1;j<b;j++)d._childIndexes[d.childNodes[e+1]._cellIndex]=e,d.removeChild(d.childNodes[e+1]);
for(var l=d.childNodes[d._childIndexes[c]]._cellIndex,j=l*1+1*b;j<d._childIndexes.length;j++)d._childIndexes[j]-=b-1}}},preventIECaching:function(a){this.no_cashe=convertStringToBoolean(a);this.xmlLoader.rSeed=this.no_cashe},enableColumnAutoSize:function(a){this._eCAS=convertStringToBoolean(a)},_onHeaderDblClick:function(a){var c=this.grid,b=c.getFirstParentOfType(_isIE?event.srcElement:a.target,"TD");if(!c._eCAS)return!1;c.adjustColumnSize(b._cellIndexS)},adjustColumnSize:function(a,c){if(!this._hrrar||
!this._hrrar[a]){this._notresize=!0;var b=0;this._setColumnSizeR(a,20);for(var d=1;d<this.hdr.rows.length;d++){var e=this.hdr.rows[d];if((e=e.childNodes[e._childIndexes?e._childIndexes[a]:a])&&(!e.colSpan||e.colSpan<2)&&e._cellIndex==a)e.childNodes[0]&&e.childNodes[0].className=="hdrcell"&&(e=e.childNodes[0]),b=Math.max(b,e.scrollWidth)}for(var f=this.obj.rows.length,g=1;g<f;g++){var i=this.obj.rows[g];this.rowsAr[i.idd]&&!(i._childIndexes&&i._childIndexes[a]!=a)&&i.childNodes[a]&&(i=_isFF||_isOpera||
c?i.childNodes[a].textContent.length*this.fontWidth:i.childNodes[a].scrollWidth,i>b&&(b=i))}b+=20+(c||0);this._setColumnSizeR(a,b);this._notresize=!1;this.setSizes()}},detachHeader:function(a,c){var c=c||this.hdr,b=c.rows[a+1];b&&b.parentNode.removeChild(b);this.setSizes()},detachFooter:function(a){this.detachHeader(a,this.ftr)},attachHeader:function(a,c,b){typeof a=="string"&&(a=this._eSplit(a));typeof c=="string"&&(c=c.split(this.delim));b=b||"_aHead";if(this.hdr.rows.length)if(a)this._createHRow([a,
c],this[b=="_aHead"?"hdr":"ftr"]);else{if(this[b])for(var d=0;d<this[b].length;d++)this.attachHeader.apply(this,this[b][d])}else this[b]||(this[b]=[]),this[b][this[b].length]=[a,c,b]},_createHRow:function(a,c){if(!c){if(this.entBox.style.position!="absolute")this.entBox.style.position="relative";var b=document.createElement("DIV");b.className="ftr";this.entBox.appendChild(b);var d=document.createElement("TABLE");d.cellPadding=d.cellSpacing=0;if(!_isIE||_isIE==8)d.width="100%",d.style.paddingRight=
"20px";d.style.marginRight="20px";d.style.tableLayout="fixed";b.appendChild(d);d.appendChild(document.createElement("TBODY"));this.ftr=c=d;for(var e=d.insertRow(0),f=this.hdrLabels.length<=1?a[0].length:this.hdrLabels.length,g=0;g<f;g++)e.appendChild(document.createElement("TH")),e.childNodes[g]._cellIndex=g;_isIE&&_isIE<8?e.style.position="absolute":e.style.height="auto"}var i=a[1],b=document.createElement("TR");c.rows[0].parentNode.appendChild(b);for(g=0;g<a[0].length;g++)if(a[0][g]=="#cspan"){var h=
b.cells[b.cells.length-1];h.colSpan=(h.colSpan||1)+1}else if(a[0][g]=="#rspan"&&c.rows.length>1){for(var j=c.rows.length-2,l=!1,h=null;!l;){for(var h=c.rows[j],m=0;m<h.cells.length;m++)if(h.cells[m]._cellIndex==g){l=m+1;break}j--}h=h.cells[l-1];h.rowSpan=(h.rowSpan||1)+1}else{var k=document.createElement("TD");k._cellIndex=k._cellIndexS=g;if(this._hrrar&&this._hrrar[g]&&!_isIE)k.style.display="none";if(typeof a[0][g]=="object")k.appendChild(a[0][g]);else if(k.innerHTML=this.forceDivInHeader?"<div class='hdrcell'>"+
(a[0][g]||"&nbsp;")+"</div>":a[0][g]||"&nbsp;",(a[0][g]||"").indexOf("#")!=-1)if(d=a[0][g].match(/(^|{)#([^}]+)(}|$)/)){var n="_in_header_"+d[2];if(this[n])this[n](this.forceDivInHeader?k.firstChild:k,g,a[0][g].split(d[0]))}if(i)k.style.cssText=i[g];b.appendChild(k)}var o=c;if(_isKHTML)c._kTimer&&window.clearTimeout(c._kTimer),c._kTimer=window.setTimeout(function(){c.rows[1].style.display="none";window.setTimeout(function(){c.rows[1].style.display=""},1)},500)},attachFooter:function(a,c){this.attachHeader(a,
c,"_aFoot")},setCellExcellType:function(a,c,b){this.changeCellType(this.getRowById(a),c,b)},changeCellType:function(a,c,b){var b=b||this.cellType[c],d=this.cells3(a,c),e=d.getValue();d.cell._cellType=b;d=this.cells3(a,c);d.setValue(e)},setRowExcellType:function(a,c){for(var b=this.rowsAr[a],d=0;d<b.childNodes.length;d++)this.changeCellType(b,d,c)},setColumnExcellType:function(a,c){for(var b=0;b<this.rowsBuffer.length;b++)this.rowsBuffer[b]&&this.rowsBuffer[b].tagName=="TR"&&this.changeCellType(this.rowsBuffer[b],
a,c);this.cellType[a]=="math"?this._strangeParams[b]=c:this.cellType[a]=c},forEachRow:function(a){for(var c in this.rowsAr)this.rowsAr[c]&&this.rowsAr[c].idd&&a.apply(this,[this.rowsAr[c].idd])},forEachRowA:function(a){for(var c=0;c<this.rowsBuffer.length;c++)this.rowsBuffer[c]&&a.call(this,this.render_row(c).idd)},forEachCell:function(a,c){var b=this.getRowById(a);if(b)for(var d=0;d<this._cCount;d++)c(this.cells3(b,d),d)},enableAutoWidth:function(a,c,b){this._awdth=[convertStringToBoolean(a),parseInt(c||
99999),parseInt(b||0)];if(arguments.length==1)this.objBox.style.overflowX=a?"hidden":"auto"},updateFromXML:function(a,c,b,d){typeof c=="undefined"&&(c=!0);this._refresh_mode=[!0,c,b];this.load(a,d)},_refreshFromXML:function(a){this._f_rowsBuffer&&this.filterBy(0,"");reset=!1;if(window.eXcell_tree)eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue,eXcell_tree.prototype.setValue=function(a){var b=this.grid._h2.get[this.cell.parentNode.idd];b&&this.cell.parentNode.valTag?this.setLabel(a):
this.setValueX(a)};var c=this.cellType._dhx_find("tree");a.getXMLTopNode("rows");var b=a.doXPath("//rows")[0].getAttribute("parent")||0,d={};this._refresh_mode[2]&&(c!=-1?this._h2.forEachChild(b,function(a){d[a.id]=!0},this):this.forEachRow(function(a){d[a]=!0}));for(var e=a.doXPath("//row"),f=0;f<e.length;f++){var g=e[f],i=g.getAttribute("id");d[i]=!1;b=g.parentNode.getAttribute("id")||b;if(this.rowsAr[i]&&this.rowsAr[i].tagName!="TR")this._h2?this._h2.get[i].buff.data=g:this.rowsBuffer[this.getRowIndex(i)].data=
g,this.rowsAr[i]=g;else if(this.rowsAr[i])this._process_xml_row(this.rowsAr[i],g,-1),this._postRowProcessing(this.rowsAr[i],!0);else if(this._refresh_mode[1]){var h={idd:i,data:g,_parser:this._process_xml_row,_locator:this._get_xml_data},j=this.rowsBuffer.length;this._refresh_mode[1]=="top"?(this.rowsBuffer.unshift(h),j=0):this.rowsBuffer.push(h);if(this._h2)reset=!0,this._h2.add(i,g.parentNode.getAttribute("id")||g.parentNode.getAttribute("parent")).buff=this.rowsBuffer[this.rowsBuffer.length-1];
this.rowsAr[i]=g;g=this.render_row(j);this._insertRowAt(g,j?-1:0)}}if(this._refresh_mode[2])for(i in d)d[i]&&this.rowsAr[i]&&this.deleteRow(i);this._refresh_mode=null;if(window.eXcell_tree)eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX;reset&&this._renderSort();if(this._f_rowsBuffer)this._f_rowsBuffer=null,this.filterByAll()},setTabOrder:function(a){var c=a.split(this.delim);this._tabOrder=[];for(var b=this._cCount||a.length,d=0;d<b;d++)c[d]={c:parseInt(c[d]),ind:d};c.sort(function(a,
b){return a.c>b.c?1:-1});for(d=0;d<b;d++)this._tabOrder[c[d].ind]=!c[d+1]||typeof c[d].c=="undefined"?(c[0].ind+1)*-1:c[d+1].ind},i18n:{loading:"Loading",decimal_separator:".",group_separator:","},_key_events:{k13_1_0:function(){var a=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[a+1],this.cell._cellIndex,!0)},k13_0_1:function(){var a=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[a-1],this.cell._cellIndex,!0)},k13_0_0:function(){this.editStop();this.callEvent("onEnter",
[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},k9_0_0:function(){this.editStop();if(!this.callEvent("onTab",[!0]))return!0;var a=this._getNextCell(null,1);if(a)this.selectCell(a.parentNode,a._cellIndex,this.row!=a.parentNode,!1,!0),this._still_active=!0},k9_0_1:function(){this.editStop();if(!this.callEvent("onTab",[!1]))return!1;var a=this._getNextCell(null,-1);if(a)this.selectCell(a.parentNode,a._cellIndex,this.row!=a.parentNode,!1,!0),this._still_active=
!0},k113_0_0:function(){this._f2kE&&this.editCell()},k32_0_0:function(){var a=this.cells4(this.cell);if(!a.changeState||a.changeState()===!1)return!1},k27_0_0:function(){this.editStop(!0)},k33_0_0:function(){this.pagingOn?this.changePage(this.currentPage-1):this.scrollPage(-1)},k34_0_0:function(){this.pagingOn?this.changePage(this.currentPage+1):this.scrollPage(1)},k37_0_0:function(){if(!this.editor&&this.isTreeGrid())this.collapseKids(this.row);else return!1},k39_0_0:function(){if(!this.editor&&
this.isTreeGrid())this.expandKids(this.row);else return!1},k40_0_0:function(){var a=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftNext();else{if(!this.row.idd)return;var c=Math.max(a._r_select||0,this.getRowIndex(this.row.idd)),b=this._nextRow(c,1);if(b)a._r_select=null,this.selectCell(b,this.cell._cellIndex,!0),a.pagingOn&&a.showRow(b.idd);else{if(!this.callEvent("onLastRow",[]))return!1;this._key_events.k34_0_0.apply(this,[]);this.pagingOn&&this.rowsCol[c+1]&&
this.selectCell(c+1,0,!0)}}this._still_active=!0},k38_0_0:function(){var a=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftPrev();else{if(!this.row.idd)return;var c=this.getRowIndex(this.row.idd)+1;if(c!=-1&&(!this.pagingOn||c!=1)){var b=this._nextRow(c-1,-1);this.selectCell(b,this.cell._cellIndex,!0);a.pagingOn&&b&&a.showRow(b.idd)}else this._key_events.k33_0_0.apply(this,[])}this._still_active=!0}},_build_master_row:function(){for(var a=document.createElement("DIV"),
c=["<table><tr>"],b=0;b<this._cCount;b++)c.push("<td></td>");c.push("</tr></table>");a.innerHTML=c.join("");this._master_row=a.firstChild.rows[0]},_prepareRow:function(a){this._master_row||this._build_master_row();for(var c=this._master_row.cloneNode(!0),b=0;b<c.childNodes.length;b++){c.childNodes[b]._cellIndex=b;if(this._enbCid)c.childNodes[b].id="c_"+a+"_"+b;this.dragAndDropOff&&this.dragger.addDraggableItem(c.childNodes[b],this)}c.idd=a;c.grid=this;return c},_process_jsarray_row:function(a,c){a._attrs=
{};for(var b=0;b<a.childNodes.length;b++)a.childNodes[b]._attrs={};this._fillRow(a,this._c_order?this._swapColumns(c):c);return a},_get_jsarray_data:function(a,c){return a[c]},_process_json_row:function(a,c){c=this._c_order?this._swapColumns(c.data):c.data;return this._process_some_row(a,c)},_process_some_row:function(a,c){a._attrs={};for(var b=0;b<a.childNodes.length;b++)a.childNodes[b]._attrs={};this._fillRow(a,c);return a},_get_json_data:function(a,c){return a.data[c]},_process_js_row:function(a,
c){for(var b=[],d=0;d<this.columnIds.length;d++)b[d]=c[this.columnIds[d]],!b[d]&&b[d]!==0&&(b[d]="");this._process_some_row(a,b);a._attrs=c;return a},_get_js_data:function(a,c){return a[this.columnIds[c]]},_process_csv_row:function(a,c){a._attrs={};for(var b=0;b<a.childNodes.length;b++)a.childNodes[b]._attrs={};this._fillRow(a,this._c_order?this._swapColumns(c.split(this.csv.cell)):c.split(this.csv.cell));return a},_get_csv_data:function(a,c){return a.split(this.csv.cell)[c]},_process_store_row:function(a,
c){for(var b=[],d=0;d<this.columnIds.length;d++)b[d]=c[this.columnIds[d]];for(var e=0;e<a.childNodes.length;e++)a.childNodes[e]._attrs={};a._attrs=c;this._fillRow(a,b)},_process_xml_row:function(a,c){var b=this.xmlLoader.doXPath(this.xml.cell,c),d=[];a._attrs=this._xml_attrs(c);if(this._ud_enabled)for(var e=this.xmlLoader.doXPath("./userdata",c),f=e.length-1;f>=0;f--){for(var g="",i=0;i<e[f].childNodes.length;i++)g+=e[f].childNodes[i].nodeValue;this.setUserData(a.idd,e[f].getAttribute("name"),g)}for(i=
0;i<b.length;i++){var h=b[this._c_order?this._c_order[i]:i];if(h){var j=a._childIndexes?a._childIndexes[i]:i,l=h.getAttribute("type");if(a.childNodes[j]){if(l)a.childNodes[j]._cellType=l;a.childNodes[j]._attrs=this._xml_attrs(h)}h.getAttribute("xmlcontent")||(h=h.firstChild?h.firstChild.data:"");d.push(h)}}for(;i<a.childNodes.length;i++)a.childNodes[i]._attrs={};a.parentNode&&a.parentNode.tagName=="row"&&(a._attrs.parent=a.parentNode.getAttribute("idd"));this._fillRow(a,d);return a},_get_xml_data:function(a,
c){for(a=a.firstChild;;){if(!a)return"";a.tagName=="cell"&&c--;if(c<0)break;a=a.nextSibling}return a.firstChild?a.firstChild.data:""},_fillRow:function(a,c){this.editor&&this.editStop();for(var b=0;b<a.childNodes.length;b++)if(b<c.length||this.defVal[b]){var d=a.childNodes[b]._cellIndex,e=c[d],f=this.cells4(a.childNodes[b]);if(this.defVal[d]&&(e==""||typeof e=="undefined"))e=this.defVal[d];f&&f.setValue(e)}else a.childNodes[b].innerHTML="&nbsp;",a.childNodes[b]._clearCell=!0;return a},_postRowProcessing:function(a,
c){if(a._attrs["class"])a._css=a.className=a._attrs["class"];if(a._attrs.locked)a._locked=!0;if(a._attrs.bgColor)a.bgColor=a._attrs.bgColor;for(var b=0,d=0;d<a.childNodes.length;d++){var e=a.childNodes[d],f=e._cellIndex,g=e._attrs.style||a._attrs.style;g&&(e.style.cssText+=";"+g);if(e._attrs["class"])e.className=e._attrs["class"];if(g=e._attrs.align||this.cellAlign[f])e.align=g;e.vAlign=e._attrs.valign||this.cellVAlign[f];var i=e._attrs.bgColor||this.columnColor[f];if(i)e.bgColor=i;e._attrs.colspan&&
!c&&(this.setColspan(a.idd,d+b,e._attrs.colspan),b+=e._attrs.colspan-1);if(this._hrrar&&this._hrrar[f]&&!c)e.style.display="none"}this.callEvent("onRowCreated",[a.idd,a,null])},load:function(a,c,b){this.callEvent("onXLS",[this]);arguments.length==2&&typeof c!="function"&&(b=c,c=null);b=b||"xml";if(!this.xmlFileUrl)this.xmlFileUrl=a;this._data_type=b;this.xmlLoader.onloadAction=function(a,e,f,g,i){a.callEvent&&(i=a["_process_"+b](i),a._contextCallTimer||a.callEvent("onXLE",[a,0,0,i]),c&&(c(),c=null))};
this.xmlLoader.loadXML(a)},loadXMLString:function(a,c){var b=new dtmlXMLLoaderObject(function(){});b.loadXMLString(a);this.parse(b,c,"xml")},loadXML:function(a,c){this.load(a,c,"xml")},parse:function(a,c,b){arguments.length==2&&typeof c!="function"&&(b=c,c=null);this._data_type=b=b||"xml";a=this["_process_"+b](a);this._contextCallTimer||this.callEvent("onXLE",[this,0,0,a]);c&&c()},xml:{top:"rows",row:"./row",cell:"./cell",s_row:"row",s_cell:"cell",row_attrs:[],cell_attrs:[]},csv:{row:"\n",cell:","},
_xml_attrs:function(a){var c={};if(a.attributes.length)for(var b=0;b<a.attributes.length;b++)c[a.attributes[b].name]=a.attributes[b].value;return c},_process_xml:function(a){if(!a.doXPath){var c=new dtmlXMLLoaderObject(function(){});typeof a=="string"?c.loadXMLString(a):(c.xmlDoc=a.responseXML?a:{},c.xmlDoc.responseXML=a);a=c}if(this._refresh_mode)return this._refreshFromXML(a);this._parsing=!0;var b=a.getXMLTopNode(this.xml.top);if(b.tagName==this.xml.top){var d=b.getAttribute("dhx_security");if(d)dhtmlx.security_key=
d;this._parseHead(b);var e=a.doXPath(this.xml.row,b),f=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0),g=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0),i=!1;g&&g!=this.rowsBuffer.length&&(this.rowsBuffer[g-1]||(this.rowsBuffer.length&&(i=!0),this.rowsBuffer[g-1]=null),g<this.rowsBuffer.length&&(this.rowsBuffer.splice(g,this.rowsBuffer.length-g),i=!0));if(this.isTreeGrid())return this._process_tree_xml(a);for(var h=0;h<e.length;h++)if(!this.rowsBuffer[h+f]){var j=
e[h].getAttribute("id")||h+f+1;this.rowsBuffer[h+f]={idd:j,data:e[h],_parser:this._process_xml_row,_locator:this._get_xml_data};this.rowsAr[j]=e[h]}this.callEvent("onDataReady",[]);if(i&&this._srnd){var l=this.objBox.scrollTop;this._reset_view();this.objBox.scrollTop=l}else this.render_dataset();this._parsing=!1;return a.xmlDoc.responseXML?a.xmlDoc.responseXML:a.xmlDoc}},_process_jsarray:function(a){this._parsing=!0;if(a&&a.xmlDoc)eval("dhtmlx.temp="+a.xmlDoc.responseText+";"),a=dhtmlx.temp;for(var c=
0;c<a.length;c++){var b=c+1;this.rowsBuffer.push({idd:b,data:a[c],_parser:this._process_jsarray_row,_locator:this._get_jsarray_data});this.rowsAr[b]=a[c]}this.render_dataset();this._parsing=!1},_process_csv:function(a){this._parsing=!0;if(a.xmlDoc)a=a.xmlDoc.responseText;a=a.replace(/\r/g,"");a=a.split(this.csv.row);if(this._csvHdr){this.clearAll();var c=a.splice(0,1)[0].split(this.csv.cell);this._csvAID||c.splice(0,1);this.setHeader(c.join(this.delim));this.init()}for(var b=0;b<a.length;b++)if(a[b]||
b!=a.length-1){if(this._csvAID){var d=b+1;this.rowsBuffer.push({idd:d,data:a[b],_parser:this._process_csv_row,_locator:this._get_csv_data})}else{var e=a[b].split(this.csv.cell),d=e.splice(0,1)[0];this.rowsBuffer.push({idd:d,data:e,_parser:this._process_jsarray_row,_locator:this._get_jsarray_data})}this.rowsAr[d]=a[b]}this.render_dataset();this._parsing=!1},_process_js:function(a){return this._process_json(a,"js")},_process_json:function(a,c){this._parsing=!0;if(a&&a.xmlDoc)eval("dhtmlx.temp="+a.xmlDoc.responseText+
";"),a=dhtmlx.temp;if(c=="js"){if(a.data)a=a.data;for(var b=0;b<a.length;b++){var d=a[b],e=d.id||b+1;this.rowsBuffer.push({idd:e,data:d,_parser:this._process_js_row,_locator:this._get_js_data});this.rowsAr[e]=a[b]}}else for(b=0;b<a.rows.length;b++)e=a.rows[b].id,this.rowsBuffer.push({idd:e,data:a.rows[b],_parser:this._process_json_row,_locator:this._get_json_data}),this.rowsAr[e]=a.rows[b];if(a.dhx_security)dhtmlx.security_key=a.dhx_security;this.render_dataset();this._parsing=!1},render_dataset:function(a,
c){if(this._srnd){if(this._fillers)return this._update_srnd_view();c=Math.min(this._get_view_size()+(this._srnd_pr||0),this.rowsBuffer.length)}this.pagingOn?(a=Math.max(a||0,(this.currentPage-1)*this.rowsBufferOutSize),c=Math.min(this.currentPage*this.rowsBufferOutSize,this.rowsBuffer.length)):(a=a||0,c=c||this.rowsBuffer.length);for(var b=a;b<c;b++){var d=this.render_row(b);if(d==-1){if(this.xmlFileUrl&&this.callEvent("onDynXLS",[b,this._dpref?this._dpref:c-b]))this.load(this.xmlFileUrl+getUrlSymbol(this.xmlFileUrl)+
"posStart="+b+"&count="+(this._dpref?this._dpref:c-b),this._data_type);c=b;break}if(!d.parentNode||!d.parentNode.tagName)if(this._insertRowAt(d,b),d._attrs.selected||d._attrs.select)this.selectRow(d,d._attrs.call?!0:!1,!0),d._attrs.selected=d._attrs.select=null;if(this._ads_count&&b-a==this._ads_count){var e=this;this._context_parsing=this._context_parsing||this._parsing;return this._contextCallTimer=window.setTimeout(function(){e._contextCallTimer=null;e.render_dataset(b,c);if(!e._contextCallTimer)e._context_parsing?
e.callEvent("onXLE",[]):e._fixAlterCss(),e.callEvent("onDistributedEnd",[]),e._context_parsing=!1},this._ads_time)}}if(this._srnd&&!this._fillers){var f=this.rowsBuffer.length-c;for(this._fillers=[];f>0;){var g=_isIE||window._FFrv?Math.min(f,5E4):f,i=this._add_filler(c,g);i&&this._fillers.push(i);f-=g;c+=g}}this.setSizes()},render_row:function(a){if(!this.rowsBuffer[a])return-1;if(this.rowsBuffer[a]._parser){var c=this.rowsBuffer[a];if(this.rowsAr[c.idd]&&this.rowsAr[c.idd].tagName=="TR")return this.rowsBuffer[a]=
this.rowsAr[c.idd];var b=this._prepareRow(c.idd);this.rowsBuffer[a]=b;this.rowsAr[c.idd]=b;c._parser.call(this,b,c.data);this._postRowProcessing(b);return b}return this.rowsBuffer[a]},_get_cell_value:function(a,c,b){return a._locator?(this._c_order&&(c=this._c_order[c]),a._locator.call(this,a.data,c)):this.cells3(a,c)[b?b:"getValue"]()},sortRows:function(a,c,b){b=(b||"asc").toLowerCase();c=c||this.fldSort[a];a=a||0;if(this.isTreeGrid())this.sortTreeRows(a,c,b);else{var d={},e=this.cellType[a],f="getValue";
e=="link"&&(f="getContent");if(e=="dhxCalendar"||e=="dhxCalendarA")f="getDate";for(var g=0;g<this.rowsBuffer.length;g++)d[this.rowsBuffer[g].idd]=this._get_cell_value(this.rowsBuffer[g],a,f);this._sortRows(a,c,b,d)}this.callEvent("onAfterSorting",[a,c,b])},_sortCore:function(a,c,b,d,e){var f="sort";if(this._sst)e.stablesort=this.rowsCol.stablesort,f="stablesort";c.length>4&&(c=window[c]);if(c=="cus"){var g=this._customSorts[a];e[f](function(a,c){return g(d[a.idd],d[c.idd],b,a.idd,c.idd)})}else if(typeof c==
"function")e[f](function(a,e){return c(d[a.idd],d[e.idd],b,a.idd,e.idd)});else if(c=="str")e[f](function(a,c){return b=="asc"?d[a.idd]>d[c.idd]?1:-1:d[a.idd]<d[c.idd]?1:-1});else if(c=="int")e[f](function(a,c){var e=parseFloat(d[a.idd]),e=isNaN(e)?-99999999999999:e,g=parseFloat(d[c.idd]),g=isNaN(g)?-99999999999999:g;return b=="asc"?e-g:g-e});else if(c=="date")e[f](function(a,c){var e=Date.parse(d[a.idd])||Date.parse("01/01/1900"),g=Date.parse(d[c.idd])||Date.parse("01/01/1900");return b=="asc"?e-
g:g-e})},_sortRows:function(a,c,b,d){this._sortCore(a,c,b,d,this.rowsBuffer);this._reset_view();this.callEvent("onGridReconstructed",[])},_reset_view:function(a){if(this.obj.rows[0]){this._lahRw&&this._unsetRowHover(0,!0);this.callEvent("onResetView",[]);var c=this.obj.rows[0].parentNode,b=c.removeChild(c.childNodes[0],!0);if(_isKHTML)for(var d=c.parentNode.childNodes.length-1;d>=0;d--)c.parentNode.childNodes[d].tagName=="TR"&&c.parentNode.removeChild(c.parentNode.childNodes[d],!0);else if(_isIE)for(d=
c.childNodes.length-1;d>=0;d--)c.childNodes[d].removeNode(!0);else c.innerHTML="";c.appendChild(b);this.rowsCol=dhtmlxArray();this._sst&&this.enableStableSorting(!0);this._fillers=this.undefined;a||this.render_dataset()}},deleteRow:function(a,c){c||(c=this.getRowById(a));if(c){this.editStop();if(!this._realfake&&this.callEvent("onBeforeRowDeleted",[a])==!1)return!1;var b=0;if(this.cellType._dhx_find("tree")!=-1&&!this._realfake)b=this._h2.get[a].parent.id,this._removeTrGrRow(c);else{c.parentNode&&
c.parentNode.removeChild(c);var d=this.rowsCol._dhx_find(c);d!=-1&&this.rowsCol._dhx_removeAt(d);for(var e=0;e<this.rowsBuffer.length;e++)if(this.rowsBuffer[e]&&this.rowsBuffer[e].idd==a){this.rowsBuffer._dhx_removeAt(e);d=e;break}}this.rowsAr[a]=null;for(e=0;e<this.selectedRows.length;e++)this.selectedRows[e].idd==a&&this.selectedRows._dhx_removeAt(e);if(this._srnd){for(e=0;e<this._fillers.length;e++){var f=this._fillers[e];f&&this._update_fillers(e,f[1]>=d?-1:0,f[0]>=d?-1:0)}this._update_srnd_view()}this.pagingOn&&
this.changePage();this._realfake||this.callEvent("onAfterRowDeleted",[a,b]);this.callEvent("onGridReconstructed",[]);this._ahgr&&this.setSizes();return!0}},_addRow:function(a,c,b){if(b==-1||typeof b=="undefined")b=this.rowsBuffer.length;typeof c=="string"&&(c=c.split(this.delim));var d=this._prepareRow(a);d._attrs={};for(var e=0;e<d.childNodes.length;e++)d.childNodes[e]._attrs={};this.rowsAr[d.idd]=d;if(this._h2)this._h2.get[d.idd].buff=d;this._fillRow(d,c);this._postRowProcessing(d);if(this._skipInsert)return this._skipInsert=
!1,this.rowsAr[d.idd]=d;if(this.pagingOn)return this.rowsBuffer._dhx_insertAt(b,d),this.rowsAr[d.idd]=d;if(this._fillers){this.rowsCol._dhx_insertAt(b,null);this.rowsBuffer._dhx_insertAt(b,d);this._fake&&this._fake.rowsCol._dhx_insertAt(b,null);this.rowsAr[d.idd]=d;for(var f=!1,g=0;g<this._fillers.length;g++){var i=this._fillers[g];if(i&&i[0]<=b&&i[0]+i[1]>=b){i[1]+=1;var h=i[2].firstChild.style.height=parseInt(i[2].firstChild.style.height)+this._srdh+"px",f=!0;if(this._fake)this._fake._fillers[g][1]++,
this._fake._fillers[g][2].firstChild.style.height=h}i&&i[0]>b&&(i[0]+=1,this._fake&&this._fake._fillers[g][0]++)}f||this._fillers.push(this._add_filler(b,1,b==0?{parentNode:this.obj.rows[0].parentNode,nextSibling:this.rowsCol[1]}:this.rowsCol[b-1]));return d}this.rowsBuffer._dhx_insertAt(b,d);return this._insertRowAt(d,b)},addRow:function(a,c,b){var d=this._addRow(a,c,b);this.dragContext||this.callEvent("onRowAdded",[a]);this.pagingOn&&this.changePage(this.currentPage);this._srnd&&this._update_srnd_view();
d._added=!0;this._ahgr&&this.setSizes();this.callEvent("onGridReconstructed",[]);return d},_insertRowAt:function(a,c,b){this.rowsAr[a.idd]=a;if(this._skipInsert)return this._skipInsert=!1,a;if(c<0||!c&&parseInt(c)!==0)c=this.rowsCol.length;else if(c>this.rowsCol.length)c=this.rowsCol.length;if(this._cssEven){var d=a.className.replace(this._cssUnEven,"");a.className+=(this._cssSP?this.getLevel(a.idd):c)%2==1?d+" "+this._cssUnEven+(this._cssSU?" "+this._cssUnEven+"_"+this.getLevel(a.idd):""):d+" "+
this._cssEven+(this._cssSU?" "+this._cssEven+"_"+this.getLevel(a.idd):"")}b||(c==this.obj.rows.length-1||!this.rowsCol[c]?_isKHTML?this.obj.appendChild(a):this.obj.firstChild.appendChild(a):this.rowsCol[c].parentNode.insertBefore(a,this.rowsCol[c]));this.rowsCol._dhx_insertAt(c,a);this.callEvent("onRowInserted",[a,c]);return a},getRowById:function(a){var c=this.rowsAr[a];if(c){if(c.tagName!="TR"){for(var b=0;b<this.rowsBuffer.length;b++)if(this.rowsBuffer[b]&&this.rowsBuffer[b].idd==a)return this.render_row(b);
if(this._h2)return this.render_row(null,c.idd)}return c}return null},cellById:function(a,c){return this.cells(a,c)},cells:function(a,c){if(arguments.length==0)return this.cells4(this.cell);else var b=this.getRowById(a);var d=b._childIndexes?b.childNodes[b._childIndexes[c]]:b.childNodes[c];!d&&b._childIndexes&&(d=b.firstChild||{});return this.cells4(d)},cellByIndex:function(a,c){return this.cells2(a,c)},cells2:function(a,c){var b=this.render_row(a),d=b._childIndexes?b.childNodes[b._childIndexes[c]]:
b.childNodes[c];!d&&b._childIndexes&&(d=b.firstChild||{});return this.cells4(d)},cells3:function(a,c){var b=a._childIndexes?a.childNodes[a._childIndexes[c]]:a.childNodes[c];return this.cells4(b)},cells4:function(a){var c=window["eXcell_"+(a._cellType||this.cellType[a._cellIndex])];if(c)return new c(a)},cells5:function(a,c){c=c||a._cellType||this.cellType[a._cellIndex];if(!this._ecache[c]){var b=window["eXcell_"+c]?window["eXcell_"+c]:eXcell_ro;this._ecache[c]=new b(a)}this._ecache[c].cell=a;return this._ecache[c]},
dma:function(a){if(!this._ecache)this._ecache={};if(a&&!this._dma)this._dma=this.cells4,this.cells4=this.cells5;else if(!a&&this._dma)this.cells4=this._dma,this._dma=null},getRowsNum:function(){return this.rowsBuffer.length},enableEditTabOnly:function(a){this.smartTabOrder=arguments.length>0?convertStringToBoolean(a):!0},setExternalTabOrder:function(a,c){var b=this;this.tabStart=typeof a=="object"?a:document.getElementById(a);var d=this.tabStart.onkeydown;this.tabStart.onkeydown=function(a){d&&d.call(this,
a);var c=a||window.event;if(c.keyCode==9&&!c.shiftKey)return c.cancelBubble=!0,b.selectCell(0,0,0,0,1),b.smartTabOrder&&b.cells2(0,0).isDisabled()&&b._key_events.k9_0_0.call(b),this.blur(),!1};if(_isOpera)this.tabStart.onkeypress=this.tabStart.onkeydown;this.tabEnd=typeof c=="object"?c:document.getElementById(c);var e=this.tabEnd.onkeydown;this.tabEnd.onkeydown=this.tabEnd.onkeypress=function(a){e&&e.call(this,a);var c=a||window.event;if(c.keyCode==9&&c.shiftKey)return c.cancelBubble=!0,b.selectCell(b.getRowsNum()-
1,b.getColumnCount()-1,0,0,1),b.smartTabOrder&&b.cells2(b.getRowsNum()-1,b.getColumnCount()-1).isDisabled()&&b._key_events.k9_0_1.call(b),this.blur(),!1};if(_isOpera)this.tabEnd.onkeypress=this.tabEnd.onkeydown},uid:function(){if(!this._ui_seed)this._ui_seed=(new Date).valueOf();return this._ui_seed++},clearAndLoad:function(){var a=this._pgn_skin;this._pgn_skin=null;this.clearAll();this._pgn_skin=a;this.load.apply(this,arguments)},getStateOfView:function(){if(this.pagingOn){var a=(this.currentPage-
1)*this.rowsBufferOutSize;return[this.currentPage,a,Math.min(a+this.rowsBufferOutSize,this.rowsBuffer.length),this.rowsBuffer.length]}return[Math.floor(this.objBox.scrollTop/this._srdh),Math.ceil(parseInt(this.objBox.offsetHeight)/this._srdh),this.rowsBuffer.length]}};
(function(){function a(a,b){this[a]=b}function c(a,b){this[a].call(this,b)}function b(a,b){this[a].call(this,b.join(this.delim))}function d(a,b){for(var c=0;c<b.length;c++)if(typeof b[c]=="object"){var d=this.getCombo(c),e;for(e in b[c])d.put(e,b[c][e])}}function e(a,b){function c(a,b,d){e[b]||(e[b]=[]);if(typeof d=="object")d.toString=function(){return this.text};e[b][a]=d}for(var d=1,e=[],f=0;f<b.length;f++)if(typeof b[f]=="object"&&b[f].length)for(var k=0;k<b[f].length;k++)c(f,k,b[f][k]);else c(f,
0,b[f]);for(f=0;f<e.length;f++)for(k=0;k<e[0].length;k++){var n=e[f][k];e[f][k]=(n||"").toString()||"&nbsp;";if(n&&n.colspan)for(var o=1;o<n.colspan;o++)c(k+o,f,"#cspan");if(n&&n.rowspan)for(o=1;o<n.rowspan;o++)c(k,f+o,"#rspan")}this.setHeader(e[0]);for(f=1;f<e.length;f++)this.attachHeader(e[f])}var f=[{name:"label",def:"&nbsp;",operation:"setHeader",type:e},{name:"id",def:"",operation:"columnIds",type:a},{name:"width",def:"*",operation:"setInitWidths",type:b},{name:"align",def:"left",operation:"cellAlign",
type:a},{name:"valign",def:"middle",operation:"cellVAlign",type:a},{name:"sort",def:"na",operation:"fldSort",type:a},{name:"type",def:"ro",operation:"setColTypes",type:b},{name:"options",def:"",operation:"",type:d}];dhtmlx.extend_api("dhtmlXGridObject",{_init:function(a){return[a.parent]},image_path:"setImagePath",columns:"columns",rows:"rows",headers:"headers",skin:"setSkin",smart_rendering:"enableSmartRendering",css:"enableAlterCss",auto_height:"enableAutoHeight",save_hidden:"enableAutoHiddenColumnsSaving",
save_cookie:"enableAutoSaving",save_size:"enableAutoSizeSaving",auto_width:"enableAutoWidth",block_selection:"enableBlockSelection",csv_id:"enableCSVAutoID",csv_header:"enableCSVHeader",cell_ids:"enableCellIds",colspan:"enableColSpan",column_move:"enableColumnMove",context_menu:"enableContextMenu",distributed:"enableDistributedParsing",drag:"enableDragAndDrop",drag_order:"enableDragOrder",tabulation:"enableEditTabOnly",header_images:"enableHeaderImages",header_menu:"enableHeaderMenu",keymap:"enableKeyboardSupport",
mouse_navigation:"enableLightMouseNavigation",markers:"enableMarkedCells",math_editing:"enableMathEditing",math_serialization:"enableMathSerialization",drag_copy:"enableMercyDrag",multiline:"enableMultiline",multiselect:"enableMultiselect",save_column_order:"enableOrderSaving",hover:"enableRowsHover",rowspan:"enableRowspan",smart:"enableSmartRendering",save_sorting:"enableSortingSaving",stable_sorting:"enableStableSorting",undo:"enableUndoRedo",csv_cell:"setCSVDelimiter",date_format:"setDateFormat",
drag_behavior:"setDragBehavior",editable:"setEditable",without_header:"setNoHeader",submit_changed:"submitOnlyChanged",submit_serialization:"submitSerialization",submit_selected:"submitOnlySelected",submit_id:"submitOnlyRowID",xml:"load"},{columns:function(a){for(var b=0;b<f.length;b++){for(var d=[],e=0;e<a.length;e++)d[e]=a[e][f[b].name]||f[b].def;var l=f[b].type||c;l.call(this,f[b].operation,d,a)}this.init()},rows:function(){},headers:function(a){for(var b=0;b<a.length;b++)this.attachHeader(a[b])}})})();
dhtmlXGridObject.prototype._dp_init=function(a){a.attachEvent("insertCallback",function(a,b){this.obj._h2?this.obj.addRow(b,d,null,parent):this.obj.addRow(b,[],0);var d=this.obj.getRowById(b);d&&(this.obj._process_xml_row(d,a.firstChild),this.obj._postRowProcessing(d))});a.attachEvent("updateCallback",function(a,b){var d=this.obj.getRowById(b);d&&(this.obj._process_xml_row(d,a.firstChild),this.obj._postRowProcessing(d))});a.attachEvent("deleteCallback",function(a,b){this.obj.setUserData(b,this.action_param,
"true_deleted");this.obj.deleteRow(b)});a._methods=["setRowTextStyle","setCellTextStyle","changeRowId","deleteRow"];this.attachEvent("onEditCell",function(c,b,d){if(a._columns&&!a._columns[d])return!0;var e=this.cells(b,d);c==1?e.isCheckbox()&&a.setUpdated(b,!0):c==2&&e.wasChanged()&&a.setUpdated(b,!0);return!0});this.attachEvent("onRowPaste",function(c){a.setUpdated(c,!0)});this.attachEvent("onUndo",function(c){a.setUpdated(c,!0)});this.attachEvent("onRowIdChange",function(c,b){var d=a.findRow(c);
d<a.updatedRows.length&&(a.updatedRows[d]=b)});this.attachEvent("onSelectStateChanged",function(){a.updateMode=="row"&&a.sendData();return!0});this.attachEvent("onEnter",function(){a.updateMode=="row"&&a.sendData();return!0});this.attachEvent("onBeforeRowDeleted",function(c){if(!this.rowsAr[c])return!0;if(this.dragContext&&a.dnd)return window.setTimeout(function(){a.setUpdated(c,!0)},1),!0;var b=a.getState(c);this._h2&&this._h2.forEachChild(c,function(b){a.setUpdated(b.id,!1);a.markRow(b.id,!0,"deleted")},
this);if(b=="inserted")return a.set_invalid(c,!1),a.setUpdated(c,!1),!0;if(b=="deleted")return!1;if(b=="true_deleted")return a.setUpdated(c,!1),!0;a.setUpdated(c,!0,"deleted");return!1});this.attachEvent("onBindUpdate",function(c){if(typeof c=="object")c=c.id;a.setUpdated(c,!0)});this.attachEvent("onRowAdded",function(c){if(this.dragContext&&a.dnd)return!0;a.setUpdated(c,!0,"inserted");return!0});a._getRowData=function(a){var b=[];b.gr_id=a;this.obj.isTreeGrid()&&(b.gr_pid=this.obj.getParentId(a));
for(var d=this.obj.getRowById(a),e=0;e<this.obj._cCount;e++){var f=this.obj._c_order?this.obj._c_order[e]:e,g=this.obj.cells(d.idd,e);if(!this._changed||g.wasChanged())this._endnm?b[this.obj.getColumnId(e)]=g.getValue():b["c"+f]=g.getValue()}var i=this.obj.UserData[a];if(i)for(var h=0;h<i.keys.length;h++)i.keys[h]&&i.keys[h].indexOf("__")!=0&&(b[i.keys[h]]=i.values[h]);if(i=this.obj.UserData.gridglobaluserdata)for(h=0;h<i.keys.length;h++)b[i.keys[h]]=i.values[h];return b};a._clearUpdateFlag=function(a){var b=
this.obj.getRowById(a);if(b)for(var d=0;d<this.obj._cCount;d++)this.obj.cells(a,d).cell.wasChanged=!1};a.checkBeforeUpdate=function(a){for(var b=!0,d=[],e=0;e<this.obj._cCount;e++)if(this.mandatoryFields[e]){var f=this.mandatoryFields[e].call(this.obj,this.obj.cells(a,e).getValue(),a,e);typeof f=="string"?(this.messages.push(f),b=!1):(b&=f,d[e]=!f)}b||(this.set_invalid(a,"invalid",d),this.setUpdated(a,!1));return b}};
function dhtmlXGridCellObject(a){this.destructor=function(){return this.base=this.grid=this.cell=this.cell.obj=null};this.cell=a;this.getValue=function(){return this.cell.firstChild&&this.cell.firstChild.tagName=="TEXTAREA"?this.cell.firstChild.value:this.cell.innerHTML._dhx_trim()};this.getMathValue=function(){return this.cell.original?this.cell.original:this.getValue()};this.wasChanged=function(){return this.cell.wasChanged?!0:!1};this.isCheckbox=function(){var a=this.cell.firstChild;return a&&
a.tagName=="INPUT"?(type=a.type,type=="radio"||type=="checkbox"?!0:!1):!1};this.isChecked=function(){if(this.isCheckbox())return this.cell.firstChild.checked};this.isDisabled=function(){return this.cell._disabled};this.setChecked=function(a){if(this.isCheckbox())a!="true"&&a!=1&&(a=!1),this.cell.firstChild.checked=a};this.setDisabled=function(a){a!="true"&&a!=1&&(a=!1);if(this.isCheckbox())this.cell.firstChild.disabled=a,this.disabledF&&this.disabledF(a);this.cell._disabled=a}}
dhtmlXGridCellObject.prototype={getAttribute:function(a){return this.cell._attrs[a]},setAttribute:function(a,c){this.cell._attrs[a]=c},getInput:function(){if(this.obj&&(this.obj.tagName=="INPUT"||this.obj.tagName=="TEXTAREA"))return this.obj;var a=(this.obj||this.cell).getElementsByTagName("TEXTAREA");a.length||(a=(this.obj||this.cell).getElementsByTagName("INPUT"));return a[0]}};
dhtmlXGridCellObject.prototype.setValue=function(a){typeof a!="number"&&(!a||a.toString()._dhx_trim()=="")?(a="&nbsp;",this.cell._clearCell=!0):this.cell._clearCell=!1;this.setCValue(a)};dhtmlXGridCellObject.prototype.getTitle=function(){return _isIE?this.cell.innerText:this.cell.textContent};dhtmlXGridCellObject.prototype.setCValue=function(a){this.cell.innerHTML=a};dhtmlXGridCellObject.prototype.setCTxtValue=function(a){this.cell.innerHTML="";this.cell.appendChild(document.createTextNode(a))};
dhtmlXGridCellObject.prototype.setLabel=function(a){this.cell.innerHTML=a};dhtmlXGridCellObject.prototype.getMath=function(){return this._val?this.val:this.getValue()};function eXcell(){this.val=this.obj=null;this.changeState=function(){return!1};this.edit=function(){this.val=this.getValue()};this.detach=function(){return!1};this.getPosition=function(a){for(var c=a,b=0,d=0;c.tagName!="BODY";)b+=c.offsetLeft,d+=c.offsetTop,c=c.offsetParent;return[b,d]}}eXcell.prototype=new dhtmlXGridCellObject;
function eXcell_ed(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.edit=function(){this.cell.atag=!this.grid.multiLine&&(_isKHTML||_isMacOS||_isFF)?"INPUT":"TEXTAREA";this.val=this.getValue();this.obj=document.createElement(this.cell.atag);this.obj.setAttribute("autocomplete","off");this.obj.style.height=this.cell.offsetHeight-(_isIE?4:4)+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.style.textAlign;this.obj.onclick=function(a){(a||event).cancelBubble=
!0};this.obj.onmousedown=function(a){(a||event).cancelBubble=!0};this.obj.value=this.val;this.cell.innerHTML="";this.cell.appendChild(this.obj);this.obj.onselectstart=function(a){a||(a=event);return a.cancelBubble=!0};_isIE&&this.obj.focus();this.obj.focus()};this.getValue=function(){return this.cell.firstChild&&this.cell.atag&&this.cell.firstChild.tagName==this.cell.atag?this.cell.firstChild.value:this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()};this.detach=function(){this.setValue(this.obj.value);
return this.val!=this.getValue()}}eXcell_ed.prototype=new eXcell;function eXcell_edtxt(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.getValue=function(){return this.cell.firstChild&&this.cell.atag&&this.cell.firstChild.tagName==this.cell.atag?this.cell.firstChild.value:this.cell._clearCell?"":_isIE?this.cell.innerText:this.cell.textContent};this.setValue=function(a){!a||a.toString()._dhx_trim()==""?(a=" ",this.cell._clearCell=!0):this.cell._clearCell=!1;this.setCTxtValue(a)}}
eXcell_edtxt.prototype=new eXcell_ed;function eXcell_edn(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.getValue=function(){return this.cell.firstChild&&this.cell.firstChild.tagName=="TEXTAREA"?this.cell.firstChild.value:this.cell._clearCell?"":this.cell._orig_value||this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)};this.detach=function(){var a=this.obj.value;this.setValue(a);return this.val!=this.getValue()}}eXcell_edn.prototype=new eXcell_ed;
eXcell_edn.prototype.setValue=function(a){if(!a||a.toString()._dhx_trim()=="")return this.cell._clearCell=!0,this.setCValue("&nbsp;",0);else this.cell._clearCell=!1,this.cell._orig_value=a;this.setCValue(this.grid._aplNF(a,this.cell._cellIndex),a)};function eXcell_ro(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return!0};this.getValue=function(){return this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()}}
eXcell_ro.prototype=new eXcell;function eXcell_ron(a){this.cell=a;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return!0};this.getValue=function(){return this.cell._clearCell?"":this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex).toString()}}eXcell_ron.prototype=new eXcell;
eXcell_ron.prototype.setValue=function(a){if(a!==0&&(!a||a.toString()._dhx_trim()==""))return this.setCValue("&nbsp;"),this.cell._clearCell=!0;this.cell._clearCell=!1;this.setCValue(a?this.grid._aplNF(a,this.cell._cellIndex):"0")};
function eXcell_rotxt(a){this.cell=a;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return!0};this.setValue=function(a){a?this.cell._clearCell=!1:(a=" ",this.cell._clearCell=!0);this.setCTxtValue(a)};this.getValue=function(){return this.cell._clearCell?"":_isIE?this.cell.innerText:this.cell.textContent}}eXcell_rotxt.prototype=new eXcell;
function dhtmlXGridComboObject(){this.keys=new dhtmlxArray;this.values=new dhtmlxArray;this.put=function(a,c){for(var b=0;b<this.keys.length;b++)if(this.keys[b]==a)return this.values[b]=c,!0;this.values[this.values.length]=c;this.keys[this.keys.length]=a};this.get=function(a){for(var c=0;c<this.keys.length;c++)if(this.keys[c]==a)return this.values[c];return null};this.clear=function(){this.keys=new dhtmlxArray;this.values=new dhtmlxArray};this.remove=function(a){for(var c=0;c<this.keys.length;c++)if(this.keys[c]==
a)return this.keys._dhx_removeAt(c),this.values._dhx_removeAt(c),!0};this.size=function(){for(var a=0,c=0;c<this.keys.length;c++)this.keys[c]!=null&&a++;return a};this.getKeys=function(){for(var a=[],c=0;c<this.keys.length;c++)this.keys[c]!=null&&(a[a.length]=this.keys[c]);return a};this.save=function(){this._save=[];for(var a=0;a<this.keys.length;a++)this._save[a]=[this.keys[a],this.values[a]]};this.restore=function(){if(this._save){this.keys[a]=[];this.values[a]=[];for(var a=0;a<this._save.length;a++)this.keys[a]=
this._save[a][0],this.values[a]=this._save[a][1]}};return this}function Hashtable(){this.keys=new dhtmlxArray;this.values=new dhtmlxArray;return this}Hashtable.prototype=new dhtmlXGridComboObject;
dhtmlXGridObject.prototype._process_json_row=function(a,c){a._attrs=c;for(var b=0;b<a.childNodes.length;b++)a.childNodes[b]._attrs={};if(c.userdata)for(var d in c.userdata)this.setUserData(a.idd,d,c.userdata[d]);for(var c=this._c_order?this._swapColumns(c.data):c.data,e=0;e<c.length;e++)if(typeof c[e]=="object"&&c[e]!=null){a.childNodes[e]._attrs=c[e];if(c[e].type)a.childNodes[e]._cellType=c[e].type;c[e]=c[e].value}this._fillRow(a,c);return a};
dhtmlXGridObject.prototype._process_js_row=function(a,c){a._attrs=c;for(var b=0;b<a.childNodes.length;b++)a.childNodes[b]._attrs={};if(c.userdata)for(var d in c.userdata)this.setUserData(a.idd,d,c.userdata[d]);for(var e=[],f=0;f<this.columnIds.length;f++){e[f]=c[this.columnIds[f]];if(typeof e[f]=="object"&&e[f]!=null){a.childNodes[f]._attrs=e[f];if(e[f].type)a.childNodes[f]._cellType=e[f].type;e[f]=e[f].value}!e[f]&&e[f]!==0&&(e[f]="")}this._fillRow(a,e);return a};
dhtmlXGridObject.prototype.updateFromJSON=function(a,c,b,d){typeof c=="undefined"&&(c=!0);this._refresh_mode=[!0,c,b];this.load(a,d,"json")};
dhtmlXGridObject.prototype._refreshFromJSON=function(a){this._f_rowsBuffer&&this.filterBy(0,"");reset=!1;if(window.eXcell_tree)eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue,eXcell_tree.prototype.setValue=function(a){var b=this.grid._h2.get[this.cell.parentNode.idd];b&&this.cell.parentNode.valTag?this.setLabel(a):this.setValueX(a)};var c=this.cellType._dhx_find("tree"),b=a.parent||0,d={};this._refresh_mode[2]&&(c!=-1?this._h2.forEachChild(b,function(a){d[a.id]=!0},this):this.forEachRow(function(a){d[a]=
!0}));for(var e=a.rows,f=0;f<e.length;f++){var g=e[f],i=g.id;d[i]=!1;if(this.rowsAr[i]&&this.rowsAr[i].tagName!="TR")this._h2?this._h2.get[i].buff.data=g:this.rowsBuffer[this.getRowIndex(i)].data=g,this.rowsAr[i]=g;else if(this.rowsAr[i])this._process_json_row(this.rowsAr[i],g,-1),this._postRowProcessing(this.rowsAr[i],!0);else if(this._refresh_mode[1]){var h={idd:i,data:g,_parser:this._process_json_row,_locator:this._get_json_data},j=this.rowsBuffer.length;this._refresh_mode[1]=="top"?(this.rowsBuffer.unshift(h),
j=0):this.rowsBuffer.push(h);if(this._h2)reset=!0,this._h2.add(i,b).buff=this.rowsBuffer[this.rowsBuffer.length-1];this.rowsAr[i]=g;g=this.render_row(j);this._insertRowAt(g,j?-1:0)}}if(this._refresh_mode[2])for(i in d)d[i]&&this.rowsAr[i]&&this.deleteRow(i);this._refresh_mode=null;if(window.eXcell_tree)eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX;reset&&this._renderSort();if(this._f_rowsBuffer)this._f_rowsBuffer=null,this.filterByAll()};
dhtmlXGridObject.prototype._process_js=function(a){return this._process_json(a,"js")};
dhtmlXGridObject.prototype._process_json=function(a,c){this._parsing=!0;try{if(a&&a.xmlDoc)eval("dhtmlx.temp="+a.xmlDoc.responseText+";"),a=dhtmlx.temp;else if(typeof a=="string")eval("dhtmlx.temp="+a+";"),a=dhtmlx.temp}catch(b){dhtmlxError.throwError("LoadXML","Incorrect JSON",[a.xmlDoc||a,this]),a={rows:[]}}if(this._refresh_mode)return this._refreshFromJSON(a);var d=parseInt(a.pos||0),e=parseInt(a.total_count||0),f=!1;e&&(this.rowsBuffer[e-1]||(this.rowsBuffer.length&&(f=!0),this.rowsBuffer[e-1]=
null),e<this.rowsBuffer.length&&(this.rowsBuffer.splice(e,this.rowsBuffer.length-e),f=!0));for(var g in a)g!="rows"&&this.setUserData("",g,a[g]);if(c=="js"&&a.collections)for(var i in a.collections){var h=this.getColIndexById(i),j=a.collections[i];if(h!==window.undefined)if(this.cellType[h]=="clist"){colplaindata=[];for(var l=0;l<j.length;l++)colplaindata.push(j[l].label);this.registerCList(h,colplaindata)}else for(var m=this.getCombo(h),l=0;l<j.length;l++)m.put(j[l].value,j[l].label)}if(this.isTreeGrid())return this._process_tree_json(a,
null,null,c);if(c=="js"){if(a.data)a=a.data;for(var k=0;k<a.length;k++)if(!this.rowsBuffer[k+d]){var n=a[k],o=n.id||k+1;this.rowsBuffer[k+d]={idd:o,data:n,_parser:this._process_js_row,_locator:this._get_js_data};this.rowsAr[o]=a[k]}}else for(k=0;k<a.rows.length;k++)if(!this.rowsBuffer[k+d])o=a.rows[k].id,this.rowsBuffer[k+d]={idd:o,data:a.rows[k],_parser:this._process_json_row,_locator:this._get_json_data},this.rowsAr[o]=a.rows[k];if(f&&this._srnd){var p=this.objBox.scrollTop;this._reset_view();this.objBox.scrollTop=
p}else this.render_dataset();this._parsing=!1};dhtmlXGridObject.prototype._get_json_data=function(a,c){return typeof a.data[c]=="object"?a.data[c].value:a.data[c]};
dhtmlXGridObject.prototype._process_tree_json=function(a,c,b,d){this._parsing=!0;var e=!1;if(!c){this.render_row=this.render_row_tree;e=!0;c=a;b=c.parent||0;b=="0"&&(b=0);if(!this._h2)this._h2=new dhtmlxHierarchy;if(this._fake)this._fake._h2=this._h2}if(d=="js"){if(c.data&&!b)a=c.data;if(c.rows)c=c.rows;for(var f=0;f<c.length;f++){var g=c[f].id,i=this._h2.add(g,b);i.buff={idd:g,data:c[f],_parser:this._process_js_row,_locator:this._get_js_data};if(c[f].open)i.state="minus";this.rowsAr[g]=i.buff;this._process_tree_json(c[f],
c[f],g,d)}}else if(c.rows)for(f=0;f<c.rows.length;f++){g=c.rows[f].id;i=this._h2.add(g,b);i.buff={idd:g,data:c.rows[f],_parser:this._process_json_row,_locator:this._get_json_data};if(c.rows[f].open)i.state="minus";this.rowsAr[g]=i.buff;this._process_tree_json(c.rows[f],c.rows[f],g,d)}if(e)b!=0&&this._h2.change(b,"state","minus"),this._updateTGRState(this._h2.get[b]),this._h2_to_buff(),b!=0&&(this._srnd||this.pagingOn)?this._renderSort():this.render_dataset(),this._slowParse===!1&&this.forEachRow(function(a){this.render_row_tree(0,
a)}),this._parsing=!1};
dhtmlXGridObject.prototype.filterBy=function(a,c,b){if(this.isTreeGrid())return this.filterTreeBy(a,c,b);if(this._f_rowsBuffer){if(!b&&(this.rowsBuffer=dhtmlxArray([].concat(this._f_rowsBuffer)),this._fake))this._fake.rowsBuffer=this.rowsBuffer}else this._f_rowsBuffer=[].concat(this.rowsBuffer);if(this.rowsBuffer.length){var d=!0;this.dma(!0);if(typeof a=="object")for(var e=0;e<c.length;e++)this._filterA(a[e],c[e]);else this._filterA(a,c);this.dma(!1);this.pagingOn&&this.rowsBuffer.length/this.rowsBufferOutSize<
this.currentPage-1&&this.changePage(0);this._reset_view();this.callEvent("onGridReconstructed",[])}};dhtmlXGridObject.prototype._filterA=function(a,c){if(c!=""){var b=!0;typeof c=="function"?b=!1:c=(c||"").toString().toLowerCase();if(this.rowsBuffer.length)for(var d=this.rowsBuffer.length-1;d>=0;d--)(b?this._get_cell_value(this.rowsBuffer[d],a).toString().toLowerCase().indexOf(c)==-1:!c.call(this,this._get_cell_value(this.rowsBuffer[d],a),this.rowsBuffer[d].idd))&&this.rowsBuffer.splice(d,1)}};
dhtmlXGridObject.prototype.getFilterElement=function(a){if(this.filters){for(var c=0;c<this.filters.length;c++)if(this.filters[c][1]==a)return this.filters[c][0].combo||this.filters[c][0];return null}};
dhtmlXGridObject.prototype.collectValues=function(a){var c=this.callEvent("onCollectValues",[a]);if(c!==!0)return c;if(this.isTreeGrid())return this.collectTreeValues(a);this.dma(!0);this._build_m_order();for(var a=this._m_order?this._m_order[a]:a,b={},d=[],e=this._f_rowsBuffer||this.rowsBuffer,f=0;f<e.length;f++){var g=this._get_cell_value(e[f],a);if(g&&(!e[f]._childIndexes||e[f]._childIndexes[a]!=e[f]._childIndexes[a-1]))b[g]=!0}this.dma(!1);var i=this.combos[a]||(this._col_combos?this._col_combos[a]:
!1),h;for(h in b)if(b[h]===!0){if(i)if(i.get&&i.get(h))h=i.get(h);else if(i.getOption&&i.getOption(h))h=i.getOption(h).text;d.push(h)}return d.sort()};dhtmlXGridObject.prototype._build_m_order=function(){if(this._c_order){this._m_order=[];for(var a=0;a<this._c_order.length;a++)this._m_order[this._c_order[a]]=a}};
dhtmlXGridObject.prototype.filterByAll=function(){var a=[],c=[];this._build_m_order();for(var b=0;b<this.filters.length;b++)if(!(b>=this._cCount)){var d=this._m_order?this._m_order[this.filters[b][1]]:this.filters[b][1];c.push(d);var e=this.filters[b][0].old_value=this.filters[b][0].value;this.filters[b][0]._filter&&(e=this.filters[b][0]._filter());var f;if(typeof e!="function"&&(f=this.combos[d]||(this._col_combos?this._col_combos[d]:!1)))f.values?(d=f.values._dhx_find(e),e=d==-1?e:f.keys[d]):f.getOptionByLabel&&
(e=f.getOptionByLabel(e)?f.getOptionByLabel(e).value:e);a.push(e)}if(this.callEvent("onFilterStart",[c,a])&&(this.filterBy(c,a),this._cssEven&&this._fixAlterCss(),this.callEvent("onFilterEnd",[this.filters]),this._f_rowsBuffer&&this.rowsBuffer.length==this._f_rowsBuffer.length))this._f_rowsBuffer=null};
dhtmlXGridObject.prototype.makeFilter=function(a,c){if(!this.filters)this.filters=[];typeof a!="object"&&(a=document.getElementById(a));if(a){var b=this;if(!a.style.width)a.style.width="90%";if(a.tagName=="SELECT"){this.filters.push([a,c]);this._loadSelectOptins(a,c);a.onchange=function(){b.filterByAll()};if(_isIE)a.style.marginTop="1px";this.attachEvent("onEditCell",function(b,d,g){this._build_m_order();b==2&&this.filters&&(this._m_order?g==this._m_order[c]:g==c)&&this._loadSelectOptins(a,c);return!0})}else if(a.tagName==
"INPUT")this.filters.push([a,c]),a.old_value=a.value="",a.onkeydown=function(){this._timer&&window.clearTimeout(this._timer);this._timer=window.setTimeout(function(){if(a.value!=a.old_value)b.filterByAll(),a.old_value=a.value},500)};else if(a.tagName=="DIV"&&a.className=="combo"){this.filters.push([a,c]);a.style.padding="0px";a.style.margin="0px";if(!window.dhx_globalImgPath)window.dhx_globalImgPath=this.imgURL;var d=new dhtmlXCombo(a,"_filter","90%");d.filterSelfA=d.filterSelf;d.filterSelf=function(){this.getSelectedIndex()==
0&&this.setComboText("");this.filterSelfA.apply(this,arguments);this.optionsArr[0].hide(!1)};d.enableFilteringMode(!0);a.combo=d;a.value="";this._loadComboOptins(a,c);d.attachEvent("onChange",function(){a.value=d.getSelectedValue();if(a.value===null)a.value="";b.filterByAll()})}a.parentNode&&(a.parentNode.className+=" filter");this._filters_ready()}};
dhtmlXGridObject.prototype.findCell=function(a,c,b,d){d=d||function(a,b){return b.toString().toLowerCase().indexOf(a)!=-1};d===!0&&(d=function(a,b){return b.toString().toLowerCase()==a});var e=[],a=a.toString().toLowerCase();typeof b!="number"&&(b=b?1:0);if(!this.rowsBuffer.length)return e;for(var f=c||0;f<this._cCount;f++){if(this._h2)this._h2.forEachChild(0,function(c){if(b&&e.length==b)return e;d(a,this._get_cell_value(c.buff,f))&&e.push([c.id,f])},this);else for(var g=0;g<this.rowsBuffer.length;g++)if(d(a,
this._get_cell_value(this.rowsBuffer[g],f))&&(e.push([this.rowsBuffer[g].idd,f]),b&&e.length==b))return e;if(typeof c!="undefined")break}return e};
dhtmlXGridObject.prototype.makeSearch=function(a,c,b){typeof a!="object"&&(a=document.getElementById(a));if(a){var d=this;if(a.tagName=="INPUT")a.onkeypress=function(){this._timer&&window.clearTimeout(this._timer);this._timer=window.setTimeout(function(){if(a.value!=""){var e=d.findCell(a.value,c,!0,b);e.length&&(d._h2&&d.openItem(e[0][0]),d.selectCell(d.getRowIndex(e[0][0]),c||0))}},500)};a.parentNode&&(a.parentNode.className+=" filter")}};
dhtmlXGridObject.prototype._loadSelectOptins=function(a,c){var b=this.collectValues(c),d=a.value;a.innerHTML="";a.options[0]=new Option("","");for(var e=this._filter_tr?this._filter_tr[c]:null,f=0;f<b.length;f++)a.options[a.options.length]=new Option(e?e(b[f]):b[f],b[f]);a.value=d};dhtmlXGridObject.prototype.setSelectFilterLabel=function(a,c){if(!this._filter_tr)this._filter_tr=[];this._filter_tr[a]=c};
dhtmlXGridObject.prototype._loadComboOptins=function(a,c){if(a.combo){var b=this.collectValues(c);a.combo.clearAll();a.combo.render(!1);for(var d=[["","&nbsp;"]],e=0;e<b.length;e++)d.push([b[e],b[e]]);a.combo.addOption(d);a.combo.render(!0)}};
dhtmlXGridObject.prototype.refreshFilters=function(){if(this.filters)for(var a=0;a<this.filters.length;a++)switch(this.filters[a][0].tagName.toLowerCase()){case "select":this._loadSelectOptins.apply(this,this.filters[a]);break;case "div":this._loadComboOptins.apply(this,this.filters[a])}};
dhtmlXGridObject.prototype._filters_ready=function(){this.attachEvent("onXLE",this.refreshFilters);this.attachEvent("onRowCreated",function(a,c){if(this._f_rowsBuffer)for(var b=0;b<this._f_rowsBuffer.length;b++)if(this._f_rowsBuffer[b].idd==a)return this._f_rowsBuffer[b]=c});this.attachEvent("onClearAll",function(){this._f_rowsBuffer=null;if(!this.hdr.rows.length)this.filters=[]});window.dhtmlXCombo&&this.attachEvent("onScroll",dhtmlXCombo.prototype.closeAll);this._filters_ready=function(){}};
dhtmlXGridObject.prototype._in_header_text_filter=function(a,c){a.innerHTML="<input type='text'>";a.onclick=a.onmousedown=function(a){return(a||event).cancelBubble=!0};a.onselectstart=function(){return event.cancelBubble=!0};this.makeFilter(a.firstChild,c)};
dhtmlXGridObject.prototype._in_header_text_filter_inc=function(a,c){a.innerHTML="<input type='text'>";a.onclick=a.onmousedown=function(a){return(a||event).cancelBubble=!0};a.onselectstart=function(){return event.cancelBubble=!0};this.makeFilter(a.firstChild,c);a.firstChild._filter=function(){return a.firstChild.value==""?"":function(b){return b.toString().toLowerCase().indexOf(a.firstChild.value.toLowerCase())==0}};this._filters_ready()};
dhtmlXGridObject.prototype._in_header_select_filter=function(a,c){a.innerHTML="<select></select>";a.onclick=function(a){(a||event).cancelBubble=!0;return!1};this.makeFilter(a.firstChild,c)};
dhtmlXGridObject.prototype._in_header_select_filter_strict=function(a,c){a.innerHTML="<select style='width:90%; font-size:8pt; font-family:Tahoma;'></select>";a.onclick=function(a){(a||event).cancelBubble=!0;return!1};this.makeFilter(a.firstChild,c);var b=this.combos;a.firstChild._filter=function(){var d=a.firstChild.value;if(!d)return"";b[c]&&(d=b[c].keys[b[c].values._dhx_find(d)]);d=d.toLowerCase();return function(a){return a.toString().toLowerCase()==d}};this._filters_ready()};
dhtmlXGridObject.prototype._in_header_combo_filter=function(a,c){a.innerHTML="<div style='width:100%; padding-left:2px; overflow:hidden; ' class='combo'></div>";a.onselectstart=function(){return event.cancelBubble=!0};a.onclick=a.onmousedown=function(a){return(a||event).cancelBubble=!0};this.makeFilter(a.firstChild,c)};
dhtmlXGridObject.prototype._search_common=function(a){a.innerHTML="<input type='text' style='width:90%; '>";a.onclick=a.onmousedown=function(a){return(a||event).cancelBubble=!0};a.onselectstart=function(){return event.cancelBubble=!0}};dhtmlXGridObject.prototype._in_header_text_search=function(a,c){this._search_common(a,c);this.makeSearch(a.firstChild,c)};dhtmlXGridObject.prototype._in_header_text_search_strict=function(a,c){this._search_common(a,c);this.makeSearch(a.firstChild,c,!0)};
dhtmlXGridObject.prototype._in_header_numeric_filter=function(a,c){this._in_header_text_filter.call(this,a,c);a.firstChild._filter=function(){var a=this.value,c,e="==",f=parseFloat(a.replace("=","")),g=null;if(a){if(a.indexOf("..")!=-1)return a=a.split(".."),f=parseFloat(a[0]),g=parseFloat(a[1]),function(a){return a>=f&&a<=g?!0:!1};if(c=a.match(/>=|<=|>|</))e=c[0],f=parseFloat(a.replace(e,""));return Function("v"," if (v "+e+" "+f+" ) return true; return false;")}return""}};
dhtmlXGridObject.prototype._in_header_master_checkbox=function(a,c,b){a.innerHTML=b[0]+"<input type='checkbox' />"+b[1];var d=this;a.getElementsByTagName("input")[0].onclick=function(a){d._build_m_order();var b=d._m_order?d._m_order[c]:c,g=this.checked?1:0;d.forEachRowA(function(a){var c=this.cells(a,b);if(c.isCheckbox())c.setValue(g),c.cell.wasChanged=!0;this.callEvent("onEditCell",[1,a,b,g]);this.callEvent("onCheckbox",[a,b,g])});(a||event).cancelBubble=!0}};
dhtmlXGridObject.prototype._in_header_stat_total=function(a,c,b){var d=function(){var a=0;this._build_m_order();for(var b=this._m_order?this._m_order[c]:c,d=0;d<this.rowsBuffer.length;d++){var i=parseFloat(this._get_cell_value(this.rowsBuffer[d],b));a+=isNaN(i)?0:i}return this._maskArr[b]?this._aplNF(a,b):Math.round(a*100)/100};this._stat_in_header(a,d,c,b,b)};
dhtmlXGridObject.prototype._in_header_stat_multi_total=function(a,c,b){var d=b[1].split(":");b[1]="";for(var e=0;e<d.length;e++)d[e]=parseInt(d[e]);for(var f=function(){for(var a=0,b=0;b<this.rowsBuffer.length;b++){for(var e=1,g=0;g<d.length;g++)e*=parseFloat(this._get_cell_value(this.rowsBuffer[b],d[g]));a+=isNaN(e)?0:e}return this._maskArr[c]?this._aplNF(a,c):Math.round(a*100)/100},g=[],i=0;i<d.length;i++)g[d[i]]=!0;this._stat_in_header(a,f,g,b,b)};
dhtmlXGridObject.prototype._in_header_stat_max=function(a,c,b){var d=function(){this._build_m_order();var a=this._m_order?this._m_order[c]:c,b=-999999999;if(this.getRowsNum()==0)return"&nbsp;";for(var d=0;d<this.rowsBuffer.length;d++)b=Math.max(b,parseFloat(this._get_cell_value(this.rowsBuffer[d],a)));return this._maskArr[c]?this._aplNF(b,c):b};this._stat_in_header(a,d,c,b)};
dhtmlXGridObject.prototype._in_header_stat_min=function(a,c,b){var d=function(){this._build_m_order();var a=this._m_order?this._m_order[c]:c,b=999999999;if(this.getRowsNum()==0)return"&nbsp;";for(var d=0;d<this.rowsBuffer.length;d++)b=Math.min(b,parseFloat(this._get_cell_value(this.rowsBuffer[d],a)));return this._maskArr[c]?this._aplNF(b,c):b};this._stat_in_header(a,d,c,b)};
dhtmlXGridObject.prototype._in_header_stat_average=function(a,c,b){var d=function(){this._build_m_order();var a=this._m_order?this._m_order[c]:c,b=0,d=0;if(this.getRowsNum()==0)return"&nbsp;";for(var i=0;i<this.rowsBuffer.length;i++){var h=parseFloat(this._get_cell_value(this.rowsBuffer[i],a));b+=isNaN(h)?0:h;d++}return this._maskArr[c]?this._aplNF(b/d,c):Math.round(b/d*100)/100};this._stat_in_header(a,d,c,b)};
dhtmlXGridObject.prototype._in_header_stat_count=function(a,c,b){var d=function(){return this.getRowsNum()};this._stat_in_header(a,d,c,b)};
dhtmlXGridObject.prototype._stat_in_header=function(a,c,b,d){var e=this,f=function(){this.dma(!0);a.innerHTML=(d[0]?d[0]:"")+c.call(this)+(d[1]?d[1]:"");this.dma(!1);this.callEvent("onStatReady",[])};if(!this._stat_events)this._stat_events=[],this.attachEvent("onClearAll",function(){if(!this.hdr.rows[1]){for(var a=0;a<this._stat_events.length;a++)for(var b=0;b<4;b++)this.detachEvent(this._stat_events[a][b]);this._stat_events=[]}});this._stat_events.push([this.attachEvent("onGridReconstructed",f),
this.attachEvent("onXLE",f),this.attachEvent("onFilterEnd",f),this.attachEvent("onEditCell",function(a,c,d){a==2&&(d==b||b&&b[d])&&f.call(this);return!0})]);a.innerHTML=""};
dhtmlXGridObject.prototype.startFastOperations=function(){this._disF=["setSizes","callEvent","_fixAlterCss","cells4","forEachRow"];this._disA=[];for(var a=this._disF.length-1;a>=0;a--)this._disA[a]=this[this._disF[a]],this[this._disF[a]]=function(){return!0};this._cellCache=[];this.cells4=function(a){var b=this._cellCache[a._cellIndex];if(!b)b=this._cellCache[a._cellIndex]=this._disA[3].apply(this,[a]),b.destructor=function(){return!0},b.setCValue=function(a){b.cell.innerHTML=a};b.cell=a;b.combo=
a._combo||this.combos[a._cellIndex];return b}};dhtmlXGridObject.prototype.stopFastOperations=function(){if(this._disF){for(var a=this._disF.length-1;a>=0;a--)this[this._disF[a]]=this._disA[a];this.setSizes();this.callEvent("onGridReconstructed",[])}};dhtmlXGridObject.prototype._updateTGRState=function(a){if(a.update&&a.id!=0){if(this.rowsAr[a.id].imgTag)this.rowsAr[a.id].imgTag.src=this.imgURL+a.state+".gif";a.update=!1}};
dhtmlXGridObject.prototype.doExpand=function(a){this.editStop();var c=a.parentNode.parentNode.parentNode,b=this._h2.get[c.idd];if(this.callEvent("onOpen",[c.idd,b.state=="plus"?-1:1]))b.state=="plus"?this.expandKids(c):b.state=="minus"&&!b._closeable&&this.collapseKids(c)};
function dhtmlxHierarchy(){var a={id:0,childs:[],level:-1,parent:null,index:0,state:dhtmlXGridObject._emptyLineImg};this.order=[a];this.get={0:a};this.swap=function(a,b){var d=a.parent,e=a.index;d.childs[e]=b;d.childs[b.index]=a;a.index=b.index;b.index=e};this.forEachChildF=function(a,b,d,e){for(var f=this.get[a],g=0;g<f.childs.length;g++)if(b.apply(d||this,[f.childs[g]]))f.childs[g].childs.length&&this.forEachChildF(f.childs[g].id,b,d,e),e&&e.call(d||this,f.childs[g])};this.forEachChild=function(a,
b,d){for(var e=this.get[a],f=0;f<e.childs.length;f++)b.apply(d||this,[e.childs[f]]),e.childs[f].childs.length&&this.forEachChild(e.childs[f].id,b,d)};this.change=function(a,b,d){var e=this.get[a];if(e[b]!=d)e[b]=d,e.update=!0};this.add=function(a,b){return this.addAfter(a,b)};this.addAfter=function(a,b,d,e){var f=this.get[b||0],g=d?this.get[d].index+(e?0:1):f.childs.length,i={id:a,childs:[],level:f.level+1,parent:f,index:g,state:dhtmlXGridObject._emptyLineImg};f.state==dhtmlXGridObject._emptyLineImg&&
this.change(b,"state",b==0?"minus":"plus");if(d){for(var h=g;h<f.childs.length;h++)f.childs[h].index++;f.childs=f.childs.slice(0,g).concat([i]).concat(f.childs.slice(g,f.childs.length))}else f.childs.push(i);return this.get[a]=i};this.addBefore=function(a,b,d){return this.addAfter(a,b,d,!0)};this.remove=function(a){for(var b=this.get[a||0],d=0;d<b.childs.length;d++)this.deleteAll(b.childs[d].id);b.childs=[];b.parent.childs=b.parent.childs.slice(0,b.index).concat(b.parent.childs.slice(b.index+1));
for(d=b.index;d<b.parent.childs.length;d++)b.parent.childs[d].index--;delete this.get[a]};this.deleteAll=function(a){for(var b=this.get[a||0],d=0;d<b.childs.length;d++)this.deleteAll(b.childs[d].id);b.childs=[];delete this.get[a]};return this}dhtmlXGridObject.prototype._getOpenLenght=function(a,c){var b=this._h2.get[a].childs;c+=b.length;for(var d=0;d<b.length;d++)b[d].childs.length&&b[d].state=="minus"&&(c+=this._getOpenLenght(b[d].id,0));return c};
dhtmlXGridObject.prototype.collapseKids=function(a){var c=this._h2.get[a.idd];if(c.state=="minus"&&this.callEvent("onOpenStart",[a.idd,1])){var b=a.rowIndex;b<0&&(b=this.rowsCol._dhx_find(a)+1);this._h2.change(c.id,"state","plus");this._updateTGRState(c);if(this._srnd||this.pagingOn)this._h2_to_buff(),this._renderSort();else{for(var d=this._getOpenLenght(this.rowsCol[b-1].idd,0),e=0;e<d;e++)this.rowsCol[b+e].parentNode.removeChild(this.rowsCol[b+e]);this.rowsCol.splice(b,d)}this.callEvent("onGridReconstructed",
[]);this.setSizes();this._h2_to_buff();this.callEvent("onOpenEnd",[a.idd,-1])}};
dhtmlXGridObject.prototype._massInsert=function(a,c,b){var d=[],e=_isKHTML?this.obj:this.obj.rows[0].parentNode;this._h2_to_buff();if(this._srnd||this.pagingOn)return this._renderSort();for(var f=this._getOpenLenght(a.id,0),g=0;g<f;g++){var i=this.render_row(b+g);c?c.parentNode.insertBefore(i,c):e.appendChild(i);d.push(i)}this.rowsCol=dhtmlxArray(this.rowsCol.slice(0,b).concat(d).concat(this.rowsCol.slice(b)));return a.childs.length+d.length};
dhtmlXGridObject.prototype.expandKids=function(a,c){var b=this._h2.get[a.idd];if(b.childs.length||b._xml_await)if(b.state=="plus"&&(b._loading||c||this.callEvent("onOpenStart",[b.id,-1]))){var d=this.getRowIndex(b.id)+1;if(b.childs.length){b._loading=!1;this._h2.change(b.id,"state","minus");this._updateTGRState(b);var e=this._massInsert(b,this.rowsCol[d],d);this.callEvent("onGridReconstructed",[])}else if(b._xml_await)b._loading=!0,this.callEvent("onDynXLS",[b.id])&&this.load(this.kidsXmlFile+""+
(this.kidsXmlFile.indexOf("?")!=-1?"&":"?")+"id="+b.id,this._data_type);this.setSizes();b._loading||this.callEvent("onOpenEnd",[b.id,1]);this._fixAlterCss()}};dhtmlXGridObject.prototype.kidsXmlFile="";
dhtmlXGridObject.prototype.sortTreeRows=function(a,c,b){var d="getValue";this.cells5({parentNode:{grid:this}},this.getColType(a)).getDate&&(d="getDate",c="str");this.forEachRow(function(b){var e=this._h2.get[b];if(e){var g=this._get_cell_value(e.buff,a,d);c=="int"?(e._sort=parseFloat(g),e._sort=isNaN(e._sort)?-99999999999999:e._sort):e._sort=g}});var e=this,f=1,g=-1;b=="des"&&(f=-1,g=1);var i=null;c=="cus"&&(i=function(c,d){return e._customSorts[a](c._sort,d._sort,b,c.id,d.id)});c=="str"&&(i=function(a,
b){return a._sort<b._sort?g:a._sort==b._sort?0:f});c=="int"&&(i=function(a,b){return a._sort<b._sort?g:a._sort==b._sort?0:f});c=="date"&&(i=function(a,b){return(Date.parse(new Date(a._sort||"01/01/1900"))-Date.parse(new Date(b._sort||"01/01/1900")))*f});this._sortTreeRows(i,0);this._renderSort(0,!0);this.callEvent("onGridReconstructed",[])};
dhtmlXGridObject.prototype._sortTreeRows=function(a,c){var b=this._h2.get[c].childs;this.rowsCol.stablesort?this.rowsCol.stablesort.call(b,a):b.sort(a);for(var d=0;d<b.length;d++)b[d].childs.length&&this._sortTreeRows(a,b[d].id),b[d].index=d};dhtmlXGridObject.prototype._renderSort=function(){this._h2_to_buff();var a=this.objBox.scrollTop;this._reset_view();this.objBox.scrollTop=a};
dhtmlXGridObject.prototype._fixAlterCssTGR=function(){this._realfake||this._h2.forEachChild(0,function(a){if(a.buff.tagName=="TR"){var c=(this._cssSP?a.level%2:a.index%2)?this._cssUnEven:this._cssEven;this.rowsAr[a.id].className=c+(this._cssSU?" "+c+"_"+a.level:"")+" "+(this.rowsAr[a.id]._css||"")+(this.rowsAr[a.id].className.indexOf("rowselected")!=-1?" rowselected":"")}},this)};
dhtmlXGridObject.prototype.moveRowUDTG=function(a,c){var b=this._h2.get[a],d=b.parent.childs[b.index+c];if(d&&d.parent==b.parent){var e=[b.state,d.state];this.collapseKids(this.rowsAr[b.id]);this.collapseKids(this.rowsAr[d.id]);var f=this.rowsCol._dhx_find(this.rowsAr[a]),g=this.rowsBuffer._dhx_find(this.rowsAr[a]),i=this.obj.rows[0].parentNode.removeChild(this.rowsCol[f]),h=this.rowsCol[f+(c==1?2:c)];h?h.parentNode.insertBefore(i,h):this.obj.rows[0].parentNode.appendChild(i);this.rowsCol._dhx_swapItems(f,
f+c);this.rowsBuffer._dhx_swapItems(g,g+c);this._h2.swap(d,b);e[0]=="minus"&&this.expandKids(this.rowsAr[b.id]);e[1]=="minus"&&this.expandKids(this.rowsAr[d.id]);this._fixAlterCss(Math.min(f,f+c))}};
function eXcell_tree(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.isDisabled=function(){return this.cell._disabled||this.grid._edtc};this.edit=function(){if(!this.er&&!this.grid._edtc){this.er=this.cell.parentNode.valTag;this.val=this.getLabel();this.cell.atag=!this.grid.multiLine&&(_isKHTML||_isMacOS||_isFF)?"INPUT":"TEXTAREA";this.er.innerHTML="<"+this.cell.atag+" class='dhx_combo_edit' type='text' style='height:"+(this.cell.offsetHeight-6)+"px; width:100%; border:0px; margin:0px; padding:0px; padding-top:"+
(_isFF?1:2)+"px; overflow:hidden;'></"+this.cell.atag+">";this.er.childNodes[0].onmousedown=function(a){(a||event).cancelBubble=!0};this.er.childNodes[0].onselectstart=function(a){a||(a=event);return a.cancelBubble=!0};if(_isFF)this.er.style.top="1px";this.er.className+=" editable";this.er.firstChild.onclick=function(a){(a||event).cancelBubble=!0};this.er.firstChild.value=this.val;this.obj=this.er.firstChild;this.er.firstChild.style.width=Math.max(0,this.cell.offsetWidth-this.er.offsetLeft)+"px";
this.er.firstChild.focus();_isIE&&this.er.firstChild.focus()}};this.detach=function(){if(this.er){this.setLabel(this.er.firstChild.value);this.er.className=this.er.className.replace("editable","");var a=this.val!=this.er.innerHTML;if(_isFF)this.er.style.top="2px";this.obj=this.er=null;return a}};this.getValue=function(){return this.getLabel()};this.setImage=function(a){this.cell.parentNode.imgTag.nextSibling.src=this.grid.iconURL+a;this.grid._h2.get[this.cell.parentNode.idd].image=a};this.getImage=
function(){return this.grid._h2.get[this.cell.parentNode.idd].image};this.setLabel=function(a){this.setValueA(a)};this.getLabel=function(){return this.cell.parentNode.valTag.innerHTML}}eXcell_tree.prototype=new eXcell;eXcell_tree.prototype.setValueA=function(a){this.cell.parentNode.valTag.innerHTML=a;this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,a])};
eXcell_tree.prototype.setValue=function(a){if(this.cell.parentNode.imgTag)return this.setLabel(a);if(this.grid._tgc.imgURL==null||this.grid._tgc.imgURL!=this.grid.imgURL){var c={};c.spacer="<img src='"+this.grid.imgURL+"blank.gif'  align='absmiddle' class='space'>";c.imst="<img src='"+this.grid.imgURL;c.imsti="<img src='"+(this.grid.iconURL||this.grid.imgURL);c.imact="' align='absmiddle'  onclick='this."+(_isKHTML?"":"parentNode.")+"parentNode.parentNode.parentNode.parentNode.grid.doExpand(this);event.cancelBubble=true;'>";
c.plus=c.imst+"plus.gif"+c.imact;c.minus=c.imst+"minus.gif"+c.imact;c.blank=c.imst+"blank.gif"+c.imact;c.start="<div class='treegrid_cell' style='overflow:hidden; white-space : nowrap; height:"+(_isIE?20:18)+"px;'>";c.itemim="' align='absmiddle' "+(this.grid._img_height?' height="'+this.grid._img_height+'"':"")+(this.grid._img_width?' width="'+this.grid._img_width+'"':"")+" ><span "+(_isFF||_isOpera?"style='position:relative; top:2px;'":"")+"id='nodeval'>";c.close="</span></div>";this.grid._tgc=c}var c=
this.grid._tgc,b=this.cell.parentNode.idd,d=this.grid._h2.get[b];if(this.grid.kidsXmlFile||this.grid._slowParse)d.has_kids=d.has_kids||this.cell.parentNode._attrs.xmlkids&&d.state!="minus",d._xml_await=!!d.has_kids;d.image=d.image||this.cell._attrs.image||"leaf.gif";d.label=a;for(var e=[c.start],f=0;f<d.level;f++)e.push(c.spacer);d.has_kids?(e.push(c.plus),d.state="plus"):e.push(c.imst+d.state+".gif"+c.imact);e.push(c.imsti);e.push(d.image);e.push(c.itemim);e.push(d.label);e.push(c.close);this.cell.innerHTML=
e.join("");this.cell._treeCell=!0;this.cell.parentNode.imgTag=this.cell.childNodes[0].childNodes[d.level];this.cell.parentNode.valTag=this.cell.childNodes[0].childNodes[d.level+2];if(_isKHTML)this.cell.vAlign="top";if(d.parent.id!=0&&d.parent.state=="plus")this.grid._updateTGRState(d.parent,!1),this.cell.parentNode._skipInsert=!0;this.grid.callEvent("onCellChanged",[b,this.cell._cellIndex,a])};
dhtmlXGridObject.prototype._process_tree_xml=function(a,c,b){this._parsing=!0;var d=!1;if(!c){this.render_row=this.render_row_tree;d=!0;c=a.getXMLTopNode(this.xml.top);b=c.getAttribute("parent")||0;b=="0"&&(b=0);if(!this._h2)this._h2=new dhtmlxHierarchy;if(this._fake)this._fake._h2=this._h2}var e=a.doXPath(this.xml.row,c);this._open=this._open||[];for(var f=0;f<e.length;f++){var g=e[f].getAttribute("id");g||(g=this.uid(),e[f].setAttribute("id",g));var i=this._h2.add(g,b);i.buff={idd:g,data:e[f],_parser:this._process_xml_row,
_locator:this._get_xml_data};if(e[f].getAttribute("open"))i.state="minus",this._open.push(g);this.rowsAr[g]=i.buff;this._process_tree_xml(a,e[f],g)}if(d){e.length?b!=0&&!this._srnd&&this._h2.change(b,"state","minus"):this._h2.change(b,"state",dhtmlXGridObject._emptyLineImg);for(f=0;f<this._open.length;f++){var h=this._h2.get[this._open[f]];if(!h.childs.length)h.state=dhtmlXGridObject._emptyLineImg}this._updateTGRState(this._h2.get[b]);this._h2_to_buff();b!=0&&this._srnd?this.openItem(b):this.pagingOn?
this._renderSort():this.render_dataset();if(this.kidsXmlFile)for(f=0;f<this._open.length;f++)h=this._h2.get[this._open[f]],h._xml_await&&this.expandKids({idd:h.id});this._open=[];this._slowParse===!1&&this.forEachRow(function(a){this.render_row_tree(0,a)});this._parsing=!1;b!=0&&!this._srnd&&this.callEvent("onOpenEnd",[b,1])}return a.xmlDoc.responseXML?a.xmlDoc.responseXML:a.xmlDoc};
dhtmlXGridObject.prototype._h2_to_buff=function(a){if(!a&&(a=this._h2.get[0],this.rowsBuffer=new dhtmlxArray,this._fake&&!this._realfake))this._fake.rowsBuffer=this.rowsBuffer;for(var c=0;c<a.childs.length;c++)this.rowsBuffer.push(a.childs[c].buff),a.childs[c].state=="minus"&&this._h2_to_buff(a.childs[c])};
dhtmlXGridObject.prototype.render_row_tree=function(a,c){if(c)var b=this._h2.get[c],b=b?b.buff:b;else b=this.rowsBuffer[a];if(!b)return-1;if(b._parser){if(this.rowsAr[b.idd]&&this.rowsAr[b.idd].tagName=="TR")return this._h2.get[b.idd].buff=this.rowsBuffer[a]=this.rowsAr[b.idd];var d=this._prepareRow(b.idd);this.rowsAr[b.idd]=d;c||(this.rowsBuffer[a]=d);this._h2.get[b.idd].buff=d;b._parser.call(this,d,b.data);this._postRowProcessing(d);return d}return b};
dhtmlXGridObject.prototype._removeTrGrRow=function(a,c){if(c)this._h2.forEachChild(c.id,function(a){this._removeTrGrRow(null,a);delete this.rowsAr[a.id]},this);else{var b=this.getRowIndex(a.idd),c=this._h2.get[a.idd];if(b!=-1&&b!==this.undefined){var d=1;c&&c.state=="minus"&&(d+=this._getOpenLenght(c.id,0));for(var e=0;e<d;e++)this.rowsCol[e+b]&&this.rowsCol[e+b].parentNode.removeChild(this.rowsCol[e+b]);if(this._fake){for(e=0;e<d;e++)this._fake.rowsCol[e+b]&&this._fake.rowsCol[e+b].parentNode.removeChild(this._fake.rowsCol[e+
b]);d>1&&this._fake.rowsCol.splice(b+1,d-1)}this.rowsCol.splice(b,d);this.rowsBuffer.splice(b,d)}c&&(this._removeTrGrRow(null,c),delete this.rowsAr[c.id],c.parent.childs.length==1&&(this._h2.change(c.parent.id,"state",dhtmlXGridObject._emptyLineImg),this._updateTGRState(c.parent)),this._h2.remove(c.id))}};dhtmlXGridObject.prototype.openItem=function(a){var c=this._h2.get[a||0],b=this.getRowById(a||0);b&&(c.parent&&c.parent.id!=0&&this.openItem(c.parent.id),this.expandKids(b))};
dhtmlXGridObject.prototype._addRowClassic=dhtmlXGridObject.prototype.addRow;
dhtmlXGridObject.prototype.addRow=function(a,c,b,d,e,f){if(!this._h2)return this._addRowClassic(a,c,b);var d=d||0,g=this.cellType._dhx_find("tree");typeof c=="string"&&(c=c.split(this.delim));var i=this._h2.get[a];if(!i)d==0?b=this.rowsBuffer.length:(b=this.getRowIndex(d)+1,this._h2.get[d].state=="minus"?b+=this._getOpenLenght(d,0):this._skipInsert=!0);i=i||this._h2.add(a,d);i.image=e;i.has_kids=f;return i.buff=this._addRowClassic(a,c,b)};
dhtmlXGridObject.prototype.addRowBefore=function(a,c,b,d,e){var f=this.rowsAr[b];if(f){if(!this._h2)return this.addRow(a,c,this.getRowIndex(b));var g=this._h2.get[b].parent.id,i=this.getRowIndex(b);if(i==-1)this._skipInsert=!0;this._h2.addBefore(a,g,b);return this.addRow(a,c,i,this._h2.get[b].parent.id,d,e)}};
dhtmlXGridObject.prototype.addRowAfter=function(a,c,b,d,e){var f=this.rowsAr[b];if(f){if(!this._h2)return this.addRow(a,c,this.getRowIndex(b)+1);var g=this._h2.get[b].parent.id,i=this.getRowIndex(b);if(i==-1)this._skipInsert=!0;this._h2.get[b].state=="minus"?i+=this._getOpenLenght(b,0)+1:i++;this._h2.addAfter(a,g,b);return this.addRow(a,c,i,g,d,e)}};dhtmlXGridObject.prototype.enableSmartXMLParsing=function(a){this._slowParse=convertStringToBoolean(a)};
dhtmlXGridObject.prototype._copyTreeGridRowContent=function(a,c,b){var d=this.cellType._dhx_find("tree");for(i=0;i<a.cells.length;i++)i!=d?this.cells(b,i).setValue(this.cells(c,i).getValue()):this.cells(b,i).setValueA(this.cells(c,i).getValue())};dhtmlXGridObject.prototype.closeItem=function(a){var c=this.getRowById(a);c&&this.collapseKids(c)};dhtmlXGridObject.prototype.deleteChildItems=function(a){var c=this._h2.get[a];if(c)for(;c.childs.length;)this.deleteRow(c.childs[0].id)};
dhtmlXGridObject.prototype.getAllSubItems=function(a){var c=[],b=this._h2.get[a||0];if(b)for(var d=0;d<b.childs.length;d++)c.push(b.childs[d].id),b.childs[d].childs.length&&(c=c.concat(this.getAllSubItems(b.childs[d].id).split(this.delim)));return c.join(this.delim)};dhtmlXGridObject.prototype.getChildItemIdByIndex=function(a,c){var b=this._h2.get[a||0];return!b?null:b.childs[c]?b.childs[c].id:null};dhtmlXGridObject.prototype.getItemText=function(a){return this.cells(a,this.cellType._dhx_find("tree")).getLabel()};
dhtmlXGridObject.prototype.getOpenState=function(a){var c=this._h2.get[a||0];if(c)return c.state=="minus"?!0:!1};dhtmlXGridObject.prototype.getParentId=function(a){var c=this._h2.get[a||0];return!c||!c.parent?null:c.parent.id};dhtmlXGridObject.prototype.getSubItems=function(a){var c=[],b=this._h2.get[a||0];if(b)for(var d=0;d<b.childs.length;d++)c.push(b.childs[d].id);return c.join(this.delim)};
dhtmlXGridObject.prototype.expandAll=function(a){this._renderAllExpand(a||0);this._h2_to_buff();this._reset_view();this.setSizes();this.callEvent("onGridReconstructed",[]);this._redrawLines&&this._redrawLines()};dhtmlXGridObject.prototype._renderAllExpand=function(a){for(var c=this._h2.get[a].childs,b=0;b<c.length;b++)c[b].childs.length&&(this._h2.change(c[b].id,"state","minus"),this._updateTGRState(c[b]),this._renderAllExpand(c[b].id))};
dhtmlXGridObject.prototype.collapseAll=function(a){this._h2.forEachChild(a||0,function(a){if(a&&a.state=="minus")a.state="plus",a.update=!0,this._updateTGRState(a)},this);this._h2_to_buff();this._reset_view();this.setSizes();this.callEvent("onGridReconstructed",[]);this._redrawLines&&this._redrawLines()};dhtmlXGridObject.prototype.hasChildren=function(a){var c=this._h2.get[a];return c&&c.childs.length?c.childs.length:c._xml_await?-1:0};
dhtmlXGridObject.prototype.setItemCloseable=function(a,c){var b=this._h2.get[a];if(b)b._closeable=!convertStringToBoolean(c)};dhtmlXGridObject.prototype.setItemText=function(a,c){return this.cells(a,this.cellType._dhx_find("tree")).setLabel(c)};dhtmlXGridObject.prototype.setItemImage=function(a,c){this._h2.get[a].image=c;this.rowsAr[a].imgTag.nextSibling.src=(this.iconURL||"")+c};dhtmlXGridObject.prototype.getItemImage=function(a){this.getRowById(a);return this._h2.get[a].image};
dhtmlXGridObject.prototype.setImageSize=function(a,c){this._img_width=a;this._img_height=c};dhtmlXGridObject.prototype._getRowImage=function(a){return this._h2.get[a.idd].image};dhtmlXGridObject.prototype.setOnOpenStartHandler=function(a){this.attachEvent("onOpenStart",a)};dhtmlXGridObject.prototype.setOnOpenEndHandler=function(a){this.attachEvent("onOpenEnd",a)};dhtmlXGridObject.prototype.enableTreeCellEdit=function(a){this._edtc=!convertStringToBoolean(a)};
dhtmlXGridObject.prototype.getLevel=function(a){var c=this._h2.get[a||0];return!c?-1:c.level};dhtmlXGridObject.prototype._fixHiddenRowsAllTG=function(a,c){for(i in this.rowsAr)if(this.rowsAr[i]&&this.rowsAr[i].childNodes)this.rowsAr[i].childNodes[a].style.display=c};dhtmlXGridObject._emptyLineImg="blank";
dhtmlXGridObject.prototype._updateLine=function(a,c){if(c=c||this.rowsAr[a.id]){var b=c.imgTag;if(b){if(a.state=="blank")return b.src=this.imgURL+"blank.gif";var d=1,d=a.index==0?a.level==0?a.parent.childs.length-1>a.index?3:1:a.parent.childs.length-1>a.index?3:2:a.parent.childs.length-1>a.index?3:2;b.src=this.imgURL+a.state+d+".gif"}}};
dhtmlXGridObject.prototype._updateParentLine=function(a,c){if(c=c||this.rowsAr[a.id]){var b=c.imgTag;if(b)for(var d=a.level;d>0;d--){if(a.id==0)break;b=b.previousSibling;a=a.parent;b.src=a.parent.childs.length-1>a.index?this.imgURL+"line1.gif":this.imgURL+"blank.gif"}}};dhtmlXGridObject.prototype._renderSortA=dhtmlXGridObject.prototype._renderSort;dhtmlXGridObject.prototype._renderSort=function(){this._renderSortA.apply(this,arguments);this._redrawLines(0)};
dhtmlXGridObject.prototype._redrawLines=function(a){this._tgle&&this._h2.forEachChild(a||0,function(a){this._updateLine(a);this._updateParentLine(a)},this)};
dhtmlXGridObject.prototype.enableTreeGridLines=function(){dhtmlXGridObject._emptyLineImg="line";this._updateTGRState=function(a,c){if(!c&&a.update&&a.id!=0)this._tgle&&this._updateLine(a,this.rowsAr[a.id]),a.update=!1};this._tgle=!0;this.attachEvent("onXLE",function(a,c,b){this._redrawLines(b)});this.attachEvent("onOpenEnd",function(a){this._redrawLines(a)});this.attachEvent("onRowAdded",function(a){var c=this._h2.get[a];this._updateLine(c);this._updateParentLine(c);c.index<c.parent.childs.length-
1?(c=c.parent.childs[c.index+1],this._updateLine(c),this._updateParentLine(c)):c.index!=0&&(c=c.parent.childs[c.index-1],this._updateLine(c),this._updateParentLine(c),c.childs.length&&this._h2.forEachChild(c.id,function(a){this._updateParentLine(a)},this))});this.attachEvent("onOpen",function(a,c){if(c)for(var b=this._h2.get[a],d=0;d<b.childs.length;d++)this._updateParentLine(b.childs[d]);return!0});this.attachEvent("onBeforeRowDeleted",function(a){var c=this,b=this._h2.get[a],d=null;b.index!=0&&
(d=b.parent.childs[b.index-1]);b=b.parent;window.setTimeout(function(){if(b=c._h2.get[b.id])c._updateLine(b),c._updateParentLine(b),d&&(c._updateLine(d),d.state=="minus"&&c._h2.forEachChild(d.id,function(a){c._updateParentLine(a)},c))},1);return!0})};dhtmlXGridObject.prototype.setFiltrationLevel=function(a,c,b){this._tr_strfltr=a;this._tr_fltr_c=c;this._tr_fltr_d=b;this.refreshFilters()};
dhtmlXGridObject.prototype.filterTreeBy=function(a,c,b){var d=this._h2;if(typeof this._tr_strfltr=="undefined")this._tr_strfltr=-1;if(this._f_rowsBuffer){if(!b&&(this._h2=this._f_rowsBuffer,this._fake))this._fake._h2=this._h2}else this._f_rowsBuffer=this._h2;var e=!0;this.dma(!0);this._fbf={};if(typeof a=="object")for(var f=0;f<c.length;f++)this._filterTreeA(a[f],c[f]);else this._filterTreeA(a,c);this._fbf=null;this.dma(!1);this._fix_filtered_images(this._h2,d);this._renderSort();this.callEvent("onGridReconstructed",
[])};
dhtmlXGridObject.prototype._filterTreeA=function(a,c){if(c!=""){var b=!0;typeof c=="function"?b=!1:c=(c||"").toString().toLowerCase();var d=function(a,b,c){var e=c.get[a.parent.id];e||(e=d(a.parent,b,c));c=f.get[a.id];c||(c={id:a.id,childs:[],level:a.level,parent:e,index:e.childs.length,image:a.image,state:a.state,buff:a.buff,has_kids:a.has_kids,_xml_await:a._xml_await},e.childs.push(c),f.get[c.id]=c);return c},e=this._fbf,f=new dhtmlxHierarchy,g,i=this._tr_strfltr,h=this,j=function(a){for(var b=0;b<
a.childs.length;b++)h.temp(a.childs[b])};switch(i.toString()){case "-2":g=function(a){if(e[a.id])return!1;j(a);return!0};break;case "-1":g=function(a){return!a.childs.length};break;default:g=function(a){return i==a.level}}this.temp=function(h){if(h.id!=0&&g(h))return(b?this._get_cell_value(h.buff,a).toString().toLowerCase().indexOf(c)==-1:!c(this._get_cell_value(h.buff,a),h.id))?(e[h.id]=!0,this._tr_fltr_c&&d(h.parent,this._h2,f),!1):(d(h,this._h2,f),h.childs&&i!=-2&&this._h2.forEachChild(h.id,function(a){d(a,
this._h2,f)},this),!0);else this._tr_fltr_d&&this._tr_strfltr>h.level&&h.id!=0&&d(h,this._h2,f),j(h)};this.temp(this._h2.get[0]);this._h2=f;if(this._fake)this._fake._h2=this._h2}};
dhtmlXGridObject.prototype._fix_filtered_images=function(a,c){a.forEachChild(0,function(a){if(!a.childs.length&&!a.has_kids){if(a.state!=dhtmlXGridObject._emptyLineImg)a.state=dhtmlXGridObject._emptyLineImg,a.update=!0,this._updateTGRState(a)}else if(a.buff.tagName=="TR"){var d=c.get[a.id];if(d&&d.state!=dhtmlXGridObject._emptyLineImg)a.state=d.state;a.update=!0;this._updateTGRState(a)}},this)};
dhtmlXGridObject.prototype.collectTreeValues=function(a){if(typeof this._tr_strfltr=="undefined")this._tr_strfltr=-1;this.dma(!0);this._build_m_order();var a=this._m_order?this._m_order[a]:a,c={},b=[],d=this._f_rowsBuffer||this._h2;d.forEachChild(0,function(b){if(this._tr_strfltr==-2||this._tr_strfltr==-1&&!b.childs.length||this._tr_strfltr==b.level){var d=this._get_cell_value(b.buff,a);d&&(c[d]=!0)}},this);this.dma(!1);var e=this.combos[a],f;for(f in c)c[f]===!0&&b.push(e?e.get(f)||f:f);return b.sort()};
dhtmlXGridObject.prototype._in_header_stat_tree_total=function(a,c,b){var d=function(){var a=0;this._build_m_order();var b=this._m_order?this._m_order[c]:c;this._h2.forEachChild(0,function(c){var d=parseFloat(this._get_cell_value(c.buff||this.rowsAr[c.id],b));a+=isNaN(d)?0:d},this);return this._maskArr[c]?this._aplNF(a,c):Math.round(a*100)/100};this._stat_in_header(a,d,c,b,b)};
dhtmlXGridObject.prototype._in_header_stat_tree_total_leaf=function(a,c,b){var d=function(){var a=0;this._build_m_order();var b=this._m_order?this._m_order[c]:c;this._h2.forEachChild(0,function(c){if(!c.childs.length){var d=parseFloat(this._get_cell_value(c.buff||this.rowsAr[c.id],b));a+=isNaN(d)?0:d}},this);return this._maskArr[c]?this._aplNF(a,c):Math.round(a*100)/100};this._stat_in_header(a,d,c,b,b)};
dhtmlXGridObject.prototype._in_header_stat_tree_multi_total=function(a,c,b){var d=b[1].split(":");b[1]="";var e=function(){var a=0;this._h2.forEachChild(0,function(b){var c=parseFloat(this._get_cell_value(b.buff||this.rowsAr[b.id],d[0]))*parseFloat(this._get_cell_value(b.buff||this.rowsAr[b.id],d[1]));a+=isNaN(c)?0:c},this);return this._maskArr[c]?this._aplNF(a,c):Math.round(a*100)/100};this._stat_in_header(a,e,c,b,b)};
dhtmlXGridObject.prototype._in_header_stat_tree_multi_total_leaf=function(a,c,b){var d=b[1].split(":");b[1]="";var e=function(){var a=0;this._h2.forEachChild(0,function(b){if(!b.childs.length){var c=parseFloat(this._get_cell_value(b.buff||this.rowsAr[b.id],d[0]))*parseFloat(this._get_cell_value(b.buff||this.rowsAr[b.id],d[1]));a+=isNaN(c)?0:c}},this);return this._maskArr[c]?this._aplNF(a,c):Math.round(a*100)/100};this._stat_in_header(a,e,c,b,b)};
dhtmlXGridObject.prototype._in_header_stat_tree_max=function(a,c,b){var d=function(){var a=-999999999;this._build_m_order();var b=this._m_order?this._m_order[c]:c;if(this.getRowsNum()==0)return"";this._h2.forEachChild(0,function(c){var d=parseFloat(this._get_cell_value(c.buff||this.rowsAr[c.id],b));isNaN(d)||(a=Math.max(a,d))},this);return this._maskArr[c]?this._aplNF(a,c):a};this._stat_in_header(a,d,c,b)};
dhtmlXGridObject.prototype._in_header_stat_tree_min=function(a,c,b){var d=function(){var a=999999999;this._build_m_order();var b=this._m_order?this._m_order[c]:c;if(this.getRowsNum()==0)return"";this._h2.forEachChild(0,function(c){var d=parseFloat(this._get_cell_value(c.buff||this.rowsAr[c.id],b));isNaN(d)||(a=Math.min(a,d))},this);return this._maskArr[c]?this._aplNF(a,c):a};this._stat_in_header(a,d,c,b)};
dhtmlXGridObject.prototype._in_header_stat_tree_average=function(a,c,b){var d=function(){var a=0,b=0;this._build_m_order();var d=this._m_order?this._m_order[c]:c;this._h2.forEachChild(0,function(c){var h=parseFloat(this._get_cell_value(c.buff||this.rowsAr[c.id],d));a+=isNaN(h)?0:h;b++},this);return this._maskArr[c]?this._aplNF(a,c):Math.round(a/b*100)/100};this._stat_in_header(a,d,c,b)};
dhtmlXGridObject.prototype._in_header_stat_tree_max_leaf=function(a,c,b){var d=function(){var a=-999999999;this._build_m_order();var b=this._m_order?this._m_order[c]:c;if(this.getRowsNum()==0)return"";this._h2.forEachChild(0,function(c){if(!c.childs.length){var d=parseFloat(this._get_cell_value(c.buff||this.rowsAr[c.id],b));isNaN(d)||(a=Math.max(a,d))}},this);return this._maskArr[c]?this._aplNF(a,c):a};this._stat_in_header(a,d,c,b)};
dhtmlXGridObject.prototype._in_header_stat_tree_min_leaf=function(a,c,b){var d=function(){var a=999999999;this._build_m_order();var b=this._m_order?this._m_order[c]:c;if(this.getRowsNum()==0)return"";this._h2.forEachChild(0,function(c){if(!c.childs.length){var d=parseFloat(this._get_cell_value(c.buff||this.rowsAr[c.id],b));isNaN(d)||(a=Math.min(a,d))}},this);return this._maskArr[c]?this._aplNF(a,c):a};this._stat_in_header(a,d,c,b)};
dhtmlXGridObject.prototype._in_header_stat_tree_average_leaf=function(a,c,b){var d=function(){var a=0,b=0;this._build_m_order();var d=this._m_order?this._m_order[c]:c;this._h2.forEachChild(0,function(c){if(!c.childs.length){var h=parseFloat(this._get_cell_value(c.buff||this.rowsAr[c.id],d));a+=isNaN(h)?0:h;b++}},this);return this._maskArr[c]?this._aplNF(a,c):Math.round(a/b*100)/100};this._stat_in_header(a,d,c,b)};
dhtmlXGridObject.prototype._in_header_stat_tree_count=function(a,c,b){var d=function(){var a=0;this._h2.forEachChild(0,function(){a++},this);return a};this._stat_in_header(a,d,c,b)};dhtmlXGridObject.prototype._in_header_stat_tree_count_leaf=function(a,c,b){var d=function(){var a=0;this._h2.forEachChild(0,function(b){b.childs.length||a++},this);return a};this._stat_in_header(a,d,c,b)};
dhtmlXGridObject.prototype._stat_in_header=function(a,c,b,d){var e=this,f=function(){this.dma(!0);a.innerHTML=(d[0]?d[0]:"")+c.call(this)+(d[1]?d[1]:"");this.dma(!1);this.callEvent("onStatReady",[])};if(!this._stat_events)this._stat_events=[],this.attachEvent("onClearAll",function(){if(!this.hdr.rows[1]){for(var a=0;a<this._stat_events.length;a++)for(var b=0;b<4;b++)this.detachEvent(this._stat_events[a][b]);this._stat_events=[]}});this._stat_events.push([this.attachEvent("onGridReconstructed",f),
this.attachEvent("onXLE",f),this.attachEvent("onFilterEnd",f),this.attachEvent("onEditCell",function(a,c,d){a==2&&d==b&&f.call(this);return!0})]);a.innerHTML=""};dhtmlXGridObject.prototype._build_m_order=function(){if(this._c_order){this._m_order=[];for(var a=0;a<this._c_order.length;a++)this._m_order[this._c_order[a]]=a}};
function dhtmlXToolbarObject(a,c){var b=this;for(this.cont=typeof a!="object"?document.getElementById(a):a;this.cont.childNodes.length>0;)this.cont.removeChild(this.cont.childNodes[0]);this.cont.dir="ltr";this.cont.innerHTML+="<div class='dhxtoolbar_hdrline_ll'></div><div class='dhxtoolbar_hdrline_rr'></div><div class='dhxtoolbar_hdrline_l'></div><div class='dhxtoolbar_hdrline_r'></div>";this.base=document.createElement("DIV");this.base.className="float_left";this.cont.appendChild(this.base);this.align=
"left";this.setAlign=function(a){this.align=a=="right"?"right":"left";this.base.className=a=="right"?"float_right":"float_left";if(this._spacer)this._spacer.className="dhxtoolbar_spacer "+(a=="right"?" float_left":" float_right")};this._isIE6=!1;if(_isIE)this._isIE6=window.XMLHttpRequest==null?!0:!1;if(this._isIPad=navigator.userAgent.search(/iPad/gi)>=0)this.cont.ontouchstart=function(a){a=a||event;a.returnValue=!1;a.cancelBubble=!0;return!1};this.iconSize=18;this.setIconSize=function(a){this.iconSize=
{18:!0,24:!0,32:!0,48:!0}[a]?a:18;this.setSkin(this.skin,!0);this.callEvent("_onIconSizeChange",[this.iconSize])};this.selectPolygonOffsetLeft=this.selectPolygonOffsetTop=0;this._improveTerraceSkin=function(){var a=[],b={buttonInput:!0,separator:!0,text:!0},c=[this.base];this._spacer!=null&&c.push(this._spacer);for(var g=0;g<c.length;g++){a[g]=[];for(var i=0;i<c[g].childNodes.length;i++)if(c[g].childNodes[i].idd!=null&&c[g].childNodes[i].style.display!="none"){var h=this.idPrefix+c[g].childNodes[i].idd;
this.objPull[h]!=null&&this.objPull[h].obj==c[g].childNodes[i]&&a[g].push({a:h,type:this.objPull[h].type,node:this.objPull[h][this.objPull[h].type=="buttonSelect"?"arw":"obj"]})}c[g]=null}for(g=0;g<a.length;g++)for(i=0;i<a[g].length;i++){var j=a[g][i];if(j.type=="buttonInput")j.node.className=j.node.className.replace(/dhx_toolbar_btn/,"dhx_toolbar_inp");var l=!1,m=!1;if(!b[j.type]){if(i==a[g].length-1||a[g][i+1]!=null&&b[a[g][i+1].type])l=!0;if(i==0||i-1>=0&&a[g][i-1]!=null&&b[a[g][i-1].type])m=!0}j.node.style.borderRight=
l?"1px solid #cecece":"0px solid white";j.node.style.borderTopRightRadius=j.node.style.borderBottomRightRadius=l?"5px":"0px";j.type=="buttonSelect"?(j.node.previousSibling.style.borderTopLeftRadius=j.node.previousSibling.style.borderBottomLeftRadius=m?"5px":"0px",j.node.previousSibling._br=l,j.node.previousSibling._bl=m):j.node.style.borderTopLeftRadius=j.node.style.borderBottomLeftRadius=m?"5px":"0px";j.node._br=l;j.node._bl=m}for(g=0;g<a.length;g++){for(i=0;i<a[g].length;i++){for(h in a[g][i])a[g][i][h]=
null;a[g][i]=null}a[g]=null}a=c=null};this._improveTerraceButtonSelect=function(a,b){var c=this.objPull[a];b==!0?(c.obj.style.borderBottomLeftRadius=c.obj._bl?"5px":"0px",c.arw.style.borderBottomRightRadius=c.obj._br?"5px":"0px"):(c.obj.style.borderBottomLeftRadius="0px",c.arw.style.borderBottomRightRadius="0px");c=null};this.setSkin=function(a,b){if(b===!0)this.cont.className=this.cont.className.replace(/dhx_toolbar_base_\d{1,}_/,"dhx_toolbar_base_"+this.iconSize+"_");else{this.skin=a;if(this.skin==
"dhx_skyblue")this.selectPolygonOffsetTop=1;if(this.skin=="dhx_web")this.selectPolygonOffsetLeft=this.selectPolygonOffsetTop=1;if(this.skin=="dhx_terrace")this.selectPolygonOffsetTop=-1,this.selectPolygonOffsetLeft=0;this.cont.className="dhx_toolbar_base_"+this.iconSize+"_"+this.skin+(this.rtl?" rtl":"")}for(var c in this.objPull){var g=this.objPull[c];if(g.type=="slider")g.pen._detectLimits(),g.pen._definePos(),g.label.className="dhx_toolbar_slider_label_"+this.skin+(this.rtl?" rtl":"");if(g.type==
"buttonSelect")g.polygon.className="dhx_toolbar_poly_"+this.iconSize+"_"+this.skin+(this.rtl?" rtl":"")}a=="dhx_terrace"&&this._improveTerraceSkin()};this.setSkin(c!=null?c:typeof dhtmlx!="undefined"&&typeof dhtmlx.skin=="string"?dhtmlx.skin:"dhx_skyblue");this.objPull={};this.anyUsed="none";this.imagePath="";this.setIconPath=this.setIconsPath=function(a){this.imagePath=a};this._doOnLoad=function(){};this.loadXML=function(a,b){if(b!=null)this._doOnLoad=function(){b()};this.callEvent("onXLS",[]);this._xmlLoader=
new dtmlXMLLoaderObject(this._xmlParser,window);this._xmlLoader.loadXML(a)};this.loadXMLString=function(a,b){if(b!=null)this._doOnLoad=function(){b()};this._xmlLoader=new dtmlXMLLoaderObject(this._xmlParser,window);this._xmlLoader.loadXMLString(a)};this._xmlParser=function(){for(var a=this.getXMLTopNode("toolbar"),c="id,type,hidden,title,text,enabled,img,imgdis,action,openAll,renderSelect,mode,maxOpen,width,value,selected,length,textMin,textMax,toolTip,valueMin,valueMax,valueNow".split(","),f="id,type,enabled,disabled,action,selected,img,text".split(","),
g=0;g<a.childNodes.length;g++)if(a.childNodes[g].tagName=="item"){for(var i={},h=0;h<c.length;h++)i[c[h]]=a.childNodes[g].getAttribute(c[h]);i.items=[];i.userdata=[];for(var j=0;j<a.childNodes[g].childNodes.length;j++){if(a.childNodes[g].childNodes[j].tagName=="item"&&i.type=="buttonSelect"){for(var l={},h=0;h<f.length;h++)l[f[h]]=a.childNodes[g].childNodes[j].getAttribute(f[h]);var m=a.childNodes[g].childNodes[j].getElementsByTagName("itemText");if(m!=null&&m[0]!=null)l.itemText=m[0].firstChild.nodeValue;
for(var k=a.childNodes[g].childNodes[j].getElementsByTagName("userdata"),h=0;h<k.length;h++){if(!l.userdata)l.userdata={};var n={};try{n.name=k[h].getAttribute("name")}catch(o){n.name=""}try{n.value=k[h].firstChild.nodeValue}catch(p){n.value=""}if(n.name!="")l.userdata[n.name]=n.value}i.items[i.items.length]=l}if(a.childNodes[g].childNodes[j].tagName=="userdata"){l={};try{l.name=a.childNodes[g].childNodes[j].getAttribute("name")}catch(q){l.name=""}try{l.value=a.childNodes[g].childNodes[j].firstChild.nodeValue}catch(r){l.value=
""}i.userdata[i.userdata.length]=l}}b._addItemToStorage(i)}b.skin=="dhx_terrace"&&b._improveTerraceSkin();b.callEvent("onXLE",[]);b._doOnLoad();this.destructor()};this._addItemToStorage=function(a,b){var c=a.id||this._genStr(24),g=a.type||"";if(g!=""&&this["_"+g+"Object"]!=null){if((typeof a.openAll=="undefined"||a.openAll==null)&&this.skin=="dhx_terrace")a.openAll=!0;this.objPull[this.idPrefix+c]=new this["_"+g+"Object"](this,c,a);this.objPull[this.idPrefix+c].type=g;this.setPosition(c,b)}if(a.userdata)for(var i=
0;i<a.userdata.length;i++)this.setUserData(c,a.userdata[i].name,a.userdata[i].value)};this._genStr=function(a){for(var b="",c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",g=0;g<a;g++)b+=c.charAt(Math.round(Math.random()*(c.length-1)));return b};this.rootTypes="button,buttonSelect,buttonTwoState,separator,label,slider,text,buttonInput".split(",");this.idPrefix=this._genStr(12);dhtmlxEventable(this);this._getObj=function(a,b){for(var c=null,g=0;g<a.childNodes.length;g++)a.childNodes[g].tagName!=
null&&String(a.childNodes[g].tagName).toLowerCase()==String(b).toLowerCase()&&(c=a.childNodes[g]);return c};this._addImgObj=function(a){var b=document.createElement("IMG");a.childNodes.length>0?a.insertBefore(b,a.childNodes[0]):a.appendChild(b);return b};this._setItemImage=function(a,b,c){c==!0?a.imgEn=b:a.imgDis=b;if(!(!a.state&&c==!0||a.state&&c==!1)){var g=this._getObj(a.obj,"img");g==null&&(g=this._addImgObj(a.obj));g.src=this.imagePath+b}};this._clearItemImage=function(a,b){b==!0?a.imgEn="":
a.imgDis="";if(!(!a.state&&b==!0||a.state&&b==!1)){var c=this._getObj(a.obj,"img");c!=null&&c.parentNode.removeChild(c)}};this._setItemText=function(a,b){var c=this._getObj(a.obj,"div");b==null||b.length==0?c!=null&&c.parentNode.removeChild(c):(c==null&&(c=document.createElement("DIV"),a.obj.appendChild(c)),c.innerHTML=b)};this._getItemText=function(a){var b=this._getObj(a.obj,"div");return b!=null?b.innerHTML:""};this._enableItem=function(a){if(!a.state){a.state=!0;this.objPull[a.id].type=="buttonTwoState"&&
this.objPull[a.id].obj.pressed==!0?(a.obj.className="dhx_toolbar_btn pres",a.obj.renderAs="dhx_toolbar_btn over"):(a.obj.className="dhx_toolbar_btn def",a.obj.renderAs=a.obj.className);if(a.arw)a.arw.className=String(a.obj.className).replace("btn","arw");var b=this._getObj(a.obj,"img");a.imgEn!=""?(b==null&&(b=this._addImgObj(a.obj)),b.src=this.imagePath+a.imgEn):b!=null&&b.parentNode.removeChild(b)}};this._disableItem=function(a){if(a.state){a.state=!1;a.obj.className="dhx_toolbar_btn "+(this.objPull[a.id].type==
"buttonTwoState"&&a.obj.pressed?"pres_":"")+"dis";a.obj.renderAs="dhx_toolbar_btn def";if(a.arw)a.arw.className=String(a.obj.className).replace("btn","arw");var b=this._getObj(a.obj,"img");a.imgDis!=""?(b==null&&(b=this._addImgObj(a.obj)),b.src=this.imagePath+a.imgDis):b!=null&&b.parentNode.removeChild(b);if(a.polygon!=null&&a.polygon.style.display!="none"){a.polygon.style.display="none";if(a.polygon._ie6cover)a.polygon._ie6cover.style.display="none";this.skin=="dhx_terrace"&&this._improveTerraceButtonSelect(a.id,
!0)}this.anyUsed="none"}};this.clearAll=function(){for(var a in this.objPull)this._removeItem(String(a).replace(this.idPrefix,""))};this._isWebToolbar=!0;this._doOnClick=function(){b&&b.forEachItem&&b.forEachItem(function(a){if(b.objPull[b.idPrefix+a].type=="buttonSelect"){var c=b.objPull[b.idPrefix+a];if(c.arw._skip===!0)c.arw._skip=!1;else if(c.polygon.style.display!="none"){c.obj.renderAs="dhx_toolbar_btn def";c.obj.className=c.obj.renderAs;c.arw.className=String(c.obj.renderAs).replace("btn",
"arw");b.anyUsed="none";c.polygon.style.display="none";if(c.polygon._ie6cover)c.polygon._ie6cover.style.display="none";b.skin=="dhx_terrace"&&b._improveTerraceButtonSelect(c.id,!0)}}})};this._isIPad?document.addEventListener("touchstart",this._doOnClick,!1):_isIE?document.body.attachEvent("onmousedown",this._doOnClick):window.addEventListener("mousedown",this._doOnClick,!1);return this}
dhtmlXToolbarObject.prototype.addSpacer=function(a){var c=this.idPrefix+a;if(this._spacer!=null){if(this._spacer.idd==a)return;if(this._spacer==this.objPull[c].obj.parentNode){for(var b=!0;b;){var d=this._spacer.childNodes[0].idd;this.base.appendChild(this._spacer.childNodes[0]);if(d==a||this._spacer.childNodes.length==0)this.objPull[c].arw!=null&&this.base.appendChild(this.objPull[c].arw),b=!1}this._spacer.idd=a;this._fixSpacer();return}if(this.base==this.objPull[c].obj.parentNode){for(var b=!0,
e=this.objPull[c].arw!=null;b;){var f=this.base.childNodes.length-1;e==!0&&this.base.childNodes[f]==this.objPull[c].arw&&(b=!1);this.base.childNodes[f].idd==a&&(b=!1);b&&(this._spacer.childNodes.length>0?this._spacer.insertBefore(this.base.childNodes[f],this._spacer.childNodes[0]):this._spacer.appendChild(this.base.childNodes[f]))}this._spacer.idd=a;this._fixSpacer();return}}else{for(var g=null,f=0;f<this.base.childNodes.length;f++)this.base.childNodes[f]==this.objPull[this.idPrefix+a].obj&&(g=f,
this.objPull[this.idPrefix+a].arw!=null&&(g=f+1));if(g!=null){this._spacer=document.createElement("DIV");this._spacer.className="dhxtoolbar_spacer "+(this.align=="right"?" float_left":" float_right");this._spacer.dir="ltr";for(this._spacer.idd=a;this.base.childNodes.length>g+1;)this._spacer.appendChild(this.base.childNodes[g+1]);this.cont.appendChild(this._spacer);this._fixSpacer()}}this.skin=="dhx_terrace"&&this._improveTerraceSkin()};
dhtmlXToolbarObject.prototype.removeSpacer=function(){if(this._spacer){for(;this._spacer.childNodes.length>0;)this.base.appendChild(this._spacer.childNodes[0]);this._spacer.parentNode.removeChild(this._spacer);this._spacer=null;this.skin=="dhx_terrace"&&this._improveTerraceSkin()}};
dhtmlXToolbarObject.prototype._fixSpacer=function(){if(_isIE&&this._spacer!=null){this._spacer.style.borderLeft="1px solid #a4bed4";var a=this._spacer;window.setTimeout(function(){a.style.borderLeft="0px solid #a4bed4";a=null},1)}};
dhtmlXToolbarObject.prototype.getType=function(a){var c=this.getParentId(a);if(c!=null){var b=null,d=this.objPull[this.idPrefix+c]._listOptions[a];d!=null&&(b=d.sep!=null?"buttonSelectSeparator":"buttonSelectButton");return b}else return this.objPull[this.idPrefix+a]==null?null:this.objPull[this.idPrefix+a].type};dhtmlXToolbarObject.prototype.getTypeExt=function(a){var c=this.getType(a);return c=="buttonSelectButton"||c=="buttonSelectSeparator"?c=c=="buttonSelectButton"?"button":"separator":null};
dhtmlXToolbarObject.prototype.inArray=function(a,c){for(var b=0;b<a.length;b++)if(a[b]==c)return!0;return!1};dhtmlXToolbarObject.prototype.getParentId=function(a){var c=null,b;for(b in this.objPull)if(this.objPull[b]._listOptions)for(var d in this.objPull[b]._listOptions)d==a&&(c=String(b).replace(this.idPrefix,""));return c};dhtmlXToolbarObject.prototype._addItem=function(a,c){this._addItemToStorage(a,c);this.skin=="dhx_terrace"&&this._improveTerraceSkin()};
dhtmlXToolbarObject.prototype.addButton=function(a,c,b,d,e){this._addItem({id:a,type:"button",text:b,img:d,imgdis:e},c)};dhtmlXToolbarObject.prototype.addText=function(a,c,b){this._addItem({id:a,type:"text",text:b},c)};
dhtmlXToolbarObject.prototype.addButtonSelect=function(a,c,b,d,e,f,g,i,h,j){for(var l=[],m=0;m<d.length;m++){var k={};d[m].id&&d[m].type?(k.id=d[m].id,k.type=d[m].type=="obj"?"button":"separator",k.text=d[m].text,k.img=d[m].img):(k.id=d[m][0],k.type=d[m][1]=="obj"?"button":"separator",k.text=d[m][2]||null,k.img=d[m][3]||null);l[l.length]=k}this._addItem({id:a,type:"buttonSelect",text:b,img:e,imgdis:f,renderSelect:g,openAll:i,items:l,maxOpen:h,mode:j},c)};
dhtmlXToolbarObject.prototype.addButtonTwoState=function(a,c,b,d,e){this._addItem({id:a,type:"buttonTwoState",img:d,imgdis:e,text:b},c)};dhtmlXToolbarObject.prototype.addSeparator=function(a,c){this._addItem({id:a,type:"separator"},c)};dhtmlXToolbarObject.prototype.addSlider=function(a,c,b,d,e,f,g,i,h){this._addItem({id:a,type:"slider",length:b,valueMin:d,valueMax:e,valueNow:f,textMin:g,textMax:i,toolTip:h},c)};
dhtmlXToolbarObject.prototype.addInput=function(a,c,b,d){this._addItem({id:a,type:"buttonInput",value:b,width:d},c)};dhtmlXToolbarObject.prototype.forEachItem=function(a){for(var c in this.objPull)this.inArray(this.rootTypes,this.objPull[c].type)&&a(this.objPull[c].id.replace(this.idPrefix,""))};
(function(){for(var a="isVisible,enableItem,disableItem,isEnabled,setItemText,getItemText,setItemToolTip,getItemToolTip,getInput,setItemImage,setItemImageDis,clearItemImage,clearItemImageDis,setItemState,getItemState,setItemToolTipTemplate,getItemToolTipTemplate,setValue,getValue,setMinValue,getMinValue,setMaxValue,getMaxValue,setWidth,getWidth,setMaxOpen".split(","),c=[!1,"","",!1,"","","","","","","","","",!1,"","","",null,"",[null,null],"",[null,null],"",null],b=function(a,b){return function(c,
d,e){c=this.idPrefix+c;return this.objPull[c][a]!=null?this.objPull[c][a].call(this.objPull[c],d,e):b}},d=0;d<a.length;d++){var e=a[d],f=c[d];dhtmlXToolbarObject.prototype[e]=b(e,f)}})();dhtmlXToolbarObject.prototype.showItem=function(a){a=this.idPrefix+a;this.objPull[a]!=null&&this.objPull[a].showItem!=null&&(this.objPull[a].showItem(),this.skin=="dhx_terrace"&&this._improveTerraceSkin())};
dhtmlXToolbarObject.prototype.hideItem=function(a){a=this.idPrefix+a;this.objPull[a]!=null&&this.objPull[a].hideItem!=null&&(this.objPull[a].hideItem(),this.skin=="dhx_terrace"&&this._improveTerraceSkin())};dhtmlXToolbarObject.prototype.getPosition=function(a){return this._getPosition(a)};
dhtmlXToolbarObject.prototype._getPosition=function(a){if(this.objPull[this.idPrefix+a]==null)return null;for(var c=null,b=0,d=0;d<this.base.childNodes.length;d++)this.base.childNodes[d].idd!=null&&(this.base.childNodes[d].idd==a&&(c=b),b++);if(!c&&this._spacer!=null)for(d=0;d<this._spacer.childNodes.length;d++)this._spacer.childNodes[d].idd!=null&&(this._spacer.childNodes[d].idd==a&&(c=b),b++);return c};dhtmlXToolbarObject.prototype.setPosition=function(a,c){this._setPosition(a,c)};
dhtmlXToolbarObject.prototype._setPosition=function(a,c){if(this.objPull[this.idPrefix+a]!=null){if(isNaN(c))c=this.base.childNodes.length;c<0&&(c=0);var b=null;if(this._spacer)b=this._spacer.idd,this.removeSpacer();var d=this.objPull[this.idPrefix+a];this.base.removeChild(d.obj);d.arw&&this.base.removeChild(d.arw);var e=this._getIdByPosition(c,!0);e[0]==null?(this.base.appendChild(d.obj),d.arw&&this.base.appendChild(d.arw)):(this.base.insertBefore(d.obj,this.base.childNodes[e[1]]),d.arw&&this.base.insertBefore(d.arw,
this.base.childNodes[e[1]+1]));b!=null&&this.addSpacer(b)}};dhtmlXToolbarObject.prototype._getIdByPosition=function(a,c){for(var b=null,d=0,e=0,f=0;f<this.base.childNodes.length;f++)this.base.childNodes[f].idd!=null&&b==null&&d++==a&&(b=this.base.childNodes[f].idd),b==null&&e++;e=b==null?null:e;return c==!0?[b,e]:b};dhtmlXToolbarObject.prototype.removeItem=function(a){this._removeItem(a);this.skin=="dhx_terrace"&&this._improveTerraceSkin()};
dhtmlXToolbarObject.prototype._removeItem=function(a){var c=this.getType(a),a=this.idPrefix+a,b=this.objPull[a];if(c=="button")b.obj._doOnMouseOver=null,b.obj._doOnMouseOut=null,b.obj._doOnMouseUp=null,b.obj._doOnMouseUpOnceAnywhere=null,b.obj.onclick=null,b.obj.onmouseover=null,b.obj.onmouseout=null,b.obj.onmouseup=null,b.obj.onmousedown=null,b.obj.onselectstart=null,b.obj.renderAs=null,b.obj.idd=null,b.obj.parentNode.removeChild(b.obj),b.obj=null,b.id=null,b.state=null,b.img=null,b.imgEn=null,b.imgDis=
null,b.type=null,b.enableItem=null,b.disableItem=null,b.isEnabled=null,b.showItem=null,b.hideItem=null,b.isVisible=null,b.setItemText=null,b.getItemText=null,b.setItemImage=null,b.clearItemImage=null,b.setItemImageDis=null,b.clearItemImageDis=null,b.setItemToolTip=null,b.getItemToolTip=null;if(c=="buttonTwoState")b.obj._doOnMouseOver=null,b.obj._doOnMouseOut=null,b.obj.onmouseover=null,b.obj.onmouseout=null,b.obj.onmousedown=null,b.obj.onselectstart=null,b.obj.renderAs=null,b.obj.idd=null,b.obj.parentNode.removeChild(b.obj),
b.obj=null,b.id=null,b.state=null,b.img=null,b.imgEn=null,b.imgDis=null,b.type=null,b.enableItem=null,b.disableItem=null,b.isEnabled=null,b.showItem=null,b.hideItem=null,b.isVisible=null,b.setItemText=null,b.getItemText=null,b.setItemImage=null,b.clearItemImage=null,b.setItemImageDis=null,b.clearItemImageDis=null,b.setItemToolTip=null,b.getItemToolTip=null,b.setItemState=null,b.getItemState=null;if(c=="buttonSelect"){for(var d in b._listOptions)this.removeListOption(a,d);b._listOptions=null;if(b.polygon._ie6cover)document.body.removeChild(b.polygon._ie6cover),
b.polygon._ie6cover=null;b.p_tbl.removeChild(b.p_tbody);b.polygon.removeChild(b.p_tbl);b.polygon.onselectstart=null;document.body.removeChild(b.polygon);b.p_tbody=null;b.p_tbl=null;b.polygon=null;b.obj.onclick=null;b.obj.onmouseover=null;b.obj.onmouseout=null;b.obj.onmouseup=null;b.obj.onmousedown=null;b.obj.onselectstart=null;b.obj.idd=null;b.obj.iddPrefix=null;b.obj.parentNode.removeChild(b.obj);b.obj=null;b.arw.onclick=null;b.arw.onmouseover=null;b.arw.onmouseout=null;b.arw.onmouseup=null;b.arw.onmousedown=
null;b.arw.onselectstart=null;b.arw.parentNode.removeChild(b.arw);b.arw=null;b.renderSelect=null;b.state=null;b.type=null;b.id=null;b.img=null;b.imgEn=null;b.imgDis=null;b.openAll=null;b._isListButton=null;b._separatorButtonSelectObject=null;b._buttonButtonSelectObject=null;b.setWidth=null;b.enableItem=null;b.disableItem=null;b.isEnabled=null;b.showItem=null;b.hideItem=null;b.isVisible=null;b.setItemText=null;b.getItemText=null;b.setItemImage=null;b.clearItemImage=null;b.setItemImageDis=null;b.clearItemImageDis=
null;b.setItemToolTip=null;b.getItemToolTip=null;b.addListOption=null;b.removeListOption=null;b.showListOption=null;b.hideListOption=null;b.isListOptionVisible=null;b.enableListOption=null;b.disableListOption=null;b.isListOptionEnabled=null;b.setListOptionPosition=null;b.getListOptionPosition=null;b.setListOptionImage=null;b.getListOptionImage=null;b.clearListOptionImage=null;b.setListOptionText=null;b.getListOptionText=null;b.setListOptionToolTip=null;b.getListOptionToolTip=null;b.forEachListOption=
null;b.getAllListOptions=null;b.setListOptionSelected=null;b.getListOptionSelected=null}if(c=="buttonInput")b.obj.childNodes[0].onkeydown=null,b.obj.removeChild(b.obj.childNodes[0]),b.obj.w=null,b.obj.idd=null,b.obj.parentNode.removeChild(b.obj),b.obj=null,b.id=null,b.type=null,b.enableItem=null,b.disableItem=null,b.isEnabled=null,b.showItem=null,b.hideItem=null,b.isVisible=null,b.setItemToolTip=null,b.getItemToolTip=null,b.setWidth=null,b.getWidth=null,b.setValue=null,b.getValue=null,b.setItemText=
null,b.getItemText=null;if(c=="slider"){this._isIPad?(document.removeEventListener("touchmove",pen._doOnMouseMoveStart,!1),document.removeEventListener("touchend",pen._doOnMouseMoveEnd,!1)):_isIE?(document.body.detachEvent("onmousemove",b.pen._doOnMouseMoveStart),document.body.detachEvent("onmouseup",b.pen._doOnMouseMoveEnd)):(window.removeEventListener("mousemove",b.pen._doOnMouseMoveStart,!1),window.removeEventListener("mouseup",b.pen._doOnMouseMoveEnd,!1));b.pen.allowMove=null;b.pen.initXY=null;
b.pen.maxX=null;b.pen.minX=null;b.pen.nowX=null;b.pen.newNowX=null;b.pen.valueMax=null;b.pen.valueMin=null;b.pen.valueNow=null;b.pen._definePos=null;b.pen._detectLimits=null;b.pen._doOnMouseMoveStart=null;b.pen._doOnMouseMoveEnd=null;b.pen.onmousedown=null;b.obj.removeChild(b.pen);b.pen=null;b.label.tip=null;document.body.removeChild(b.label);b.label=null;b.obj.onselectstart=null;for(b.obj.idd=null;b.obj.childNodes.length>0;)b.obj.removeChild(b.obj.childNodes[0]);b.obj.parentNode.removeChild(b.obj);
b.obj=null;b.id=null;b.type=null;b.state=null;b.enableItem=null;b.disableItem=null;b.isEnabled=null;b.setItemToolTipTemplate=null;b.getItemToolTipTemplate=null;b.setMaxValue=null;b.setMinValue=null;b.getMaxValue=null;b.getMinValue=null;b.setValue=null;b.getValue=null;b.showItem=null;b.hideItem=null;b.isVisible=null}if(c=="separator")b.obj.onselectstart=null,b.obj.idd=null,b.obj.parentNode.removeChild(b.obj),b.obj=null,b.id=null,b.type=null,b.showItem=null,b.hideItem=null,b.isVisible=null;if(c=="text")b.obj.onselectstart=
null,b.obj.idd=null,b.obj.parentNode.removeChild(b.obj),b.obj=null,b.id=null,b.type=null,b.showItem=null,b.hideItem=null,b.isVisible=null,b.setWidth=null,b.setItemText=null,b.getItemText=null;b=c=null;this.objPull[this.idPrefix+a]=null;delete this.objPull[this.idPrefix+a]};
(function(){for(var a="addListOption,removeListOption,showListOption,hideListOption,isListOptionVisible,enableListOption,disableListOption,isListOptionEnabled,setListOptionPosition,getListOptionPosition,setListOptionText,getListOptionText,setListOptionToolTip,getListOptionToolTip,setListOptionImage,getListOptionImage,clearListOptionImage,forEachListOption,getAllListOptions,setListOptionSelected,getListOptionSelected".split(","),c=function(a){return function(b,c,d,h,j,l){b=this.idPrefix+b;if(this.objPull[b]!=
null)return this.objPull[b].type!="buttonSelect"?void 0:this.objPull[b][a].call(this.objPull[b],c,d,h,j,l)}},b=0;b<a.length;b++){var d=a[b];dhtmlXToolbarObject.prototype[d]=c(d)}})();dhtmlXToolbarObject.prototype._rtlParseBtn=function(a,c){return a+c};
dhtmlXToolbarObject.prototype._separatorObject=function(a,c,b){this.id=a.idPrefix+c;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_sep";this.obj.style.display=b.hidden!=null?"none":"";this.obj.idd=String(c);this.obj.title=b.title||"";this.obj.onselectstart=function(a){a=a||event;a.returnValue=!1};if(a._isIPad)this.obj.ontouchstart=function(a){a=a||event;a.returnValue=!1;a.cancelBubble=!0;return!1};a.base.appendChild(this.obj);this.showItem=function(){this.obj.style.display=
""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return this.obj.style.display==""};return this};
dhtmlXToolbarObject.prototype._textObject=function(a,c,b){this.id=a.idPrefix+c;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_text";this.obj.style.display=b.hidden!=null?"none":"";this.obj.idd=String(c);this.obj.title=b.title||"";this.obj.onselectstart=function(a){a=a||event;a.returnValue=!1};if(a._isIPad)this.obj.ontouchstart=function(a){a=a||event;a.returnValue=!1;a.cancelBubble=!0;return!1};this.obj.innerHTML=b.text||"";a.base.appendChild(this.obj);this.showItem=function(){this.obj.style.display=
""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return this.obj.style.display==""};this.setItemText=function(a){this.obj.innerHTML=a};this.getItemText=function(){return this.obj.innerHTML};this.setWidth=function(a){this.obj.style.width=a+"px"};this.setItemToolTip=function(a){this.obj.title=a};this.getItemToolTip=function(){return this.obj.title};return this};
dhtmlXToolbarObject.prototype._buttonObject=function(a,c,b){this.id=a.idPrefix+c;this.state=b.enabled!=null?!1:!0;this.imgEn=b.img||"";this.imgDis=b.imgdis||"";this.img=this.state?this.imgEn!=""?this.imgEn:"":this.imgDis!=""?this.imgDis:"";this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn "+(this.state?"def":"dis");this.obj.style.display=b.hidden!=null?"none":"";this.obj.allowClick=!1;this.obj.extAction=b.action||null;this.obj.renderAs=this.obj.className;this.obj.idd=String(c);
this.obj.title=b.title||"";this.obj.pressed=!1;this.obj.innerHTML=a._rtlParseBtn(this.img!=""?"<img src='"+a.imagePath+this.img+"'>":"",b.text!=null?"<div>"+b.text+"</div>":"");var d=this;this.obj.onselectstart=function(a){a=a||event;a.returnValue=!1};this.obj.onmouseover=function(){this._doOnMouseOver()};this.obj.onmouseout=function(){this._doOnMouseOut()};this.obj._doOnMouseOver=function(){this.allowClick=!0;if(d.state!=!1&&a.anyUsed=="none")this.renderAs=this.className="dhx_toolbar_btn over"};
this.obj._doOnMouseOut=function(){this.allowClick=!1;if(d.state!=!1&&a.anyUsed=="none")this.className="dhx_toolbar_btn def",this.renderAs=this.renderAs};this.obj.onclick=function(b){if(d.state!=!1&&this.allowClick!=!1){var b=b||event,c=this.idd.replace(a.idPrefix,"");if(this.extAction)try{window[this.extAction](c)}catch(g){}a&&a.callEvent&&a.callEvent("onClick",[c])}};this.obj[a._isIPad?"ontouchstart":"onmousedown"]=function(b){if(d.state==!1)return b=b||event,b.returnValue=!1,b.cancelBubble=!0,!1;
if(a.anyUsed=="none")return a.anyUsed=this.idd,this.className="dhx_toolbar_btn pres",this.pressed=!0,this.onmouseover=function(){this._doOnMouseOver()},this.onmouseout=function(){a.anyUsed="none";this._doOnMouseOut()},!1};this.obj[a._isIPad?"ontouchend":"onmouseup"]=function(){if(d.state!=!1&&!(a.anyUsed!="none"&&a.anyUsed!=this.idd)){var b=a.anyUsed;this._doOnMouseUp();a._isIPad&&b!="none"&&a.callEvent("onClick",[this.idd.replace(a.idPrefix,"")])}};if(a._isIPad)this.obj.ontouchmove=function(){this._doOnMouseUp()};
this.obj._doOnMouseUp=function(){a.anyUsed="none";this.className=this.renderAs;this.pressed=!1};this.obj._doOnMouseUpOnceAnywhere=function(){this._doOnMouseUp();this.onmouseover=function(){this._doOnMouseOver()};this.onmouseout=function(){this._doOnMouseOut()}};a.base.appendChild(this.obj);this.enableItem=function(){a._enableItem(this)};this.disableItem=function(){a._disableItem(this)};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display=
"none"};this.isVisible=function(){return this.obj.style.display==""};this.setItemText=function(b){a._setItemText(this,b)};this.getItemText=function(){return a._getItemText(this)};this.setItemImage=function(b){a._setItemImage(this,b,!0)};this.clearItemImage=function(){a._clearItemImage(this,!0)};this.setItemImageDis=function(b){a._setItemImage(this,b,!1)};this.clearItemImageDis=function(){a._clearItemImage(this,!1)};this.setItemToolTip=function(a){this.obj.title=a};this.getItemToolTip=function(){return this.obj.title};
return this};
dhtmlXToolbarObject.prototype._buttonSelectObject=function(a,c,b){this.id=a.idPrefix+c;this.state=b.enabled!=null?b.enabled=="true"?!0:!1:!0;this.imgEn=b.img||"";this.imgDis=b.imgdis||"";this.img=this.state?this.imgEn!=""?this.imgEn:"":this.imgDis!=""?this.imgDis:"";this.mode=b.mode||"button";if(this.mode=="select"){if(this.openAll=!0,this.renderSelect=!1,!b.text||b.text.length==0)b.text="&nbsp;"}else this.openAll=b.openAll=="true"||b.openAll==!0||b.openAll==1||b.openAll=="1"||b.openAll=="yes"||b.openAll==
"on",this.renderSelect=b.renderSelect!=null?b.renderSelect=="false"||b.renderSelect=="disabled"?!1:!0:!0;this.maxOpen=!isNaN(b.maxOpen?b.maxOpen:"")?b.maxOpen:null;this._maxOpenTest=function(){if(!isNaN(this.maxOpen)&&!a._sbw){var b=document.createElement("DIV");b.className="dhxtoolbar_maxopen_test";document.body.appendChild(b);var c=document.createElement("DIV");c.className="dhxtoolbar_maxopen_test2";b.appendChild(c);a._sbw=b.offsetWidth-c.offsetWidth;b.removeChild(c);c=null;document.body.removeChild(b);
b=null}};this._maxOpenTest();this.obj=document.createElement("DIV");this.obj.allowClick=!1;this.obj.extAction=b.action||null;this.obj.className="dhx_toolbar_btn "+(this.state?"def":"dis");this.obj.style.display=b.hidden!=null?"none":"";this.obj.renderAs=this.obj.className;this.obj.onselectstart=function(a){a=a||event;a.returnValue=!1};this.obj.idd=String(c);this.obj.title=b.title||"";this.callEvent=this.obj.pressed=!1;this.obj.innerHTML=a._rtlParseBtn(this.img!=""?"<img src='"+a.imagePath+this.img+
"'>":"",b.text!=null?"<div>"+b.text+"</div>":"");a.base.appendChild(this.obj);this.arw=document.createElement("DIV");this.arw.className="dhx_toolbar_arw "+(this.state?"def":"dis");this.arw.style.display=this.obj.style.display;this.arw.innerHTML="<div class='arwimg'>&nbsp;</div>";this.arw.title=this.obj.title;this.arw.onselectstart=function(a){a=a||event;a.returnValue=!1};a.base.appendChild(this.arw);var d=this;this.obj.onmouseover=function(b){b=b||event;if(a.anyUsed=="none"&&d.state)d.obj.renderAs=
"dhx_toolbar_btn over",d.obj.className=d.obj.renderAs,d.arw.className=String(d.obj.renderAs).replace("btn","arw")};this.obj.onmouseout=function(){d.obj.allowClick=!1;if(a.anyUsed=="none"&&d.state)d.obj.renderAs="dhx_toolbar_btn def",d.obj.className=d.obj.renderAs,d.arw.className=String(d.obj.renderAs).replace("btn","arw"),d.callEvent=!1};this.arw.onmouseover=this.obj.onmouseover;this.arw.onmouseout=this.obj.onmouseout;if(this.openAll!=!0)this.obj.onclick=function(b){b=b||event;if(d.obj.allowClick&&
d.state&&a.anyUsed=="none"){var c=d.obj.idd.replace(a.idPrefix,"");if(d.obj.extAction)try{window[d.obj.extAction](c)}catch(e){}a.callEvent("onClick",[c])}},this.obj[a._isIPad?"ontouchstart":"onmousedown"]=function(b){b=b||event;if(a.anyUsed=="none"&&d.state)d.obj.allowClick=!0,d.obj.className="dhx_toolbar_btn pres",d.arw.className="dhx_toolbar_arw pres",d.callEvent=!0},this.obj[a._isIPad?"ontouchend":"onmouseup"]=function(b){b=b||event;b.cancelBubble=!0;if(a.anyUsed=="none"&&d.state&&(d.obj.className=
d.obj.renderAs,d.arw.className=String(d.obj.renderAs).replace("btn","arw"),a._isIPad&&d.callEvent)){var c=d.obj.idd.replace(a.idPrefix,"");a.callEvent("onClick",[c])}};if(a._isIPad)this.obj.ontouchmove=this.obj.onmouseout;this.arw[a._isIPad?"ontouchstart":"onmousedown"]=function(b){var b=b||event,c=this.className.indexOf("dhx_toolbar_arw")===0?this:this.nextSibling;c._skip?(b=b||event,b.cancelBubble=!0):c._skip=!0;c=null;if(d.state){if(a.anyUsed==d.obj.idd){d.obj.className=d.obj.renderAs;d.arw.className=
String(d.obj.renderAs).replace("btn","arw");a.anyUsed="none";d.polygon.style.display="none";if(d.polygon._ie6cover)d.polygon._ie6cover.style.display="none";a.skin=="dhx_terrace"&&a._improveTerraceButtonSelect(d.id,!0)}else{if(a.anyUsed!="none"&&a.objPull[a.idPrefix+a.anyUsed].type=="buttonSelect"){var e=a.objPull[a.idPrefix+a.anyUsed];if(e.polygon.style.display!="none"){e.obj.renderAs="dhx_toolbar_btn def";e.obj.className=e.obj.renderAs;e.arw.className=String(d.obj.renderAs).replace("btn","arw");
e.polygon.style.display="none";if(e.polygon._ie6cover)e.polygon._ie6cover.style.display="none";a.skin=="dhx_terrace"&&a._improveTerraceButtonSelect(e.id,!0)}}d.obj.className="dhx_toolbar_btn over";d.arw.className="dhx_toolbar_arw pres";a.anyUsed=d.obj.idd;d.polygon.style.top="0px";d.polygon.style.visibility="hidden";d.polygon.style.display="";a.skin=="dhx_terrace"&&a._improveTerraceButtonSelect(d.id,!1);d._fixMaxOpenHeight(d.maxOpen||null);a._autoDetectVisibleArea();var f=getAbsoluteTop(d.obj)+d.obj.offsetHeight+
a.selectPolygonOffsetTop,l=d.polygon.offsetHeight;if(f+l>a.tY2){var m=d.maxOpen!=null?Math.floor((a.tY2-f)/22):0;m>=1?d._fixMaxOpenHeight(m):(f=getAbsoluteTop(d.obj)-l-a.selectPolygonOffsetTop,f<0&&(f=0))}d.polygon.style.top=f+"px";if(a.rtl)d.polygon.style.left=getAbsoluteLeft(d.obj)+d.obj.offsetWidth-d.polygon.offsetWidth+a.selectPolygonOffsetLeft+"px";else{var k=document.body.scrollLeft,n=k+(window.innerWidth||document.body.clientWidth),o=getAbsoluteLeft(d.obj)+a.selectPolygonOffsetLeft;o+d.polygon.offsetWidth>
n&&(o=getAbsoluteLeft(d.arw)+d.arw.offsetWidth-d.polygon.offsetWidth);d.polygon.style.left=o+"px"}d.polygon.style.visibility="visible";if(d.polygon._ie6cover)d.polygon._ie6cover.style.left=d.polygon.style.left,d.polygon._ie6cover.style.top=d.polygon.style.top,d.polygon._ie6cover.style.width=d.polygon.offsetWidth+"px",d.polygon._ie6cover.style.height=d.polygon.offsetHeight+"px",d.polygon._ie6cover.style.display=""}return!1}};this.arw.onclick=function(a){a=a||event;a.cancelBubble=!0};this.arw[a._isIPad?
"ontouchend":"onmouseup"]=function(a){a=a||event;a.cancelBubble=!0};if(this.openAll===!0&&(this.obj.onclick=this.arw.onclick,this.obj.onmousedown=this.arw.onmousedown,this.obj.onmouseup=this.arw.onmouseup,a._isIPad))this.obj.ontouchstart=this.arw.ontouchstart,this.obj.ontouchend=this.arw.ontouchend;this.obj.iddPrefix=a.idPrefix;this._listOptions={};this._fixMaxOpenHeight=function(b){var c="auto",e=!1;if(b!==null){var f=0,l;for(l in this._listOptions)f++;f>b?(this._ph=22*b,c=this._ph+"px"):e=!0}this.polygon.style.width=
"auto";this.polygon.style.height="auto";if(!e&&d.maxOpen!=null)this.polygon.style.width=this.p_tbl.offsetWidth+a._sbw+"px",this.polygon.style.height=c};this._separatorButtonSelectObject=function(a,b,c){this.obj={};this.obj.tr=document.createElement("TR");this.obj.tr.className="tr_sep";this.obj.tr.onselectstart=function(a){a=a||event;return a.returnValue=!1};this.obj.td=document.createElement("TD");this.obj.td.colSpan="2";this.obj.td.className="td_btn_sep";this.obj.td.onselectstart=function(a){a=a||
event;return a.returnValue=!1};isNaN(c)?c=d.p_tbody.childNodes.length+1:c<1&&(c=1);c>d.p_tbody.childNodes.length?d.p_tbody.appendChild(this.obj.tr):d.p_tbody.insertBefore(this.obj.tr,d.p_tbody.childNodes[c-1]);this.obj.tr.appendChild(this.obj.td);this.obj.sep=document.createElement("DIV");this.obj.sep.className="btn_sep";this.obj.sep.onselectstart=function(a){a=a||event;return a.returnValue=!1};this.obj.td.appendChild(this.obj.sep);d._listOptions[a]=this.obj;return this};this._buttonButtonSelectObject=
function(b,c,e){this.obj={};this.obj.tr=document.createElement("TR");this.obj.tr.en=c.enabled=="false"?!1:c.disabled=="true"?!1:!0;this.obj.tr.extAction=c.action||null;this.obj.tr._selected=c.selected!=null;this.obj.tr.className="tr_btn"+(this.obj.tr.en?this.obj.tr._selected&&d.renderSelect?" tr_btn_selected":"":" tr_btn_disabled");this.obj.tr.onselectstart=function(a){a=a||event;return a.returnValue=!1};this.obj.tr.idd=String(b);if(c.userdata)this.obj.userData=c.userdata;isNaN(e)?e=d.p_tbody.childNodes.length+
1:e<1&&(e=1);e>d.p_tbody.childNodes.length?d.p_tbody.appendChild(this.obj.tr):d.p_tbody.insertBefore(this.obj.tr,d.p_tbody.childNodes[e-1]);this.obj.td_a=document.createElement("TD");this.obj.td_a.className="td_btn_img";this.obj.td_a.onselectstart=function(a){a=a||event;return a.returnValue=!1};this.obj.td_b=document.createElement("TD");this.obj.td_b.className="td_btn_txt";this.obj.td_b.onselectstart=function(a){a=a||event;return a.returnValue=!1};a.rtl?(this.obj.tr.appendChild(this.obj.td_b),this.obj.tr.appendChild(this.obj.td_a)):
(this.obj.tr.appendChild(this.obj.td_a),this.obj.tr.appendChild(this.obj.td_b));if(c.img!=null)this.obj.td_a.innerHTML="<img class='btn_sel_img' src='"+a.imagePath+c.img+"' border='0'>",this.obj.tr._img=c.img;var f=c.text!=null?c.text:c.itemText||"";this.obj.td_b.innerHTML="<div class='btn_sel_text'>"+f+"</div>";this.obj.tr[a._isIPad?"ontouchstart":"onmouseover"]=function(){if(this.en&&(!this._selected||!d.renderSelect))this.className="tr_btn tr_btn_over"};this.obj.tr.onmouseout=function(){if(this.en)if(this._selected&&
d.renderSelect){if(String(this.className).search("tr_btn_selected")==-1)this.className="tr_btn tr_btn_selected"}else this.className="tr_btn"};this.obj.tr[a._isIPad?"ontouchend":"onclick"]=function(b){b=b||event;b.cancelBubble=!0;if(this.en){d.setListOptionSelected(this.idd.replace(a.idPrefix,""));d.obj.renderAs="dhx_toolbar_btn def";d.obj.className=d.obj.renderAs;d.arw.className=String(d.obj.renderAs).replace("btn","arw");d.polygon.style.display="none";if(d.polygon._ie6cover)d.polygon._ie6cover.style.display=
"none";a.skin=="dhx_terrace"&&a._improveTerraceButtonSelect(d.id,!0);a.anyUsed="none";var c=this.idd.replace(a.idPrefix,"");if(this.extAction)try{window[this.extAction](c)}catch(e){}a.callEvent("onClick",[c])}};d._listOptions[b]=this.obj;return this};this.polygon=document.createElement("DIV");this.polygon.dir="ltr";this.polygon.style.display="none";this.polygon.style.zIndex=101;this.polygon.className="dhx_toolbar_poly_"+a.iconSize+"_"+a.skin+(a.rtl?" rtl":"");this.polygon.onselectstart=function(a){a=
a||event;a.returnValue=!1};this.polygon.onmousedown=function(a){a=a||event;a.cancelBubble=!0};this.polygon.style.overflowY="auto";if(a._isIPad)this.polygon.ontouchstart=function(a){a=a||event;a.returnValue=!1;a.cancelBubble=!0;return!1};this.p_tbl=document.createElement("TABLE");this.p_tbl.className="buttons_cont";this.p_tbl.cellSpacing="0";this.p_tbl.cellPadding="0";this.p_tbl.border="0";this.polygon.appendChild(this.p_tbl);this.p_tbody=document.createElement("TBODY");this.p_tbl.appendChild(this.p_tbody);
if(b.items)for(var e=0;e<b.items.length;e++){var f="_"+(b.items[e].type||"")+"ButtonSelectObject";typeof this[f]=="function"&&new this[f](b.items[e].id||a._genStr(24),b.items[e])}document.body.appendChild(this.polygon);if(a._isIE6)this.polygon._ie6cover=document.createElement("IFRAME"),this.polygon._ie6cover.frameBorder=0,this.polygon._ie6cover.style.position="absolute",this.polygon._ie6cover.style.border="none",this.polygon._ie6cover.style.backgroundColor="#000000",this.polygon._ie6cover.style.filter=
"alpha(opacity=100)",this.polygon._ie6cover.style.display="none",this.polygon._ie6cover.setAttribute("src","javascript:false;"),document.body.appendChild(this.polygon._ie6cover);this.setWidth=function(a){this.obj.style.width=a-this.arw.offsetWidth+"px";this.polygon.style.width=this.obj.offsetWidth+this.arw.offsetWidth-2+"px";this.p_tbl.style.width=this.polygon.style.width};this.enableItem=function(){a._enableItem(this)};this.disableItem=function(){a._disableItem(this)};this.isEnabled=function(){return this.state};
this.showItem=function(){this.obj.style.display="";this.arw.style.display=""};this.hideItem=function(){this.obj.style.display="none";this.arw.style.display="none"};this.isVisible=function(){return this.obj.style.display==""};this.setItemText=function(b){a._setItemText(this,b)};this.getItemText=function(){return a._getItemText(this)};this.setItemImage=function(b){a._setItemImage(this,b,!0)};this.clearItemImage=function(){a._clearItemImage(this,!0)};this.setItemImageDis=function(b){a._setItemImage(this,
b,!1)};this.clearItemImageDis=function(){a._clearItemImage(this,!1)};this.setItemToolTip=function(a){this.obj.title=a;this.arw.title=a};this.getItemToolTip=function(){return this.obj.title};this.addListOption=function(a,b,c,d,e){if(c=="button"||c=="separator"){var f={id:a,type:c,text:d,img:e};new this["_"+c+"ButtonSelectObject"](a,f,b)}};this.removeListOption=function(a){if(this._isListButton(a,!0)){var b=this._listOptions[a];if(b.td_a!=null&&b.td_b!=null){b.td_a.onselectstart=null;for(b.td_b.onselectstart=
null;b.td_a.childNodes.length>0;)b.td_a.removeChild(b.td_a.childNodes[0]);for(;b.td_b.childNodes.length>0;)b.td_b.removeChild(b.td_b.childNodes[0]);b.tr.onselectstart=null;b.tr.onmouseover=null;b.tr.onmouseout=null;for(b.tr.onclick=null;b.tr.childNodes.length>0;)b.tr.removeChild(b.tr.childNodes[0]);b.tr.parentNode.removeChild(b.tr);b.td_a=null;b.td_b=null}else{b.sep.onselectstart=null;b.td.onselectstart=null;for(b.tr.onselectstart=null;b.td.childNodes.length>0;)b.td.removeChild(b.td.childNodes[0]);
for(;b.tr.childNodes.length>0;)b.tr.removeChild(b.tr.childNodes[0]);b.tr.parentNode.removeChild(b.tr);b.sep=null;b.td=null}b=b.tr=null;this._listOptions[a]=null;try{delete this._listOptions[a]}catch(c){}}};this.showListOption=function(a){if(this._isListButton(a,!0))this._listOptions[a].tr.style.display=""};this.hideListOption=function(a){if(this._isListButton(a,!0))this._listOptions[a].tr.style.display="none"};this.isListOptionVisible=function(a){return!this._isListButton(a,!0)?void 0:this._listOptions[a].tr.style.display!=
"none"};this.enableListOption=function(b){if(this._isListButton(b))this._listOptions[b].tr.en=!0,this._listOptions[b].tr.className="tr_btn"+(this._listOptions[b].tr._selected&&a.renderSelect?" tr_btn_selected":"")};this.disableListOption=function(a){if(this._isListButton(a))this._listOptions[a].tr.en=!1,this._listOptions[a].tr.className="tr_btn tr_btn_disabled"};this.isListOptionEnabled=function(a){return!this._isListButton(a)?void 0:this._listOptions[a].tr.en};this.setListOptionPosition=function(a,
b){if(this._listOptions[a]&&!(this.getListOptionPosition(a)==b||isNaN(b))){b<1&&(b=1);var c=this._listOptions[a].tr;this.p_tbody.removeChild(c);b>this.p_tbody.childNodes.length?this.p_tbody.appendChild(c):this.p_tbody.insertBefore(c,this.p_tbody.childNodes[b-1]);c=null}};this.getListOptionPosition=function(a){var b=-1;if(!this._listOptions[a])return b;for(var c=0;c<this.p_tbody.childNodes.length;c++)this.p_tbody.childNodes[c]==this._listOptions[a].tr&&(b=c+1);return b};this.setListOptionImage=function(b,
c){if(this._isListButton(b)){var d=this._listOptions[b].tr.childNodes[a.rtl?1:0];if(d.childNodes.length>0)d.childNodes[0].src=a.imagePath+c;else{var e=document.createElement("IMG");e.className="btn_sel_img";e.src=a.imagePath+c;d.appendChild(e)}d=null}};this.getListOptionImage=function(b){if(this._isListButton(b)){var c=this._listOptions[b].tr.childNodes[a.rtl?1:0],d=null;if(c.childNodes.length>0)d=c.childNodes[0].src;c=null;return d}};this.clearListOptionImage=function(b){if(this._isListButton(b)){for(var c=
this._listOptions[b].tr.childNodes[a.rtl?1:0];c.childNodes.length>0;)c.removeChild(c.childNodes[0]);c=null}};this.setListOptionText=function(b,c){if(this._isListButton(b))this._listOptions[b].tr.childNodes[a.rtl?0:1].childNodes[0].innerHTML=c};this.getListOptionText=function(b){return!this._isListButton(b)?void 0:this._listOptions[b].tr.childNodes[a.rtl?0:1].childNodes[0].innerHTML};this.setListOptionToolTip=function(a,b){if(this._isListButton(a))this._listOptions[a].tr.title=b};this.getListOptionToolTip=
function(a){return!this._isListButton(a)?void 0:this._listOptions[a].tr.title};this.forEachListOption=function(a){for(var b in this._listOptions)a(b)};this.getAllListOptions=function(){var a=[],b;for(b in this._listOptions)a[a.length]=b;return a};this.setListOptionSelected=function(a){for(var b in this._listOptions){var c=this._listOptions[b];if(c.td_a!=null&&c.td_b!=null&&c.tr.en)b==a?(c.tr._selected=!0,c.tr.className="tr_btn"+(this.renderSelect?" tr_btn_selected":""),this.mode=="select"&&(c.tr._img?
this.setItemImage(c.tr._img):this.clearItemImage(),this.setItemText(this.getListOptionText(a)))):(c.tr._selected=!1,c.tr.className="tr_btn");c=null}};this.getListOptionSelected=function(){var a=null,b;for(b in this._listOptions)this._listOptions[b].tr._selected==!0&&(a=b);return a};this._isListButton=function(a,b){return this._listOptions[a]==null?!1:!b&&this._listOptions[a].tr.className=="tr_sep"?!1:!0};this.setMaxOpen=function(a){this._ph=null;typeof a=="number"?(this.maxOpen=a,this._maxOpenTest()):
this.maxOpen=null};b.width&&this.setWidth(b.width);this.mode=="select"&&typeof b.selected!="undefined"&&this.setListOptionSelected(b.selected);return this};
dhtmlXToolbarObject.prototype._buttonInputObject=function(a,c,b){this.id=a.idPrefix+c;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn def";this.obj.style.display=b.hidden!=null?"none":"";this.obj.idd=String(c);this.obj.w=b.width!=null?b.width:100;this.obj.title=b.title!=null?b.title:"";this.obj.innerHTML="<input class='inp' type='text' style='-moz-user-select:text;width:"+this.obj.w+"px;'"+(b.value!=null?" value='"+b.value+"'":"")+">";var d=a,e=this;this.obj.childNodes[0].onkeydown=
function(a){a=a||event;a.keyCode==13&&d.callEvent("onEnter",[e.obj.idd,this.value])};a.base.appendChild(this.obj);this.enableItem=function(){this.obj.childNodes[0].disabled=!1};this.disableItem=function(){this.obj.childNodes[0].disabled=!0};this.isEnabled=function(){return!this.obj.childNodes[0].disabled};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return this.obj.style.display!="none"};this.setValue=function(a){this.obj.childNodes[0].value=
a};this.getValue=function(){return this.obj.childNodes[0].value};this.setWidth=function(a){this.obj.w=a;this.obj.childNodes[0].style.width=this.obj.w+"px"};this.getWidth=function(){return this.obj.w};this.setItemToolTip=function(a){this.obj.title=a};this.getItemToolTip=function(){return this.obj.title};this.getInput=function(){return this.obj.firstChild};return this};
dhtmlXToolbarObject.prototype._buttonTwoStateObject=function(a,c,b){this.id=a.idPrefix+c;this.state=b.enabled!=null?!1:!0;this.imgEn=b.img!=null?b.img:"";this.imgDis=b.imgdis!=null?b.imgdis:"";this.img=this.state?this.imgEn!=""?this.imgEn:"":this.imgDis!=""?this.imgDis:"";this.obj=document.createElement("DIV");this.obj.pressed=b.selected!=null;this.obj.extAction=b.action||null;this.obj.className="dhx_toolbar_btn "+(this.obj.pressed?"pres"+(this.state?"":"_dis"):this.state?"def":"dis");this.obj.style.display=
b.hidden!=null?"none":"";this.obj.renderAs=this.obj.className;this.obj.idd=String(c);this.obj.title=b.title||"";if(this.obj.pressed)this.obj.renderAs="dhx_toolbar_btn over";this.obj.innerHTML=a._rtlParseBtn(this.img!=""?"<img src='"+a.imagePath+this.img+"'>":"",b.text!=null?"<div>"+b.text+"</div>":"");a.base.appendChild(this.obj);var d=this;this.obj.onselectstart=function(a){a=a||event;a.returnValue=!1};this.obj.onmouseover=function(){this._doOnMouseOver()};this.obj.onmouseout=function(){this._doOnMouseOut()};
this.obj._doOnMouseOver=function(){if(d.state!=!1&&a.anyUsed=="none")this.renderAs=this.pressed?"dhx_toolbar_btn over":this.className="dhx_toolbar_btn over"};this.obj._doOnMouseOut=function(){if(d.state!=!1&&a.anyUsed=="none")this.renderAs=this.pressed?"dhx_toolbar_btn def":this.className="dhx_toolbar_btn def"};this.obj[a._isIPad?"ontouchstart":"onmousedown"]=function(){if((!a.checkEvent("onBeforeStateChange")||a.callEvent("onBeforeStateChange",[this.idd.replace(a.idPrefix,""),this.pressed]))&&d.state!=
!1&&a.anyUsed=="none"){this.className=(this.pressed=!this.pressed)?"dhx_toolbar_btn pres":this.renderAs;var b=this.idd.replace(a.idPrefix,"");if(this.extAction)try{window[this.extAction](b,this.pressed)}catch(c){}a.callEvent("onStateChange",[b,this.pressed]);return!1}};this.setItemState=function(b,c){if(this.obj.pressed!=b&&(b==!0?(this.obj.pressed=!0,this.obj.className="dhx_toolbar_btn pres"+(this.state?"":"_dis"),this.obj.renderAs="dhx_toolbar_btn over"):(this.obj.pressed=!1,this.obj.className=
"dhx_toolbar_btn "+(this.state?"def":"dis"),this.obj.renderAs=this.obj.className),c==!0)){var d=this.obj.idd.replace(a.idPrefix,"");if(this.obj.extAction)try{window[this.obj.extAction](d,this.obj.pressed)}catch(i){}a.callEvent("onStateChange",[d,this.obj.pressed])}};this.getItemState=function(){return this.obj.pressed};this.enableItem=function(){a._enableItem(this)};this.disableItem=function(){a._disableItem(this)};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display=
""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return this.obj.style.display==""};this.setItemText=function(b){a._setItemText(this,b)};this.getItemText=function(){return a._getItemText(this)};this.setItemImage=function(b){a._setItemImage(this,b,!0)};this.clearItemImage=function(){a._clearItemImage(this,!0)};this.setItemImageDis=function(b){a._setItemImage(this,b,!1)};this.clearItemImageDis=function(){a._clearItemImage(this,!1)};this.setItemToolTip=function(a){this.obj.title=
a};this.getItemToolTip=function(){return this.obj.title};return this};
dhtmlXToolbarObject.prototype._sliderObject=function(a,c,b){this.id=a.idPrefix+c;this.state=b.enabled!=null?b.enabled=="true"?!0:!1:!0;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn "+(this.state?"def":"dis");this.obj.style.display=b.hidden!=null?"none":"";this.obj.onselectstart=function(a){a=a||event;a.returnValue=!1};this.obj.idd=String(c);this.obj.len=b.length!=null?Number(b.length):50;this.obj.innerHTML="<div>"+(b.textMin||"")+"</div><div class='sl_bg_l'></div><div class='sl_bg_m' style='width:"+
this.obj.len+"px;'></div><div class='sl_bg_r'></div><div>"+(b.textMax||"")+"</div>";a.base.appendChild(this.obj);var d=this;this.pen=document.createElement("DIV");this.pen.className="sl_pen";this.obj.appendChild(this.pen);var e=this.pen;this.label=document.createElement("DIV");this.label.dir="ltr";this.label.className="dhx_toolbar_slider_label_"+a.skin+(a.rtl?"_rtl":"");this.label.style.display="none";this.label.tip=b.toolTip||"%v";document.body.appendChild(this.label);var f=this.label;this.pen.valueMin=
b.valueMin!=null?Number(b.valueMin):0;this.pen.valueMax=b.valueMax!=null?Number(b.valueMax):100;if(this.pen.valueMin>this.pen.valueMax)this.pen.valueMin=this.pen.valueMax;this.pen.valueNow=b.valueNow!=null?Number(b.valueNow):this.pen.valueMax;if(this.pen.valueNow>this.pen.valueMax)this.pen.valueNow=this.pen.valueMax;if(this.pen.valueNow<this.pen.valueMin)this.pen.valueNow=this.pen.valueMin;this.pen._detectLimits=function(){this.minX=d.obj.childNodes[1].offsetLeft-4;this.maxX=d.obj.childNodes[3].offsetLeft-
this.offsetWidth+1};this.pen._detectLimits();this.pen._definePos=function(){this.nowX=Math.round((this.valueNow-this.valueMin)*(this.maxX-this.minX)/(this.valueMax-this.valueMin)+this.minX);this.style.left=this.nowX+"px";this.newNowX=this.nowX};this.pen._definePos();this.pen.initXY=0;this.pen.allowMove=!1;this.pen[a._isIPad?"ontouchstart":"onmousedown"]=function(b){if(d.state!=!1&&(b=b||event,this.initXY=a._isIPad?b.touches[0].clientX:b.clientX,this.newValueNow=this.valueNow,this.allowMove=!0,this.className=
"sl_pen over",f.tip!=""))f.style.visibility="hidden",f.style.display="",f.innerHTML=f.tip.replace("%v",this.valueNow),f.style.left=Math.round(getAbsoluteLeft(this)+this.offsetWidth/2-f.offsetWidth/2)+"px",f.style.top=getAbsoluteTop(this)-f.offsetHeight-3+"px",f.style.visibility=""};this.pen._doOnMouseMoveStart=function(b){b=b||event;if(e.allowMove){var c=a._isIPad?b.touches[0].clientX:b.clientX,d=c-e.initXY;if(!(c<getAbsoluteLeft(e)+Math.round(e.offsetWidth/2)&&e.nowX==e.minX)&&!(c>getAbsoluteLeft(e)+
Math.round(e.offsetWidth/2)&&e.nowX==e.maxX)){e.newNowX=e.nowX+d;if(e.newNowX<e.minX)e.newNowX=e.minX;if(e.newNowX>e.maxX)e.newNowX=e.maxX;e.nowX=e.newNowX;e.style.left=e.nowX+"px";e.initXY=c;e.newValueNow=Math.round((e.valueMax-e.valueMin)*(e.newNowX-e.minX)/(e.maxX-e.minX)+e.valueMin);if(f.tip!="")f.innerHTML=f.tip.replace(/%v/gi,e.newValueNow),f.style.left=Math.round(getAbsoluteLeft(e)+e.offsetWidth/2-f.offsetWidth/2)+"px",f.style.top=getAbsoluteTop(e)-f.offsetHeight-3+"px";b.cancelBubble=!0;return b.returnValue=
!1}}};this.pen._doOnMouseMoveEnd=function(){if(e.allowMove){e.className="sl_pen";e.allowMove=!1;e.nowX=e.newNowX;e.valueNow=e.newValueNow;if(f.tip!="")f.style.display="none";a.callEvent("onValueChange",[d.obj.idd.replace(a.idPrefix,""),e.valueNow])}};a._isIPad?(document.addEventListener("touchmove",e._doOnMouseMoveStart,!1),document.addEventListener("touchend",e._doOnMouseMoveEnd,!1)):_isIE?(document.body.attachEvent("onmousemove",e._doOnMouseMoveStart),document.body.attachEvent("onmouseup",e._doOnMouseMoveEnd)):
(window.addEventListener("mousemove",e._doOnMouseMoveStart,!1),window.addEventListener("mouseup",e._doOnMouseMoveEnd,!1));this.enableItem=function(){if(!this.state)this.state=!0,this.obj.className="dhx_toolbar_btn def"};this.disableItem=function(){if(this.state)this.state=!1,this.obj.className="dhx_toolbar_btn dis"};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return this.obj.style.display==
""};this.setValue=function(b,c){b=Number(b);if(b<this.pen.valueMin)b=this.pen.valueMin;if(b>this.pen.valueMax)b=this.pen.valueMax;this.pen.valueNow=b;this.pen._definePos();c==!0&&a.callEvent("onValueChange",[this.obj.idd.replace(a.idPrefix,""),this.pen.valueNow])};this.getValue=function(){return this.pen.valueNow};this.setMinValue=function(a,b){a=Number(a);if(!(a>this.pen.valueMax)){this.obj.childNodes[0].innerHTML=b;this.obj.childNodes[0].style.display=b.length>0?"":"none";this.pen.valueMin=a;if(this.pen.valueNow<
this.pen.valueMin)this.pen.valueNow=this.pen.valueMin;this.pen._detectLimits();this.pen._definePos()}};this.setMaxValue=function(a,b){a=Number(a);if(!(a<this.pen.valueMin)){this.obj.childNodes[4].innerHTML=b;this.obj.childNodes[4].style.display=b.length>0?"":"none";this.pen.valueMax=a;if(this.pen.valueNow>this.pen.valueMax)this.pen.valueNow=this.pen.valueMax;this.pen._detectLimits();this.pen._definePos()}};this.getMinValue=function(){var a=this.obj.childNodes[0].innerHTML,b=this.pen.valueMin;return[b,
a]};this.getMaxValue=function(){var a=this.obj.childNodes[4].innerHTML,b=this.pen.valueMax;return[b,a]};this.setItemToolTipTemplate=function(a){this.label.tip=a};this.getItemToolTipTemplate=function(){return this.label.tip};return this};
dhtmlXToolbarObject.prototype.unload=function(){this._isIPad?document.removeEventListener("touchstart",this._doOnClick,!1):_isIE?document.body.detachEvent("onmousedown",this._doOnClick):window.removeEventListener("mousedown",this._doOnClick,!1);this._doOnClick=null;this.clearAll();this.objPull=null;if(this._xmlLoader)this._xmlLoader.destructor(),this._xmlLoader=null;for(;this.base.childNodes.length>0;)this.base.removeChild(this.base.childNodes[0]);this.cont.removeChild(this.base);for(this.base=null;this.cont.childNodes.length>
0;)this.cont.removeChild(this.cont.childNodes[0]);this.cont.className="";this.cont=null;this.detachAllEvents();this.items=this.setMaxOpen=this.getUserData=this.setUserData=this.unload=this.getListOptionSelected=this.setListOptionSelected=this.getAllListOptions=this.forEachListOption=this.clearListOptionImage=this.getListOptionImage=this.setListOptionImage=this.getListOptionToolTip=this.setListOptionToolTip=this.getListOptionText=this.setListOptionText=this.getListOptionPosition=this.setListOptionPosition=
this.isListOptionEnabled=this.disableListOption=this.enableListOption=this.isListOptionVisible=this.hideListOption=this.showListOption=this.removeListOption=this.addListOption=this.removeItem=this.setPosition=this.getPosition=this.getWidth=this.setWidth=this.getMaxValue=this.setMaxValue=this.getMinValue=this.setMinValue=this.getValue=this.setValue=this.getItemToolTipTemplate=this.setItemToolTipTemplate=this.getItemState=this.setItemState=this.clearItemImageDis=this.clearItemImage=this.setItemImageDis=
this.setItemImage=this.getItemToolTip=this.setItemToolTip=this.getItemText=this.setItemText=this.isEnabled=this.disableItem=this.enableItem=this.isVisible=this.hideItem=this.showItem=this.forEachItem=this.addInput=this.addSlider=this.addSeparator=this.addButtonTwoState=this.addButtonSelect=this.addText=this.addButton=this.getParentId=this.inArray=this.getTypeExt=this.getType=this.removeSpacer=this.addSpacer=this.clearAll=this.detachAllEvents=this.detachEvent=this.eventCatcher=this.checkEvent=this.callEvent=
this.attachEvent=this.loadXMLString=this.loadXML=this.setIconPath=this.setIconsPath=this.setSkin=this.setAlign=this._removeItem=this._autoDetectVisibleArea=this._sliderObject=this._buttonTwoStateObject=this._buttonInputObject=this._buttonSelectObject=this._buttonObject=this._textObject=this._separatorObject=this._getIdByPosition=this._setPosition=this._getPosition=this._addItem=this._genStr=this._addItemToStorage=this._doOnLoad=this._xmlParser=this._disableItem=this._enableItem=this._getItemText=
this._setItemText=this._clearItemImage=this._setItemImage=this._addImgObj=this._getObj=this._sbw=this.setRTL=this._rtlParseBtn=this._rtl=this.skin=this.selectPolygonOffsetTop=this.selectPolygonOffsetLeft=this.rootTypes=this.imagePath=this.idPrefix=this.anyUsed=this.align=this._isWebToolbar=this._isIE6=this.tY2=this.tY1=this.tX2=this.tX1=null};
dhtmlXToolbarObject.prototype._autoDetectVisibleArea=function(){this.tX1=document.body.scrollLeft;this.tX2=this.tX1+(window.innerWidth||document.body.clientWidth);this.tY1=Math.max((_isIE?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop);this.tY2=this.tY1+(_isIE?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0):window.innerHeight)};
dhtmlXToolbarObject.prototype.setUserData=function(a,c,b){if(this.objPull[this.idPrefix+a]!=null){var d=this.objPull[this.idPrefix+a];if(d.userData==null)d.userData={};d.userData[c]=b}};dhtmlXToolbarObject.prototype.getUserData=function(a,c){return this.objPull[this.idPrefix+a]==null?null:this.objPull[this.idPrefix+a].userData==null?null:this.objPull[this.idPrefix+a].userData[c]==null?null:this.objPull[this.idPrefix+a].userData[c]};
dhtmlXToolbarObject.prototype._isListOptionExists=function(a,c){if(this.objPull[this.idPrefix+a]==null)return!1;var b=this.objPull[this.idPrefix+a];return b.type!="buttonSelect"?!1:b._listOptions[c]==null?!1:!0};dhtmlXToolbarObject.prototype.setListOptionUserData=function(a,c,b,d){if(this._isListOptionExists(a,c)){var e=this.objPull[this.idPrefix+a]._listOptions[c];if(e.userData==null)e.userData={};e.userData[b]=d}};
dhtmlXToolbarObject.prototype.getListOptionUserData=function(a,c,b){if(!this._isListOptionExists(a,c))return null;var d=this.objPull[this.idPrefix+a]._listOptions[c];return!d.userData?null:d.userData[b]?d.userData[b]:null};
(function(){dhtmlx.extend_api("dhtmlXToolbarObject",{_init:function(a){return[a.parent,a.skin]},icon_path:"setIconsPath",xml:"loadXML",items:"items",align:"setAlign",rtl:"setRTL",skin:"setSkin"},{items:function(a){for(var c=0;c<a.length;c++){var b=a[c];b.type=="button"&&this.addButton(b.id,null,b.text,b.img,b.img_disabled);b.type=="separator"&&this.addSeparator(b.id,null);b.type=="text"&&this.addText(b.id,null,b.text);b.type=="buttonSelect"&&this.addButtonSelect(b.id,null,b.text,b.options,b.img,b.img_disabled,
b.renderSelect,b.openAll,b.maxOpen);b.type=="buttonTwoState"&&this.addButtonTwoState(b.id,null,b.text,b.img,b.img_disabled);b.type=="buttonInput"&&this.addInput(b.id,null,b.text);b.type=="slider"&&this.addSlider(b.id,null,b.length,b.value_min,b.value_max,b.value_now,b.text_min,b.text_max,b.tip_template);b.width&&this.setWidth(b.id,b.width);b.disabled&&this.disableItem(b.id);b.tooltip&&this.setItemToolTip(b.id,b.tooltip);b.pressed===!0&&this.setItemState(b.id,!0)}}})})();dhtmlx.skin="dhx_skyblue";
